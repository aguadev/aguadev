/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

/*
	This is an optimized version of Dojo, built for deployment and not for
	development. To get sources and documentation, please visit:

		http://dojotoolkit.org
*/

if(!dojo._hasResource["dijit._base.manager"]){dojo._hasResource["dijit._base.manager"]=true;dojo.provide("dijit._base.manager");dojo.declare("dijit.WidgetSet",null,{constructor:function(){this._hash={};this.length=0;},add:function(_1){if(this._hash[_1.id]){throw new Error("Tried to register widget with id=="+_1.id+" but that id is already registered");}this._hash[_1.id]=_1;this.length++;},remove:function(id){if(this._hash[id]){delete this._hash[id];this.length--;}},forEach:function(_2,_3){_3=_3||dojo.global;var i=0,id;for(id in this._hash){_2.call(_3,this._hash[id],i++,this._hash);}return this;},filter:function(_4,_5){_5=_5||dojo.global;var _6=new dijit.WidgetSet(),i=0,id;for(id in this._hash){var w=this._hash[id];if(_4.call(_5,w,i++,this._hash)){_6.add(w);}}return _6;},byId:function(id){return this._hash[id];},byClass:function(_7){var _8=new dijit.WidgetSet(),id,_9;for(id in this._hash){_9=this._hash[id];if(_9.declaredClass==_7){_8.add(_9);}}return _8;},toArray:function(){var ar=[];for(var id in this._hash){ar.push(this._hash[id]);}return ar;},map:function(_a,_b){return dojo.map(this.toArray(),_a,_b);},every:function(_c,_d){_d=_d||dojo.global;var x=0,i;for(i in this._hash){if(!_c.call(_d,this._hash[i],x++,this._hash)){return false;}}return true;},some:function(_e,_f){_f=_f||dojo.global;var x=0,i;for(i in this._hash){if(_e.call(_f,this._hash[i],x++,this._hash)){return true;}}return false;}});(function(){dijit.registry=new dijit.WidgetSet();var _10=dijit.registry._hash,_11=dojo.attr,_12=dojo.hasAttr,_13=dojo.style;dijit.byId=function(id){return typeof id=="string"?_10[id]:id;};var _14={};dijit.getUniqueId=function(_15){var id;do{id=_15+"_"+(_15 in _14?++_14[_15]:_14[_15]=0);}while(_10[id]);return dijit._scopeName=="dijit"?id:dijit._scopeName+"_"+id;};dijit.findWidgets=function(_16){var _17=[];function _18(_19){for(var _1a=_19.firstChild;_1a;_1a=_1a.nextSibling){if(_1a.nodeType==1){var _1b=_1a.getAttribute("widgetId");if(_1b){var _1c=_10[_1b];if(_1c){_17.push(_1c);}}else{_18(_1a);}}}};_18(_16);return _17;};dijit._destroyAll=function(){dijit._curFocus=null;dijit._prevFocus=null;dijit._activeStack=[];dojo.forEach(dijit.findWidgets(dojo.body()),function(_1d){if(!_1d._destroyed){if(_1d.destroyRecursive){_1d.destroyRecursive();}else{if(_1d.destroy){_1d.destroy();}}}});};if(dojo.isIE){dojo.addOnWindowUnload(function(){dijit._destroyAll();});}dijit.byNode=function(_1e){return _10[_1e.getAttribute("widgetId")];};dijit.getEnclosingWidget=function(_1f){while(_1f){var id=_1f.getAttribute&&_1f.getAttribute("widgetId");if(id){return _10[id];}_1f=_1f.parentNode;}return null;};var _20=(dijit._isElementShown=function(_21){var s=_13(_21);return (s.visibility!="hidden")&&(s.visibility!="collapsed")&&(s.display!="none")&&(_11(_21,"type")!="hidden");});dijit.hasDefaultTabStop=function(_22){switch(_22.nodeName.toLowerCase()){case "a":return _12(_22,"href");case "area":case "button":case "input":case "object":case "select":case "textarea":return true;case "iframe":var _23;try{var _24=_22.contentDocument;if("designMode" in _24&&_24.designMode=="on"){return true;}_23=_24.body;}catch(e1){try{_23=_22.contentWindow.document.body;}catch(e2){return false;}}return _23.contentEditable=="true"||(_23.firstChild&&_23.firstChild.contentEditable=="true");default:return _22.contentEditable=="true";}};var _25=(dijit.isTabNavigable=function(_26){if(_11(_26,"disabled")){return false;}else{if(_12(_26,"tabIndex")){return _11(_26,"tabIndex")>=0;}else{return dijit.hasDefaultTabStop(_26);}}});dijit._getTabNavigable=function(_27){var _28,_29,_2a,_2b,_2c,_2d,_2e={};function _2f(_30){return _30&&_30.tagName.toLowerCase()=="input"&&_30.type&&_30.type.toLowerCase()=="radio"&&_30.name&&_30.name.toLowerCase();};var _31=function(_32){dojo.query("> *",_32).forEach(function(_33){if((dojo.isIE&&_33.scopeName!=="HTML")||!_20(_33)){return;}if(_25(_33)){var _34=_11(_33,"tabIndex");if(!_12(_33,"tabIndex")||_34==0){if(!_28){_28=_33;}_29=_33;}else{if(_34>0){if(!_2a||_34<_2b){_2b=_34;_2a=_33;}if(!_2c||_34>=_2d){_2d=_34;_2c=_33;}}}var rn=_2f(_33);if(dojo.attr(_33,"checked")&&rn){_2e[rn]=_33;}}if(_33.nodeName.toUpperCase()!="SELECT"){_31(_33);}});};if(_20(_27)){_31(_27);}function rs(_35){return _2e[_2f(_35)]||_35;};return {first:rs(_28),last:rs(_29),lowest:rs(_2a),highest:rs(_2c)};};dijit.getFirstInTabbingOrder=function(_36){var _37=dijit._getTabNavigable(dojo.byId(_36));return _37.lowest?_37.lowest:_37.first;};dijit.getLastInTabbingOrder=function(_38){var _39=dijit._getTabNavigable(dojo.byId(_38));return _39.last?_39.last:_39.highest;};dijit.defaultDuration=dojo.config["defaultDuration"]||200;})();}if(!dojo._hasResource["dojo.Stateful"]){dojo._hasResource["dojo.Stateful"]=true;dojo.provide("dojo.Stateful");dojo.declare("dojo.Stateful",null,{postscript:function(_3a){if(_3a){dojo.mixin(this,_3a);}},get:function(_3b){return this[_3b];},set:function(_3c,_3d){if(typeof _3c==="object"){for(var x in _3c){this.set(x,_3c[x]);}return this;}var _3e=this[_3c];this[_3c]=_3d;if(this._watchCallbacks){this._watchCallbacks(_3c,_3e,_3d);}return this;},watch:function(_3f,_40){var _41=this._watchCallbacks;if(!_41){var _42=this;_41=this._watchCallbacks=function(_43,_44,_45,_46){var _47=function(_48){if(_48){_48=_48.slice();for(var i=0,l=_48.length;i<l;i++){try{_48[i].call(_42,_43,_44,_45);}catch(e){console.error(e);}}}};_47(_41["_"+_43]);if(!_46){_47(_41["*"]);}};}if(!_40&&typeof _3f==="function"){_40=_3f;_3f="*";}else{_3f="_"+_3f;}var _49=_41[_3f];if(typeof _49!=="object"){_49=_41[_3f]=[];}_49.push(_40);return {unwatch:function(){_49.splice(dojo.indexOf(_49,_40),1);}};}});}if(!dojo._hasResource["dijit._WidgetBase"]){dojo._hasResource["dijit._WidgetBase"]=true;dojo.provide("dijit._WidgetBase");(function(){dojo.declare("dijit._WidgetBase",dojo.Stateful,{id:"",lang:"",dir:"","class":"",style:"",title:"",tooltip:"",baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,attributeMap:{id:"",dir:"",lang:"","class":"",style:"",title:""},_blankGif:(dojo.config.blankGif||dojo.moduleUrl("dojo","resources/blank.gif")).toString(),postscript:function(_4a,_4b){this.create(_4a,_4b);},create:function(_4c,_4d){this.srcNodeRef=dojo.byId(_4d);this._connects=[];this._subscribes=[];if(this.srcNodeRef&&(typeof this.srcNodeRef.id=="string")){this.id=this.srcNodeRef.id;}if(_4c){this.params=_4c;dojo._mixin(this,_4c);}this.postMixInProperties();if(!this.id){this.id=dijit.getUniqueId(this.declaredClass.replace(/\./g,"_"));}dijit.registry.add(this);this.buildRendering();if(this.domNode){this._applyAttributes();var _4e=this.srcNodeRef;if(_4e&&_4e.parentNode&&this.domNode!==_4e){_4e.parentNode.replaceChild(this.domNode,_4e);}}if(this.domNode){this.domNode.setAttribute("widgetId",this.id);}this.postCreate();if(this.srcNodeRef&&!this.srcNodeRef.parentNode){delete this.srcNodeRef;}this._created=true;},_applyAttributes:function(){var _4f=function(_50,_51){if((_51.params&&_50 in _51.params)||_51[_50]){_51.set(_50,_51[_50]);}};for(var _52 in this.attributeMap){_4f(_52,this);}dojo.forEach(this._getSetterAttributes(),function(a){if(!(a in this.attributeMap)){_4f(a,this);}},this);},_getSetterAttributes:function(){var _53=this.constructor;if(!_53._setterAttrs){var r=(_53._setterAttrs=[]),_54,_55=_53.prototype;for(var _56 in _55){if(dojo.isFunction(_55[_56])&&(_54=_56.match(/^_set([a-zA-Z]*)Attr$/))&&_54[1]){r.push(_54[1].charAt(0).toLowerCase()+_54[1].substr(1));}}}return _53._setterAttrs;},postMixInProperties:function(){},buildRendering:function(){if(!this.domNode){this.domNode=this.srcNodeRef||dojo.create("div");}if(this.baseClass){var _57=this.baseClass.split(" ");if(!this.isLeftToRight()){_57=_57.concat(dojo.map(_57,function(_58){return _58+"Rtl";}));}dojo.addClass(this.domNode,_57);}},postCreate:function(){},startup:function(){this._started=true;},destroyRecursive:function(_59){this._beingDestroyed=true;this.destroyDescendants(_59);this.destroy(_59);},destroy:function(_5a){this._beingDestroyed=true;this.uninitialize();var d=dojo,dfe=d.forEach,dun=d.unsubscribe;dfe(this._connects,function(_5b){dfe(_5b,d.disconnect);});dfe(this._subscribes,function(_5c){dun(_5c);});dfe(this._supportingWidgets||[],function(w){if(w.destroyRecursive){w.destroyRecursive();}else{if(w.destroy){w.destroy();}}});this.destroyRendering(_5a);dijit.registry.remove(this.id);this._destroyed=true;},destroyRendering:function(_5d){if(this.bgIframe){this.bgIframe.destroy(_5d);delete this.bgIframe;}if(this.domNode){if(_5d){dojo.removeAttr(this.domNode,"widgetId");}else{dojo.destroy(this.domNode);}delete this.domNode;}if(this.srcNodeRef){if(!_5d){dojo.destroy(this.srcNodeRef);}delete this.srcNodeRef;}},destroyDescendants:function(_5e){dojo.forEach(this.getChildren(),function(_5f){if(_5f.destroyRecursive){_5f.destroyRecursive(_5e);}});},uninitialize:function(){return false;},_setClassAttr:function(_60){var _61=this[this.attributeMap["class"]||"domNode"];dojo.replaceClass(_61,_60,this["class"]);this._set("class",_60);},_setStyleAttr:function(_62){var _63=this[this.attributeMap.style||"domNode"];if(dojo.isObject(_62)){dojo.style(_63,_62);}else{if(_63.style.cssText){_63.style.cssText+="; "+_62;}else{_63.style.cssText=_62;}}this._set("style",_62);},_attrToDom:function(_64,_65){var _66=this.attributeMap[_64];dojo.forEach(dojo.isArray(_66)?_66:[_66],function(_67){var _68=this[_67.node||_67||"domNode"];var _69=_67.type||"attribute";switch(_69){case "attribute":if(dojo.isFunction(_65)){_65=dojo.hitch(this,_65);}var _6a=_67.attribute?_67.attribute:(/^on[A-Z][a-zA-Z]*$/.test(_64)?_64.toLowerCase():_64);dojo.attr(_68,_6a,_65);break;case "innerText":_68.innerHTML="";_68.appendChild(dojo.doc.createTextNode(_65));break;case "innerHTML":_68.innerHTML=_65;break;case "class":dojo.replaceClass(_68,_65,this[_64]);break;}},this);},get:function(_6b){var _6c=this._getAttrNames(_6b);return this[_6c.g]?this[_6c.g]():this[_6b];},set:function(_6d,_6e){if(typeof _6d==="object"){for(var x in _6d){this.set(x,_6d[x]);}return this;}var _6f=this._getAttrNames(_6d);if(this[_6f.s]){var _70=this[_6f.s].apply(this,Array.prototype.slice.call(arguments,1));}else{if(_6d in this.attributeMap){this._attrToDom(_6d,_6e);}this._set(_6d,_6e);}return _70||this;},_attrPairNames:{},_getAttrNames:function(_71){var apn=this._attrPairNames;if(apn[_71]){return apn[_71];}var uc=_71.charAt(0).toUpperCase()+_71.substr(1);return (apn[_71]={n:_71+"Node",s:"_set"+uc+"Attr",g:"_get"+uc+"Attr"});},_set:function(_72,_73){var _74=this[_72];this[_72]=_73;if(this._watchCallbacks&&this._created&&_73!==_74){this._watchCallbacks(_72,_74,_73);}},toString:function(){return "[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]";},getDescendants:function(){return this.containerNode?dojo.query("[widgetId]",this.containerNode).map(dijit.byNode):[];},getChildren:function(){return this.containerNode?dijit.findWidgets(this.containerNode):[];},connect:function(obj,_75,_76){var _77=[dojo._connect(obj,_75,this,_76)];this._connects.push(_77);return _77;},disconnect:function(_78){for(var i=0;i<this._connects.length;i++){if(this._connects[i]==_78){dojo.forEach(_78,dojo.disconnect);this._connects.splice(i,1);return;}}},subscribe:function(_79,_7a){var _7b=dojo.subscribe(_79,this,_7a);this._subscribes.push(_7b);return _7b;},unsubscribe:function(_7c){for(var i=0;i<this._subscribes.length;i++){if(this._subscribes[i]==_7c){dojo.unsubscribe(_7c);this._subscribes.splice(i,1);return;}}},isLeftToRight:function(){return this.dir?(this.dir=="ltr"):dojo._isBodyLtr();},placeAt:function(_7d,_7e){if(_7d.declaredClass&&_7d.addChild){_7d.addChild(this,_7e);}else{dojo.place(this.domNode,_7d,_7e);}return this;}});})();}if(!dojo._hasResource["dojo.window"]){dojo._hasResource["dojo.window"]=true;dojo.provide("dojo.window");dojo.getObject("window",true,dojo);dojo.window.getBox=function(){var _7f=(dojo.doc.compatMode=="BackCompat")?dojo.body():dojo.doc.documentElement;var _80=dojo._docScroll();return {w:_7f.clientWidth,h:_7f.clientHeight,l:_80.x,t:_80.y};};dojo.window.get=function(doc){if(dojo.isIE&&window!==document.parentWindow){doc.parentWindow.execScript("document._parentWindow = window;","Javascript");var win=doc._parentWindow;doc._parentWindow=null;return win;}return doc.parentWindow||doc.defaultView;};dojo.window.scrollIntoView=function(_81,pos){try{_81=dojo.byId(_81);var doc=_81.ownerDocument||dojo.doc,_82=doc.body||dojo.body(),_83=doc.documentElement||_82.parentNode,_84=dojo.isIE,_85=dojo.isWebKit;if((!(dojo.isMoz||_84||_85||dojo.isOpera)||_81==_82||_81==_83)&&(typeof _81.scrollIntoView!="undefined")){_81.scrollIntoView(false);return;}var _86=doc.compatMode=="BackCompat",_87=(_84>=9&&_81.ownerDocument.parentWindow.frameElement)?((_83.clientHeight>0&&_83.clientWidth>0&&(_82.clientHeight==0||_82.clientWidth==0||_82.clientHeight>_83.clientHeight||_82.clientWidth>_83.clientWidth))?_83:_82):(_86?_82:_83),_88=_85?_82:_87,_89=_87.clientWidth,_8a=_87.clientHeight,rtl=!dojo._isBodyLtr(),_8b=pos||dojo.position(_81),el=_81.parentNode,_8c=function(el){return ((_84<=6||(_84&&_86))?false:(dojo.style(el,"position").toLowerCase()=="fixed"));};if(_8c(_81)){return;}while(el){if(el==_82){el=_88;}var _8d=dojo.position(el),_8e=_8c(el);if(el==_88){_8d.w=_89;_8d.h=_8a;if(_88==_83&&_84&&rtl){_8d.x+=_88.offsetWidth-_8d.w;}if(_8d.x<0||!_84){_8d.x=0;}if(_8d.y<0||!_84){_8d.y=0;}}else{var pb=dojo._getPadBorderExtents(el);_8d.w-=pb.w;_8d.h-=pb.h;_8d.x+=pb.l;_8d.y+=pb.t;var _8f=el.clientWidth,_90=_8d.w-_8f;if(_8f>0&&_90>0){_8d.w=_8f;_8d.x+=(rtl&&(_84||el.clientLeft>pb.l))?_90:0;}_8f=el.clientHeight;_90=_8d.h-_8f;if(_8f>0&&_90>0){_8d.h=_8f;}}if(_8e){if(_8d.y<0){_8d.h+=_8d.y;_8d.y=0;}if(_8d.x<0){_8d.w+=_8d.x;_8d.x=0;}if(_8d.y+_8d.h>_8a){_8d.h=_8a-_8d.y;}if(_8d.x+_8d.w>_89){_8d.w=_89-_8d.x;}}var l=_8b.x-_8d.x,t=_8b.y-Math.max(_8d.y,0),r=l+_8b.w-_8d.w,bot=t+_8b.h-_8d.h;if(r*l>0){var s=Math[l<0?"max":"min"](l,r);if(rtl&&((_84==8&&!_86)||_84>=9)){s=-s;}_8b.x+=el.scrollLeft;el.scrollLeft+=s;_8b.x-=el.scrollLeft;}if(bot*t>0){_8b.y+=el.scrollTop;el.scrollTop+=Math[t<0?"max":"min"](t,bot);_8b.y-=el.scrollTop;}el=(el!=_88)&&!_8e&&el.parentNode;}}catch(error){console.error("scrollIntoView: "+error);_81.scrollIntoView(false);}};}if(!dojo._hasResource["dijit._base.focus"]){dojo._hasResource["dijit._base.focus"]=true;dojo.provide("dijit._base.focus");dojo.mixin(dijit,{_curFocus:null,_prevFocus:null,isCollapsed:function(){return dijit.getBookmark().isCollapsed;},getBookmark:function(){var bm,rg,tg,sel=dojo.doc.selection,cf=dijit._curFocus;if(dojo.global.getSelection){sel=dojo.global.getSelection();if(sel){if(sel.isCollapsed){tg=cf?cf.tagName:"";if(tg){tg=tg.toLowerCase();if(tg=="textarea"||(tg=="input"&&(!cf.type||cf.type.toLowerCase()=="text"))){sel={start:cf.selectionStart,end:cf.selectionEnd,node:cf,pRange:true};return {isCollapsed:(sel.end<=sel.start),mark:sel};}}bm={isCollapsed:true};if(sel.rangeCount){bm.mark=sel.getRangeAt(0).cloneRange();}}else{rg=sel.getRangeAt(0);bm={isCollapsed:false,mark:rg.cloneRange()};}}}else{if(sel){tg=cf?cf.tagName:"";tg=tg.toLowerCase();if(cf&&tg&&(tg=="button"||tg=="textarea"||tg=="input")){if(sel.type&&sel.type.toLowerCase()=="none"){return {isCollapsed:true,mark:null};}else{rg=sel.createRange();return {isCollapsed:rg.text&&rg.text.length?false:true,mark:{range:rg,pRange:true}};}}bm={};try{rg=sel.createRange();bm.isCollapsed=!(sel.type=="Text"?rg.htmlText.length:rg.length);}catch(e){bm.isCollapsed=true;return bm;}if(sel.type.toUpperCase()=="CONTROL"){if(rg.length){bm.mark=[];var i=0,len=rg.length;while(i<len){bm.mark.push(rg.item(i++));}}else{bm.isCollapsed=true;bm.mark=null;}}else{bm.mark=rg.getBookmark();}}else{console.warn("No idea how to store the current selection for this browser!");}}return bm;},moveToBookmark:function(_91){var _92=dojo.doc,_93=_91.mark;if(_93){if(dojo.global.getSelection){var sel=dojo.global.getSelection();if(sel&&sel.removeAllRanges){if(_93.pRange){var r=_93;var n=r.node;n.selectionStart=r.start;n.selectionEnd=r.end;}else{sel.removeAllRanges();sel.addRange(_93);}}else{console.warn("No idea how to restore selection for this browser!");}}else{if(_92.selection&&_93){var rg;if(_93.pRange){rg=_93.range;}else{if(dojo.isArray(_93)){rg=_92.body.createControlRange();dojo.forEach(_93,function(n){rg.addElement(n);});}else{rg=_92.body.createTextRange();rg.moveToBookmark(_93);}}rg.select();}}}},getFocus:function(_94,_95){var _96=!dijit._curFocus||(_94&&dojo.isDescendant(dijit._curFocus,_94.domNode))?dijit._prevFocus:dijit._curFocus;return {node:_96,bookmark:(_96==dijit._curFocus)&&dojo.withGlobal(_95||dojo.global,dijit.getBookmark),openedForWindow:_95};},focus:function(_97){if(!_97){return;}var _98="node" in _97?_97.node:_97,_99=_97.bookmark,_9a=_97.openedForWindow,_9b=_99?_99.isCollapsed:false;if(_98){var _9c=(_98.tagName.toLowerCase()=="iframe")?_98.contentWindow:_98;if(_9c&&_9c.focus){try{_9c.focus();}catch(e){}}dijit._onFocusNode(_98);}if(_99&&dojo.withGlobal(_9a||dojo.global,dijit.isCollapsed)&&!_9b){if(_9a){_9a.focus();}try{dojo.withGlobal(_9a||dojo.global,dijit.moveToBookmark,null,[_99]);}catch(e2){}}},_activeStack:[],registerIframe:function(_9d){return dijit.registerWin(_9d.contentWindow,_9d);},unregisterIframe:function(_9e){dijit.unregisterWin(_9e);},registerWin:function(_9f,_a0){var _a1=function(evt){dijit._justMouseDowned=true;setTimeout(function(){dijit._justMouseDowned=false;},0);if(dojo.isIE&&evt&&evt.srcElement&&evt.srcElement.parentNode==null){return;}dijit._onTouchNode(_a0||evt.target||evt.srcElement,"mouse");};var doc=dojo.isIE?_9f.document.documentElement:_9f.document;if(doc){if(dojo.isIE){_9f.document.body.attachEvent("onmousedown",_a1);var _a2=function(evt){if(evt.srcElement.tagName.toLowerCase()!="#document"&&dijit.isTabNavigable(evt.srcElement)){dijit._onFocusNode(_a0||evt.srcElement);}else{dijit._onTouchNode(_a0||evt.srcElement);}};doc.attachEvent("onactivate",_a2);var _a3=function(evt){dijit._onBlurNode(_a0||evt.srcElement);};doc.attachEvent("ondeactivate",_a3);return function(){_9f.document.detachEvent("onmousedown",_a1);doc.detachEvent("onactivate",_a2);doc.detachEvent("ondeactivate",_a3);doc=null;};}else{doc.body.addEventListener("mousedown",_a1,true);var _a4=function(evt){dijit._onFocusNode(_a0||evt.target);};doc.addEventListener("focus",_a4,true);var _a5=function(evt){dijit._onBlurNode(_a0||evt.target);};doc.addEventListener("blur",_a5,true);return function(){doc.body.removeEventListener("mousedown",_a1,true);doc.removeEventListener("focus",_a4,true);doc.removeEventListener("blur",_a5,true);doc=null;};}}},unregisterWin:function(_a6){_a6&&_a6();},_onBlurNode:function(_a7){dijit._prevFocus=dijit._curFocus;dijit._curFocus=null;if(dijit._justMouseDowned){return;}if(dijit._clearActiveWidgetsTimer){clearTimeout(dijit._clearActiveWidgetsTimer);}dijit._clearActiveWidgetsTimer=setTimeout(function(){delete dijit._clearActiveWidgetsTimer;dijit._setStack([]);dijit._prevFocus=null;},100);},_onTouchNode:function(_a8,by){if(dijit._clearActiveWidgetsTimer){clearTimeout(dijit._clearActiveWidgetsTimer);delete dijit._clearActiveWidgetsTimer;}var _a9=[];try{while(_a8){var _aa=dojo.attr(_a8,"dijitPopupParent");if(_aa){_a8=dijit.byId(_aa).domNode;}else{if(_a8.tagName&&_a8.tagName.toLowerCase()=="body"){if(_a8===dojo.body()){break;}_a8=dojo.window.get(_a8.ownerDocument).frameElement;}else{var id=_a8.getAttribute&&_a8.getAttribute("widgetId"),_ab=id&&dijit.byId(id);if(_ab&&!(by=="mouse"&&_ab.get("disabled"))){_a9.unshift(id);}_a8=_a8.parentNode;}}}}catch(e){}dijit._setStack(_a9,by);},_onFocusNode:function(_ac){if(!_ac){return;}if(_ac.nodeType==9){return;}dijit._onTouchNode(_ac);if(_ac==dijit._curFocus){return;}if(dijit._curFocus){dijit._prevFocus=dijit._curFocus;}dijit._curFocus=_ac;dojo.publish("focusNode",[_ac]);},_setStack:function(_ad,by){var _ae=dijit._activeStack;dijit._activeStack=_ad;for(var _af=0;_af<Math.min(_ae.length,_ad.length);_af++){if(_ae[_af]!=_ad[_af]){break;}}var _b0;for(var i=_ae.length-1;i>=_af;i--){_b0=dijit.byId(_ae[i]);if(_b0){_b0._focused=false;_b0.set("focused",false);_b0._hasBeenBlurred=true;if(_b0._onBlur){_b0._onBlur(by);}dojo.publish("widgetBlur",[_b0,by]);}}for(i=_af;i<_ad.length;i++){_b0=dijit.byId(_ad[i]);if(_b0){_b0._focused=true;_b0.set("focused",true);if(_b0._onFocus){_b0._onFocus(by);}dojo.publish("widgetFocus",[_b0,by]);}}}});dojo.addOnLoad(function(){var _b1=dijit.registerWin(window);if(dojo.isIE){dojo.addOnWindowUnload(function(){dijit.unregisterWin(_b1);_b1=null;});}});}if(!dojo._hasResource["dojo.AdapterRegistry"]){dojo._hasResource["dojo.AdapterRegistry"]=true;dojo.provide("dojo.AdapterRegistry");dojo.AdapterRegistry=function(_b2){this.pairs=[];this.returnWrappers=_b2||false;};dojo.extend(dojo.AdapterRegistry,{register:function(_b3,_b4,_b5,_b6,_b7){this.pairs[((_b7)?"unshift":"push")]([_b3,_b4,_b5,_b6]);},match:function(){for(var i=0;i<this.pairs.length;i++){var _b8=this.pairs[i];if(_b8[1].apply(this,arguments)){if((_b8[3])||(this.returnWrappers)){return _b8[2];}else{return _b8[2].apply(this,arguments);}}}throw new Error("No match found");},unregister:function(_b9){for(var i=0;i<this.pairs.length;i++){var _ba=this.pairs[i];if(_ba[0]==_b9){this.pairs.splice(i,1);return true;}}return false;}});}if(!dojo._hasResource["dijit._base.place"]){dojo._hasResource["dijit._base.place"]=true;dojo.provide("dijit._base.place");dijit.getViewport=function(){return dojo.window.getBox();};dijit.placeOnScreen=function(_bb,pos,_bc,_bd){var _be=dojo.map(_bc,function(_bf){var c={corner:_bf,pos:{x:pos.x,y:pos.y}};if(_bd){c.pos.x+=_bf.charAt(1)=="L"?_bd.x:-_bd.x;c.pos.y+=_bf.charAt(0)=="T"?_bd.y:-_bd.y;}return c;});return dijit._place(_bb,_be);};dijit._place=function(_c0,_c1,_c2,_c3){var _c4=dojo.window.getBox();if(!_c0.parentNode||String(_c0.parentNode.tagName).toLowerCase()!="body"){dojo.body().appendChild(_c0);}var _c5=null;dojo.some(_c1,function(_c6){var _c7=_c6.corner;var pos=_c6.pos;var _c8=0;var _c9={w:_c7.charAt(1)=="L"?(_c4.l+_c4.w)-pos.x:pos.x-_c4.l,h:_c7.charAt(1)=="T"?(_c4.t+_c4.h)-pos.y:pos.y-_c4.t};if(_c2){var res=_c2(_c0,_c6.aroundCorner,_c7,_c9,_c3);_c8=typeof res=="undefined"?0:res;}var _ca=_c0.style;var _cb=_ca.display;var _cc=_ca.visibility;_ca.visibility="hidden";_ca.display="";var mb=dojo.marginBox(_c0);_ca.display=_cb;_ca.visibility=_cc;var _cd=Math.max(_c4.l,_c7.charAt(1)=="L"?pos.x:(pos.x-mb.w)),_ce=Math.max(_c4.t,_c7.charAt(0)=="T"?pos.y:(pos.y-mb.h)),_cf=Math.min(_c4.l+_c4.w,_c7.charAt(1)=="L"?(_cd+mb.w):pos.x),_d0=Math.min(_c4.t+_c4.h,_c7.charAt(0)=="T"?(_ce+mb.h):pos.y),_d1=_cf-_cd,_d2=_d0-_ce;_c8+=(mb.w-_d1)+(mb.h-_d2);if(_c5==null||_c8<_c5.overflow){_c5={corner:_c7,aroundCorner:_c6.aroundCorner,x:_cd,y:_ce,w:_d1,h:_d2,overflow:_c8,spaceAvailable:_c9};}return !_c8;});if(_c5.overflow&&_c2){_c2(_c0,_c5.aroundCorner,_c5.corner,_c5.spaceAvailable,_c3);}var l=dojo._isBodyLtr(),s=_c0.style;s.top=_c5.y+"px";s[l?"left":"right"]=(l?_c5.x:_c4.w-_c5.x-_c5.w)+"px";return _c5;};dijit.placeOnScreenAroundNode=function(_d3,_d4,_d5,_d6){_d4=dojo.byId(_d4);var _d7=dojo.position(_d4,true);return dijit._placeOnScreenAroundRect(_d3,_d7.x,_d7.y,_d7.w,_d7.h,_d5,_d6);};dijit.placeOnScreenAroundRectangle=function(_d8,_d9,_da,_db){return dijit._placeOnScreenAroundRect(_d8,_d9.x,_d9.y,_d9.width,_d9.height,_da,_db);};dijit._placeOnScreenAroundRect=function(_dc,x,y,_dd,_de,_df,_e0){var _e1=[];for(var _e2 in _df){_e1.push({aroundCorner:_e2,corner:_df[_e2],pos:{x:x+(_e2.charAt(1)=="L"?0:_dd),y:y+(_e2.charAt(0)=="T"?0:_de)}});}return dijit._place(_dc,_e1,_e0,{w:_dd,h:_de});};dijit.placementRegistry=new dojo.AdapterRegistry();dijit.placementRegistry.register("node",function(n,x){return typeof x=="object"&&typeof x.offsetWidth!="undefined"&&typeof x.offsetHeight!="undefined";},dijit.placeOnScreenAroundNode);dijit.placementRegistry.register("rect",function(n,x){return typeof x=="object"&&"x" in x&&"y" in x&&"width" in x&&"height" in x;},dijit.placeOnScreenAroundRectangle);dijit.placeOnScreenAroundElement=function(_e3,_e4,_e5,_e6){return dijit.placementRegistry.match.apply(dijit.placementRegistry,arguments);};dijit.getPopupAroundAlignment=function(_e7,_e8){var _e9={};dojo.forEach(_e7,function(pos){switch(pos){case "after":_e9[_e8?"BR":"BL"]=_e8?"BL":"BR";break;case "before":_e9[_e8?"BL":"BR"]=_e8?"BR":"BL";break;case "below-alt":_e8=!_e8;case "below":_e9[_e8?"BL":"BR"]=_e8?"TL":"TR";_e9[_e8?"BR":"BL"]=_e8?"TR":"TL";break;case "above-alt":_e8=!_e8;case "above":default:_e9[_e8?"TL":"TR"]=_e8?"BL":"BR";_e9[_e8?"TR":"TL"]=_e8?"BR":"BL";break;}});return _e9;};}if(!dojo._hasResource["dijit._base.window"]){dojo._hasResource["dijit._base.window"]=true;dojo.provide("dijit._base.window");dijit.getDocumentWindow=function(doc){return dojo.window.get(doc);};}if(!dojo._hasResource["dijit._base.popup"]){dojo._hasResource["dijit._base.popup"]=true;dojo.provide("dijit._base.popup");dijit.popup={_stack:[],_beginZIndex:1000,_idGen:1,_createWrapper:function(_ea){var _eb=_ea.declaredClass?_ea._popupWrapper:(_ea.parentNode&&dojo.hasClass(_ea.parentNode,"dijitPopup")),_ec=_ea.domNode||_ea;if(!_eb){_eb=dojo.create("div",{"class":"dijitPopup",style:{display:"none"},role:"presentation"},dojo.body());_eb.appendChild(_ec);var s=_ec.style;s.display="";s.visibility="";s.position="";s.top="0px";if(_ea.declaredClass){_ea._popupWrapper=_eb;dojo.connect(_ea,"destroy",function(){dojo.destroy(_eb);delete _ea._popupWrapper;});}}return _eb;},moveOffScreen:function(_ed){var _ee=this._createWrapper(_ed);dojo.style(_ee,{visibility:"hidden",top:"-9999px",display:""});},hide:function(_ef){var _f0=this._createWrapper(_ef);dojo.style(_f0,"display","none");},getTopPopup:function(){var _f1=this._stack;for(var pi=_f1.length-1;pi>0&&_f1[pi].parent===_f1[pi-1].widget;pi--){}return _f1[pi];},open:function(_f2){var _f3=this._stack,_f4=_f2.popup,_f5=_f2.orient||((_f2.parent?_f2.parent.isLeftToRight():dojo._isBodyLtr())?{"BL":"TL","BR":"TR","TL":"BL","TR":"BR"}:{"BR":"TR","BL":"TL","TR":"BR","TL":"BL"}),_f6=_f2.around,id=(_f2.around&&_f2.around.id)?(_f2.around.id+"_dropdown"):("popup_"+this._idGen++);while(_f3.length&&(!_f2.parent||!dojo.isDescendant(_f2.parent.domNode,_f3[_f3.length-1].widget.domNode))){dijit.popup.close(_f3[_f3.length-1].widget);}var _f7=this._createWrapper(_f4);dojo.attr(_f7,{id:id,style:{zIndex:this._beginZIndex+_f3.length},"class":"dijitPopup "+(_f4.baseClass||_f4["class"]||"").split(" ")[0]+"Popup",dijitPopupParent:_f2.parent?_f2.parent.id:""});if(dojo.isIE||dojo.isMoz){if(!_f4.bgIframe){_f4.bgIframe=new dijit.BackgroundIframe(_f7);}}var _f8=_f6?dijit.placeOnScreenAroundElement(_f7,_f6,_f5,_f4.orient?dojo.hitch(_f4,"orient"):null):dijit.placeOnScreen(_f7,_f2,_f5=="R"?["TR","BR","TL","BL"]:["TL","BL","TR","BR"],_f2.padding);_f7.style.display="";_f7.style.visibility="visible";_f4.domNode.style.visibility="visible";var _f9=[];_f9.push(dojo.connect(_f7,"onkeypress",this,function(evt){if(evt.charOrCode==dojo.keys.ESCAPE&&_f2.onCancel){dojo.stopEvent(evt);_f2.onCancel();}else{if(evt.charOrCode===dojo.keys.TAB){dojo.stopEvent(evt);var _fa=this.getTopPopup();if(_fa&&_fa.onCancel){_fa.onCancel();}}}}));if(_f4.onCancel){_f9.push(dojo.connect(_f4,"onCancel",_f2.onCancel));}_f9.push(dojo.connect(_f4,_f4.onExecute?"onExecute":"onChange",this,function(){var _fb=this.getTopPopup();if(_fb&&_fb.onExecute){_fb.onExecute();}}));_f3.push({widget:_f4,parent:_f2.parent,onExecute:_f2.onExecute,onCancel:_f2.onCancel,onClose:_f2.onClose,handlers:_f9});if(_f4.onOpen){_f4.onOpen(_f8);}return _f8;},close:function(_fc){var _fd=this._stack;while((_fc&&dojo.some(_fd,function(_fe){return _fe.widget==_fc;}))||(!_fc&&_fd.length)){var top=_fd.pop(),_ff=top.widget,_100=top.onClose;if(_ff.onClose){_ff.onClose();}dojo.forEach(top.handlers,dojo.disconnect);if(_ff&&_ff.domNode){this.hide(_ff);}if(_100){_100();}}}};dijit._frames=new function(){var _101=[];this.pop=function(){var _102;if(_101.length){_102=_101.pop();_102.style.display="";}else{if(dojo.isIE<9){var burl=dojo.config["dojoBlankHtmlUrl"]||(dojo.moduleUrl("dojo","resources/blank.html")+"")||"javascript:\"\"";var html="<iframe src='"+burl+"'"+" style='position: absolute; left: 0px; top: 0px;"+"z-index: -1; filter:Alpha(Opacity=\"0\");'>";_102=dojo.doc.createElement(html);}else{_102=dojo.create("iframe");_102.src="javascript:\"\"";_102.className="dijitBackgroundIframe";dojo.style(_102,"opacity",0.1);}_102.tabIndex=-1;dijit.setWaiRole(_102,"presentation");}return _102;};this.push=function(_103){_103.style.display="none";_101.push(_103);};}();dijit.BackgroundIframe=function(node){if(!node.id){throw new Error("no id");}if(dojo.isIE||dojo.isMoz){var _104=(this.iframe=dijit._frames.pop());node.appendChild(_104);if(dojo.isIE<7||dojo.isQuirks){this.resize(node);this._conn=dojo.connect(node,"onresize",this,function(){this.resize(node);});}else{dojo.style(_104,{width:"100%",height:"100%"});}}};dojo.extend(dijit.BackgroundIframe,{resize:function(node){if(this.iframe){dojo.style(this.iframe,{width:node.offsetWidth+"px",height:node.offsetHeight+"px"});}},destroy:function(){if(this._conn){dojo.disconnect(this._conn);this._conn=null;}if(this.iframe){dijit._frames.push(this.iframe);delete this.iframe;}}});}if(!dojo._hasResource["dijit._base.scroll"]){dojo._hasResource["dijit._base.scroll"]=true;dojo.provide("dijit._base.scroll");dijit.scrollIntoView=function(node,pos){dojo.window.scrollIntoView(node,pos);};}if(!dojo._hasResource["dojo.uacss"]){dojo._hasResource["dojo.uacss"]=true;dojo.provide("dojo.uacss");(function(){var d=dojo,html=d.doc.documentElement,ie=d.isIE,_105=d.isOpera,maj=Math.floor,ff=d.isFF,_106=d.boxModel.replace(/-/,""),_107={dj_ie:ie,dj_ie6:maj(ie)==6,dj_ie7:maj(ie)==7,dj_ie8:maj(ie)==8,dj_ie9:maj(ie)==9,dj_quirks:d.isQuirks,dj_iequirks:ie&&d.isQuirks,dj_opera:_105,dj_khtml:d.isKhtml,dj_webkit:d.isWebKit,dj_safari:d.isSafari,dj_chrome:d.isChrome,dj_gecko:d.isMozilla,dj_ff3:maj(ff)==3};_107["dj_"+_106]=true;var _108="";for(var clz in _107){if(_107[clz]){_108+=clz+" ";}}html.className=d.trim(html.className+" "+_108);dojo._loaders.unshift(function(){if(!dojo._isBodyLtr()){var _109="dj_rtl dijitRtl "+_108.replace(/ /g,"-rtl ");html.className=d.trim(html.className+" "+_109);}});})();}if(!dojo._hasResource["dijit._base.sniff"]){dojo._hasResource["dijit._base.sniff"]=true;dojo.provide("dijit._base.sniff");}if(!dojo._hasResource["dijit._base.typematic"]){dojo._hasResource["dijit._base.typematic"]=true;dojo.provide("dijit._base.typematic");dijit.typematic={_fireEventAndReload:function(){this._timer=null;this._callback(++this._count,this._node,this._evt);this._currentTimeout=Math.max(this._currentTimeout<0?this._initialDelay:(this._subsequentDelay>1?this._subsequentDelay:Math.round(this._currentTimeout*this._subsequentDelay)),this._minDelay);this._timer=setTimeout(dojo.hitch(this,"_fireEventAndReload"),this._currentTimeout);},trigger:function(evt,_10a,node,_10b,obj,_10c,_10d,_10e){if(obj!=this._obj){this.stop();this._initialDelay=_10d||500;this._subsequentDelay=_10c||0.9;this._minDelay=_10e||10;this._obj=obj;this._evt=evt;this._node=node;this._currentTimeout=-1;this._count=-1;this._callback=dojo.hitch(_10a,_10b);this._fireEventAndReload();this._evt=dojo.mixin({faux:true},evt);}},stop:function(){if(this._timer){clearTimeout(this._timer);this._timer=null;}if(this._obj){this._callback(-1,this._node,this._evt);this._obj=null;}},addKeyListener:function(node,_10f,_110,_111,_112,_113,_114){if(_10f.keyCode){_10f.charOrCode=_10f.keyCode;dojo.deprecated("keyCode attribute parameter for dijit.typematic.addKeyListener is deprecated. Use charOrCode instead.","","2.0");}else{if(_10f.charCode){_10f.charOrCode=String.fromCharCode(_10f.charCode);dojo.deprecated("charCode attribute parameter for dijit.typematic.addKeyListener is deprecated. Use charOrCode instead.","","2.0");}}return [dojo.connect(node,"onkeypress",this,function(evt){if(evt.charOrCode==_10f.charOrCode&&(_10f.ctrlKey===undefined||_10f.ctrlKey==evt.ctrlKey)&&(_10f.altKey===undefined||_10f.altKey==evt.altKey)&&(_10f.metaKey===undefined||_10f.metaKey==(evt.metaKey||false))&&(_10f.shiftKey===undefined||_10f.shiftKey==evt.shiftKey)){dojo.stopEvent(evt);dijit.typematic.trigger(evt,_110,node,_111,_10f,_112,_113,_114);}else{if(dijit.typematic._obj==_10f){dijit.typematic.stop();}}}),dojo.connect(node,"onkeyup",this,function(evt){if(dijit.typematic._obj==_10f){dijit.typematic.stop();}})];},addMouseListener:function(node,_115,_116,_117,_118,_119){var dc=dojo.connect;return [dc(node,"mousedown",this,function(evt){dojo.stopEvent(evt);dijit.typematic.trigger(evt,_115,node,_116,node,_117,_118,_119);}),dc(node,"mouseup",this,function(evt){dojo.stopEvent(evt);dijit.typematic.stop();}),dc(node,"mouseout",this,function(evt){dojo.stopEvent(evt);dijit.typematic.stop();}),dc(node,"mousemove",this,function(evt){evt.preventDefault();}),dc(node,"dblclick",this,function(evt){dojo.stopEvent(evt);if(dojo.isIE){dijit.typematic.trigger(evt,_115,node,_116,node,_117,_118,_119);setTimeout(dojo.hitch(this,dijit.typematic.stop),50);}})];},addListener:function(_11a,_11b,_11c,_11d,_11e,_11f,_120,_121){return this.addKeyListener(_11b,_11c,_11d,_11e,_11f,_120,_121).concat(this.addMouseListener(_11a,_11d,_11e,_11f,_120,_121));}};}if(!dojo._hasResource["dijit._base.wai"]){dojo._hasResource["dijit._base.wai"]=true;dojo.provide("dijit._base.wai");dijit.wai={onload:function(){var div=dojo.create("div",{id:"a11yTestNode",style:{cssText:"border: 1px solid;"+"border-color:red green;"+"position: absolute;"+"height: 5px;"+"top: -999px;"+"background-image: url(\""+(dojo.config.blankGif||dojo.moduleUrl("dojo","resources/blank.gif"))+"\");"}},dojo.body());var cs=dojo.getComputedStyle(div);if(cs){var _122=cs.backgroundImage;var _123=(cs.borderTopColor==cs.borderRightColor)||(_122!=null&&(_122=="none"||_122=="url(invalid-url:)"));dojo[_123?"addClass":"removeClass"](dojo.body(),"dijit_a11y");if(dojo.isIE){div.outerHTML="";}else{dojo.body().removeChild(div);}}}};if(dojo.isIE||dojo.isMoz){dojo._loaders.unshift(dijit.wai.onload);}dojo.mixin(dijit,{hasWaiRole:function(elem,role){var _124=this.getWaiRole(elem);return role?(_124.indexOf(role)>-1):(_124.length>0);},getWaiRole:function(elem){return dojo.trim((dojo.attr(elem,"role")||"").replace("wairole:",""));},setWaiRole:function(elem,role){dojo.attr(elem,"role",role);},removeWaiRole:function(elem,role){var _125=dojo.attr(elem,"role");if(!_125){return;}if(role){var t=dojo.trim((" "+_125+" ").replace(" "+role+" "," "));dojo.attr(elem,"role",t);}else{elem.removeAttribute("role");}},hasWaiState:function(elem,_126){return elem.hasAttribute?elem.hasAttribute("aria-"+_126):!!elem.getAttribute("aria-"+_126);},getWaiState:function(elem,_127){return elem.getAttribute("aria-"+_127)||"";},setWaiState:function(elem,_128,_129){elem.setAttribute("aria-"+_128,_129);},removeWaiState:function(elem,_12a){elem.removeAttribute("aria-"+_12a);}});}if(!dojo._hasResource["dijit._base"]){dojo._hasResource["dijit._base"]=true;dojo.provide("dijit._base");}if(!dojo._hasResource["dijit._Widget"]){dojo._hasResource["dijit._Widget"]=true;dojo.provide("dijit._Widget");dojo.connect(dojo,"_connect",function(_12b,_12c){if(_12b&&dojo.isFunction(_12b._onConnect)){_12b._onConnect(_12c);}});dijit._connectOnUseEventHandler=function(_12d){};dijit._lastKeyDownNode=null;if(dojo.isIE){(function(){var _12e=function(evt){dijit._lastKeyDownNode=evt.srcElement;};dojo.doc.attachEvent("onkeydown",_12e);dojo.addOnWindowUnload(function(){dojo.doc.detachEvent("onkeydown",_12e);});})();}else{dojo.doc.addEventListener("keydown",function(evt){dijit._lastKeyDownNode=evt.target;},true);}(function(){dojo.declare("dijit._Widget",dijit._WidgetBase,{_deferredConnects:{onClick:"",onDblClick:"",onKeyDown:"",onKeyPress:"",onKeyUp:"",onMouseMove:"",onMouseDown:"",onMouseOut:"",onMouseOver:"",onMouseLeave:"",onMouseEnter:"",onMouseUp:""},onClick:dijit._connectOnUseEventHandler,onDblClick:dijit._connectOnUseEventHandler,onKeyDown:dijit._connectOnUseEventHandler,onKeyPress:dijit._connectOnUseEventHandler,onKeyUp:dijit._connectOnUseEventHandler,onMouseDown:dijit._connectOnUseEventHandler,onMouseMove:dijit._connectOnUseEventHandler,onMouseOut:dijit._connectOnUseEventHandler,onMouseOver:dijit._connectOnUseEventHandler,onMouseLeave:dijit._connectOnUseEventHandler,onMouseEnter:dijit._connectOnUseEventHandler,onMouseUp:dijit._connectOnUseEventHandler,create:function(_12f,_130){this._deferredConnects=dojo.clone(this._deferredConnects);for(var attr in this.attributeMap){delete this._deferredConnects[attr];}for(attr in this._deferredConnects){if(this[attr]!==dijit._connectOnUseEventHandler){delete this._deferredConnects[attr];}}this.inherited(arguments);if(this.domNode){for(attr in this.params){this._onConnect(attr);}}},_onConnect:function(_131){if(_131 in this._deferredConnects){var _132=this[this._deferredConnects[_131]||"domNode"];this.connect(_132,_131.toLowerCase(),_131);delete this._deferredConnects[_131];}},focused:false,isFocusable:function(){return this.focus&&(dojo.style(this.domNode,"display")!="none");},onFocus:function(){},onBlur:function(){},_onFocus:function(e){this.onFocus();},_onBlur:function(){this.onBlur();},setAttribute:function(attr,_133){dojo.deprecated(this.declaredClass+"::setAttribute(attr, value) is deprecated. Use set() instead.","","2.0");this.set(attr,_133);},attr:function(name,_134){if(dojo.config.isDebug){var _135=arguments.callee._ach||(arguments.callee._ach={}),_136=(arguments.callee.caller||"unknown caller").toString();if(!_135[_136]){dojo.deprecated(this.declaredClass+"::attr() is deprecated. Use get() or set() instead, called from "+_136,"","2.0");_135[_136]=true;}}var args=arguments.length;if(args>=2||typeof name==="object"){return this.set.apply(this,arguments);}else{return this.get(name);}},nodesWithKeyClick:["input","button"],connect:function(obj,_137,_138){var d=dojo,dc=d._connect,_139=this.inherited(arguments,[obj,_137=="ondijitclick"?"onclick":_137,_138]);if(_137=="ondijitclick"){if(d.indexOf(this.nodesWithKeyClick,obj.nodeName.toLowerCase())==-1){var m=d.hitch(this,_138);_139.push(dc(obj,"onkeydown",this,function(e){if((e.keyCode==d.keys.ENTER||e.keyCode==d.keys.SPACE)&&!e.ctrlKey&&!e.shiftKey&&!e.altKey&&!e.metaKey){dijit._lastKeyDownNode=e.target;if(!("openDropDown" in this&&obj==this._buttonNode)){e.preventDefault();}}}),dc(obj,"onkeyup",this,function(e){if((e.keyCode==d.keys.ENTER||e.keyCode==d.keys.SPACE)&&e.target==dijit._lastKeyDownNode&&!e.ctrlKey&&!e.shiftKey&&!e.altKey&&!e.metaKey){dijit._lastKeyDownNode=null;return m(e);}}));}}return _139;},_onShow:function(){this.onShow();},onShow:function(){},onHide:function(){},onClose:function(){return true;}});})();}if(!dojo._hasResource["dijit._Contained"]){dojo._hasResource["dijit._Contained"]=true;dojo.provide("dijit._Contained");dojo.declare("dijit._Contained",null,{getParent:function(){var _13a=dijit.getEnclosingWidget(this.domNode.parentNode);return _13a&&_13a.isContainer?_13a:null;},_getSibling:function(_13b){var node=this.domNode;do{node=node[_13b+"Sibling"];}while(node&&node.nodeType!=1);return node&&dijit.byNode(node);},getPreviousSibling:function(){return this._getSibling("previous");},getNextSibling:function(){return this._getSibling("next");},getIndexInParent:function(){var p=this.getParent();if(!p||!p.getIndexOfChild){return -1;}return p.getIndexOfChild(this);}});}if(!dojo._hasResource["dijit._Container"]){dojo._hasResource["dijit._Container"]=true;dojo.provide("dijit._Container");dojo.declare("dijit._Container",null,{isContainer:true,buildRendering:function(){this.inherited(arguments);if(!this.containerNode){this.containerNode=this.domNode;}},addChild:function(_13c,_13d){var _13e=this.containerNode;if(_13d&&typeof _13d=="number"){var _13f=this.getChildren();if(_13f&&_13f.length>=_13d){_13e=_13f[_13d-1].domNode;_13d="after";}}dojo.place(_13c.domNode,_13e,_13d);if(this._started&&!_13c._started){_13c.startup();}},removeChild:function(_140){if(typeof _140=="number"){_140=this.getChildren()[_140];}if(_140){var node=_140.domNode;if(node&&node.parentNode){node.parentNode.removeChild(node);}}},hasChildren:function(){return this.getChildren().length>0;},destroyDescendants:function(_141){dojo.forEach(this.getChildren(),function(_142){_142.destroyRecursive(_141);});},_getSiblingOfChild:function(_143,dir){var node=_143.domNode,_144=(dir>0?"nextSibling":"previousSibling");do{node=node[_144];}while(node&&(node.nodeType!=1||!dijit.byNode(node)));return node&&dijit.byNode(node);},getIndexOfChild:function(_145){return dojo.indexOf(this.getChildren(),_145);},startup:function(){if(this._started){return;}dojo.forEach(this.getChildren(),function(_146){_146.startup();});this.inherited(arguments);}});}if(!dojo._hasResource["dijit.layout._LayoutWidget"]){dojo._hasResource["dijit.layout._LayoutWidget"]=true;dojo.provide("dijit.layout._LayoutWidget");dojo.declare("dijit.layout._LayoutWidget",[dijit._Widget,dijit._Container,dijit._Contained],{baseClass:"dijitLayoutContainer",isLayoutContainer:true,buildRendering:function(){this.inherited(arguments);dojo.addClass(this.domNode,"dijitContainer");},startup:function(){if(this._started){return;}this.inherited(arguments);var _147=this.getParent&&this.getParent();if(!(_147&&_147.isLayoutContainer)){this.resize();this.connect(dojo.isIE?this.domNode:dojo.global,"onresize",function(){this.resize();});}},resize:function(_148,_149){var node=this.domNode;if(_148){dojo.marginBox(node,_148);if(_148.t){node.style.top=_148.t+"px";}if(_148.l){node.style.left=_148.l+"px";}}var mb=_149||{};dojo.mixin(mb,_148||{});if(!("h" in mb)||!("w" in mb)){mb=dojo.mixin(dojo.marginBox(node),mb);}var cs=dojo.getComputedStyle(node);var me=dojo._getMarginExtents(node,cs);var be=dojo._getBorderExtents(node,cs);var bb=(this._borderBox={w:mb.w-(me.w+be.w),h:mb.h-(me.h+be.h)});var pe=dojo._getPadExtents(node,cs);this._contentBox={l:dojo._toPixelValue(node,cs.paddingLeft),t:dojo._toPixelValue(node,cs.paddingTop),w:bb.w-pe.w,h:bb.h-pe.h};this.layout();},layout:function(){},_setupChild:function(_14a){var cls=this.baseClass+"-child "+(_14a.baseClass?this.baseClass+"-"+_14a.baseClass:"");dojo.addClass(_14a.domNode,cls);},addChild:function(_14b,_14c){this.inherited(arguments);if(this._started){this._setupChild(_14b);}},removeChild:function(_14d){var cls=this.baseClass+"-child"+(_14d.baseClass?" "+this.baseClass+"-"+_14d.baseClass:"");dojo.removeClass(_14d.domNode,cls);this.inherited(arguments);}});dijit.layout.marginBox2contentBox=function(node,mb){var cs=dojo.getComputedStyle(node);var me=dojo._getMarginExtents(node,cs);var pb=dojo._getPadBorderExtents(node,cs);return {l:dojo._toPixelValue(node,cs.paddingLeft),t:dojo._toPixelValue(node,cs.paddingTop),w:mb.w-(me.w+pb.w),h:mb.h-(me.h+pb.h)};};(function(){var _14e=function(word){if(word==null){return "";}return word.substring(0,1).toUpperCase()+word.substring(1);};var size=function(_14f,dim){var _150=_14f.resize?_14f.resize(dim):dojo.marginBox(_14f.domNode,dim);if(_150){dojo.mixin(_14f,_150);}else{dojo.mixin(_14f,dojo.marginBox(_14f.domNode));dojo.mixin(_14f,dim);}};dijit.layout.layoutChildren=function(_151,dim,_152,_153,_154){dim=dojo.mixin({},dim);dojo.addClass(_151,"dijitLayoutContainer");_152=dojo.filter(_152,function(item){return item.region!="center"&&item.layoutAlign!="client";}).concat(dojo.filter(_152,function(item){return item.region=="center"||item.layoutAlign=="client";}));dojo.forEach(_152,function(_155){var elm=_155.domNode,pos=(_155.region||_155.layoutAlign);var _156=elm.style;_156.left=dim.l+"px";_156.top=dim.t+"px";_156.position="absolute";dojo.addClass(elm,"dijitAlign"+_14e(pos));var _157={};if(_153&&_153==_155.id){_157[_155.region=="top"||_155.region=="bottom"?"h":"w"]=_154;}if(pos=="top"||pos=="bottom"){_157.w=dim.w;size(_155,_157);dim.h-=_155.h;if(pos=="top"){dim.t+=_155.h;}else{_156.top=dim.t+dim.h+"px";}}else{if(pos=="left"||pos=="right"){_157.h=dim.h;size(_155,_157);dim.w-=_155.w;if(pos=="left"){dim.l+=_155.w;}else{_156.left=dim.l+dim.w+"px";}}else{if(pos=="client"||pos=="center"){size(_155,dim);}}}});};})();}if(!dojo._hasResource["dijit.layout._ContentPaneResizeMixin"]){dojo._hasResource["dijit.layout._ContentPaneResizeMixin"]=true;dojo.provide("dijit.layout._ContentPaneResizeMixin");dojo.declare("dijit.layout._ContentPaneResizeMixin",null,{doLayout:true,isContainer:true,isLayoutContainer:true,_startChildren:function(){dojo.forEach(this.getChildren(),function(_158){_158.startup();_158._started=true;});},startup:function(){if(this._started){return;}var _159=dijit._Contained.prototype.getParent.call(this);this._childOfLayoutWidget=_159&&_159.isLayoutContainer;this._needLayout=!this._childOfLayoutWidget;this.inherited(arguments);this._startChildren();if(this._isShown()){this._onShow();}if(!this._childOfLayoutWidget){this.connect(dojo.isIE?this.domNode:dojo.global,"onresize",function(){this._needLayout=!this._childOfLayoutWidget;this.resize();});}},_checkIfSingleChild:function(){var _15a=dojo.query("> *",this.containerNode).filter(function(node){return node.tagName!=="SCRIPT";}),_15b=_15a.filter(function(node){return dojo.hasAttr(node,"data-dojo-type")||dojo.hasAttr(node,"dojoType")||dojo.hasAttr(node,"widgetId");}),_15c=dojo.filter(_15b.map(dijit.byNode),function(_15d){return _15d&&_15d.domNode&&_15d.resize;});if(_15a.length==_15b.length&&_15c.length==1){this._singleChild=_15c[0];}else{delete this._singleChild;}dojo.toggleClass(this.containerNode,this.baseClass+"SingleChild",!!this._singleChild);},resize:function(_15e,_15f){if(!this._wasShown&&this.open!==false){this._onShow();}this._resizeCalled=true;this._scheduleLayout(_15e,_15f);},_scheduleLayout:function(_160,_161){if(this._isShown()){this._layout(_160,_161);}else{this._needLayout=true;this._changeSize=_160;this._resultSize=_161;}},_layout:function(_162,_163){if(_162){dojo.marginBox(this.domNode,_162);}var cn=this.containerNode;if(cn===this.domNode){var mb=_163||{};dojo.mixin(mb,_162||{});if(!("h" in mb)||!("w" in mb)){mb=dojo.mixin(dojo.marginBox(cn),mb);}this._contentBox=dijit.layout.marginBox2contentBox(cn,mb);}else{this._contentBox=dojo.contentBox(cn);}this._layoutChildren();delete this._needLayout;},_layoutChildren:function(){if(this.doLayout){this._checkIfSingleChild();}if(this._singleChild&&this._singleChild.resize){var cb=this._contentBox||dojo.contentBox(this.containerNode);this._singleChild.resize({w:cb.w,h:cb.h});}else{dojo.forEach(this.getChildren(),function(_164){if(_164.resize){_164.resize();}});}},_isShown:function(){if(this._childOfLayoutWidget){if(this._resizeCalled&&"open" in this){return this.open;}return this._resizeCalled;}else{if("open" in this){return this.open;}else{var node=this.domNode,_165=this.domNode.parentNode;return (node.style.display!="none")&&(node.style.visibility!="hidden")&&!dojo.hasClass(node,"dijitHidden")&&_165&&_165.style&&(_165.style.display!="none");}}},_onShow:function(){if(this._needLayout){this._layout(this._changeSize,this._resultSize);}this.inherited(arguments);this._wasShown=true;}});}if(!dojo._hasResource["dojo.string"]){dojo._hasResource["dojo.string"]=true;dojo.provide("dojo.string");dojo.getObject("string",true,dojo);dojo.string.rep=function(str,num){if(num<=0||!str){return "";}var buf=[];for(;;){if(num&1){buf.push(str);}if(!(num>>=1)){break;}str+=str;}return buf.join("");};dojo.string.pad=function(text,size,ch,end){if(!ch){ch="0";}var out=String(text),pad=dojo.string.rep(ch,Math.ceil((size-out.length)/ch.length));return end?out+pad:pad+out;};dojo.string.substitute=function(_166,map,_167,_168){_168=_168||dojo.global;_167=_167?dojo.hitch(_168,_167):function(v){return v;};return _166.replace(/\$\{([^\s\:\}]+)(?:\:([^\s\:\}]+))?\}/g,function(_169,key,_16a){var _16b=dojo.getObject(key,false,map);if(_16a){_16b=dojo.getObject(_16a,false,_168).call(_168,_16b,key);}return _167(_16b,key).toString();});};dojo.string.trim=String.prototype.trim?dojo.trim:function(str){str=str.replace(/^\s+/,"");for(var i=str.length-1;i>=0;i--){if(/\S/.test(str.charAt(i))){str=str.substring(0,i+1);break;}}return str;};}if(!dojo._hasResource["dojo.date.stamp"]){dojo._hasResource["dojo.date.stamp"]=true;dojo.provide("dojo.date.stamp");dojo.getObject("date.stamp",true,dojo);dojo.date.stamp.fromISOString=function(_16c,_16d){if(!dojo.date.stamp._isoRegExp){dojo.date.stamp._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/;}var _16e=dojo.date.stamp._isoRegExp.exec(_16c),_16f=null;if(_16e){_16e.shift();if(_16e[1]){_16e[1]--;}if(_16e[6]){_16e[6]*=1000;}if(_16d){_16d=new Date(_16d);dojo.forEach(dojo.map(["FullYear","Month","Date","Hours","Minutes","Seconds","Milliseconds"],function(prop){return _16d["get"+prop]();}),function(_170,_171){_16e[_171]=_16e[_171]||_170;});}_16f=new Date(_16e[0]||1970,_16e[1]||0,_16e[2]||1,_16e[3]||0,_16e[4]||0,_16e[5]||0,_16e[6]||0);if(_16e[0]<100){_16f.setFullYear(_16e[0]||1970);}var _172=0,_173=_16e[7]&&_16e[7].charAt(0);if(_173!="Z"){_172=((_16e[8]||0)*60)+(Number(_16e[9])||0);if(_173!="-"){_172*=-1;}}if(_173){_172-=_16f.getTimezoneOffset();}if(_172){_16f.setTime(_16f.getTime()+_172*60000);}}return _16f;};dojo.date.stamp.toISOString=function(_174,_175){var _176=function(n){return (n<10)?"0"+n:n;};_175=_175||{};var _177=[],_178=_175.zulu?"getUTC":"get",date="";if(_175.selector!="time"){var year=_174[_178+"FullYear"]();date=["0000".substr((year+"").length)+year,_176(_174[_178+"Month"]()+1),_176(_174[_178+"Date"]())].join("-");}_177.push(date);if(_175.selector!="date"){var time=[_176(_174[_178+"Hours"]()),_176(_174[_178+"Minutes"]()),_176(_174[_178+"Seconds"]())].join(":");var _179=_174[_178+"Milliseconds"]();if(_175.milliseconds){time+="."+(_179<100?"0":"")+_176(_179);}if(_175.zulu){time+="Z";}else{if(_175.selector!="time"){var _17a=_174.getTimezoneOffset();var _17b=Math.abs(_17a);time+=(_17a>0?"-":"+")+_176(Math.floor(_17b/60))+":"+_176(_17b%60);}}_177.push(time);}return _177.join("T");};}if(!dojo._hasResource["dojo.parser"]){dojo._hasResource["dojo.parser"]=true;dojo.provide("dojo.parser");new Date("X");dojo.parser=new function(){var d=dojo;function _17c(_17d){if(d.isString(_17d)){return "string";}if(typeof _17d=="number"){return "number";}if(typeof _17d=="boolean"){return "boolean";}if(d.isFunction(_17d)){return "function";}if(d.isArray(_17d)){return "array";}if(_17d instanceof Date){return "date";}if(_17d instanceof d._Url){return "url";}return "object";};function _17e(_17f,type){switch(type){case "string":return _17f;case "number":return _17f.length?Number(_17f):NaN;case "boolean":return typeof _17f=="boolean"?_17f:!(_17f.toLowerCase()=="false");case "function":if(d.isFunction(_17f)){_17f=_17f.toString();_17f=d.trim(_17f.substring(_17f.indexOf("{")+1,_17f.length-1));}try{if(_17f===""||_17f.search(/[^\w\.]+/i)!=-1){return new Function(_17f);}else{return d.getObject(_17f,false)||new Function(_17f);}}catch(e){return new Function();}case "array":return _17f?_17f.split(/\s*,\s*/):[];case "date":switch(_17f){case "":return new Date("");case "now":return new Date();default:return d.date.stamp.fromISOString(_17f);}case "url":return d.baseUrl+_17f;default:return d.fromJson(_17f);}};var _180={},_181={};d.connect(d,"extend",function(){_181={};});function _182(cls,_183){for(var name in cls){if(name.charAt(0)=="_"){continue;}if(name in _180){continue;}_183[name]=_17c(cls[name]);}return _183;};function _184(_185,_186){var c=_181[_185];if(!c){var cls=d.getObject(_185),_187=null;if(!cls){return null;}if(!_186){_187=_182(cls.prototype,{});}c={cls:cls,params:_187};}else{if(!_186&&!c.params){c.params=_182(c.cls.prototype,{});}}return c;};this._functionFromScript=function(_188,_189){var _18a="";var _18b="";var _18c=(_188.getAttribute(_189+"args")||_188.getAttribute("args"));if(_18c){d.forEach(_18c.split(/\s*,\s*/),function(part,idx){_18a+="var "+part+" = arguments["+idx+"]; ";});}var _18d=_188.getAttribute("with");if(_18d&&_18d.length){d.forEach(_18d.split(/\s*,\s*/),function(part){_18a+="with("+part+"){";_18b+="}";});}return new Function(_18a+_188.innerHTML+_18b);};this.instantiate=function(_18e,_18f,args){var _190=[],_18f=_18f||{};args=args||{};var _191=(args.scope||d._scopeName)+"Type",_192="data-"+(args.scope||d._scopeName)+"-";d.forEach(_18e,function(obj){if(!obj){return;}var node,type,_193,_194,_195,_196;if(obj.node){node=obj.node;type=obj.type;_196=obj.fastpath;_193=obj.clsInfo||(type&&_184(type,_196));_194=_193&&_193.cls;_195=obj.scripts;}else{node=obj;type=_191 in _18f?_18f[_191]:node.getAttribute(_191);_193=type&&_184(type);_194=_193&&_193.cls;_195=(_194&&(_194._noScript||_194.prototype._noScript)?[]:d.query("> script[type^='dojo/']",node));}if(!_193){throw new Error("Could not load class '"+type);}var _197={};if(args.defaults){d._mixin(_197,args.defaults);}if(obj.inherited){d._mixin(_197,obj.inherited);}if(_196){var _198=node.getAttribute(_192+"props");if(_198&&_198.length){try{_198=d.fromJson.call(args.propsThis,"{"+_198+"}");d._mixin(_197,_198);}catch(e){throw new Error(e.toString()+" in data-dojo-props='"+_198+"'");}}var _199=node.getAttribute(_192+"attach-point");if(_199){_197.dojoAttachPoint=_199;}var _19a=node.getAttribute(_192+"attach-event");if(_19a){_197.dojoAttachEvent=_19a;}dojo.mixin(_197,_18f);}else{var _19b=node.attributes;for(var name in _193.params){var item=name in _18f?{value:_18f[name],specified:true}:_19b.getNamedItem(name);if(!item||(!item.specified&&(!dojo.isIE||name.toLowerCase()!="value"))){continue;}var _19c=item.value;switch(name){case "class":_19c="className" in _18f?_18f.className:node.className;break;case "style":_19c="style" in _18f?_18f.style:(node.style&&node.style.cssText);}var _19d=_193.params[name];if(typeof _19c=="string"){_197[name]=_17e(_19c,_19d);}else{_197[name]=_19c;}}}var _19e=[],_19f=[];d.forEach(_195,function(_1a0){node.removeChild(_1a0);var _1a1=(_1a0.getAttribute(_192+"event")||_1a0.getAttribute("event")),type=_1a0.getAttribute("type"),nf=d.parser._functionFromScript(_1a0,_192);if(_1a1){if(type=="dojo/connect"){_19e.push({event:_1a1,func:nf});}else{_197[_1a1]=nf;}}else{_19f.push(nf);}});var _1a2=_194.markupFactory||_194.prototype&&_194.prototype.markupFactory;var _1a3=_1a2?_1a2(_197,node,_194):new _194(_197,node);_190.push(_1a3);var _1a4=(node.getAttribute(_192+"id")||node.getAttribute("jsId"));if(_1a4){d.setObject(_1a4,_1a3);}d.forEach(_19e,function(_1a5){d.connect(_1a3,_1a5.event,null,_1a5.func);});d.forEach(_19f,function(func){func.call(_1a3);});});if(!_18f._started){d.forEach(_190,function(_1a6){if(!args.noStart&&_1a6&&dojo.isFunction(_1a6.startup)&&!_1a6._started&&(!_1a6.getParent||!_1a6.getParent())){_1a6.startup();}});}return _190;};this.parse=function(_1a7,args){var root;if(!args&&_1a7&&_1a7.rootNode){args=_1a7;root=args.rootNode;}else{root=_1a7;}root=root?dojo.byId(root):dojo.body();args=args||{};var _1a8=(args.scope||d._scopeName)+"Type",_1a9="data-"+(args.scope||d._scopeName)+"-";function scan(_1aa,list){var _1ab=dojo.clone(_1aa.inherited);dojo.forEach(["dir","lang"],function(name){var val=_1aa.node.getAttribute(name);if(val){_1ab[name]=val;}});var _1ac=_1aa.clsInfo&&!_1aa.clsInfo.cls.prototype._noScript?_1aa.scripts:null;var _1ad=(!_1aa.clsInfo||!_1aa.clsInfo.cls.prototype.stopParser)||(args&&args.template);for(var _1ae=_1aa.node.firstChild;_1ae;_1ae=_1ae.nextSibling){if(_1ae.nodeType==1){var type,_1af=_1ad&&_1ae.getAttribute(_1a9+"type");if(_1af){type=_1af;}else{type=_1ad&&_1ae.getAttribute(_1a8);}var _1b0=_1af==type;if(type){var _1b1={"type":type,fastpath:_1b0,clsInfo:_184(type,_1b0),node:_1ae,scripts:[],inherited:_1ab};list.push(_1b1);scan(_1b1,list);}else{if(_1ac&&_1ae.nodeName.toLowerCase()=="script"){type=_1ae.getAttribute("type");if(type&&/^dojo\/\w/i.test(type)){_1ac.push(_1ae);}}else{if(_1ad){scan({node:_1ae,inherited:_1ab},list);}}}}}};var _1b2={};if(args&&args.inherited){for(var key in args.inherited){if(args.inherited[key]){_1b2[key]=args.inherited[key];}}}var list=[];scan({node:root,inherited:_1b2},list);var _1b3=args&&args.template?{template:true}:null;return this.instantiate(list,_1b3,args);};}();(function(){var _1b4=function(){if(dojo.config.parseOnLoad){dojo.parser.parse();}};if(dojo.getObject("dijit.wai.onload")===dojo._loaders[0]){dojo._loaders.splice(1,0,_1b4);}else{dojo._loaders.unshift(_1b4);}})();}if(!dojo._hasResource["dojo.html"]){dojo._hasResource["dojo.html"]=true;dojo.provide("dojo.html");dojo.getObject("html",true,dojo);(function(){var _1b5=0,d=dojo;dojo.html._secureForInnerHtml=function(cont){return cont.replace(/(?:\s*<!DOCTYPE\s[^>]+>|<title[^>]*>[\s\S]*?<\/title>)/ig,"");};dojo.html._emptyNode=dojo.empty;dojo.html._setNodeContent=function(node,cont){d.empty(node);if(cont){if(typeof cont=="string"){cont=d._toDom(cont,node.ownerDocument);}if(!cont.nodeType&&d.isArrayLike(cont)){for(var _1b6=cont.length,i=0;i<cont.length;i=_1b6==cont.length?i+1:0){d.place(cont[i],node,"last");}}else{d.place(cont,node,"last");}}return node;};dojo.declare("dojo.html._ContentSetter",null,{node:"",content:"",id:"",cleanContent:false,extractContent:false,parseContent:false,parserScope:dojo._scopeName,startup:true,constructor:function(_1b7,node){dojo.mixin(this,_1b7||{});node=this.node=dojo.byId(this.node||node);if(!this.id){this.id=["Setter",(node)?node.id||node.tagName:"",_1b5++].join("_");}},set:function(cont,_1b8){if(undefined!==cont){this.content=cont;}if(_1b8){this._mixin(_1b8);}this.onBegin();this.setContent();this.onEnd();return this.node;},setContent:function(){var node=this.node;if(!node){throw new Error(this.declaredClass+": setContent given no node");}try{node=dojo.html._setNodeContent(node,this.content);}catch(e){var _1b9=this.onContentError(e);try{node.innerHTML=_1b9;}catch(e){console.error("Fatal "+this.declaredClass+".setContent could not change content due to "+e.message,e);}}this.node=node;},empty:function(){if(this.parseResults&&this.parseResults.length){dojo.forEach(this.parseResults,function(w){if(w.destroy){w.destroy();}});delete this.parseResults;}dojo.html._emptyNode(this.node);},onBegin:function(){var cont=this.content;if(dojo.isString(cont)){if(this.cleanContent){cont=dojo.html._secureForInnerHtml(cont);}if(this.extractContent){var _1ba=cont.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);if(_1ba){cont=_1ba[1];}}}this.empty();this.content=cont;return this.node;},onEnd:function(){if(this.parseContent){this._parse();}return this.node;},tearDown:function(){delete this.parseResults;delete this.node;delete this.content;},onContentError:function(err){return "Error occured setting content: "+err;},_mixin:function(_1bb){var _1bc={},key;for(key in _1bb){if(key in _1bc){continue;}this[key]=_1bb[key];}},_parse:function(){var _1bd=this.node;try{var _1be={};dojo.forEach(["dir","lang","textDir"],function(name){if(this[name]){_1be[name]=this[name];}},this);this.parseResults=dojo.parser.parse({rootNode:_1bd,noStart:!this.startup,inherited:_1be,scope:this.parserScope});}catch(e){this._onError("Content",e,"Error parsing in _ContentSetter#"+this.id);}},_onError:function(type,err,_1bf){var _1c0=this["on"+type+"Error"].call(this,err);if(_1bf){console.error(_1bf,err);}else{if(_1c0){dojo.html._setNodeContent(this.node,_1c0,true);}}}});dojo.html.set=function(node,cont,_1c1){if(undefined==cont){console.warn("dojo.html.set: no cont argument provided, using empty string");cont="";}if(!_1c1){return dojo.html._setNodeContent(node,cont,true);}else{var op=new dojo.html._ContentSetter(dojo.mixin(_1c1,{content:cont,node:node}));return op.set();}};})();}if(!dojo._hasResource["dojo.i18n"]){dojo._hasResource["dojo.i18n"]=true;dojo.provide("dojo.i18n");dojo.getObject("i18n",true,dojo);dojo.i18n.getLocalization=dojo.i18n.getLocalization||function(_1c2,_1c3,_1c4){_1c4=dojo.i18n.normalizeLocale(_1c4);var _1c5=_1c4.split("-");var _1c6=[_1c2,"nls",_1c3].join(".");var _1c7=dojo._loadedModules[_1c6];if(_1c7){var _1c8;for(var i=_1c5.length;i>0;i--){var loc=_1c5.slice(0,i).join("_");if(_1c7[loc]){_1c8=_1c7[loc];break;}}if(!_1c8){_1c8=_1c7.ROOT;}if(_1c8){var _1c9=function(){};_1c9.prototype=_1c8;return new _1c9();}}throw new Error("Bundle not found: "+_1c3+" in "+_1c2+" , locale="+_1c4);};dojo.i18n.normalizeLocale=function(_1ca){var _1cb=_1ca?_1ca.toLowerCase():dojo.locale;if(_1cb=="root"){_1cb="ROOT";}return _1cb;};dojo.i18n._requireLocalization=function(_1cc,_1cd,_1ce,_1cf){var _1d0=dojo.i18n.normalizeLocale(_1ce);var _1d1=[_1cc,"nls",_1cd].join(".");var _1d2="";if(_1cf){var _1d3=_1cf.split(",");for(var i=0;i<_1d3.length;i++){if(_1d0["indexOf"](_1d3[i])==0){if(_1d3[i].length>_1d2.length){_1d2=_1d3[i];}}}if(!_1d2){_1d2="ROOT";}}var _1d4=_1cf?_1d2:_1d0;var _1d5=dojo._loadedModules[_1d1];var _1d6=null;if(_1d5){if(dojo.config.localizationComplete&&_1d5._built){return;}var _1d7=_1d4.replace(/-/g,"_");var _1d8=_1d1+"."+_1d7;_1d6=dojo._loadedModules[_1d8];}if(!_1d6){_1d5=dojo["provide"](_1d1);var syms=dojo._getModuleSymbols(_1cc);var _1d9=syms.concat("nls").join("/");var _1da;dojo.i18n._searchLocalePath(_1d4,_1cf,function(loc){var _1db=loc.replace(/-/g,"_");var _1dc=_1d1+"."+_1db;var _1dd=false;if(!dojo._loadedModules[_1dc]){dojo["provide"](_1dc);var _1de=[_1d9];if(loc!="ROOT"){_1de.push(loc);}_1de.push(_1cd);var _1df=_1de.join("/")+".js";_1dd=dojo._loadPath(_1df,null,function(hash){hash=hash.root||hash;var _1e0=function(){};_1e0.prototype=_1da;_1d5[_1db]=new _1e0();for(var j in hash){_1d5[_1db][j]=hash[j];}});}else{_1dd=true;}if(_1dd&&_1d5[_1db]){_1da=_1d5[_1db];}else{_1d5[_1db]=_1da;}if(_1cf){return true;}});}if(_1cf&&_1d0!=_1d2){_1d5[_1d0.replace(/-/g,"_")]=_1d5[_1d2.replace(/-/g,"_")];}};(function(){var _1e1=dojo.config.extraLocale;if(_1e1){if(!_1e1 instanceof Array){_1e1=[_1e1];}var req=dojo.i18n._requireLocalization;dojo.i18n._requireLocalization=function(m,b,_1e2,_1e3){req(m,b,_1e2,_1e3);if(_1e2){return;}for(var i=0;i<_1e1.length;i++){req(m,b,_1e1[i],_1e3);}};}})();dojo.i18n._searchLocalePath=function(_1e4,down,_1e5){_1e4=dojo.i18n.normalizeLocale(_1e4);var _1e6=_1e4.split("-");var _1e7=[];for(var i=_1e6.length;i>0;i--){_1e7.push(_1e6.slice(0,i).join("-"));}_1e7.push(false);if(down){_1e7.reverse();}for(var j=_1e7.length-1;j>=0;j--){var loc=_1e7[j]||"ROOT";var stop=_1e5(loc);if(stop){break;}}};dojo.i18n._preloadLocalizations=function(_1e8,_1e9){function _1ea(_1eb){_1eb=dojo.i18n.normalizeLocale(_1eb);dojo.i18n._searchLocalePath(_1eb,true,function(loc){for(var i=0;i<_1e9.length;i++){if(_1e9[i]==loc){dojo["require"](_1e8+"_"+loc);return true;}}return false;});};_1ea();var _1ec=dojo.config.extraLocale||[];for(var i=0;i<_1ec.length;i++){_1ea(_1ec[i]);}};}if(!dojo._hasResource["dijit.layout.ContentPane"]){dojo._hasResource["dijit.layout.ContentPane"]=true;dojo.provide("dijit.layout.ContentPane");dojo.declare("dijit.layout.ContentPane",[dijit._Widget,dijit.layout._ContentPaneResizeMixin],{href:"",extractContent:false,parseOnLoad:true,parserScope:dojo._scopeName,preventCache:false,preload:false,refreshOnShow:false,loadingMessage:"<span class='dijitContentPaneLoading'>${loadingState}</span>",errorMessage:"<span class='dijitContentPaneError'>${errorState}</span>",isLoaded:false,baseClass:"dijitContentPane",ioArgs:{},onLoadDeferred:null,attributeMap:dojo.delegate(dijit._Widget.prototype.attributeMap,{title:[]}),stopParser:true,template:false,create:function(_1ed,_1ee){if((!_1ed||!_1ed.template)&&_1ee&&!("href" in _1ed)&&!("content" in _1ed)){var df=dojo.doc.createDocumentFragment();_1ee=dojo.byId(_1ee);while(_1ee.firstChild){df.appendChild(_1ee.firstChild);}_1ed=dojo.delegate(_1ed,{content:df});}this.inherited(arguments,[_1ed,_1ee]);},postMixInProperties:function(){this.inherited(arguments);var _1ef=dojo.i18n.getLocalization("dijit","loading",this.lang);this.loadingMessage=dojo.string.substitute(this.loadingMessage,_1ef);this.errorMessage=dojo.string.substitute(this.errorMessage,_1ef);},buildRendering:function(){this.inherited(arguments);if(!this.containerNode){this.containerNode=this.domNode;}this.domNode.title="";if(!dojo.attr(this.domNode,"role")){dijit.setWaiRole(this.domNode,"group");}},_startChildren:function(){this.inherited(arguments);if(this._contentSetter){dojo.forEach(this._contentSetter.parseResults,function(obj){if(!obj._started&&!obj._destroyed&&dojo.isFunction(obj.startup)){obj.startup();obj._started=true;}},this);}},setHref:function(href){dojo.deprecated("dijit.layout.ContentPane.setHref() is deprecated. Use set('href', ...) instead.","","2.0");return this.set("href",href);},_setHrefAttr:function(href){this.cancel();this.onLoadDeferred=new dojo.Deferred(dojo.hitch(this,"cancel"));this.onLoadDeferred.addCallback(dojo.hitch(this,"onLoad"));this._set("href",href);if(this.preload||(this._created&&this._isShown())){this._load();}else{this._hrefChanged=true;}return this.onLoadDeferred;},setContent:function(data){dojo.deprecated("dijit.layout.ContentPane.setContent() is deprecated.  Use set('content', ...) instead.","","2.0");this.set("content",data);},_setContentAttr:function(data){this._set("href","");this.cancel();this.onLoadDeferred=new dojo.Deferred(dojo.hitch(this,"cancel"));if(this._created){this.onLoadDeferred.addCallback(dojo.hitch(this,"onLoad"));}this._setContent(data||"");this._isDownloaded=false;return this.onLoadDeferred;},_getContentAttr:function(){return this.containerNode.innerHTML;},cancel:function(){if(this._xhrDfd&&(this._xhrDfd.fired==-1)){this._xhrDfd.cancel();}delete this._xhrDfd;this.onLoadDeferred=null;},uninitialize:function(){if(this._beingDestroyed){this.cancel();}this.inherited(arguments);},destroyRecursive:function(_1f0){if(this._beingDestroyed){return;}this.inherited(arguments);},_onShow:function(){this.inherited(arguments);if(this.href){if(!this._xhrDfd&&(!this.isLoaded||this._hrefChanged||this.refreshOnShow)){return this.refresh();}}},refresh:function(){this.cancel();this.onLoadDeferred=new dojo.Deferred(dojo.hitch(this,"cancel"));this.onLoadDeferred.addCallback(dojo.hitch(this,"onLoad"));this._load();return this.onLoadDeferred;},_load:function(){this._setContent(this.onDownloadStart(),true);var self=this;var _1f1={preventCache:(this.preventCache||this.refreshOnShow),url:this.href,handleAs:"text"};if(dojo.isObject(this.ioArgs)){dojo.mixin(_1f1,this.ioArgs);}var hand=(this._xhrDfd=(this.ioMethod||dojo.xhrGet)(_1f1));hand.addCallback(function(html){try{self._isDownloaded=true;self._setContent(html,false);self.onDownloadEnd();}catch(err){self._onError("Content",err);}delete self._xhrDfd;return html;});hand.addErrback(function(err){if(!hand.canceled){self._onError("Download",err);}delete self._xhrDfd;return err;});delete this._hrefChanged;},_onLoadHandler:function(data){this._set("isLoaded",true);try{this.onLoadDeferred.callback(data);}catch(e){console.error("Error "+this.widgetId+" running custom onLoad code: "+e.message);}},_onUnloadHandler:function(){this._set("isLoaded",false);try{this.onUnload();}catch(e){console.error("Error "+this.widgetId+" running custom onUnload code: "+e.message);}},destroyDescendants:function(){if(this.isLoaded){this._onUnloadHandler();}var _1f2=this._contentSetter;dojo.forEach(this.getChildren(),function(_1f3){if(_1f3.destroyRecursive){_1f3.destroyRecursive();}});if(_1f2){dojo.forEach(_1f2.parseResults,function(_1f4){if(_1f4.destroyRecursive&&_1f4.domNode&&_1f4.domNode.parentNode==dojo.body()){_1f4.destroyRecursive();}});delete _1f2.parseResults;}dojo.html._emptyNode(this.containerNode);delete this._singleChild;},_setContent:function(cont,_1f5){this.destroyDescendants();var _1f6=this._contentSetter;if(!(_1f6&&_1f6 instanceof dojo.html._ContentSetter)){_1f6=this._contentSetter=new dojo.html._ContentSetter({node:this.containerNode,_onError:dojo.hitch(this,this._onError),onContentError:dojo.hitch(this,function(e){var _1f7=this.onContentError(e);try{this.containerNode.innerHTML=_1f7;}catch(e){console.error("Fatal "+this.id+" could not change content due to "+e.message,e);}})});}var _1f8=dojo.mixin({cleanContent:this.cleanContent,extractContent:this.extractContent,parseContent:this.parseOnLoad,parserScope:this.parserScope,startup:false,dir:this.dir,lang:this.lang},this._contentSetterParams||{});_1f6.set((dojo.isObject(cont)&&cont.domNode)?cont.domNode:cont,_1f8);delete this._contentSetterParams;if(this.doLayout){this._checkIfSingleChild();}if(!_1f5){if(this._started){this._startChildren();this._scheduleLayout();}this._onLoadHandler(cont);}},_onError:function(type,err,_1f9){this.onLoadDeferred.errback(err);var _1fa=this["on"+type+"Error"].call(this,err);if(_1f9){console.error(_1f9,err);}else{if(_1fa){this._setContent(_1fa,true);}}},onLoad:function(data){console.log("dijit.layout.ContentPane.onLoad    caller: "+this.onLoad.caller.nom);},onUnload:function(){},onDownloadStart:function(){return this.loadingMessage;},onContentError:function(_1fb){},onDownloadError:function(_1fc){return this.errorMessage;},onDownloadEnd:function(){}});}if(!dojo._hasResource["dojo.cache"]){dojo._hasResource["dojo.cache"]=true;dojo.provide("dojo.cache");var cache={};dojo.cache=function(_1fd,url,_1fe){if(typeof _1fd=="string"){var _1ff=dojo.moduleUrl(_1fd,url);}else{_1ff=_1fd;_1fe=url;}var key=_1ff.toString();var val=_1fe;if(_1fe!=undefined&&!dojo.isString(_1fe)){val=("value" in _1fe?_1fe.value:undefined);}var _200=_1fe&&_1fe.sanitize?true:false;if(typeof val=="string"){val=cache[key]=_200?dojo.cache._sanitize(val):val;}else{if(val===null){delete cache[key];}else{if(!(key in cache)){val=dojo._getText(key);cache[key]=_200?dojo.cache._sanitize(val):val;}val=cache[key];}}return val;};dojo.cache._sanitize=function(val){if(val){val=val.replace(/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,"");var _201=val.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);if(_201){val=_201[1];}}else{val="";}return val;};}if(!dojo._hasResource["dijit._Templated"]){dojo._hasResource["dijit._Templated"]=true;dojo.provide("dijit._Templated");dojo.declare("dijit._Templated",null,{templateString:null,templatePath:null,widgetsInTemplate:false,_skipNodeCache:false,_earlyTemplatedStartup:false,constructor:function(){this._attachPoints=[];this._attachEvents=[];},_stringRepl:function(tmpl){var _202=this.declaredClass,_203=this;return dojo.string.substitute(tmpl,this,function(_204,key){if(key.charAt(0)=="!"){_204=dojo.getObject(key.substr(1),false,_203);}if(typeof _204=="undefined"){throw new Error(_202+" template:"+key);}if(_204==null){return "";}return key.charAt(0)=="!"?_204:_204.toString().replace(/"/g,"&quot;");},this);},buildRendering:function(){var _205=dijit._Templated.getCachedTemplate(this.templatePath,this.templateString,this._skipNodeCache);var node;if(dojo.isString(_205)){node=dojo._toDom(this._stringRepl(_205));if(node.nodeType!=1){throw new Error("Invalid template: "+_205);}}else{node=_205.cloneNode(true);}this.domNode=node;this.inherited(arguments);this._attachTemplateNodes(node);if(this.widgetsInTemplate){var cw=(this._startupWidgets=dojo.parser.parse(node,{noStart:!this._earlyTemplatedStartup,template:true,inherited:{dir:this.dir,lang:this.lang},propsThis:this,scope:"dojo"}));this._supportingWidgets=dijit.findWidgets(node);this._attachTemplateNodes(cw,function(n,p){return n[p];});}this._fillContent(this.srcNodeRef);},_fillContent:function(_206){var dest=this.containerNode;if(_206&&dest){while(_206.hasChildNodes()){dest.appendChild(_206.firstChild);}}},_attachTemplateNodes:function(_207,_208){_208=_208||function(n,p){return n.getAttribute(p);};var _209=dojo.isArray(_207)?_207:(_207.all||_207.getElementsByTagName("*"));var x=dojo.isArray(_207)?0:-1;for(;x<_209.length;x++){var _20a=(x==-1)?_207:_209[x];if(this.widgetsInTemplate&&(_208(_20a,"dojoType")||_208(_20a,"data-dojo-type"))){continue;}var _20b=_208(_20a,"dojoAttachPoint")||_208(_20a,"data-dojo-attach-point");if(_20b){var _20c,_20d=_20b.split(/\s*,\s*/);while((_20c=_20d.shift())){if(dojo.isArray(this[_20c])){this[_20c].push(_20a);}else{this[_20c]=_20a;}this._attachPoints.push(_20c);}}var _20e=_208(_20a,"dojoAttachEvent")||_208(_20a,"data-dojo-attach-event");if(_20e){var _20f,_210=_20e.split(/\s*,\s*/);var trim=dojo.trim;while((_20f=_210.shift())){if(_20f){var _211=null;if(_20f.indexOf(":")!=-1){var _212=_20f.split(":");_20f=trim(_212[0]);_211=trim(_212[1]);}else{_20f=trim(_20f);}if(!_211){_211=_20f;}this._attachEvents.push(this.connect(_20a,_20f,_211));}}}var role=_208(_20a,"waiRole");if(role){dijit.setWaiRole(_20a,role);}var _213=_208(_20a,"waiState");if(_213){dojo.forEach(_213.split(/\s*,\s*/),function(_214){if(_214.indexOf("-")!=-1){var pair=_214.split("-");dijit.setWaiState(_20a,pair[0],pair[1]);}});}}},startup:function(){dojo.forEach(this._startupWidgets,function(w){if(w&&!w._started&&w.startup){w.startup();}});this.inherited(arguments);},destroyRendering:function(){dojo.forEach(this._attachPoints,function(_215){delete this[_215];},this);this._attachPoints=[];dojo.forEach(this._attachEvents,this.disconnect,this);this._attachEvents=[];this.inherited(arguments);}});dijit._Templated._templateCache={};dijit._Templated.getCachedTemplate=function(_216,_217,_218){var _219=dijit._Templated._templateCache;var key=_217||_216;var _21a=_219[key];if(_21a){try{if(!_21a.ownerDocument||_21a.ownerDocument==dojo.doc){return _21a;}}catch(e){}dojo.destroy(_21a);}if(!_217){_217=dojo.cache(_216,{sanitize:true});}_217=dojo.string.trim(_217);if(_218||_217.match(/\$\{([^\}]+)\}/g)){return (_219[key]=_217);}else{var node=dojo._toDom(_217);if(node.nodeType!=1){throw new Error("Invalid template: "+_217);}return (_219[key]=node);}};if(dojo.isIE){dojo.addOnWindowUnload(function(){var _21b=dijit._Templated._templateCache;for(var key in _21b){var _21c=_21b[key];if(typeof _21c=="object"){dojo.destroy(_21c);}delete _21b[key];}});}dojo.extend(dijit._Widget,{dojoAttachEvent:"",dojoAttachPoint:"",waiRole:"",waiState:""});}if(!dojo._hasResource["dijit._CssStateMixin"]){dojo._hasResource["dijit._CssStateMixin"]=true;dojo.provide("dijit._CssStateMixin");dojo.declare("dijit._CssStateMixin",[],{cssStateNodes:{},hovering:false,active:false,_applyAttributes:function(){this.inherited(arguments);dojo.forEach(["onmouseenter","onmouseleave","onmousedown"],function(e){this.connect(this.domNode,e,"_cssMouseEvent");},this);dojo.forEach(["disabled","readOnly","checked","selected","focused","state","hovering","active"],function(attr){this.watch(attr,dojo.hitch(this,"_setStateClass"));},this);for(var ap in this.cssStateNodes){this._trackMouseState(this[ap],this.cssStateNodes[ap]);}this._setStateClass();},_cssMouseEvent:function(_21d){if(!this.disabled){switch(_21d.type){case "mouseenter":case "mouseover":this._set("hovering",true);this._set("active",this._mouseDown);break;case "mouseleave":case "mouseout":this._set("hovering",false);this._set("active",false);break;case "mousedown":this._set("active",true);this._mouseDown=true;var _21e=this.connect(dojo.body(),"onmouseup",function(){this._mouseDown=false;this._set("active",false);this.disconnect(_21e);});break;}}},_setStateClass:function(){var _21f=this.baseClass.split(" ");function _220(_221){_21f=_21f.concat(dojo.map(_21f,function(c){return c+_221;}),"dijit"+_221);};if(!this.isLeftToRight()){_220("Rtl");}if(this.checked){_220("Checked");}if(this.state){_220(this.state);}if(this.selected){_220("Selected");}if(this.disabled){_220("Disabled");}else{if(this.readOnly){_220("ReadOnly");}else{if(this.active){_220("Active");}else{if(this.hovering){_220("Hover");}}}}if(this._focused){_220("Focused");}var tn=this.stateNode||this.domNode,_222={};dojo.forEach(tn.className.split(" "),function(c){_222[c]=true;});if("_stateClasses" in this){dojo.forEach(this._stateClasses,function(c){delete _222[c];});}dojo.forEach(_21f,function(c){_222[c]=true;});var _223=[];for(var c in _222){_223.push(c);}tn.className=_223.join(" ");this._stateClasses=_21f;},_trackMouseState:function(node,_224){var _225=false,_226=false,_227=false;var self=this,cn=dojo.hitch(this,"connect",node);function _228(){var _229=("disabled" in self&&self.disabled)||("readonly" in self&&self.readonly);dojo.toggleClass(node,_224+"Hover",_225&&!_226&&!_229);dojo.toggleClass(node,_224+"Active",_226&&!_229);dojo.toggleClass(node,_224+"Focused",_227&&!_229);};cn("onmouseenter",function(){_225=true;_228();});cn("onmouseleave",function(){_225=false;_226=false;_228();});cn("onmousedown",function(){_226=true;_228();});cn("onmouseup",function(){_226=false;_228();});cn("onfocus",function(){_227=true;_228();});cn("onblur",function(){_227=false;_228();});this.watch("disabled",_228);this.watch("readOnly",_228);}});}if(!dojo._hasResource["dijit.form._FormWidget"]){dojo._hasResource["dijit.form._FormWidget"]=true;dojo.provide("dijit.form._FormWidget");dojo.declare("dijit.form._FormWidget",[dijit._Widget,dijit._Templated,dijit._CssStateMixin],{name:"",alt:"",value:"",type:"text",tabIndex:"0",disabled:false,intermediateChanges:false,scrollOnFocus:true,attributeMap:dojo.delegate(dijit._Widget.prototype.attributeMap,{value:"focusNode",id:"focusNode",tabIndex:"focusNode",alt:"focusNode",title:"focusNode"}),postMixInProperties:function(){this.nameAttrSetting=this.name?("name=\""+this.name.replace(/'/g,"&quot;")+"\""):"";this.inherited(arguments);},postCreate:function(){this.inherited(arguments);this.connect(this.domNode,"onmousedown","_onMouseDown");},_setDisabledAttr:function(_22a){this._set("disabled",_22a);dojo.attr(this.focusNode,"disabled",_22a);if(this.valueNode){dojo.attr(this.valueNode,"disabled",_22a);}dijit.setWaiState(this.focusNode,"disabled",_22a);if(_22a){this._set("hovering",false);this._set("active",false);var _22b="tabIndex" in this.attributeMap?this.attributeMap.tabIndex:"focusNode";dojo.forEach(dojo.isArray(_22b)?_22b:[_22b],function(_22c){var node=this[_22c];if(dojo.isWebKit||dijit.hasDefaultTabStop(node)){node.setAttribute("tabIndex","-1");}else{node.removeAttribute("tabIndex");}},this);}else{if(this.tabIndex!=""){this.focusNode.setAttribute("tabIndex",this.tabIndex);}}},setDisabled:function(_22d){dojo.deprecated("setDisabled("+_22d+") is deprecated. Use set('disabled',"+_22d+") instead.","","2.0");this.set("disabled",_22d);},_onFocus:function(e){if(this.scrollOnFocus){dojo.window.scrollIntoView(this.domNode);}this.inherited(arguments);},isFocusable:function(){return !this.disabled&&this.focusNode&&(dojo.style(this.domNode,"display")!="none");},focus:function(){if(!this.disabled){dijit.focus(this.focusNode);}},compare:function(val1,val2){if(typeof val1=="number"&&typeof val2=="number"){return (isNaN(val1)&&isNaN(val2))?0:val1-val2;}else{if(val1>val2){return 1;}else{if(val1<val2){return -1;}else{return 0;}}}},onChange:function(_22e){},_onChangeActive:false,_handleOnChange:function(_22f,_230){if(this._lastValueReported==undefined&&(_230===null||!this._onChangeActive)){this._resetValue=this._lastValueReported=_22f;}this._pendingOnChange=this._pendingOnChange||(typeof _22f!=typeof this._lastValueReported)||(this.compare(_22f,this._lastValueReported)!=0);if((this.intermediateChanges||_230||_230===undefined)&&this._pendingOnChange){this._lastValueReported=_22f;this._pendingOnChange=false;if(this._onChangeActive){if(this._onChangeHandle){clearTimeout(this._onChangeHandle);}this._onChangeHandle=setTimeout(dojo.hitch(this,function(){this._onChangeHandle=null;this.onChange(_22f);}),0);}}},create:function(){this.inherited(arguments);this._onChangeActive=true;},destroy:function(){if(this._onChangeHandle){clearTimeout(this._onChangeHandle);this.onChange(this._lastValueReported);}this.inherited(arguments);},setValue:function(_231){dojo.deprecated("dijit.form._FormWidget:setValue("+_231+") is deprecated.  Use set('value',"+_231+") instead.","","2.0");this.set("value",_231);},getValue:function(){dojo.deprecated(this.declaredClass+"::getValue() is deprecated. Use get('value') instead.","","2.0");return this.get("value");},_onMouseDown:function(e){if(!e.ctrlKey&&dojo.mouseButtons.isLeft(e)&&this.isFocusable()){var _232=this.connect(dojo.body(),"onmouseup",function(){if(this.isFocusable()){this.focus();}this.disconnect(_232);});}}});dojo.declare("dijit.form._FormValueWidget",dijit.form._FormWidget,{readOnly:false,attributeMap:dojo.delegate(dijit.form._FormWidget.prototype.attributeMap,{value:"",readOnly:"focusNode"}),_setReadOnlyAttr:function(_233){dojo.attr(this.focusNode,"readOnly",_233);dijit.setWaiState(this.focusNode,"readonly",_233);this._set("readOnly",_233);},postCreate:function(){this.inherited(arguments);if(dojo.isIE<9||(dojo.isIE&&dojo.isQuirks)){this.connect(this.focusNode||this.domNode,"onkeydown",this._onKeyDown);}if(this._resetValue===undefined){this._lastValueReported=this._resetValue=this.value;}},_setValueAttr:function(_234,_235){this._handleOnChange(_234,_235);},_handleOnChange:function(_236,_237){this._set("value",_236);this.inherited(arguments);},undo:function(){this._setValueAttr(this._lastValueReported,false);},reset:function(){this._hasBeenBlurred=false;this._setValueAttr(this._resetValue,true);},_onKeyDown:function(e){if(e.keyCode==dojo.keys.ESCAPE&&!(e.ctrlKey||e.altKey||e.metaKey)){var te;if(dojo.isIE){e.preventDefault();te=document.createEventObject();te.keyCode=dojo.keys.ESCAPE;te.shiftKey=e.shiftKey;e.srcElement.fireEvent("onkeypress",te);}}},_layoutHackIE7:function(){if(dojo.isIE==7){var _238=this.domNode;var _239=_238.parentNode;var _23a=_238.firstChild||_238;var _23b=_23a.style.filter;var _23c=this;while(_239&&_239.clientHeight==0){(function ping(){var _23d=_23c.connect(_239,"onscroll",function(e){_23c.disconnect(_23d);_23a.style.filter=(new Date()).getMilliseconds();setTimeout(function(){_23a.style.filter=_23b;},0);});})();_239=_239.parentNode;}}}});}if(!dojo._hasResource["dijit._HasDropDown"]){dojo._hasResource["dijit._HasDropDown"]=true;dojo.provide("dijit._HasDropDown");dojo.declare("dijit._HasDropDown",null,{_buttonNode:null,_arrowWrapperNode:null,_popupStateNode:null,_aroundNode:null,dropDown:null,autoWidth:true,forceWidth:false,maxHeight:0,dropDownPosition:["below","above"],_stopClickEvents:true,_onDropDownMouseDown:function(e){if(this.disabled||this.readOnly){return;}dojo.stopEvent(e);this._docHandler=this.connect(dojo.doc,"onmouseup","_onDropDownMouseUp");this.toggleDropDown();},_onDropDownMouseUp:function(e){if(e&&this._docHandler){this.disconnect(this._docHandler);}var _23e=this.dropDown,_23f=false;if(e&&this._opened){var c=dojo.position(this._buttonNode,true);if(!(e.pageX>=c.x&&e.pageX<=c.x+c.w)||!(e.pageY>=c.y&&e.pageY<=c.y+c.h)){var t=e.target;while(t&&!_23f){if(dojo.hasClass(t,"dijitPopup")){_23f=true;}else{t=t.parentNode;}}if(_23f){t=e.target;if(_23e.onItemClick){var _240;while(t&&!(_240=dijit.byNode(t))){t=t.parentNode;}if(_240&&_240.onClick&&_240.getParent){_240.getParent().onItemClick(_240,e);}}return;}}}if(this._opened&&_23e.focus&&_23e.autoFocus!==false){window.setTimeout(dojo.hitch(_23e,"focus"),1);}},_onDropDownClick:function(e){if(this._stopClickEvents){dojo.stopEvent(e);}},buildRendering:function(){this.inherited(arguments);this._buttonNode=this._buttonNode||this.focusNode||this.domNode;this._popupStateNode=this._popupStateNode||this.focusNode||this._buttonNode;var _241={"after":this.isLeftToRight()?"Right":"Left","before":this.isLeftToRight()?"Left":"Right","above":"Up","below":"Down","left":"Left","right":"Right"}[this.dropDownPosition[0]]||this.dropDownPosition[0]||"Down";dojo.addClass(this._arrowWrapperNode||this._buttonNode,"dijit"+_241+"ArrowButton");},postCreate:function(){this.inherited(arguments);this.connect(this._buttonNode,"onmousedown","_onDropDownMouseDown");this.connect(this._buttonNode,"onclick","_onDropDownClick");this.connect(this.focusNode,"onkeypress","_onKey");this.connect(this.focusNode,"onkeyup","_onKeyUp");},destroy:function(){if(this.dropDown){if(!this.dropDown._destroyed){this.dropDown.destroyRecursive();}delete this.dropDown;}this.inherited(arguments);},_onKey:function(e){if(this.disabled||this.readOnly){return;}var d=this.dropDown,_242=e.target;if(d&&this._opened&&d.handleKey){if(d.handleKey(e)===false){dojo.stopEvent(e);return;}}if(d&&this._opened&&e.charOrCode==dojo.keys.ESCAPE){this.closeDropDown();dojo.stopEvent(e);}else{if(!this._opened&&(e.charOrCode==dojo.keys.DOWN_ARROW||((e.charOrCode==dojo.keys.ENTER||e.charOrCode==" ")&&((_242.tagName||"").toLowerCase()!=="input"||(_242.type&&_242.type.toLowerCase()!=="text"))))){this._toggleOnKeyUp=true;dojo.stopEvent(e);}}},_onKeyUp:function(){if(this._toggleOnKeyUp){delete this._toggleOnKeyUp;this.toggleDropDown();var d=this.dropDown;if(d&&d.focus){setTimeout(dojo.hitch(d,"focus"),1);}}},_onBlur:function(){var _243=dijit._curFocus&&this.dropDown&&dojo.isDescendant(dijit._curFocus,this.dropDown.domNode);this.closeDropDown(_243);this.inherited(arguments);},isLoaded:function(){return true;},loadDropDown:function(_244){_244();},toggleDropDown:function(){if(this.disabled||this.readOnly){return;}if(!this._opened){if(!this.isLoaded()){this.loadDropDown(dojo.hitch(this,"openDropDown"));return;}else{this.openDropDown();}}else{this.closeDropDown();}},openDropDown:function(){var _245=this.dropDown,_246=_245.domNode,_247=this._aroundNode||this.domNode,self=this;if(!this._preparedNode){this._preparedNode=true;if(_246.style.width){this._explicitDDWidth=true;}if(_246.style.height){this._explicitDDHeight=true;}}if(this.maxHeight||this.forceWidth||this.autoWidth){var _248={display:"",visibility:"hidden"};if(!this._explicitDDWidth){_248.width="";}if(!this._explicitDDHeight){_248.height="";}dojo.style(_246,_248);var _249=this.maxHeight;if(_249==-1){var _24a=dojo.window.getBox(),_24b=dojo.position(_247,false);_249=Math.floor(Math.max(_24b.y,_24a.h-(_24b.y+_24b.h)));}if(_245.startup&&!_245._started){_245.startup();}dijit.popup.moveOffScreen(_245);var mb=dojo._getMarginSize(_246);var _24c=(_249&&mb.h>_249);dojo.style(_246,{overflowX:"hidden",overflowY:_24c?"auto":"hidden"});if(_24c){mb.h=_249;if("w" in mb){mb.w+=16;}}else{delete mb.h;}if(this.forceWidth){mb.w=_247.offsetWidth;}else{if(this.autoWidth){mb.w=Math.max(mb.w,_247.offsetWidth);}else{delete mb.w;}}if(dojo.isFunction(_245.resize)){_245.resize(mb);}else{dojo.marginBox(_246,mb);}}var _24d=dijit.popup.open({parent:this,popup:_245,around:_247,orient:dijit.getPopupAroundAlignment((this.dropDownPosition&&this.dropDownPosition.length)?this.dropDownPosition:["below"],this.isLeftToRight()),onExecute:function(){self.closeDropDown(true);},onCancel:function(){self.closeDropDown(true);},onClose:function(){dojo.attr(self._popupStateNode,"popupActive",false);dojo.removeClass(self._popupStateNode,"dijitHasDropDownOpen");self._opened=false;}});dojo.attr(this._popupStateNode,"popupActive","true");dojo.addClass(self._popupStateNode,"dijitHasDropDownOpen");this._opened=true;return _24d;},closeDropDown:function(_24e){if(this._opened){if(_24e){this.focus();}dijit.popup.close(this.dropDown);this._opened=false;}}});}if(!dojo._hasResource["dijit.form.Button"]){dojo._hasResource["dijit.form.Button"]=true;dojo.provide("dijit.form.Button");dojo.declare("dijit.form.Button",dijit.form._FormWidget,{label:"",showLabel:true,iconClass:"",type:"button",baseClass:"dijitButton",templateString:dojo.cache("dijit.form","templates/Button.html","<span class=\"dijit dijitReset dijitInline\"\n\t><span class=\"dijitReset dijitInline dijitButtonNode\"\n\t\tdojoAttachEvent=\"ondijitclick:_onButtonClick\"\n\t\t><span class=\"dijitReset dijitStretch dijitButtonContents\"\n\t\t\tdojoAttachPoint=\"titleNode,focusNode\"\n\t\t\trole=\"button\" aria-labelledby=\"${id}_label\"\n\t\t\t><span class=\"dijitReset dijitInline dijitIcon\" dojoAttachPoint=\"iconNode\"></span\n\t\t\t><span class=\"dijitReset dijitToggleButtonIconChar\">&#x25CF;</span\n\t\t\t><span class=\"dijitReset dijitInline dijitButtonText\"\n\t\t\t\tid=\"${id}_label\"\n\t\t\t\tdojoAttachPoint=\"containerNode\"\n\t\t\t></span\n\t\t></span\n\t></span\n\t><input ${!nameAttrSetting} type=\"${type}\" value=\"${value}\" class=\"dijitOffScreen\" tabIndex=\"-1\"\n\t\tdojoAttachPoint=\"valueNode\"\n/></span>\n"),attributeMap:dojo.delegate(dijit.form._FormWidget.prototype.attributeMap,{value:"valueNode"}),_onClick:function(e){if(this.disabled){return false;}this._clicked();return this.onClick(e);},_onButtonClick:function(e){if(this._onClick(e)===false){e.preventDefault();}else{if(this.type=="submit"&&!(this.valueNode||this.focusNode).form){for(var node=this.domNode;node.parentNode;node=node.parentNode){var _24f=dijit.byNode(node);if(_24f&&typeof _24f._onSubmit=="function"){_24f._onSubmit(e);break;}}}else{if(this.valueNode){this.valueNode.click();e.preventDefault();}}}},buildRendering:function(){this.inherited(arguments);dojo.setSelectable(this.focusNode,false);},_fillContent:function(_250){if(_250&&(!this.params||!("label" in this.params))){this.set("label",_250.innerHTML);}},_setShowLabelAttr:function(val){if(this.containerNode){dojo.toggleClass(this.containerNode,"dijitDisplayNone",!val);}this._set("showLabel",val);},onClick:function(e){return true;},_clicked:function(e){},setLabel:function(_251){dojo.deprecated("dijit.form.Button.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",_251);},_setLabelAttr:function(_252){this._set("label",_252);this.containerNode.innerHTML=_252;if(this.showLabel==false&&!this.params.title){this.titleNode.title=dojo.trim(this.containerNode.innerText||this.containerNode.textContent||"");}},_setIconClassAttr:function(val){var _253=this.iconClass||"dijitNoIcon",_254=val||"dijitNoIcon";dojo.replaceClass(this.iconNode,_254,_253);this._set("iconClass",val);}});dojo.declare("dijit.form.DropDownButton",[dijit.form.Button,dijit._Container,dijit._HasDropDown],{baseClass:"dijitDropDownButton",templateString:dojo.cache("dijit.form","templates/DropDownButton.html","<span class=\"dijit dijitReset dijitInline\"\n\t><span class='dijitReset dijitInline dijitButtonNode'\n\t\tdojoAttachEvent=\"ondijitclick:_onButtonClick\" dojoAttachPoint=\"_buttonNode\"\n\t\t><span class=\"dijitReset dijitStretch dijitButtonContents\"\n\t\t\tdojoAttachPoint=\"focusNode,titleNode,_arrowWrapperNode\"\n\t\t\trole=\"button\" aria-haspopup=\"true\" aria-labelledby=\"${id}_label\"\n\t\t\t><span class=\"dijitReset dijitInline dijitIcon\"\n\t\t\t\tdojoAttachPoint=\"iconNode\"\n\t\t\t></span\n\t\t\t><span class=\"dijitReset dijitInline dijitButtonText\"\n\t\t\t\tdojoAttachPoint=\"containerNode,_popupStateNode\"\n\t\t\t\tid=\"${id}_label\"\n\t\t\t></span\n\t\t\t><span class=\"dijitReset dijitInline dijitArrowButtonInner\"></span\n\t\t\t><span class=\"dijitReset dijitInline dijitArrowButtonChar\">&#9660;</span\n\t\t></span\n\t></span\n\t><input ${!nameAttrSetting} type=\"${type}\" value=\"${value}\" class=\"dijitOffScreen\" tabIndex=\"-1\"\n\t\tdojoAttachPoint=\"valueNode\"\n/></span>\n"),_fillContent:function(){if(this.srcNodeRef){var _255=dojo.query("*",this.srcNodeRef);dijit.form.DropDownButton.superclass._fillContent.call(this,_255[0]);this.dropDownContainer=this.srcNodeRef;}},startup:function(){if(this._started){return;}if(!this.dropDown&&this.dropDownContainer){var _256=dojo.query("[widgetId]",this.dropDownContainer)[0];this.dropDown=dijit.byNode(_256);delete this.dropDownContainer;}if(this.dropDown){dijit.popup.hide(this.dropDown);}this.inherited(arguments);},isLoaded:function(){var _257=this.dropDown;return (!!_257&&(!_257.href||_257.isLoaded));},loadDropDown:function(){var _258=this.dropDown;if(!_258){return;}if(!this.isLoaded()){var _259=dojo.connect(_258,"onLoad",this,function(){dojo.disconnect(_259);this.openDropDown();});_258.refresh();}else{this.openDropDown();}},isFocusable:function(){return this.inherited(arguments)&&!this._mouseDown;}});dojo.declare("dijit.form.ComboButton",dijit.form.DropDownButton,{templateString:dojo.cache("dijit.form","templates/ComboButton.html","<table class=\"dijit dijitReset dijitInline dijitLeft\"\n\tcellspacing='0' cellpadding='0' role=\"presentation\"\n\t><tbody role=\"presentation\"><tr role=\"presentation\"\n\t\t><td class=\"dijitReset dijitStretch dijitButtonNode\" dojoAttachPoint=\"buttonNode\" dojoAttachEvent=\"ondijitclick:_onButtonClick,onkeypress:_onButtonKeyPress\"\n\t\t><div id=\"${id}_button\" class=\"dijitReset dijitButtonContents\"\n\t\t\tdojoAttachPoint=\"titleNode\"\n\t\t\trole=\"button\" aria-labelledby=\"${id}_label\"\n\t\t\t><div class=\"dijitReset dijitInline dijitIcon\" dojoAttachPoint=\"iconNode\" role=\"presentation\"></div\n\t\t\t><div class=\"dijitReset dijitInline dijitButtonText\" id=\"${id}_label\" dojoAttachPoint=\"containerNode\" role=\"presentation\"></div\n\t\t></div\n\t\t></td\n\t\t><td id=\"${id}_arrow\" class='dijitReset dijitRight dijitButtonNode dijitArrowButton'\n\t\t\tdojoAttachPoint=\"_popupStateNode,focusNode,_buttonNode\"\n\t\t\tdojoAttachEvent=\"onkeypress:_onArrowKeyPress\"\n\t\t\ttitle=\"${optionsTitle}\"\n\t\t\trole=\"button\" aria-haspopup=\"true\"\n\t\t\t><div class=\"dijitReset dijitArrowButtonInner\" role=\"presentation\"></div\n\t\t\t><div class=\"dijitReset dijitArrowButtonChar\" role=\"presentation\">&#9660;</div\n\t\t></td\n\t\t><td style=\"display:none !important;\"\n\t\t\t><input ${!nameAttrSetting} type=\"${type}\" value=\"${value}\" dojoAttachPoint=\"valueNode\"\n\t\t/></td></tr></tbody\n></table>\n"),attributeMap:dojo.mixin(dojo.clone(dijit.form.Button.prototype.attributeMap),{id:"",tabIndex:["focusNode","titleNode"],title:"titleNode"}),optionsTitle:"",baseClass:"dijitComboButton",cssStateNodes:{"buttonNode":"dijitButtonNode","titleNode":"dijitButtonContents","_popupStateNode":"dijitDownArrowButton"},_focusedNode:null,_onButtonKeyPress:function(evt){if(evt.charOrCode==dojo.keys[this.isLeftToRight()?"RIGHT_ARROW":"LEFT_ARROW"]){dijit.focus(this._popupStateNode);dojo.stopEvent(evt);}},_onArrowKeyPress:function(evt){if(evt.charOrCode==dojo.keys[this.isLeftToRight()?"LEFT_ARROW":"RIGHT_ARROW"]){dijit.focus(this.titleNode);dojo.stopEvent(evt);}},focus:function(_25a){if(!this.disabled){dijit.focus(_25a=="start"?this.titleNode:this._popupStateNode);}}});dojo.declare("dijit.form.ToggleButton",dijit.form.Button,{baseClass:"dijitToggleButton",checked:false,attributeMap:dojo.mixin(dojo.clone(dijit.form.Button.prototype.attributeMap),{checked:"focusNode"}),_clicked:function(evt){this.set("checked",!this.checked);},_setCheckedAttr:function(_25b,_25c){this._set("checked",_25b);dojo.attr(this.focusNode||this.domNode,"checked",_25b);dijit.setWaiState(this.focusNode||this.domNode,"pressed",_25b);this._handleOnChange(_25b,_25c);},setChecked:function(_25d){dojo.deprecated("setChecked("+_25d+") is deprecated. Use set('checked',"+_25d+") instead.","","2.0");this.set("checked",_25d);},reset:function(){this._hasBeenBlurred=false;this.set("checked",this.params.checked||false);}});}if(!dojo._hasResource["dijit.form.ToggleButton"]){dojo._hasResource["dijit.form.ToggleButton"]=true;dojo.provide("dijit.form.ToggleButton");}if(!dojo._hasResource["dijit.form.CheckBox"]){dojo._hasResource["dijit.form.CheckBox"]=true;dojo.provide("dijit.form.CheckBox");dojo.declare("dijit.form.CheckBox",dijit.form.ToggleButton,{templateString:dojo.cache("dijit.form","templates/CheckBox.html","<div class=\"dijit dijitReset dijitInline\" role=\"presentation\"\n\t><input\n\t \t${!nameAttrSetting} type=\"${type}\" ${checkedAttrSetting}\n\t\tclass=\"dijitReset dijitCheckBoxInput\"\n\t\tdojoAttachPoint=\"focusNode\"\n\t \tdojoAttachEvent=\"onclick:_onClick\"\n/></div>\n"),baseClass:"dijitCheckBox",type:"checkbox",value:"on",readOnly:false,attributeMap:dojo.delegate(dijit.form._FormWidget.prototype.attributeMap,{readOnly:"focusNode"}),_setReadOnlyAttr:function(_25e){this._set("readOnly",_25e);dojo.attr(this.focusNode,"readOnly",_25e);dijit.setWaiState(this.focusNode,"readonly",_25e);},_setValueAttr:function(_25f,_260){if(typeof _25f=="string"){this._set("value",_25f);dojo.attr(this.focusNode,"value",_25f);_25f=true;}if(this._created){this.set("checked",_25f,_260);}},_getValueAttr:function(){return (this.checked?this.value:false);},_setLabelAttr:undefined,postMixInProperties:function(){if(this.value==""){this.value="on";}this.checkedAttrSetting=this.checked?"checked":"";this.inherited(arguments);},_fillContent:function(_261){},reset:function(){this._hasBeenBlurred=false;this.set("checked",this.params.checked||false);this._set("value",this.params.value||"on");dojo.attr(this.focusNode,"value",this.value);},_onFocus:function(){if(this.id){dojo.query("label[for='"+this.id+"']").addClass("dijitFocusedLabel");}this.inherited(arguments);},_onBlur:function(){if(this.id){dojo.query("label[for='"+this.id+"']").removeClass("dijitFocusedLabel");}this.inherited(arguments);},_onClick:function(e){if(this.readOnly){dojo.stopEvent(e);return false;}return this.inherited(arguments);}});dojo.declare("dijit.form.RadioButton",dijit.form.CheckBox,{type:"radio",baseClass:"dijitRadio",_setCheckedAttr:function(_262){this.inherited(arguments);if(!this._created){return;}if(_262){var _263=this;dojo.query("INPUT[type=radio]",this.focusNode.form||dojo.doc).forEach(function(_264){if(_264.name==_263.name&&_264!=_263.focusNode&&_264.form==_263.focusNode.form){var _265=dijit.getEnclosingWidget(_264);if(_265&&_265.checked){_265.set("checked",false);}}});}},_clicked:function(e){if(!this.checked){this.set("checked",true);}}});}if(!dojo._hasResource["dijit.form.TextBox"]){dojo._hasResource["dijit.form.TextBox"]=true;dojo.provide("dijit.form.TextBox");dojo.declare("dijit.form.TextBox",dijit.form._FormValueWidget,{trim:false,uppercase:false,lowercase:false,propercase:false,maxLength:"",selectOnClick:false,placeHolder:"",templateString:dojo.cache("dijit.form","templates/TextBox.html","<div class=\"dijit dijitReset dijitInline dijitLeft\" id=\"widget_${id}\" role=\"presentation\"\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class=\"dijitReset dijitInputInner\" dojoAttachPoint='textbox,focusNode' autocomplete=\"off\"\n\t\t\t${!nameAttrSetting} type='${type}'\n\t/></div\n></div>\n"),_singleNodeTemplate:"<input class=\"dijit dijitReset dijitLeft dijitInputField\" dojoAttachPoint=\"textbox,focusNode\" autocomplete=\"off\" type=\"${type}\" ${!nameAttrSetting} />",_buttonInputDisabled:dojo.isIE?"disabled":"",baseClass:"dijitTextBox",attributeMap:dojo.delegate(dijit.form._FormValueWidget.prototype.attributeMap,{maxLength:"focusNode"}),postMixInProperties:function(){var type=this.type.toLowerCase();if(this.templateString&&this.templateString.toLowerCase()=="input"||((type=="hidden"||type=="file")&&this.templateString==dijit.form.TextBox.prototype.templateString)){this.templateString=this._singleNodeTemplate;}this.inherited(arguments);},_setPlaceHolderAttr:function(v){this._set("placeHolder",v);if(!this._phspan){this._attachPoints.push("_phspan");this._phspan=dojo.create("span",{className:"dijitPlaceHolder dijitInputField"},this.textbox,"after");}this._phspan.innerHTML="";this._phspan.appendChild(document.createTextNode(v));this._updatePlaceHolder();},_updatePlaceHolder:function(){if(this._phspan){this._phspan.style.display=(this.placeHolder&&!this._focused&&!this.textbox.value)?"":"none";}},_getValueAttr:function(){return this.parse(this.get("displayedValue"),this.constraints);},_setValueAttr:function(_266,_267,_268){var _269;if(_266!==undefined){_269=this.filter(_266);if(typeof _268!="string"){if(_269!==null&&((typeof _269!="number")||!isNaN(_269))){_268=this.filter(this.format(_269,this.constraints));}else{_268="";}}}if(_268!=null&&_268!=undefined&&((typeof _268)!="number"||!isNaN(_268))&&this.textbox.value!=_268){this.textbox.value=_268;this._set("displayedValue",this.get("displayedValue"));}this._updatePlaceHolder();this.inherited(arguments,[_269,_267]);},displayedValue:"",getDisplayedValue:function(){dojo.deprecated(this.declaredClass+"::getDisplayedValue() is deprecated. Use set('displayedValue') instead.","","2.0");return this.get("displayedValue");},_getDisplayedValueAttr:function(){return this.filter(this.textbox.value);},setDisplayedValue:function(_26a){dojo.deprecated(this.declaredClass+"::setDisplayedValue() is deprecated. Use set('displayedValue', ...) instead.","","2.0");this.set("displayedValue",_26a);},_setDisplayedValueAttr:function(_26b){if(_26b===null||_26b===undefined){_26b="";}else{if(typeof _26b!="string"){_26b=String(_26b);}}this.textbox.value=_26b;this._setValueAttr(this.get("value"),undefined);this._set("displayedValue",this.get("displayedValue"));},format:function(_26c,_26d){return ((_26c==null||_26c==undefined)?"":(_26c.toString?_26c.toString():_26c));},parse:function(_26e,_26f){return _26e;},_refreshState:function(){},_onInput:function(e){if(e&&e.type&&/key/i.test(e.type)&&e.keyCode){switch(e.keyCode){case dojo.keys.SHIFT:case dojo.keys.ALT:case dojo.keys.CTRL:case dojo.keys.TAB:return;}}if(this.intermediateChanges){var _270=this;setTimeout(function(){_270._handleOnChange(_270.get("value"),false);},0);}this._refreshState();this._set("displayedValue",this.get("displayedValue"));},postCreate:function(){if(dojo.isIE){setTimeout(dojo.hitch(this,function(){var s=dojo.getComputedStyle(this.domNode);if(s){var ff=s.fontFamily;if(ff){var _271=this.domNode.getElementsByTagName("INPUT");if(_271){for(var i=0;i<_271.length;i++){_271[i].style.fontFamily=ff;}}}}}),0);}this.textbox.setAttribute("value",this.textbox.value);this.inherited(arguments);if(dojo.isMoz||dojo.isOpera){this.connect(this.textbox,"oninput","_onInput");}else{this.connect(this.textbox,"onkeydown","_onInput");this.connect(this.textbox,"onkeyup","_onInput");this.connect(this.textbox,"onpaste","_onInput");this.connect(this.textbox,"oncut","_onInput");}},_blankValue:"",filter:function(val){if(val===null){return this._blankValue;}if(typeof val!="string"){return val;}if(this.trim){val=dojo.trim(val);}if(this.uppercase){val=val.toUpperCase();}if(this.lowercase){val=val.toLowerCase();}if(this.propercase){val=val.replace(/[^\s]+/g,function(word){return word.substring(0,1).toUpperCase()+word.substring(1);});}return val;},_setBlurValue:function(){this._setValueAttr(this.get("value"),true);},_onBlur:function(e){if(this.disabled){return;}this._setBlurValue();this.inherited(arguments);if(this._selectOnClickHandle){this.disconnect(this._selectOnClickHandle);}if(this.selectOnClick&&dojo.isMoz){this.textbox.selectionStart=this.textbox.selectionEnd=undefined;}this._updatePlaceHolder();},_onFocus:function(by){if(this.disabled||this.readOnly){return;}if(this.selectOnClick&&by=="mouse"){this._selectOnClickHandle=this.connect(this.domNode,"onmouseup",function(){this.disconnect(this._selectOnClickHandle);var _272;if(dojo.isIE){var _273=dojo.doc.selection.createRange();var _274=_273.parentElement();_272=_274==this.textbox&&_273.text.length==0;}else{_272=this.textbox.selectionStart==this.textbox.selectionEnd;}if(_272){dijit.selectInputText(this.textbox);}});}this._updatePlaceHolder();this.inherited(arguments);this._refreshState();},reset:function(){this.textbox.value="";this.inherited(arguments);}});dijit.selectInputText=function(_275,_276,stop){var _277=dojo.global;var _278=dojo.doc;_275=dojo.byId(_275);if(isNaN(_276)){_276=0;}if(isNaN(stop)){stop=_275.value?_275.value.length:0;}dijit.focus(_275);if(_278["selection"]&&dojo.body()["createTextRange"]){if(_275.createTextRange){var r=_275.createTextRange();r.collapse(true);r.moveStart("character",-99999);r.moveStart("character",_276);r.moveEnd("character",stop-_276);r.select();}}else{if(_277["getSelection"]){if(_275.setSelectionRange){_275.setSelectionRange(_276,stop);}}}};}if(!dojo._hasResource["dijit.form.SimpleTextarea"]){dojo._hasResource["dijit.form.SimpleTextarea"]=true;dojo.provide("dijit.form.SimpleTextarea");dojo.declare("dijit.form.SimpleTextarea",dijit.form.TextBox,{baseClass:"dijitTextBox dijitTextArea",attributeMap:dojo.delegate(dijit.form._FormValueWidget.prototype.attributeMap,{rows:"textbox",cols:"textbox"}),rows:"3",cols:"20",templateString:"<textarea ${!nameAttrSetting} dojoAttachPoint='focusNode,containerNode,textbox' autocomplete='off'></textarea>",postMixInProperties:function(){if(!this.value&&this.srcNodeRef){this.value=this.srcNodeRef.value;}this.inherited(arguments);},buildRendering:function(){this.inherited(arguments);if(dojo.isIE&&this.cols){dojo.addClass(this.textbox,"dijitTextAreaCols");}},filter:function(_279){if(_279){_279=_279.replace(/\r/g,"");}return this.inherited(arguments);},_previousValue:"",_onInput:function(e){if(this.maxLength){var _27a=parseInt(this.maxLength);var _27b=this.textbox.value.replace(/\r/g,"");var _27c=_27b.length-_27a;if(_27c>0){if(e){dojo.stopEvent(e);}var _27d=this.textbox;if(_27d.selectionStart){var pos=_27d.selectionStart;var cr=0;if(dojo.isOpera){cr=(this.textbox.value.substring(0,pos).match(/\r/g)||[]).length;}this.textbox.value=_27b.substring(0,pos-_27c-cr)+_27b.substring(pos-cr);_27d.setSelectionRange(pos-_27c,pos-_27c);}else{if(dojo.doc.selection){_27d.focus();var _27e=dojo.doc.selection.createRange();_27e.moveStart("character",-_27c);_27e.text="";_27e.select();}}}this._previousValue=this.textbox.value;}this.inherited(arguments);}});}if(!dojo._hasResource["dijit.form.Textarea"]){dojo._hasResource["dijit.form.Textarea"]=true;dojo.provide("dijit.form.Textarea");dojo.declare("dijit.form.Textarea",dijit.form.SimpleTextarea,{baseClass:"dijitTextBox dijitTextArea dijitExpandingTextArea",cols:"",_previousNewlines:0,_strictMode:(dojo.doc.compatMode!="BackCompat"),_getHeight:function(_27f){var newH=_27f.scrollHeight;if(dojo.isIE){newH+=_27f.offsetHeight-_27f.clientHeight-((dojo.isIE<8&&this._strictMode)?dojo._getPadBorderExtents(_27f).h:0);}else{if(dojo.isMoz){newH+=_27f.offsetHeight-_27f.clientHeight;}else{if(dojo.isWebKit){newH+=dojo._getBorderExtents(_27f).h;}else{newH+=dojo._getPadBorderExtents(_27f).h;}}}return newH;},_estimateHeight:function(_280){_280.style.maxHeight="";_280.style.height="auto";_280.rows=(_280.value.match(/\n/g)||[]).length+1;},_needsHelpShrinking:dojo.isMoz||dojo.isWebKit,_onInput:function(){this.inherited(arguments);if(this._busyResizing){return;}this._busyResizing=true;var _281=this.textbox;if(_281.scrollHeight&&_281.offsetHeight&&_281.clientHeight){var newH=this._getHeight(_281)+"px";if(_281.style.height!=newH){_281.style.maxHeight=_281.style.height=newH;}if(this._needsHelpShrinking){if(this._setTimeoutHandle){clearTimeout(this._setTimeoutHandle);}this._setTimeoutHandle=setTimeout(dojo.hitch(this,"_shrink"),0);}}else{this._estimateHeight(_281);}this._busyResizing=false;},_busyResizing:false,_shrink:function(){this._setTimeoutHandle=null;if(this._needsHelpShrinking&&!this._busyResizing){this._busyResizing=true;var _282=this.textbox;var _283=false;if(_282.value==""){_282.value=" ";_283=true;}var _284=_282.scrollHeight;if(!_284){this._estimateHeight(_282);}else{var _285=_282.style.paddingBottom;var _286=dojo._getPadExtents(_282);_286=_286.h-_286.t;_282.style.paddingBottom=_286+1+"px";var newH=this._getHeight(_282)-1+"px";if(_282.style.maxHeight!=newH){_282.style.paddingBottom=_286+_284+"px";_282.scrollTop=0;_282.style.maxHeight=this._getHeight(_282)-_284+"px";}_282.style.paddingBottom=_285;}if(_283){_282.value="";}this._busyResizing=false;}},resize:function(){this._onInput();},_setValueAttr:function(){this.inherited(arguments);this.resize();},buildRendering:function(){this.inherited(arguments);dojo.style(this.textbox,{overflowY:"hidden",overflowX:"auto",boxSizing:"border-box",MsBoxSizing:"border-box",WebkitBoxSizing:"border-box",MozBoxSizing:"border-box"});},postCreate:function(){this.inherited(arguments);this.connect(this.textbox,"onscroll","_onInput");this.connect(this.textbox,"onresize","_onInput");this.connect(this.textbox,"onfocus","_onInput");this._setTimeoutHandle=setTimeout(dojo.hitch(this,"resize"),0);},uninitialize:function(){if(this._setTimeoutHandle){clearTimeout(this._setTimeoutHandle);}this.inherited(arguments);}});}if(!dojo._hasResource["dojo.dnd.common"]){dojo._hasResource["dojo.dnd.common"]=true;dojo.provide("dojo.dnd.common");dojo.getObject("dnd",true,dojo);dojo.dnd.getCopyKeyState=dojo.isCopyKey;dojo.dnd._uniqueId=0;dojo.dnd.getUniqueId=function(){var id;do{id=dojo._scopeName+"Unique"+(++dojo.dnd._uniqueId);}while(dojo.byId(id));return id;};dojo.dnd._empty={};dojo.dnd.isFormElement=function(e){var t=e.target;if(t.nodeType==3){t=t.parentNode;}return " button textarea input select option ".indexOf(" "+t.tagName.toLowerCase()+" ")>=0;};}if(!dojo._hasResource["dojo.dnd.Container"]){dojo._hasResource["dojo.dnd.Container"]=true;dojo.provide("dojo.dnd.Container");dojo.declare("dojo.dnd.Container",null,{skipForm:false,constructor:function(node,_287){this.node=dojo.byId(node);if(!_287){_287={};}this.creator=_287.creator||null;this.skipForm=_287.skipForm;this.parent=_287.dropParent&&dojo.byId(_287.dropParent);this.map={};this.current=null;this.containerState="";dojo.addClass(this.node,"dojoDndContainer");if(!(_287&&_287._skipStartup)){this.startup();}this.events=[dojo.connect(this.node,"onmouseover",this,"onMouseOver"),dojo.connect(this.node,"onmouseout",this,"onMouseOut"),dojo.connect(this.node,"ondragstart",this,"onSelectStart"),dojo.connect(this.node,"onselectstart",this,"onSelectStart")];},creator:function(){},getItem:function(key){return this.map[key];},setItem:function(key,data){this.map[key]=data;},delItem:function(key){delete this.map[key];},forInItems:function(f,o){o=o||dojo.global;var m=this.map,e=dojo.dnd._empty;for(var i in m){if(i in e){continue;}f.call(o,m[i],i,this);}return o;},clearItems:function(){this.map={};},getAllNodes:function(){return dojo.query("> .dojoDndItem",this.parent);},sync:function(){var map={};this.getAllNodes().forEach(function(node){if(node.id){var item=this.getItem(node.id);if(item){map[node.id]=item;return;}}else{node.id=dojo.dnd.getUniqueId();}var type=node.getAttribute("dndType"),data=node.getAttribute("dndData");map[node.id]={data:data||node.innerHTML,type:type?type.split(/\s*,\s*/):["text"]};},this);this.map=map;return this;},insertNodes:function(data,_288,_289){if(!this.parent.firstChild){_289=null;}else{if(_288){if(!_289){_289=this.parent.firstChild;}}else{if(_289){_289=_289.nextSibling;}}}if(_289){for(var i=0;i<data.length;++i){var t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});this.parent.insertBefore(t.node,_289);}}else{for(var i=0;i<data.length;++i){var t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});this.parent.appendChild(t.node);}}return this;},destroy:function(){dojo.forEach(this.events,dojo.disconnect);this.clearItems();this.node=this.parent=this.current=null;},markupFactory:function(_28a,node){_28a._skipStartup=true;return new dojo.dnd.Container(node,_28a);},startup:function(){if(!this.parent){this.parent=this.node;if(this.parent.tagName.toLowerCase()=="table"){var c=this.parent.getElementsByTagName("tbody");if(c&&c.length){this.parent=c[0];}}}this.defaultCreator=dojo.dnd._defaultCreator(this.parent);this.sync();},onMouseOver:function(e){var n=e.relatedTarget;while(n){if(n==this.node){break;}try{n=n.parentNode;}catch(x){n=null;}}if(!n){this._changeState("Container","Over");this.onOverEvent();}n=this._getChildByEvent(e);if(this.current==n){return;}if(this.current){this._removeItemClass(this.current,"Over");}if(n){this._addItemClass(n,"Over");}this.current=n;},onMouseOut:function(e){for(var n=e.relatedTarget;n;){if(n==this.node){return;}try{n=n.parentNode;}catch(x){n=null;}}if(this.current){this._removeItemClass(this.current,"Over");this.current=null;}this._changeState("Container","");this.onOutEvent();},onSelectStart:function(e){if(!this.skipForm||!dojo.dnd.isFormElement(e)){dojo.stopEvent(e);}},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(type,_28b){var _28c="dojoDnd"+type;var _28d=type.toLowerCase()+"State";dojo.replaceClass(this.node,_28c+_28b,_28c+this[_28d]);this[_28d]=_28b;},_addItemClass:function(node,type){dojo.addClass(node,"dojoDndItem"+type);},_removeItemClass:function(node,type){dojo.removeClass(node,"dojoDndItem"+type);},_getChildByEvent:function(e){var node=e.target;if(node){for(var _28e=node.parentNode;_28e;node=_28e,_28e=node.parentNode){if(_28e==this.parent&&dojo.hasClass(node,"dojoDndItem")){return node;}}}return null;},_normalizedCreator:function(item,hint){var t=(this.creator||this.defaultCreator).call(this,item,hint);if(!dojo.isArray(t.type)){t.type=["text"];}if(!t.node.id){t.node.id=dojo.dnd.getUniqueId();}dojo.addClass(t.node,"dojoDndItem");return t;}});dojo.dnd._createNode=function(tag){if(!tag){return dojo.dnd._createSpan;}return function(text){return dojo.create(tag,{innerHTML:text});};};dojo.dnd._createTrTd=function(text){var tr=dojo.create("tr");dojo.create("td",{innerHTML:text},tr);return tr;};dojo.dnd._createSpan=function(text){return dojo.create("span",{innerHTML:text});};dojo.dnd._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"};dojo.dnd._defaultCreator=function(node){var tag=node.tagName.toLowerCase();var c=tag=="tbody"||tag=="thead"?dojo.dnd._createTrTd:dojo.dnd._createNode(dojo.dnd._defaultCreatorNodes[tag]);return function(item,hint){var _28f=item&&dojo.isObject(item),data,type,n;if(_28f&&item.tagName&&item.nodeType&&item.getAttribute){data=item.getAttribute("dndData")||item.innerHTML;type=item.getAttribute("dndType");type=type?type.split(/\s*,\s*/):["text"];n=item;}else{data=(_28f&&item.data)?item.data:item;type=(_28f&&item.type)?item.type:["text"];n=(hint=="avatar"?dojo.dnd._createSpan:c)(String(data));}if(!n.id){n.id=dojo.dnd.getUniqueId();}return {node:n,data:data,type:type};};};}if(!dojo._hasResource["dojo.dnd.Selector"]){dojo._hasResource["dojo.dnd.Selector"]=true;dojo.provide("dojo.dnd.Selector");dojo.declare("dojo.dnd.Selector",dojo.dnd.Container,{constructor:function(node,_290){if(!_290){_290={};}this.singular=_290.singular;this.autoSync=_290.autoSync;this.selection={};this.anchor=null;this.simpleSelection=false;this.events.push(dojo.connect(this.node,"onmousedown",this,"onMouseDown"),dojo.connect(this.node,"onmouseup",this,"onMouseUp"));},singular:false,getSelectedNodes:function(){var t=new dojo.NodeList();var e=dojo.dnd._empty;for(var i in this.selection){if(i in e){continue;}t.push(dojo.byId(i));}return t;},selectNone:function(){return this._removeSelection()._removeAnchor();},selectAll:function(){this.forInItems(function(data,id){this._addItemClass(dojo.byId(id),"Selected");this.selection[id]=1;},this);return this._removeAnchor();},deleteSelectedNodes:function(){var e=dojo.dnd._empty;for(var i in this.selection){if(i in e){continue;}var n=dojo.byId(i);this.delItem(i);dojo.destroy(n);}this.anchor=null;this.selection={};return this;},forInSelectedItems:function(f,o){o=o||dojo.global;var s=this.selection,e=dojo.dnd._empty;for(var i in s){if(i in e){continue;}f.call(o,this.getItem(i),i,this);}},sync:function(){dojo.dnd.Selector.superclass.sync.call(this);if(this.anchor){if(!this.getItem(this.anchor.id)){this.anchor=null;}}var t=[],e=dojo.dnd._empty;for(var i in this.selection){if(i in e){continue;}if(!this.getItem(i)){t.push(i);}}dojo.forEach(t,function(i){delete this.selection[i];},this);return this;},insertNodes:function(_291,data,_292,_293){var _294=this._normalizedCreator;this._normalizedCreator=function(item,hint){var t=_294.call(this,item,hint);if(_291){if(!this.anchor){this.anchor=t.node;this._removeItemClass(t.node,"Selected");this._addItemClass(this.anchor,"Anchor");}else{if(this.anchor!=t.node){this._removeItemClass(t.node,"Anchor");this._addItemClass(t.node,"Selected");}}this.selection[t.node.id]=1;}else{this._removeItemClass(t.node,"Selected");this._removeItemClass(t.node,"Anchor");}return t;};dojo.dnd.Selector.superclass.insertNodes.call(this,data,_292,_293);this._normalizedCreator=_294;return this;},destroy:function(){dojo.dnd.Selector.superclass.destroy.call(this);this.selection=this.anchor=null;},markupFactory:function(_295,node){_295._skipStartup=true;return new dojo.dnd.Selector(node,_295);},onMouseDown:function(e){if(this.autoSync){this.sync();}if(!this.current){return;}if(!this.singular&&!dojo.isCopyKey(e)&&!e.shiftKey&&(this.current.id in this.selection)){this.simpleSelection=true;if(e.button===dojo.mouseButtons.LEFT){dojo.stopEvent(e);}return;}if(!this.singular&&e.shiftKey){if(!dojo.isCopyKey(e)){this._removeSelection();}var c=this.getAllNodes();if(c.length){if(!this.anchor){this.anchor=c[0];this._addItemClass(this.anchor,"Anchor");}this.selection[this.anchor.id]=1;if(this.anchor!=this.current){var i=0;for(;i<c.length;++i){var node=c[i];if(node==this.anchor||node==this.current){break;}}for(++i;i<c.length;++i){var node=c[i];if(node==this.anchor||node==this.current){break;}this._addItemClass(node,"Selected");this.selection[node.id]=1;}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1;}}}else{if(this.singular){if(this.anchor==this.current){if(dojo.isCopyKey(e)){this.selectNone();}}else{this.selectNone();this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}}else{if(dojo.isCopyKey(e)){if(this.anchor==this.current){delete this.selection[this.anchor.id];this._removeAnchor();}else{if(this.current.id in this.selection){this._removeItemClass(this.current,"Selected");delete this.selection[this.current.id];}else{if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this._addItemClass(this.anchor,"Selected");}this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}else{if(!(this.current.id in this.selection)){this.selectNone();this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}}dojo.stopEvent(e);},onMouseUp:function(e){if(!this.simpleSelection){return;}this.simpleSelection=false;this.selectNone();if(this.current){this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}},onMouseMove:function(e){this.simpleSelection=false;},onOverEvent:function(){this.onmousemoveEvent=dojo.connect(this.node,"onmousemove",this,"onMouseMove");},onOutEvent:function(){dojo.disconnect(this.onmousemoveEvent);delete this.onmousemoveEvent;},_removeSelection:function(){console.log("dojo.dnd.Selector._removeSelection    this.selection:");console.dir({this_selection:this.selection});var e=dojo.dnd._empty;for(var i in this.selection){if(i in e){continue;}var node=dojo.byId(i);if(node){this._removeItemClass(node,"Selected");}}this.selection={};return this;},_removeAnchor:function(){if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this.anchor=null;}return this;}});}if(!dojo._hasResource["dojo.dnd.autoscroll"]){dojo._hasResource["dojo.dnd.autoscroll"]=true;dojo.provide("dojo.dnd.autoscroll");dojo.getObject("dnd",true,dojo);dojo.dnd.getViewport=dojo.window.getBox;dojo.dnd.V_TRIGGER_AUTOSCROLL=32;dojo.dnd.H_TRIGGER_AUTOSCROLL=32;dojo.dnd.V_AUTOSCROLL_VALUE=16;dojo.dnd.H_AUTOSCROLL_VALUE=16;dojo.dnd.autoScroll=function(e){var v=dojo.window.getBox(),dx=0,dy=0;if(e.clientX<dojo.dnd.H_TRIGGER_AUTOSCROLL){dx=-dojo.dnd.H_AUTOSCROLL_VALUE;}else{if(e.clientX>v.w-dojo.dnd.H_TRIGGER_AUTOSCROLL){dx=dojo.dnd.H_AUTOSCROLL_VALUE;}}if(e.clientY<dojo.dnd.V_TRIGGER_AUTOSCROLL){dy=-dojo.dnd.V_AUTOSCROLL_VALUE;}else{if(e.clientY>v.h-dojo.dnd.V_TRIGGER_AUTOSCROLL){dy=dojo.dnd.V_AUTOSCROLL_VALUE;}}window.scrollBy(dx,dy);};dojo.dnd._validNodes={"div":1,"p":1,"td":1};dojo.dnd._validOverflow={"auto":1,"scroll":1};dojo.dnd.autoScrollNodes=function(e){for(var n=e.target;n;){if(n.nodeType==1&&(n.tagName.toLowerCase() in dojo.dnd._validNodes)){var s=dojo.getComputedStyle(n);if(s.overflow.toLowerCase() in dojo.dnd._validOverflow){var b=dojo._getContentBox(n,s),t=dojo.position(n,true);var w=Math.min(dojo.dnd.H_TRIGGER_AUTOSCROLL,b.w/2),h=Math.min(dojo.dnd.V_TRIGGER_AUTOSCROLL,b.h/2),rx=e.pageX-t.x,ry=e.pageY-t.y,dx=0,dy=0;if(dojo.isWebKit||dojo.isOpera){rx+=dojo.body().scrollLeft;ry+=dojo.body().scrollTop;}if(rx>0&&rx<b.w){if(rx<w){dx=-w;}else{if(rx>b.w-w){dx=w;}}}if(ry>0&&ry<b.h){if(ry<h){dy=-h;}else{if(ry>b.h-h){dy=h;}}}var _296=n.scrollLeft,_297=n.scrollTop;n.scrollLeft=n.scrollLeft+dx;n.scrollTop=n.scrollTop+dy;if(_296!=n.scrollLeft||_297!=n.scrollTop){return;}}}try{n=n.parentNode;}catch(x){n=null;}}dojo.dnd.autoScroll(e);};}if(!dojo._hasResource["dojo.dnd.Avatar"]){dojo._hasResource["dojo.dnd.Avatar"]=true;dojo.provide("dojo.dnd.Avatar");dojo.declare("dojo.dnd.Avatar",null,{constructor:function(_298){this.manager=_298;this.construct();},construct:function(){this.isA11y=dojo.hasClass(dojo.body(),"dijit_a11y");var a=dojo.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",margin:"0px"}}),_299=this.manager.source,node,b=dojo.create("tbody",null,a),tr=dojo.create("tr",null,b),td=dojo.create("td",null,tr),icon=this.isA11y?dojo.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"<"},td):null,span=dojo.create("span",{innerHTML:_299.generateText?this._generateText():""},td),k=Math.min(5,this.manager.nodes.length),i=0;dojo.attr(tr,{"class":"dojoDndAvatarHeader",style:{opacity:0.9}});for(;i<k;++i){if(_299.creator){node=_299._normalizedCreator(_299.getItem(this.manager.nodes[i].id).data,"avatar").node;}else{node=this.manager.nodes[i].cloneNode(true);if(node.tagName.toLowerCase()=="tr"){var _29a=dojo.create("table"),_29b=dojo.create("tbody",null,_29a);_29b.appendChild(node);node=_29a;}}node.id="";tr=dojo.create("tr",null,b);td=dojo.create("td",null,tr);td.appendChild(node);dojo.attr(tr,{"class":"dojoDndAvatarItem",style:{opacity:(9-i)/10}});}this.node=a;},destroy:function(){dojo.destroy(this.node);this.node=false;},update:function(){dojo[(this.manager.canDropFlag?"add":"remove")+"Class"](this.node,"dojoDndAvatarCanDrop");if(this.isA11y){var icon=dojo.byId("a11yIcon");var text="+";if(this.manager.canDropFlag&&!this.manager.copy){text="< ";}else{if(!this.manager.canDropFlag&&!this.manager.copy){text="o";}else{if(!this.manager.canDropFlag){text="x";}}}icon.innerHTML=text;}dojo.query(("tr.dojoDndAvatarHeader td span"+(this.isA11y?" span":"")),this.node).forEach(function(node){node.innerHTML=this._generateText();},this);},_generateText:function(){return this.manager.nodes.length.toString();}});}if(!dojo._hasResource["dojo.dnd.Manager"]){dojo._hasResource["dojo.dnd.Manager"]=true;dojo.provide("dojo.dnd.Manager");dojo.declare("dojo.dnd.Manager",null,{constructor:function(){this.avatar=null;this.source=null;this.nodes=[];this.copy=true;this.target=null;this.canDropFlag=false;this.events=[];},OFFSET_X:16,OFFSET_Y:16,overSource:function(_29c){if(this.avatar){this.target=(_29c&&_29c.targetState!="Disabled")?_29c:null;this.canDropFlag=Boolean(this.target);this.avatar.update();}dojo.publish("/dnd/source/over",[_29c]);},outSource:function(_29d){if(this.avatar){if(this.target==_29d){this.target=null;this.canDropFlag=false;this.avatar.update();dojo.publish("/dnd/source/over",[null]);}}else{dojo.publish("/dnd/source/over",[null]);}},startDrag:function(_29e,_29f,copy){this.source=_29e;this.nodes=_29f;this.copy=Boolean(copy);this.avatar=this.makeAvatar();dojo.body().appendChild(this.avatar.node);dojo.publish("/dnd/start",[_29e,_29f,this.copy]);this.events=[dojo.connect(dojo.doc,"onmousemove",this,"onMouseMove"),dojo.connect(dojo.doc,"onmouseup",this,"onMouseUp"),dojo.connect(dojo.doc,"onkeydown",this,"onKeyDown"),dojo.connect(dojo.doc,"onkeyup",this,"onKeyUp"),dojo.connect(dojo.doc,"ondragstart",dojo.stopEvent),dojo.connect(dojo.body(),"onselectstart",dojo.stopEvent)];var c="dojoDnd"+(copy?"Copy":"Move");dojo.addClass(dojo.body(),c);},canDrop:function(flag){var _2a0=Boolean(this.target&&flag);if(this.canDropFlag!=_2a0){this.canDropFlag=_2a0;this.avatar.update();}},stopDrag:function(){dojo.removeClass(dojo.body(),["dojoDndCopy","dojoDndMove"]);dojo.forEach(this.events,dojo.disconnect);this.events=[];this.avatar.destroy();this.avatar=null;this.source=this.target=null;this.nodes=[];},makeAvatar:function(){return new dojo.dnd.Avatar(this);},updateAvatar:function(){this.avatar.update();},onMouseMove:function(e){var a=this.avatar;if(a){dojo.dnd.autoScrollNodes(e);var s=a.node.style;s.left=(e.pageX+this.OFFSET_X)+"px";s.top=(e.pageY+this.OFFSET_Y)+"px";var copy=Boolean(this.source.copyState(dojo.isCopyKey(e)));if(this.copy!=copy){this._setCopyStatus(copy);}}},onMouseUp:function(e){if(this.avatar){if(this.target&&this.canDropFlag){var copy=Boolean(this.source.copyState(dojo.isCopyKey(e))),_2a1=[this.source,this.nodes,copy,this.target,e];dojo.publish("/dnd/drop/before",_2a1);dojo.publish("/dnd/drop",_2a1);}else{dojo.publish("/dnd/cancel");}this.stopDrag();}},onKeyDown:function(e){if(this.avatar){switch(e.keyCode){case dojo.keys.CTRL:var copy=Boolean(this.source.copyState(true));if(this.copy!=copy){this._setCopyStatus(copy);}break;case dojo.keys.ESCAPE:dojo.publish("/dnd/cancel");this.stopDrag();break;}}},onKeyUp:function(e){if(this.avatar&&e.keyCode==dojo.keys.CTRL){var copy=Boolean(this.source.copyState(false));if(this.copy!=copy){this._setCopyStatus(copy);}}},_setCopyStatus:function(copy){this.copy=copy;this.source._markDndStatus(this.copy);this.updateAvatar();dojo.replaceClass(dojo.body(),"dojoDnd"+(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?"Move":"Copy"));}});dojo.dnd._manager=null;dojo.dnd.manager=function(){if(!dojo.dnd._manager){dojo.dnd._manager=new dojo.dnd.Manager();}return dojo.dnd._manager;};}if(!dojo._hasResource["dojo.dnd.Source"]){dojo._hasResource["dojo.dnd.Source"]=true;dojo.provide("dojo.dnd.Source");dojo.declare("dojo.dnd.Source",dojo.dnd.Selector,{isSource:true,horizontal:false,copyOnly:false,selfCopy:false,selfAccept:true,skipForm:false,withHandles:false,autoSync:false,delay:0,accept:["text"],generateText:true,constructor:function(node,_2a2){dojo.mixin(this,dojo.mixin({},_2a2));var type=this.accept;if(type.length){this.accept={};for(var i=0;i<type.length;++i){this.accept[type[i]]=1;}}this.isDragging=false;this.mouseDown=false;this.targetAnchor=null;this.targetBox=null;this.before=true;this._lastX=0;this._lastY=0;this.sourceState="";if(this.isSource){dojo.addClass(this.node,"dojoDndSource");}this.targetState="";if(this.accept){dojo.addClass(this.node,"dojoDndTarget");}if(this.horizontal){dojo.addClass(this.node,"dojoDndHorizontal");}this.topics=[dojo.subscribe("/dnd/source/over",this,"onDndSourceOver"),dojo.subscribe("/dnd/start",this,"onDndStart"),dojo.subscribe("/dnd/drop",this,"onDndDrop"),dojo.subscribe("/dnd/cancel",this,"onDndCancel")];},checkAcceptance:function(_2a3,_2a4){if(this==_2a3){return !this.copyOnly||this.selfAccept;}for(var i=0;i<_2a4.length;++i){var type=_2a3.getItem(_2a4[i].id).type;var flag=false;for(var j=0;j<type.length;++j){if(type[j] in this.accept){flag=true;break;}}if(!flag){return false;}}return true;},copyState:function(_2a5,self){if(_2a5){return true;}if(arguments.length<2){self=this==dojo.dnd.manager().target;}if(self){if(this.copyOnly){return this.selfCopy;}}else{return this.copyOnly;}return false;},destroy:function(){dojo.dnd.Source.superclass.destroy.call(this);dojo.forEach(this.topics,dojo.unsubscribe);this.targetAnchor=null;},markupFactory:function(_2a6,node){_2a6._skipStartup=true;return new dojo.dnd.Source(node,_2a6);},onMouseMove:function(e){if(this.isDragging&&this.targetState=="Disabled"){return;}dojo.dnd.Source.superclass.onMouseMove.call(this,e);var m=dojo.dnd.manager();if(!this.isDragging){if(this.mouseDown&&this.isSource&&(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay)){var _2a7=this.getSelectedNodes();if(_2a7.length){m.startDrag(this,_2a7,this.copyState(dojo.isCopyKey(e),true));}}}if(this.isDragging){var _2a8=false;if(this.current){if(!this.targetBox||this.targetAnchor!=this.current){this.targetBox=dojo.position(this.current,true);}if(this.horizontal){_2a8=(e.pageX-this.targetBox.x)<(this.targetBox.w/2);}else{_2a8=(e.pageY-this.targetBox.y)<(this.targetBox.h/2);}}if(this.current!=this.targetAnchor||_2a8!=this.before){this._markTargetAnchor(_2a8);m.canDrop(!this.current||m.source!=this||!(this.current.id in this.selection));}}},onMouseDown:function(e){if(!this.mouseDown&&this._legalMouseDown(e)&&(!this.skipForm||!dojo.dnd.isFormElement(e))){this.mouseDown=true;this._lastX=e.pageX;this._lastY=e.pageY;dojo.dnd.Source.superclass.onMouseDown.call(this,e);}},onMouseUp:function(e){if(this.mouseDown){this.mouseDown=false;dojo.dnd.Source.superclass.onMouseUp.call(this,e);}},onDndSourceOver:function(_2a9){if(this!=_2a9){this.mouseDown=false;if(this.targetAnchor){this._unmarkTargetAnchor();}}else{if(this.isDragging){var m=dojo.dnd.manager();m.canDrop(this.targetState!="Disabled"&&(!this.current||m.source!=this||!(this.current.id in this.selection)));}}},onDndStart:function(_2aa,_2ab,copy){if(this.autoSync){this.sync();}if(this.isSource){this._changeState("Source",this==_2aa?(copy?"Copied":"Moved"):"");}var _2ac=this.accept&&this.checkAcceptance(_2aa,_2ab);this._changeState("Target",_2ac?"":"Disabled");if(this==_2aa){dojo.dnd.manager().overSource(this);}this.isDragging=true;},onDndDrop:function(_2ad,_2ae,copy,_2af){if(this==_2af){this.onDrop(_2ad,_2ae,copy);}this.onDndCancel();},onDndCancel:function(){if(this.targetAnchor){this._unmarkTargetAnchor();this.targetAnchor=null;}this.before=true;this.isDragging=false;this.mouseDown=false;this._changeState("Source","");this._changeState("Target","");},onDrop:function(_2b0,_2b1,copy){if(this!=_2b0){this.onDropExternal(_2b0,_2b1,copy);}else{this.onDropInternal(_2b1,copy);}},onDropExternal:function(_2b2,_2b3,copy){console.log("dojo.dnd.Source.onDropExternal    HERE HERE HERE");var _2b4=this._normalizedCreator;if(this.creator){this._normalizedCreator=function(node,hint){return _2b4.call(this,_2b2.getItem(node.id).data,hint);};}else{if(copy){this._normalizedCreator=function(node,hint){var t=_2b2.getItem(node.id);var n=node.cloneNode(true);n.id=dojo.dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}else{this._normalizedCreator=function(node,hint){var t=_2b2.getItem(node.id);_2b2.delItem(node.id);return {node:node,data:t.data,type:t.type};};}}this.selectNone();if(!copy&&!this.creator){_2b2.selectNone();}this.insertNodes(true,_2b3,this.before,this.current);if(!copy&&this.creator){_2b2.deleteSelectedNodes();}this._normalizedCreator=_2b4;},onDropInternal:function(_2b5,copy){var _2b6=this._normalizedCreator;if(this.current&&this.current.id in this.selection){return;}if(copy){if(this.creator){this._normalizedCreator=function(node,hint){return _2b6.call(this,this.getItem(node.id).data,hint);};}else{this._normalizedCreator=function(node,hint){var t=this.getItem(node.id);var n=node.cloneNode(true);n.id=dojo.dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}}else{if(!this.current){return;}this._normalizedCreator=function(node,hint){var t=this.getItem(node.id);return {node:node,data:t.data,type:t.type};};}this._removeSelection();this.insertNodes(true,_2b5,this.before,this.current);this._normalizedCreator=_2b6;},onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){dojo.dnd.Source.superclass.onOverEvent.call(this);dojo.dnd.manager().overSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOver();}},onOutEvent:function(){dojo.dnd.Source.superclass.onOutEvent.call(this);dojo.dnd.manager().outSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOut();}},_markTargetAnchor:function(_2b7){if(this.current==this.targetAnchor&&this.before==_2b7){return;}if(this.targetAnchor){this._removeItemClass(this.targetAnchor,this.before?"Before":"After");}this.targetAnchor=this.current;this.targetBox=null;this.before=_2b7;if(this.targetAnchor){this._addItemClass(this.targetAnchor,this.before?"Before":"After");}},_unmarkTargetAnchor:function(){if(!this.targetAnchor){return;}this._removeItemClass(this.targetAnchor,this.before?"Before":"After");this.targetAnchor=null;this.targetBox=null;this.before=true;},_markDndStatus:function(copy){this._changeState("Source",copy?"Copied":"Moved");},_legalMouseDown:function(e){if(!dojo.mouseButtons.isLeft(e)){return false;}if(!this.withHandles){return true;}for(var node=e.target;node&&node!==this.node;node=node.parentNode){if(dojo.hasClass(node,"dojoDndHandle")){return true;}if(dojo.hasClass(node,"dojoDndItem")||dojo.hasClass(node,"dojoDndIgnore")){break;}}return false;}});dojo.declare("dojo.dnd.Target",dojo.dnd.Source,{constructor:function(node,_2b8){this.isSource=false;dojo.removeClass(this.node,"dojoDndSource");},markupFactory:function(_2b9,node){_2b9._skipStartup=true;return new dojo.dnd.Target(node,_2b9);}});dojo.declare("dojo.dnd.AutoSource",dojo.dnd.Source,{constructor:function(node,_2ba){this.autoSync=true;},markupFactory:function(_2bb,node){_2bb._skipStartup=true;return new dojo.dnd.AutoSource(node,_2bb);}});}if(!dojo._hasResource["dojo.data.util.filter"]){dojo._hasResource["dojo.data.util.filter"]=true;dojo.provide("dojo.data.util.filter");dojo.getObject("data.util.filter",true,dojo);dojo.data.util.filter.patternToRegExp=function(_2bc,_2bd){var rxp="^";var c=null;for(var i=0;i<_2bc.length;i++){c=_2bc.charAt(i);switch(c){case "\\":rxp+=c;i++;rxp+=_2bc.charAt(i);break;case "*":rxp+=".*";break;case "?":rxp+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":rxp+="\\";default:rxp+=c;}}rxp+="$";if(_2bd){return new RegExp(rxp,"mi");}else{return new RegExp(rxp,"m");}};}if(!dojo._hasResource["dojo.data.util.sorter"]){dojo._hasResource["dojo.data.util.sorter"]=true;dojo.provide("dojo.data.util.sorter");dojo.getObject("data.util.sorter",true,dojo);dojo.data.util.sorter.basicComparator=function(a,b){var r=-1;if(a===null){a=undefined;}if(b===null){b=undefined;}if(a==b){r=0;}else{if(a>b||a==null){r=1;}}return r;};dojo.data.util.sorter.createSortFunction=function(_2be,_2bf){var _2c0=[];function _2c1(attr,dir,comp,s){return function(_2c2,_2c3){var a=s.getValue(_2c2,attr);var b=s.getValue(_2c3,attr);return dir*comp(a,b);};};var _2c4;var map=_2bf.comparatorMap;var bc=dojo.data.util.sorter.basicComparator;for(var i=0;i<_2be.length;i++){_2c4=_2be[i];var attr=_2c4.attribute;if(attr){var dir=(_2c4.descending)?-1:1;var comp=bc;if(map){if(typeof attr!=="string"&&("toString" in attr)){attr=attr.toString();}comp=map[attr]||bc;}_2c0.push(_2c1(attr,dir,comp,_2bf));}}return function(rowA,rowB){var i=0;while(i<_2c0.length){var ret=_2c0[i++](rowA,rowB);if(ret!==0){return ret;}}return 0;};};}if(!dojo._hasResource["dojo.data.util.simpleFetch"]){dojo._hasResource["dojo.data.util.simpleFetch"]=true;dojo.provide("dojo.data.util.simpleFetch");dojo.getObject("data.util.simpleFetch",true,dojo);dojo.data.util.simpleFetch.fetch=function(_2c5){_2c5=_2c5||{};if(!_2c5.store){_2c5.store=this;}var self=this;var _2c6=function(_2c7,_2c8){if(_2c8.onError){var _2c9=_2c8.scope||dojo.global;_2c8.onError.call(_2c9,_2c7,_2c8);}};var _2ca=function(_2cb,_2cc){var _2cd=_2cc.abort||null;var _2ce=false;var _2cf=_2cc.start?_2cc.start:0;var _2d0=(_2cc.count&&(_2cc.count!==Infinity))?(_2cf+_2cc.count):_2cb.length;_2cc.abort=function(){_2ce=true;if(_2cd){_2cd.call(_2cc);}};var _2d1=_2cc.scope||dojo.global;if(!_2cc.store){_2cc.store=self;}if(_2cc.onBegin){_2cc.onBegin.call(_2d1,_2cb.length,_2cc);}if(_2cc.sort){_2cb.sort(dojo.data.util.sorter.createSortFunction(_2cc.sort,self));}if(_2cc.onItem){for(var i=_2cf;(i<_2cb.length)&&(i<_2d0);++i){var item=_2cb[i];if(!_2ce){_2cc.onItem.call(_2d1,item,_2cc);}}}if(_2cc.onComplete&&!_2ce){var _2d2=null;if(!_2cc.onItem){_2d2=_2cb.slice(_2cf,_2d0);}_2cc.onComplete.call(_2d1,_2d2,_2cc);}};this._fetchItems(_2c5,_2ca,_2c6);return _2c5;};}if(!dojo._hasResource["dojo.data.ItemFileReadStore"]){dojo._hasResource["dojo.data.ItemFileReadStore"]=true;dojo.provide("dojo.data.ItemFileReadStore");dojo.declare("dojo.data.ItemFileReadStore",null,{constructor:function(_2d3){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._jsonFileUrl=_2d3.url;this._ccUrl=_2d3.url;this.url=_2d3.url;this._jsonData=_2d3.data;this.data=null;this._datatypeMap=_2d3.typeMap||{};if(!this._datatypeMap["Date"]){this._datatypeMap["Date"]={type:Date,deserialize:function(_2d4){return dojo.date.stamp.fromISOString(_2d4);}};}this._features={"dojo.data.api.Read":true,"dojo.data.api.Identity":true};this._itemsByIdentity=null;this._storeRefPropName="_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=false;this._queuedFetches=[];if(_2d3.urlPreventCache!==undefined){this.urlPreventCache=_2d3.urlPreventCache?true:false;}if(_2d3.hierarchical!==undefined){this.hierarchical=_2d3.hierarchical?true:false;}if(_2d3.clearOnClose){this.clearOnClose=true;}if("failOk" in _2d3){this.failOk=_2d3.failOk?true:false;}},url:"",_ccUrl:"",data:null,typeMap:null,clearOnClose:false,urlPreventCache:false,failOk:false,hierarchical:true,_assertIsItem:function(item){if(!this.isItem(item)){throw new Error("dojo.data.ItemFileReadStore: Invalid item argument.");}},_assertIsAttribute:function(_2d5){if(typeof _2d5!=="string"){throw new Error("dojo.data.ItemFileReadStore: Invalid attribute argument.");}},getValue:function(item,_2d6,_2d7){var _2d8=this.getValues(item,_2d6);return (_2d8.length>0)?_2d8[0]:_2d7;},getValues:function(item,_2d9){this._assertIsItem(item);this._assertIsAttribute(_2d9);return (item[_2d9]||[]).slice(0);},getAttributes:function(item){this._assertIsItem(item);var _2da=[];for(var key in item){if((key!==this._storeRefPropName)&&(key!==this._itemNumPropName)&&(key!==this._rootItemPropName)&&(key!==this._reverseRefMap)){_2da.push(key);}}return _2da;},hasAttribute:function(item,_2db){this._assertIsItem(item);this._assertIsAttribute(_2db);return (_2db in item);},containsValue:function(item,_2dc,_2dd){var _2de=undefined;if(typeof _2dd==="string"){_2de=dojo.data.util.filter.patternToRegExp(_2dd,false);}return this._containsValue(item,_2dc,_2dd,_2de);},_containsValue:function(item,_2df,_2e0,_2e1){return dojo.some(this.getValues(item,_2df),function(_2e2){if(_2e2!==null&&!dojo.isObject(_2e2)&&_2e1){if(_2e2.toString().match(_2e1)){return true;}}else{if(_2e0===_2e2){return true;}}});},isItem:function(_2e3){if(_2e3&&_2e3[this._storeRefPropName]===this){if(this._arrayOfAllItems[_2e3[this._itemNumPropName]]===_2e3){return true;}}return false;},isItemLoaded:function(_2e4){return this.isItem(_2e4);},loadItem:function(_2e5){this._assertIsItem(_2e5.item);},getFeatures:function(){return this._features;},getLabel:function(item){if(this._labelAttr&&this.isItem(item)){return this.getValue(item,this._labelAttr);}return undefined;},getLabelAttributes:function(item){if(this._labelAttr){return [this._labelAttr];}return null;},_fetchItems:function(_2e6,_2e7,_2e8){var self=this,_2e9=function(_2ea,_2eb){var _2ec=[],i,key;if(_2ea.query){var _2ed,_2ee=_2ea.queryOptions?_2ea.queryOptions.ignoreCase:false;var _2ef={};for(key in _2ea.query){_2ed=_2ea.query[key];if(typeof _2ed==="string"){_2ef[key]=dojo.data.util.filter.patternToRegExp(_2ed,_2ee);}else{if(_2ed instanceof RegExp){_2ef[key]=_2ed;}}}for(i=0;i<_2eb.length;++i){var _2f0=true;var _2f1=_2eb[i];if(_2f1===null){_2f0=false;}else{for(key in _2ea.query){_2ed=_2ea.query[key];if(!self._containsValue(_2f1,key,_2ed,_2ef[key])){_2f0=false;}}}if(_2f0){_2ec.push(_2f1);}}_2e7(_2ec,_2ea);}else{for(i=0;i<_2eb.length;++i){var item=_2eb[i];if(item!==null){_2ec.push(item);}}_2e7(_2ec,_2ea);}};if(this._loadFinished){_2e9(_2e6,this._getItemsArray(_2e6.queryOptions));}else{if(this._jsonFileUrl!==this._ccUrl){dojo.deprecated("dojo.data.ItemFileReadStore: ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_2e6,filter:_2e9});}else{this._loadInProgress=true;var _2f2={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _2f3=dojo.xhrGet(_2f2);_2f3.addCallback(function(data){try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;_2e9(_2e6,self._getItemsArray(_2e6.queryOptions));self._handleQueuedFetches();}catch(e){self._loadFinished=true;self._loadInProgress=false;_2e8(e,_2e6);}});_2f3.addErrback(function(_2f4){self._loadInProgress=false;_2e8(_2f4,_2e6);});var _2f5=null;if(_2e6.abort){_2f5=_2e6.abort;}_2e6.abort=function(){var df=_2f3;if(df&&df.fired===-1){df.cancel();df=null;}if(_2f5){_2f5.call(_2e6);}};}}else{if(this._jsonData){try{this._loadFinished=true;this._getItemsFromLoadedData(this._jsonData);this._jsonData=null;_2e9(_2e6,this._getItemsArray(_2e6.queryOptions));}catch(e){_2e8(e,_2e6);}}else{_2e8(new Error("dojo.data.ItemFileReadStore: No JSON source data was provided as either URL or a nested Javascript object."),_2e6);}}}},_handleQueuedFetches:function(){if(this._queuedFetches.length>0){for(var i=0;i<this._queuedFetches.length;i++){var _2f6=this._queuedFetches[i],_2f7=_2f6.args,_2f8=_2f6.filter;if(_2f8){_2f8(_2f7,this._getItemsArray(_2f7.queryOptions));}else{this.fetchItemByIdentity(_2f7);}}this._queuedFetches=[];}},_getItemsArray:function(_2f9){if(_2f9&&_2f9.deep){return this._arrayOfAllItems;}return this._arrayOfTopLevelItems;},close:function(_2fa){if(this.clearOnClose&&this._loadFinished&&!this._loadInProgress){if(((this._jsonFileUrl==""||this._jsonFileUrl==null)&&(this.url==""||this.url==null))&&this.data==null){console.debug("dojo.data.ItemFileReadStore: WARNING!  Data reload "+" information has not been provided."+"  Please set 'url' or 'data' to the appropriate value before"+" the next fetch");}this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._itemsByIdentity=null;this._loadInProgress=false;this._queuedFetches=[];}},_getItemsFromLoadedData:function(_2fb){var _2fc=false,self=this;function _2fd(_2fe){var _2ff=((_2fe!==null)&&(typeof _2fe==="object")&&(!dojo.isArray(_2fe)||_2fc)&&(!dojo.isFunction(_2fe))&&(_2fe.constructor==Object||dojo.isArray(_2fe))&&(typeof _2fe._reference==="undefined")&&(typeof _2fe._type==="undefined")&&(typeof _2fe._value==="undefined")&&self.hierarchical);return _2ff;};function _300(_301){self._arrayOfAllItems.push(_301);for(var _302 in _301){var _303=_301[_302];if(_303){if(dojo.isArray(_303)){var _304=_303;for(var k=0;k<_304.length;++k){var _305=_304[k];if(_2fd(_305)){_300(_305);}}}else{if(_2fd(_303)){_300(_303);}}}}};this._labelAttr=_2fb.label;var i,item;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=_2fb.items;for(i=0;i<this._arrayOfTopLevelItems.length;++i){item=this._arrayOfTopLevelItems[i];if(dojo.isArray(item)){_2fc=true;}_300(item);item[this._rootItemPropName]=true;}var _306={},key;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){if(key!==this._rootItemPropName){var _307=item[key];if(_307!==null){if(!dojo.isArray(_307)){item[key]=[_307];}}else{item[key]=[null];}}_306[key]=key;}}while(_306[this._storeRefPropName]){this._storeRefPropName+="_";}while(_306[this._itemNumPropName]){this._itemNumPropName+="_";}while(_306[this._reverseRefMap]){this._reverseRefMap+="_";}var _308;var _309=_2fb.identifier;if(_309){this._itemsByIdentity={};this._features["dojo.data.api.Identity"]=_309;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];_308=item[_309];var _30a=_308[0];if(!Object.hasOwnProperty.call(this._itemsByIdentity,_30a)){this._itemsByIdentity[_30a]=item;}else{if(this._jsonFileUrl){throw new Error("dojo.data.ItemFileReadStore:  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+_309+"].  Value collided: ["+_30a+"]");}else{if(this._jsonData){throw new Error("dojo.data.ItemFileReadStore:  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+_309+"].  Value collided: ["+_30a+"]");}}}}}else{this._features["dojo.data.api.Identity"]=Number;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];item[this._storeRefPropName]=this;item[this._itemNumPropName]=i;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){_308=item[key];for(var j=0;j<_308.length;++j){_307=_308[j];if(_307!==null&&typeof _307=="object"){if(("_type" in _307)&&("_value" in _307)){var type=_307._type;var _30b=this._datatypeMap[type];if(!_30b){throw new Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+type+"'");}else{if(dojo.isFunction(_30b)){_308[j]=new _30b(_307._value);}else{if(dojo.isFunction(_30b.deserialize)){_308[j]=_30b.deserialize(_307._value);}else{throw new Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");}}}}if(_307._reference){var _30c=_307._reference;if(!dojo.isObject(_30c)){_308[j]=this._getItemByIdentity(_30c);}else{for(var k=0;k<this._arrayOfAllItems.length;++k){var _30d=this._arrayOfAllItems[k],_30e=true;for(var _30f in _30c){if(_30d[_30f]!=_30c[_30f]){_30e=false;}}if(_30e){_308[j]=_30d;}}}if(this.referenceIntegrity){var _310=_308[j];if(this.isItem(_310)){this._addReferenceToMap(_310,item,key);}}}else{if(this.isItem(_307)){if(this.referenceIntegrity){this._addReferenceToMap(_307,item,key);}}}}}}}},_addReferenceToMap:function(_311,_312,_313){},getIdentity:function(item){var _314=this._features["dojo.data.api.Identity"];if(_314===Number){return item[this._itemNumPropName];}else{var _315=item[_314];if(_315){return _315[0];}}return null;},fetchItemByIdentity:function(_316){var item,_317;if(!this._loadFinished){var self=this;if(this._jsonFileUrl!==this._ccUrl){dojo.deprecated("dojo.data.ItemFileReadStore: ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null&&this._jsonData==null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_316});}else{this._loadInProgress=true;var _318={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _319=dojo.xhrGet(_318);_319.addCallback(function(data){var _31a=_316.scope?_316.scope:dojo.global;try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;item=self._getItemByIdentity(_316.identity);if(_316.onItem){_316.onItem.call(_31a,item);}self._handleQueuedFetches();}catch(error){self._loadInProgress=false;if(_316.onError){_316.onError.call(_31a,error);}}});_319.addErrback(function(_31b){self._loadInProgress=false;if(_316.onError){var _31c=_316.scope?_316.scope:dojo.global;_316.onError.call(_31c,_31b);}});}}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;item=self._getItemByIdentity(_316.identity);if(_316.onItem){_317=_316.scope?_316.scope:dojo.global;_316.onItem.call(_317,item);}}}}else{item=this._getItemByIdentity(_316.identity);if(_316.onItem){_317=_316.scope?_316.scope:dojo.global;_316.onItem.call(_317,item);}}},_getItemByIdentity:function(_31d){var item=null;if(this._itemsByIdentity&&Object.hasOwnProperty.call(this._itemsByIdentity,_31d)){item=this._itemsByIdentity[_31d];}else{if(Object.hasOwnProperty.call(this._arrayOfAllItems,_31d)){item=this._arrayOfAllItems[_31d];}}if(item===undefined){item=null;}return item;},getIdentityAttributes:function(item){var _31e=this._features["dojo.data.api.Identity"];if(_31e===Number){return null;}else{return [_31e];}},_forceLoad:function(){var self=this;if(this._jsonFileUrl!==this._ccUrl){dojo.deprecated("dojo.data.ItemFileReadStore: ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){var _31f={url:this._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:true};var _320=dojo.xhrGet(_31f);_320.addCallback(function(data){try{if(self._loadInProgress!==true&&!self._loadFinished){self._getItemsFromLoadedData(data);self._loadFinished=true;}else{if(self._loadInProgress){throw new Error("dojo.data.ItemFileReadStore:  Unable to perform a synchronous load, an async load is in progress.");}}}catch(e){console.log(e);throw e;}});_320.addErrback(function(_321){throw _321;});}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;}}}});dojo.extend(dojo.data.ItemFileReadStore,dojo.data.util.simpleFetch);}if(!dojo._hasResource["dojo.data.ItemFileWriteStore"]){dojo._hasResource["dojo.data.ItemFileWriteStore"]=true;dojo.provide("dojo.data.ItemFileWriteStore");dojo.declare("dojo.data.ItemFileWriteStore",dojo.data.ItemFileReadStore,{constructor:function(_322){this._features["dojo.data.api.Write"]=true;this._features["dojo.data.api.Notification"]=true;this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};if(!this._datatypeMap["Date"].serialize){this._datatypeMap["Date"].serialize=function(obj){return dojo.date.stamp.toISOString(obj,{zulu:true});};}if(_322&&(_322.referenceIntegrity===false)){this.referenceIntegrity=false;}this._saveInProgress=false;},referenceIntegrity:true,_assert:function(_323){if(!_323){throw new Error("assertion failed in ItemFileWriteStore");}},_getIdentifierAttribute:function(){var _324=this.getFeatures()["dojo.data.api.Identity"];return _324;},newItem:function(_325,_326){this._assert(!this._saveInProgress);if(!this._loadFinished){this._forceLoad();}if(typeof _325!="object"&&typeof _325!="undefined"){throw new Error("newItem() was passed something other than an object");}var _327=null;var _328=this._getIdentifierAttribute();if(_328===Number){_327=this._arrayOfAllItems.length;}else{_327=_325[_328];if(typeof _327==="undefined"){throw new Error("newItem() was not passed an identity for the new item");}if(dojo.isArray(_327)){throw new Error("newItem() was not passed an single-valued identity");}}if(this._itemsByIdentity){this._assert(typeof this._itemsByIdentity[_327]==="undefined");}this._assert(typeof this._pending._newItems[_327]==="undefined");this._assert(typeof this._pending._deletedItems[_327]==="undefined");var _329={};_329[this._storeRefPropName]=this;_329[this._itemNumPropName]=this._arrayOfAllItems.length;if(this._itemsByIdentity){this._itemsByIdentity[_327]=_329;_329[_328]=[_327];}this._arrayOfAllItems.push(_329);var _32a=null;if(_326&&_326.parent&&_326.attribute){_32a={item:_326.parent,attribute:_326.attribute,oldValue:undefined};var _32b=this.getValues(_326.parent,_326.attribute);if(_32b&&_32b.length>0){var _32c=_32b.slice(0,_32b.length);if(_32b.length===1){_32a.oldValue=_32b[0];}else{_32a.oldValue=_32b.slice(0,_32b.length);}_32c.push(_329);this._setValueOrValues(_326.parent,_326.attribute,_32c,false);_32a.newValue=this.getValues(_326.parent,_326.attribute);}else{this._setValueOrValues(_326.parent,_326.attribute,_329,false);_32a.newValue=_329;}}else{_329[this._rootItemPropName]=true;this._arrayOfTopLevelItems.push(_329);}this._pending._newItems[_327]=_329;for(var key in _325){if(key===this._storeRefPropName||key===this._itemNumPropName){throw new Error("encountered bug in ItemFileWriteStore.newItem");}var _32d=_325[key];if(!dojo.isArray(_32d)){_32d=[_32d];}_329[key]=_32d;if(this.referenceIntegrity){for(var i=0;i<_32d.length;i++){var val=_32d[i];if(this.isItem(val)){this._addReferenceToMap(val,_329,key);}}}}this.onNew(_329,_32a);return _329;},_removeArrayElement:function(_32e,_32f){var _330=dojo.indexOf(_32e,_32f);if(_330!=-1){_32e.splice(_330,1);return true;}return false;},deleteItem:function(item){this._assert(!this._saveInProgress);this._assertIsItem(item);var _331=item[this._itemNumPropName];var _332=this.getIdentity(item);if(this.referenceIntegrity){var _333=this.getAttributes(item);if(item[this._reverseRefMap]){item["backup_"+this._reverseRefMap]=dojo.clone(item[this._reverseRefMap]);}dojo.forEach(_333,function(_334){dojo.forEach(this.getValues(item,_334),function(_335){if(this.isItem(_335)){if(!item["backupRefs_"+this._reverseRefMap]){item["backupRefs_"+this._reverseRefMap]=[];}item["backupRefs_"+this._reverseRefMap].push({id:this.getIdentity(_335),attr:_334});this._removeReferenceFromMap(_335,item,_334);}},this);},this);var _336=item[this._reverseRefMap];if(_336){for(var _337 in _336){var _338=null;if(this._itemsByIdentity){_338=this._itemsByIdentity[_337];}else{_338=this._arrayOfAllItems[_337];}if(_338){for(var _339 in _336[_337]){var _33a=this.getValues(_338,_339)||[];var _33b=dojo.filter(_33a,function(_33c){return !(this.isItem(_33c)&&this.getIdentity(_33c)==_332);},this);this._removeReferenceFromMap(item,_338,_339);if(_33b.length<_33a.length){this._setValueOrValues(_338,_339,_33b,true);}}}}}}this._arrayOfAllItems[_331]=null;item[this._storeRefPropName]=null;if(this._itemsByIdentity){delete this._itemsByIdentity[_332];}this._pending._deletedItems[_332]=item;if(item[this._rootItemPropName]){this._removeArrayElement(this._arrayOfTopLevelItems,item);}this.onDelete(item);return true;},setValue:function(item,_33d,_33e){return this._setValueOrValues(item,_33d,_33e,true);},setValues:function(item,_33f,_340){return this._setValueOrValues(item,_33f,_340,true);},unsetAttribute:function(item,_341){return this._setValueOrValues(item,_341,[],true);},_setValueOrValues:function(item,_342,_343,_344){this._assert(!this._saveInProgress);this._assertIsItem(item);this._assert(dojo.isString(_342));this._assert(typeof _343!=="undefined");var _345=this._getIdentifierAttribute();if(_342==_345){throw new Error("ItemFileWriteStore does not have support for changing the value of an item's identifier.");}var _346=this._getValueOrValues(item,_342);var _347=this.getIdentity(item);if(!this._pending._modifiedItems[_347]){var _348={};for(var key in item){if((key===this._storeRefPropName)||(key===this._itemNumPropName)||(key===this._rootItemPropName)){_348[key]=item[key];}else{if(key===this._reverseRefMap){_348[key]=dojo.clone(item[key]);}else{_348[key]=item[key].slice(0,item[key].length);}}}this._pending._modifiedItems[_347]=_348;}var _349=false;if(dojo.isArray(_343)&&_343.length===0){_349=delete item[_342];_343=undefined;if(this.referenceIntegrity&&_346){var _34a=_346;if(!dojo.isArray(_34a)){_34a=[_34a];}for(var i=0;i<_34a.length;i++){var _34b=_34a[i];if(this.isItem(_34b)){this._removeReferenceFromMap(_34b,item,_342);}}}}else{var _34c;if(dojo.isArray(_343)){var _34d=_343;_34c=_343.slice(0,_343.length);}else{_34c=[_343];}if(this.referenceIntegrity){if(_346){var _34a=_346;if(!dojo.isArray(_34a)){_34a=[_34a];}var map={};dojo.forEach(_34a,function(_34e){if(this.isItem(_34e)){var id=this.getIdentity(_34e);map[id.toString()]=true;}},this);dojo.forEach(_34c,function(_34f){if(this.isItem(_34f)){var id=this.getIdentity(_34f);if(map[id.toString()]){delete map[id.toString()];}else{this._addReferenceToMap(_34f,item,_342);}}},this);for(var rId in map){var _350;if(this._itemsByIdentity){_350=this._itemsByIdentity[rId];}else{_350=this._arrayOfAllItems[rId];}this._removeReferenceFromMap(_350,item,_342);}}else{for(var i=0;i<_34c.length;i++){var _34b=_34c[i];if(this.isItem(_34b)){this._addReferenceToMap(_34b,item,_342);}}}}item[_342]=_34c;_349=true;}if(_344){this.onSet(item,_342,_346,_343);}return _349;},_addReferenceToMap:function(_351,_352,_353){var _354=this.getIdentity(_352);var _355=_351[this._reverseRefMap];if(!_355){_355=_351[this._reverseRefMap]={};}var _356=_355[_354];if(!_356){_356=_355[_354]={};}_356[_353]=true;},_removeReferenceFromMap:function(_357,_358,_359){var _35a=this.getIdentity(_358);var _35b=_357[this._reverseRefMap];var _35c;if(_35b){for(_35c in _35b){if(_35c==_35a){delete _35b[_35c][_359];if(this._isEmpty(_35b[_35c])){delete _35b[_35c];}}}if(this._isEmpty(_35b)){delete _357[this._reverseRefMap];}}},_dumpReferenceMap:function(){var i;for(i=0;i<this._arrayOfAllItems.length;i++){var item=this._arrayOfAllItems[i];if(item&&item[this._reverseRefMap]){console.log("Item: ["+this.getIdentity(item)+"] is referenced by: "+dojo.toJson(item[this._reverseRefMap]));}}},_getValueOrValues:function(item,_35d){var _35e=undefined;if(this.hasAttribute(item,_35d)){var _35f=this.getValues(item,_35d);if(_35f.length==1){_35e=_35f[0];}else{_35e=_35f;}}return _35e;},_flatten:function(_360){if(this.isItem(_360)){var item=_360;var _361=this.getIdentity(item);var _362={_reference:_361};return _362;}else{if(typeof _360==="object"){for(var type in this._datatypeMap){var _363=this._datatypeMap[type];if(dojo.isObject(_363)&&!dojo.isFunction(_363)){if(_360 instanceof _363.type){if(!_363.serialize){throw new Error("ItemFileWriteStore:  No serializer defined for type mapping: ["+type+"]");}return {_type:type,_value:_363.serialize(_360)};}}else{if(_360 instanceof _363){return {_type:type,_value:_360.toString()};}}}}return _360;}},_getNewFileContentString:function(){var _364={};var _365=this._getIdentifierAttribute();if(_365!==Number){_364.identifier=_365;}if(this._labelAttr){_364.label=this._labelAttr;}_364.items=[];for(var i=0;i<this._arrayOfAllItems.length;++i){var item=this._arrayOfAllItems[i];if(item!==null){var _366={};for(var key in item){if(key!==this._storeRefPropName&&key!==this._itemNumPropName&&key!==this._reverseRefMap&&key!==this._rootItemPropName){var _367=key;var _368=this.getValues(item,_367);if(_368.length==1){_366[_367]=this._flatten(_368[0]);}else{var _369=[];for(var j=0;j<_368.length;++j){_369.push(this._flatten(_368[j]));_366[_367]=_369;}}}}_364.items.push(_366);}}var _36a=true;return dojo.toJson(_364,_36a);},_isEmpty:function(_36b){var _36c=true;if(dojo.isObject(_36b)){var i;for(i in _36b){_36c=false;break;}}else{if(dojo.isArray(_36b)){if(_36b.length>0){_36c=false;}}}return _36c;},save:function(_36d){this._assert(!this._saveInProgress);this._saveInProgress=true;var self=this;var _36e=function(){self._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};self._saveInProgress=false;if(_36d&&_36d.onComplete){var _36f=_36d.scope||dojo.global;_36d.onComplete.call(_36f);}};var _370=function(err){self._saveInProgress=false;if(_36d&&_36d.onError){var _371=_36d.scope||dojo.global;_36d.onError.call(_371,err);}};if(this._saveEverything){var _372=this._getNewFileContentString();this._saveEverything(_36e,_370,_372);}if(this._saveCustom){this._saveCustom(_36e,_370);}if(!this._saveEverything&&!this._saveCustom){_36e();}},revert:function(){this._assert(!this._saveInProgress);var _373;for(_373 in this._pending._modifiedItems){var _374=this._pending._modifiedItems[_373];var _375=null;if(this._itemsByIdentity){_375=this._itemsByIdentity[_373];}else{_375=this._arrayOfAllItems[_373];}_374[this._storeRefPropName]=this;for(key in _375){delete _375[key];}dojo.mixin(_375,_374);}var _376;for(_373 in this._pending._deletedItems){_376=this._pending._deletedItems[_373];_376[this._storeRefPropName]=this;var _377=_376[this._itemNumPropName];if(_376["backup_"+this._reverseRefMap]){_376[this._reverseRefMap]=_376["backup_"+this._reverseRefMap];delete _376["backup_"+this._reverseRefMap];}this._arrayOfAllItems[_377]=_376;if(this._itemsByIdentity){this._itemsByIdentity[_373]=_376;}if(_376[this._rootItemPropName]){this._arrayOfTopLevelItems.push(_376);}}for(_373 in this._pending._deletedItems){_376=this._pending._deletedItems[_373];if(_376["backupRefs_"+this._reverseRefMap]){dojo.forEach(_376["backupRefs_"+this._reverseRefMap],function(_378){var _379;if(this._itemsByIdentity){_379=this._itemsByIdentity[_378.id];}else{_379=this._arrayOfAllItems[_378.id];}this._addReferenceToMap(_379,_376,_378.attr);},this);delete _376["backupRefs_"+this._reverseRefMap];}}for(_373 in this._pending._newItems){var _37a=this._pending._newItems[_373];_37a[this._storeRefPropName]=null;this._arrayOfAllItems[_37a[this._itemNumPropName]]=null;if(_37a[this._rootItemPropName]){this._removeArrayElement(this._arrayOfTopLevelItems,_37a);}if(this._itemsByIdentity){delete this._itemsByIdentity[_373];}}this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};return true;},isDirty:function(item){if(item){var _37b=this.getIdentity(item);return new Boolean(this._pending._newItems[_37b]||this._pending._modifiedItems[_37b]||this._pending._deletedItems[_37b]).valueOf();}else{if(!this._isEmpty(this._pending._newItems)||!this._isEmpty(this._pending._modifiedItems)||!this._isEmpty(this._pending._deletedItems)){return true;}return false;}},onSet:function(item,_37c,_37d,_37e){},onNew:function(_37f,_380){},onDelete:function(_381){},close:function(_382){if(this.clearOnClose){if(!this.isDirty()){this.inherited(arguments);}else{throw new Error("dojo.data.ItemFileWriteStore: There are unsaved changes present in the store.  Please save or revert the changes before invoking close.");}}}});}if(!dojo._hasResource["plugins.core.Common.Array"]){dojo._hasResource["plugins.core.Common.Array"]=true;dojo.provide("plugins.core.Common.Array");dojo.declare("plugins.core.Common.Array",[],{_getIndex:function(_383,key){for(var i=0;i<_383.length;i++){if(_383[i]==key){return i;}}return -1;},_getObjectByKeyValue:function(_384,key,_385){if(_384==null){return;}for(var i=0;i<_384.length;i++){if(_384[i][key]==_385){return _384[i];}}return;},_addObjectToArray:function(_386,_387,_388){if(_386==null){_386=new Array;}var _389=this.notDefined(_387,_388);if(_389.length>0){console.log("  Common.Array._addObjectToArray    notDefined: "+dojo.toJson(_389));return false;}_386.push(_387);return true;},_removeObjectFromArray:function(_38a,_38b,keys){var _38c=this._getIndexInArray(_38a,_38b,keys);if(_38c==null){return false;}_38a.splice(_38c,1);return true;},_removeArrayFromArray:function(_38d,_38e,_38f){var _390=true;for(var j=0;j<_38e.length;j++){var _391=this.notDefined(_38e[j],_38f);if(_391.length>0){console.log("  Common.Array.removeArrayFromArray    object has notDefined keys: "+dojo.toJson(_391));_390=false;continue;}var _392=this._removeObjectFromArray(_38d,_38e[j],_38f);if(_392==false){_390=_392;}}return _390;},_getIndexInArray:function(_393,_394,keys){if(_393==null){return null;}for(var i=0;i<_393.length;i++){var _395=_393[i];var _396=true;for(var j=0;j<keys.length;j++){if(_395[keys[j]]!=_394[keys[j]]){_396=false;break;}}if(_396==true){return i;}}return null;},_objectInArray:function(_397,_398,keys){if(_397==null){return false;}if(_398==null){return false;}var _399=this._getIndexInArray(_397,_398,keys);if(_399==null){return false;}return true;},_removeObjectsFromArray:function(_39a,_39b,keys){if(_39a==null){return;}var _39c=new Array;for(var i=0;i<_39a.length;i++){var _39d=_39a[i];var _39e=true;for(var j=0;j<keys.length;j++){if(_39d[keys[j]]!=_39b[keys[j]]){_39e=false;break;}}if(_39e==true){_39c.push(_39a.splice(i,1));i--;}}return _39c;},_addArrayToArray:function(_39f,_3a0,keys){if(_39f==null){return;}var _3a1=true;for(var i=0;i<_3a0.length;i++){if(!this._addObjectToArray(_39f,_3a0[i],keys)){_3a1=false;}}return _3a1;},_objectsMatchByKey:function(_3a2,_3a3,keys){console.log("    Common._objectsMatchByKey object1:");console.dir({object1:_3a2});console.log("    Common._objectsMatchByKey object2:");console.dir({object2:_3a3});if(!_3a2||!_3a3){return;}if(_3a2==null||_3a2==null||keys==null){return false;}for(var i=0;i<keys.length;i++){if(_3a2[keys[i]]!=_3a3[keys[i]]){return false;}}return true;},hashArrayKeyToArray:function(_3a4,key){var _3a5=new Array;dojo.forEach(_3a4,function(_3a6){if(_3a6[key]){_3a5.push(_3a6[key]);}});return _3a5;},hashkeysToArray:function(hash){var _3a7=new Array;for(var key in hash){if(key!=null&&key!=""){_3a7.push(key);}}return _3a7;},filterHasharray:function(_3a8,key){var _3a9=new Array;dojo.forEach(_3a8,function(_3aa){if(_3aa[key]!=null){_3a9.push(_3aa);}});return _3a9;},filterByKeyValues:function(_3ab,_3ac,_3ad){if(_3ab==null){return;}if(_3ac==null){return;}if(_3ad==null){return;}for(var i=0;i<_3ab.length;i++){var _3ae=true;for(var j=0;j<_3ac.length;j++){if(_3ab[i][_3ac[j]]!=_3ad[j]){_3ae=false;break;}}if(_3ae==false){var _3af=_3ab[i];_3ab.splice(i,1);i--;}}return _3ab;},_addArrayToArray:function(_3b0,_3b1,_3b2){if(_3b0==null){_3b0=new Array;}var _3b3=this.notDefined(_3b1,_3b2);if(_3b3.length>0){console.log("  Common.Array._addArrayToArray    notDefined: "+dojo.toJson(_3b3));return false;}console.log("  Common.Array._addArrayToArray    Doing twoDArray.push(array)");_3b0.push(_3b1);console.log("  Common.Array._addArrayToArray    AFTER twoDArray.push(array). twoDArray: "+dojo.toJson(_3b0));return true;},notDefined:function(_3b4,keys){if(_3b4==null){return;}var _3b5=new Array;for(var i=0;i<keys.length;i++){if(_3b4[keys[i]]==null){_3b5.push(keys[i]);}}return _3b5;},getEntry:function(_3b6,_3b7,_3b8){if(_3b6==null){return;}if(_3b7==null){return;}if(_3b8==null){return;}for(var i=0;i<_3b6.length;i++){var _3b9=true;for(var j=0;j<_3b7.length;j++){if(_3b6[i][_3b7[j]]!=_3b8[j]){_3b9=false;break;}}if(_3b9==true){return _3b6[i];}}console.log("  Common.Array.getEntry    Returning null");return null;},uniqueValues:function(_3ba){if(_3ba.length==1){return _3ba;}_3ba=_3ba.sort();for(var i=1;i<_3ba.length;i++){if(_3ba[i-1]==_3ba[i]){_3ba.splice(i,1);i--;}}return _3ba;}});}if(!dojo._hasResource["plugins.core.Common.ComboBox"]){dojo._hasResource["plugins.core.Common.ComboBox"]=true;dojo.provide("plugins.core.Common.ComboBox");dojo.declare("plugins.core.Common.ComboBox",[],{setUsernameCombo:function(){var _3bb=Agua.getSharedUsernames();if(_3bb==null||_3bb.length==0){return;}var data={identifier:"name",items:[]};for(var i in _3bb){data.items[i]={name:_3bb[i]};}var _3bc=new dojo.data.ItemFileReadStore({data:data});this.usernameCombo.store=_3bc;this.usernameCombo.startup();this.usernameCombo.set("value",_3bb[0]);},setSharedProjectCombo:function(_3bd,_3be,_3bf){var _3c0=Agua.getSharedProjectsByUsername(_3bd);if(_3c0==null){return;}var _3c1=this.hashArrayKeyToArray(_3c0,"name");_3c1=this.uniqueValues(_3c1);if(_3c1==null||_3c1.length==0){return;}var data={identifier:"name",items:[]};for(var i in _3c1){data.items[i]={name:_3c1[i]};}var _3c2=new dojo.data.ItemFileReadStore({data:data});this.projectCombo.store=_3c2;this.projectCombo.startup();this.projectCombo.set("value",_3c1[0]);},setSharedWorkflowCombo:function(_3c3,_3c4,_3c5){console.log("  Common.ComboBox.setSharedWorkflowCombo    plugins.report.Workflow.setSharedWorkflowCombo(username, project, workflow)");console.log("  Common.ComboBox.setSharedWorkflowCombo    projectName: "+_3c4);if(_3c4==null){_3c4=this.projectCombo.get("value");}console.log("  Common.ComboBox.setSharedWorkflowCombo    AFTER projectName: "+_3c4);var _3c6=Agua.getSharedWorkflowsByProject(_3c3,_3c4);if(_3c6==null){console.log("  Common.ComboBox.setSharedWorkflowCombo    workflows is null. Returning");return;}console.log("  Common.ComboBox.setSharedWorkflowCombo    workflows: ");console.dir({workflows:_3c6});var _3c7=this.hashArrayKeyToArray(_3c6,"name");_3c7=this.uniqueValues(_3c7);console.log("  Common.ComboBox.setSharedWorkflowCombo    workflowNames: "+dojo.toJson(_3c7));if(_3c7==null||_3c7.length==0){console.log("  Common.ComboBox.setSharedWorkflowCombo    workflowNames not defined. Returning.");return;}var data={identifier:"name",items:[]};for(var i in _3c7){data.items[i]={name:_3c7[i]};}var _3c8=new dojo.data.ItemFileReadStore({data:data});this.workflowCombo.store=_3c8;this.workflowCombo.startup();this.workflowCombo.set("value",_3c7[0]);},setProjectCombo:function(_3c9,_3ca){var _3cb=Agua.getProjectNames();if(!_3cb){return;}if(_3c9==null||!_3c9){_3c9=_3cb[0];}var data={identifier:"name",items:[]};for(var i in _3cb){data.items[i]={name:_3cb[i]};}var _3cc=new dojo.data.ItemFileReadStore({data:data});var _3cd=this.projectCombo;if(_3cd==null){return;}_3cd.store=_3cc;_3cd.set("value",_3c9);},setWorkflowCombo:function(_3ce,_3cf){if(_3ce==null||!_3ce){return;}var _3d0=Agua.getWorkflowsByProject(_3ce);console.log("  Common.ComboBox.setWorkflowCombo    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX DOING SORT workflows");_3d0=this.sortHasharrayByKeys(_3d0,["number"]);console.log("  Common.ComboBox.setWorkflowCombo    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX AFTER SORT workflows:");console.dir({XXXXXXXXXXXXXXXXXworkflows:_3d0});var _3d1=this.hashArrayKeyToArray(_3d0,"name");if(!_3d1){console.log("  Common.ComboBox.setWorkflowCombo    workflowNames not defined. Returning.");return;}var data={identifier:"name",items:[]};for(var i in _3d1){data.items[i]={name:_3d1[i]};}console.log("  Common.ComboBox.setWorkflowCombo    data: "+dojo.toJson(data));var _3d2=new dojo.data.ItemFileReadStore({data:data});var _3d3=this.workflowCombo;if(_3d3==null){console.log("  Common.ComboBox.setworkflowCombo    workflowCombo is null. Returning.");return;}_3d3.store=_3d2;if(_3cf==null||!_3cf){_3cf=_3d1[0];}_3d3.startup();_3d3.set("value",_3cf);},setReportCombo:function(_3d4,_3d5,_3d6){if(_3d4==null||!_3d4){console.log("  Common.ComboBox.setReportCombo    project not defined. Returning.");return;}if(_3d5==null||!_3d5){console.log("  Common.ComboBox.setReportCombo    workflow not defined. Returning.");return;}var _3d7=Agua.getReportsByWorkflow(_3d4,_3d5);if(_3d7==null){_3d7=[];}console.log("  Common.ComboBox.setReportCombo    project "+_3d4+" reports: "+dojo.toJson(_3d7));var _3d8=this.hashArrayKeyToArray(_3d7,"name");console.log("  Common.ComboBox.setReportCombo    reportNames: "+dojo.toJson(_3d8));var data={identifier:"name",items:[]};for(var i in _3d7){data.items[i]={name:_3d8[i]};}console.log("  Common.ComboBox.setReportCombo    data: "+dojo.toJson(data));var _3d9=new dojo.data.ItemFileReadStore({data:data});var _3da=this.reportCombo;if(_3da==null){console.log("  Common.ComboBox.setreportCombo    reportCombo is null. Returning.");return;}console.log("  Common.ComboBox.setReportCombo    reportCombo: "+_3da);_3da.store=_3d9;var _3db=this;_3da.startup();_3da.set("value",_3d6);},setViewCombo:function(_3dc,_3dd){console.log("  Common.ComboBox.setViewCombo    projectName: "+_3dc);console.log("  Common.ComboBox.setViewCombo    viewName: "+_3dd);if(!this.viewCombo){return;}if(!_3dc){return;}var _3de=Agua.getViewNames(_3dc);console.log("  Common.ComboBox.setViewCombo    BEFORE SORT views: ");console.dir({views:_3de});_3de.sort(this.sortNaturally);console.log("View.setViewCombo    AFTER SORT views: ");console.dir({views:_3de});if(!_3de||_3de.length==0){_3de=[];}if(_3dd==null||!_3dd){_3dd=_3de[0];}var data={identifier:"name",items:[]};for(var i in _3de){data.items[i]={name:_3de[i]};}var _3df=new dojo.data.ItemFileReadStore({data:data});this.viewCombo.store=_3df;this.viewCombo.startup();this.viewCombo.set("value",_3dd);},getSelectedValue:function(_3e0){var _3e1=_3e0.selectedIndex;var _3e2=_3e0.options[_3e1].text;return _3e2;}});}if(!dojo._hasResource["plugins.core.Common.Date"]){dojo._hasResource["plugins.core.Common.Date"]=true;dojo.provide("plugins.core.Common.Date");dojo.declare("plugins.core.Common.Date",[],{currentDate:function(){var date=new Date;var _3e3=date.toString();return _3e3;},currentMysqlDate:function(){var date=new Date;date=this.dateToMysql(date);return date;},dateToMysql:function(date){return date.getFullYear()+"-"+(date.getMonth()<9?"0":"")+(date.getMonth()+1)+"-"+(date.getDate()<10?"0":"")+date.getDate()+" "+(date.getHours()<10?"0":"")+date.getHours()+":"+(date.getMinutes()<10?"0":"")+date.getMinutes()+":"+(date.getSeconds()<10?"0":"")+date.getSeconds();},mysqlToDate:function(_3e4){var _3e5=/^([0-9]{2,4})-([0-1][0-9])-([0-3][0-9]) (?:([0-2][0-9]):([0-5][0-9]):([0-5][0-9]))?$/;var _3e6=_3e4.replace(_3e5,"$1 $2 $3 $4 $5 $6").split(" ");return new Date(_3e6[0],_3e6[1]-1,_3e6[2],_3e6[3],_3e6[4],_3e6[5]);}});}if(!dojo._hasResource["plugins.core.Common.Sort"]){dojo._hasResource["plugins.core.Common.Sort"]=true;dojo.provide("plugins.core.Common.Sort");dojo.declare("plugins.core.Common.Sort",[],{sortHasharrayByOrder:function(_3e7,_3e8){var _3e9=new Array;for(var i=0;i<_3e8.length;i++){var _3ea=_3e8[i];for(var j=0;j<_3e7.length;j++){var _3eb=_3e7[j];var _3ec;for(var _3ec in _3eb){if(_3ec==_3ea){_3e9.push(_3eb);break;}}}}return _3e9;},sortNoCase:function(_3ed){return _3ed.sort(function(a,b){return a.toUpperCase()==b.toUpperCase()?(a<b?-1:a>b):(a.toUpperCase()<b.toUpperCase()?-1:a.toUpperCase()>b.toUpperCase());});},sortHasharrayByKeys:function(_3ee,keys){if(_3ee==null){return;}if(keys==null){return;}if(!typeof _3ee=="ARRAY"||_3ee==null){return;}if(!typeof keys=="ARRAY"||keys==null){return;}return _3ee.sort(function(a,b){var _3ef=1;for(var i=0;i<keys.length;i++){var key=keys[i];if(a[key]==null||b[key]==null){continue;}if(a[key].toUpperCase&&b[key].toUpperCase){var _3f0=a[key].toUpperCase();var _3f1=b[key].toUpperCase();_3ef=_3f0==_3f1?(a[key]<b[key]?-1:(a[key]>b[key]?1:0)):(_3f0<_3f1?-1:(_3f0>_3f1?1:0));if(_3ef!=0){break;}}else{_3ef=a[key]<b[key]?-1:(a[key]>b[key]?1:0);if(_3ef!=0){break;}}}return _3ef;});},sortHasharray:function(_3f2,key){if(_3f2==null){return;}if(key==null){return;}if(!typeof _3f2=="ARRAY"){return;}return _3f2.sort(function(a,b){if(a[key]==null){return;}if(b[key]==null){return;}return a[key].toUpperCase()==b[key].toUpperCase()?(a[key]<b[key]?-1:a[key]>b[key]):(a[key].toUpperCase()<b[key].toUpperCase()?-1:a[key].toUpperCase()>b[key].toUpperCase());});},sortNumericHasharray:function(_3f3,key){if(_3f3==null){console.log("  Common.Sort.sortNumericHasharray    hashArray is null. Returning");return;}if(key==null){console.log("  Common.Sort.sortNumericHasharray    key is null. Returning.");return;}for(var i=0;i<_3f3.length;i++){if(parseInt(_3f3[i])=="NaN"){_3f3.splice(i,1);i--;}}return _3f3.sort(function(a,b){return parseInt(a[key])==parseInt(b[key])?(parseInt(a[key])<parseInt(b[key])?-1:parseInt(a[key])>parseInt(b[key])):(parseInt(a[key])<parseInt(b[key])?-1:parseInt(a[key])>parseInt(b[key]));});},sortNaturally:function(a,b){var _3f4=a.match(/^(\d*\D+)/);var _3f5=b.match(/^(\d*\D+)/);if(_3f4&&_3f5){if(_3f4<_3f5){return -1;}if(_3f4>_3f5){return 1;}}if(_3f4&&!_3f5){return -1;}if(!_3f4&&_3f5){return 1;}var _3f6=a.match(/(\d+)[^\/^\d]*$/);var _3f7=b.match(/(\d+)[^\/^\d]*$/);if(parseInt(_3f6)&&parseInt(_3f7)){if(parseInt(_3f6)<parseInt(_3f7)){return -1;}if(parseInt(_3f6)>parseInt(_3f7)){return 1;}return 0;}if(parseInt(_3f6)&&!parseInt(_3f7)){return -1;}if(!parseInt(_3f6)&&parseInt(_3f7)){return 1;}return 0;},sortObjectsNaturally:function(a,b,key){if(a[key]&&!b[key]){return -1;}if(!a[key]&&b[key]){return 1;}if(!a[key]&&!b[key]){return 0;}var _3f8=a[key].match(/^(\d*\D+)/);if(_3f8){_3f8=_3f8[1];}var _3f9=b[key].match(/^(\d*\D+)/);if(_3f9){_3f9=_3f9[1];}if(_3f8&&_3f9){if(_3f8<_3f9){return -1;}if(_3f8>_3f9){return 1;}}if(_3f8&&!_3f9){return -1;}if(!_3f8&&_3f9){return 1;}var _3fa=a[key].match(/(\d+)[^\/^\d]*$/);if(_3fa){_3fa=parseInt(_3fa[1]);}var _3fb=b[key].match(/(\d+)[^\/^\d]*$/);if(_3fb){_3fb=parseInt(_3fb[1]);}if(_3fa&&_3fb){if(_3fa<_3fb){return -1;}if(_3fa>_3fb){return 1;}return 0;}if(_3fa&&!_3fb){return -1;}if(!_3fa&&_3fb){return 1;}return 0;},sortTwoDArray:function(_3fc,_3fd){console.log("  Common.Sort.sortTwoDArray    plugins.core.Common.sortTwoDArray(twoDArray, key)");if(_3fc==null){return;}if(_3fd==null){return;}console.log("  Common.Sort.sortTwoDArray    twoDArray: "+dojo.toJson(_3fc));console.log("  Common.Sort.sortTwoDArray    index: "+_3fd);return _3fc.sort(function(a,b){console.log("  Common.Sort.sortTwoDArray    a["+_3fd+"]: "+a[_3fd]);console.log("  Common.Sort.sortTwoDArray    b["+_3fd+"]: "+b[_3fd]);if(a[_3fd]==null){console.log("No value for index '"+_3fd+"' in twoDArray item: "+dojo.toJson(a));return;}if(b[_3fd]==null){console.log("No value for index '"+_3fd+"' in twoDArray item: "+dojo.toJson(b));return;}return a[_3fd].toUpperCase()==b[_3fd].toUpperCase()?(a[_3fd]<b[_3fd]?-1:a[_3fd]>b[_3fd]):(a[_3fd].toUpperCase()<b[_3fd].toUpperCase()?-1:a[_3fd].toUpperCase()>b[_3fd].toUpperCase());});}});}if(!dojo._hasResource["plugins.core.Common.Text"]){dojo._hasResource["plugins.core.Common.Text"]=true;dojo.provide("plugins.core.Common.Text");dojo.declare("plugins.core.Common.Text",[],{repeatChar:function(_3fe,_3ff){var _400="";for(var i=0;i<_3ff;i++){_400+=_3fe;}return _400;},xor:function(_401,_402){if((_401&&!_402)||(!_401&&_402)){return true;}return false;},systemVariables:function(_403,_404){if(_404==null){_404=this;}if(_403==null||_403==true||_403==false){return _403;}if(_403.replace==null){return _403;}_403=_403.replace(/%username%/g,Agua.cookie("username"));_403=_403.replace(/%project%/g,_404.project);_403=_403.replace(/%workflow%/g,_404.workflow);return _403;},insertTextBreaks:function(text,_405){if(this.textBreakWidth!=null){_405=this.textBreakWidth;}if(_405==null){return;}var _406="\n";text=this.removeTextBreaks(text);var _407="";var _408=0;while(_408<text.length){var temp=text.substring(_408,_408+_405);_408+=_405;_407+=temp;_407+=_406;}return _407;},removeTextBreaks:function(text){text=text.replace(/\n/g,"");return text;},jsonSafe:function(_409,mode){if(_409==null||!_409){return "";}if(_409==true||_409==false){return _409;}_409=String(_409).replace(/\s+$/g,"");_409=String(_409).replace(/^\s+/g,"");_409=String(_409).replace(/"/g,"'");var _40a=[["&quot;","'"],["&#35;","#"],["&#36;","$"],["&#37;","%"],["&amp;","&"],["&#40;","("],["&#41;",")"],["&frasl;","/"],["&#91;","["],["&#92;","\\"],["&#93;","]"],["&#96;","`"],["&#123;","{"],["&#124;","|"],["&#125;","}"]];for(var i=0;i<_40a.length;i++){if(mode=="toJson"){var _40b=new RegExp(_40a[i][1],"g");return _409.replace(_40b,_40a[i][0]);}else{if(mode=="fromJson"){var _40b=new RegExp(_40a[i][0],"g");return _409.replace(_40b,_40a[i][1]);}}}return _409;},autoHeight:function(_40c){var rows=parseInt(_40c.rows);console.log("  Common.Text.autoHeight    textarea.rows: "+_40c.rows);while(_40c.rows*_40c.cols<_40c.value.length){_40c.rows=++rows;}},firstLetterUpperCase:function(word){if(word==null||word==""){return word;}if(word.substring==null){return null;}return word.substring(0,1).toUpperCase()+word.substring(1);},cleanEnds:function(_40d){if(_40d==null){return "";}_40d=_40d.replace(/^[\s\n]+/,"");_40d=_40d.replace(/[\s\n]+$/,"");return _40d;},cleanWord:function(word){if(word==null){return "";}return word.replace(/[\s\n]+/,"");},clearValue:function(_40e,_40f){if(_40e==null){return;}if(_40e.get&&_40e.get("value")==_40f){_40e.set("value","");}else{if(_40e.value&&_40e.value.match(_40f)){_40e.value="";}}},cleanNumber:function(_410){if(_410==null){return "";}_410=_410.toString().replace(/[\s\n]+/,"");return _410.toString().replace(/[\s\n]+/,"");},convertString:function(_411,type){if(_411==null){return "";}if(_411==null){return "";}if(_411.replace==null){return _411;}var _412=_411;_411=this.convertAngleBrackets(_411,type);_411=this.convertAmpersand(_411,type);_411=this.convertQuote(_411,type);return _411;},convertBackslash:function(_413,type){if(_413==null){return "";}if(_413.replace==null){return _413;}try{var _414=function(_415,num){if(!num){return "";}var _416=_415;while(--num){_416+=_415;}return _416;};var _417=function(_418){return _414("\\",(_418.length/2));};var _419=function(_41a){return _414("\\",(_41a.length*2));};if(type=="compress"){_413=_413.replace(/\\+/g,_417);}if(type=="expand"){_413=_413.replace(/\\+/g,_419);}}catch(error){return "";}return _413;},convertAmpersand:function(_41b,type){if(_41b==null){return "";}if(_41b.replace==null){return _41b;}if(type=="textToHtml"){_41b=_41b.replace(/&/g,"&amp;");}else{_41b=_41b.replace(/&amp;/g,"&");}return _41b;},convertQuote:function(_41c,type){if(_41c==null){return "";}if(_41c.replace==null){return _41c;}if(type=="textToHtml"){_41c=_41c.replace(/"/g,"&quot;");}else{_41c=_41c.replace(/&quot;/g,"\"");}return _41c;},convertAngleBrackets:function(_41d,type){if(_41d==null){return "";}if(_41d.replace==null){return _41d;}var _41e=[["&lt;","<"],["&gt;",">"]];var from=0;var to=1;if(type=="textToHtml"){from=1;to=0;}for(var i=0;i<_41e.length;i++){var _41f=new RegExp(_41e[i][from],"g");_41d=_41d.replace(_41f,_41e[i][to]);}return _41d;},printObjectKeys:function(_420,key,_421){if(_421==null){_421="key";}for(var i=0;i<_420.length;i++){console.log(_421+" "+i+": "+_420[i][key]);}},});}if(!dojo._hasResource["dojo.fx.Toggler"]){dojo._hasResource["dojo.fx.Toggler"]=true;dojo.provide("dojo.fx.Toggler");dojo.declare("dojo.fx.Toggler",null,{node:null,showFunc:dojo.fadeIn,hideFunc:dojo.fadeOut,showDuration:200,hideDuration:200,constructor:function(args){var _422=this;dojo.mixin(_422,args);_422.node=args.node;_422._showArgs=dojo.mixin({},args);_422._showArgs.node=_422.node;_422._showArgs.duration=_422.showDuration;_422.showAnim=_422.showFunc(_422._showArgs);_422._hideArgs=dojo.mixin({},args);_422._hideArgs.node=_422.node;_422._hideArgs.duration=_422.hideDuration;_422.hideAnim=_422.hideFunc(_422._hideArgs);dojo.connect(_422.showAnim,"beforeBegin",dojo.hitch(_422.hideAnim,"stop",true));dojo.connect(_422.hideAnim,"beforeBegin",dojo.hitch(_422.showAnim,"stop",true));},show:function(_423){return this.showAnim.play(_423||0);},hide:function(_424){return this.hideAnim.play(_424||0);}});}if(!dojo._hasResource["dojo.fx"]){dojo._hasResource["dojo.fx"]=true;dojo.provide("dojo.fx");(function(){var d=dojo,_425={_fire:function(evt,args){if(this[evt]){this[evt].apply(this,args||[]);}return this;}};var _426=function(_427){this._index=-1;this._animations=_427||[];this._current=this._onAnimateCtx=this._onEndCtx=null;this.duration=0;d.forEach(this._animations,function(a){this.duration+=a.duration;if(a.delay){this.duration+=a.delay;}},this);};d.extend(_426,{_onAnimate:function(){this._fire("onAnimate",arguments);},_onEnd:function(){d.disconnect(this._onAnimateCtx);d.disconnect(this._onEndCtx);this._onAnimateCtx=this._onEndCtx=null;if(this._index+1==this._animations.length){this._fire("onEnd");}else{this._current=this._animations[++this._index];this._onAnimateCtx=d.connect(this._current,"onAnimate",this,"_onAnimate");this._onEndCtx=d.connect(this._current,"onEnd",this,"_onEnd");this._current.play(0,true);}},play:function(_428,_429){if(!this._current){this._current=this._animations[this._index=0];}if(!_429&&this._current.status()=="playing"){return this;}var _42a=d.connect(this._current,"beforeBegin",this,function(){this._fire("beforeBegin");}),_42b=d.connect(this._current,"onBegin",this,function(arg){this._fire("onBegin",arguments);}),_42c=d.connect(this._current,"onPlay",this,function(arg){this._fire("onPlay",arguments);d.disconnect(_42a);d.disconnect(_42b);d.disconnect(_42c);});if(this._onAnimateCtx){d.disconnect(this._onAnimateCtx);}this._onAnimateCtx=d.connect(this._current,"onAnimate",this,"_onAnimate");if(this._onEndCtx){d.disconnect(this._onEndCtx);}this._onEndCtx=d.connect(this._current,"onEnd",this,"_onEnd");this._current.play.apply(this._current,arguments);return this;},pause:function(){if(this._current){var e=d.connect(this._current,"onPause",this,function(arg){this._fire("onPause",arguments);d.disconnect(e);});this._current.pause();}return this;},gotoPercent:function(_42d,_42e){this.pause();var _42f=this.duration*_42d;this._current=null;d.some(this._animations,function(a){if(a.duration<=_42f){this._current=a;return true;}_42f-=a.duration;return false;});if(this._current){this._current.gotoPercent(_42f/this._current.duration,_42e);}return this;},stop:function(_430){if(this._current){if(_430){for(;this._index+1<this._animations.length;++this._index){this._animations[this._index].stop(true);}this._current=this._animations[this._index];}var e=d.connect(this._current,"onStop",this,function(arg){this._fire("onStop",arguments);d.disconnect(e);});this._current.stop();}return this;},status:function(){return this._current?this._current.status():"stopped";},destroy:function(){if(this._onAnimateCtx){d.disconnect(this._onAnimateCtx);}if(this._onEndCtx){d.disconnect(this._onEndCtx);}}});d.extend(_426,_425);dojo.fx.chain=function(_431){return new _426(_431);};var _432=function(_433){this._animations=_433||[];this._connects=[];this._finished=0;this.duration=0;d.forEach(_433,function(a){var _434=a.duration;if(a.delay){_434+=a.delay;}if(this.duration<_434){this.duration=_434;}this._connects.push(d.connect(a,"onEnd",this,"_onEnd"));},this);this._pseudoAnimation=new d.Animation({curve:[0,1],duration:this.duration});var self=this;d.forEach(["beforeBegin","onBegin","onPlay","onAnimate","onPause","onStop","onEnd"],function(evt){self._connects.push(d.connect(self._pseudoAnimation,evt,function(){self._fire(evt,arguments);}));});};d.extend(_432,{_doAction:function(_435,args){d.forEach(this._animations,function(a){a[_435].apply(a,args);});return this;},_onEnd:function(){if(++this._finished>this._animations.length){this._fire("onEnd");}},_call:function(_436,args){var t=this._pseudoAnimation;t[_436].apply(t,args);},play:function(_437,_438){this._finished=0;this._doAction("play",arguments);this._call("play",arguments);return this;},pause:function(){this._doAction("pause",arguments);this._call("pause",arguments);return this;},gotoPercent:function(_439,_43a){var ms=this.duration*_439;d.forEach(this._animations,function(a){a.gotoPercent(a.duration<ms?1:(ms/a.duration),_43a);});this._call("gotoPercent",arguments);return this;},stop:function(_43b){this._doAction("stop",arguments);this._call("stop",arguments);return this;},status:function(){return this._pseudoAnimation.status();},destroy:function(){d.forEach(this._connects,dojo.disconnect);}});d.extend(_432,_425);dojo.fx.combine=function(_43c){return new _432(_43c);};dojo.fx.wipeIn=function(args){var node=args.node=d.byId(args.node),s=node.style,o;var anim=d.animateProperty(d.mixin({properties:{height:{start:function(){o=s.overflow;s.overflow="hidden";if(s.visibility=="hidden"||s.display=="none"){s.height="1px";s.display="";s.visibility="";return 1;}else{var _43d=d.style(node,"height");return Math.max(_43d,1);}},end:function(){return node.scrollHeight;}}}},args));d.connect(anim,"onEnd",function(){s.height="auto";s.overflow=o;});return anim;};dojo.fx.wipeOut=function(args){var node=args.node=d.byId(args.node),s=node.style,o;var anim=d.animateProperty(d.mixin({properties:{height:{end:1}}},args));d.connect(anim,"beforeBegin",function(){o=s.overflow;s.overflow="hidden";s.display="";});d.connect(anim,"onEnd",function(){s.overflow=o;s.height="auto";s.display="none";});return anim;};dojo.fx.slideTo=function(args){var node=args.node=d.byId(args.node),top=null,left=null;var init=(function(n){return function(){var cs=d.getComputedStyle(n);var pos=cs.position;top=(pos=="absolute"?n.offsetTop:parseInt(cs.top)||0);left=(pos=="absolute"?n.offsetLeft:parseInt(cs.left)||0);if(pos!="absolute"&&pos!="relative"){var ret=d.position(n,true);top=ret.y;left=ret.x;n.style.position="absolute";n.style.top=top+"px";n.style.left=left+"px";}};})(node);init();var anim=d.animateProperty(d.mixin({properties:{top:args.top||0,left:args.left||0}},args));d.connect(anim,"beforeBegin",anim,init);return anim;};})();}if(!dojo._hasResource["dojox.widget.Toaster"]){dojo._hasResource["dojox.widget.Toaster"]=true;dojo.provide("dojox.widget.Toaster");dojo.declare("dojox.widget.Toaster",[dijit._Widget,dijit._Templated],{templateString:"<div class=\"dijitToasterClip\" dojoAttachPoint=\"clipNode\"><div class=\"dijitToasterContainer\" dojoAttachPoint=\"containerNode\" dojoAttachEvent=\"onclick:onSelect\"><div class=\"dijitToasterContent\" dojoAttachPoint=\"contentNode\"></div></div></div>",messageTopic:"",messageTypes:{MESSAGE:"message",WARNING:"warning",ERROR:"error",FATAL:"fatal"},defaultType:"message",positionDirection:"br-up",positionDirectionTypes:["br-up","br-left","bl-up","bl-right","tr-down","tr-left","tl-down","tl-right"],duration:2000,slideDuration:500,separator:"<hr></hr>",postCreate:function(){this.inherited(arguments);this.hide();dojo.body().appendChild(this.domNode);if(this.messageTopic){dojo.subscribe(this.messageTopic,this,"_handleMessage");}},_handleMessage:function(_43e){if(dojo.isString(_43e)){this.setContent(_43e);}else{this.setContent(_43e.message,_43e.type,_43e.duration);}},_capitalize:function(w){return w.substring(0,1).toUpperCase()+w.substring(1);},setContent:function(_43f,_440,_441){_441=_441||this.duration;if(this.slideAnim){if(this.slideAnim.status()!="playing"){this.slideAnim.stop();}if(this.slideAnim.status()=="playing"||(this.fadeAnim&&this.fadeAnim.status()=="playing")){setTimeout(dojo.hitch(this,function(){this.setContent(_43f,_440,_441);}),50);return;}}for(var type in this.messageTypes){dojo.removeClass(this.containerNode,"dijitToaster"+this._capitalize(this.messageTypes[type]));}dojo.style(this.containerNode,"opacity",1);this._setContent(_43f);dojo.addClass(this.containerNode,"dijitToaster"+this._capitalize(_440||this.defaultType));this.show();var _442=dojo.marginBox(this.containerNode);this._cancelHideTimer();if(this.isVisible){this._placeClip();if(!this._stickyMessage){this._setHideTimer(_441);}}else{var _443=this.containerNode.style;var pd=this.positionDirection;if(pd.indexOf("-up")>=0){_443.left=0+"px";_443.top=_442.h+10+"px";}else{if(pd.indexOf("-left")>=0){_443.left=_442.w+10+"px";_443.top=0+"px";}else{if(pd.indexOf("-right")>=0){_443.left=0-_442.w-10+"px";_443.top=0+"px";}else{if(pd.indexOf("-down")>=0){_443.left=0+"px";_443.top=0-_442.h-10+"px";}else{throw new Error(this.id+".positionDirection is invalid: "+pd);}}}}this.slideAnim=dojo.fx.slideTo({node:this.containerNode,top:0,left:0,duration:this.slideDuration});this.connect(this.slideAnim,"onEnd",function(_444,anim){this.fadeAnim=dojo.fadeOut({node:this.containerNode,duration:1000});this.connect(this.fadeAnim,"onEnd",function(evt){this.isVisible=false;this.hide();});this._setHideTimer(_441);this.connect(this,"onSelect",function(evt){this._cancelHideTimer();this._stickyMessage=false;this.fadeAnim.play();});this.isVisible=true;});this.slideAnim.play();}},_setContent:function(_445){if(dojo.isFunction(_445)){_445(this);return;}if(_445&&this.isVisible){_445=this.contentNode.innerHTML+this.separator+_445;}this.contentNode.innerHTML=_445;},_cancelHideTimer:function(){if(this._hideTimer){clearTimeout(this._hideTimer);this._hideTimer=null;}},_setHideTimer:function(_446){this._cancelHideTimer();if(_446>0){this._cancelHideTimer();this._hideTimer=setTimeout(dojo.hitch(this,function(evt){if(this.bgIframe&&this.bgIframe.iframe){this.bgIframe.iframe.style.display="none";}this._hideTimer=null;this._stickyMessage=false;this.fadeAnim.play();}),_446);}else{this._stickyMessage=true;}},_placeClip:function(){var view=dojo.window.getBox();var _447=dojo.marginBox(this.containerNode);var _448=this.clipNode.style;_448.height=_447.h+"px";_448.width=_447.w+"px";var pd=this.positionDirection;if(pd.match(/^t/)){_448.top=view.t+"px";}else{if(pd.match(/^b/)){_448.top=(view.h-_447.h-2+view.t)+"px";}}if(pd.match(/^[tb]r-/)){_448.left=(view.w-_447.w-1-view.l)+"px";}else{if(pd.match(/^[tb]l-/)){_448.left=0+"px";}}_448.clip="rect(0px, "+_447.w+"px, "+_447.h+"px, 0px)";if(dojo.isIE){if(!this.bgIframe){this.clipNode.id=dijit.getUniqueId("dojox_widget_Toaster_clipNode");this.bgIframe=new dijit.BackgroundIframe(this.clipNode);}var _449=this.bgIframe.iframe;if(_449){_449.style.display="block";}}},onSelect:function(e){},show:function(){dojo.style(this.domNode,"display","block");this._placeClip();if(!this._scrollConnected){this._scrollConnected=dojo.connect(window,"onscroll",this,this._placeClip);}},hide:function(){dojo.style(this.domNode,"display","none");if(this._scrollConnected){dojo.disconnect(this._scrollConnected);this._scrollConnected=false;}dojo.style(this.containerNode,"opacity",1);}});}if(!dojo._hasResource["plugins.dojox.widget.Toaster"]){dojo._hasResource["plugins.dojox.widget.Toaster"]=true;dojo.provide("plugins.dojox.widget.Toaster");dojo.declare("plugins.dojox.widget.Toaster",[dojox.widget.Toaster],{setContent:function(_44a,_44b,_44c){_44c=_44c||this.duration;if(this.slideAnim){if(this.slideAnim.status()!="playing"){this.slideAnim.stop();}if(this.slideAnim.status()=="playing"||(this.fadeAnim&&this.fadeAnim.status()=="playing")){setTimeout(dojo.hitch(this,function(){this.setContent(_44a,_44b,_44c);}),50);return;}}for(var type in this.messageTypes){dojo.removeClass(this.containerNode,"dijitToaster"+this._capitalize(this.messageTypes[type]));}dojo.style(this.containerNode,"opacity",1);this._setContent(_44a,_44b);dojo.addClass(this.containerNode,"dijitToaster"+this._capitalize(_44b||this.defaultType));this.show();var _44d=dojo.marginBox(this.containerNode);this._cancelHideTimer();if(this.isVisible){this._placeClip();if(!this._stickyMessage){this._setHideTimer(_44c);}}else{var _44e=this.containerNode.style;var pd=this.positionDirection;if(pd.indexOf("-up")>=0){_44e.left=0+"px";_44e.top=_44d.h+10+"px";}else{if(pd.indexOf("-left")>=0){_44e.left=_44d.w+10+"px";_44e.top=0+"px";}else{if(pd.indexOf("-right")>=0){_44e.left=0-_44d.w-10+"px";_44e.top=0+"px";}else{if(pd.indexOf("-down")>=0){_44e.left=0+"px";_44e.top=0-_44d.h-10+"px";}else{throw new Error(this.id+".positionDirection is invalid: "+pd);}}}}this.slideAnim=dojo.fx.slideTo({node:this.containerNode,top:0,left:0,duration:this.slideDuration});this.connect(this.slideAnim,"onEnd",function(_44f,anim){this.fadeAnim=dojo.fadeOut({node:this.containerNode,duration:1000});this.connect(this.fadeAnim,"onEnd",function(evt){this.isVisible=false;this.hide();});this._setHideTimer(_44c);this.connect(this,"onSelect",function(evt){this._cancelHideTimer();this._stickyMessage=false;this.fadeAnim.play();});this.isVisible=true;});this.slideAnim.play();}},_setContent:function(_450,_451){console.log("plugins.core.Common.Toaster._setContent    message: "+_450);console.log("plugins.core.Common.Toaster._setContent    messageType: "+_451);if(dojo.isFunction(_450)){_450(this);return;}if(_450&&this.isVisible){_450=this.contentNode.innerHTML+this.separator+"<span class='"+_451+"'>"+_450+"</span>";}else{_450="<span class='"+_451+"'>"+_450+"</span>";}console.log("plugins.core.Common.Toaster._setContent    FINAL message: "+_450);this.contentNode.innerHTML=_450;}});}if(!dojo._hasResource["plugins.core.Common.Toast"]){dojo._hasResource["plugins.core.Common.Toast"]=true;dojo.provide("plugins.core.Common.Toast");dojo.declare("plugins.core.Common.Toast",[],{setToaster:function(){console.log("Common.Toast.setToaster    this.toaster: "+this.toaster);console.dir({this_toaster:this.toaster});var _452=[dojo.moduleUrl("plugins","core/css/toaster.css")];this.loadCSS(_452);if(!this.toaster){this.toaster=new plugins.dojox.widget.Toaster({className:"toaster",positionDirection:"bl-right",duration:"500",messageTopic:"toastTopic"});}this.containerNode.style.width="100%";},toastMessage:function(args){if(!args){return;}if(!this.toaster||!this.toaster.containerNode){this.setToaster();}if(args.doToast==false){return;}var _453=args.message;if(_453==null||_453==""){return;}var type=args.type;var _454=args.duration;if(_454==null){_454=4000;}if(type!=null&&(type!="warning"&&type!="error"&&type!="fatal")){return;}var _455="toastTopic";try{dojo.publish(_455,[{message:_453,type:type,duration:_454}]);}catch(error){}},toast:function(_456){if(_456.error){var args={message:_456.error,type:"error"};if(_456.duration!=null){args.duration=_456.duration;}this.toastMessage(args);}else{var args={message:_456.status,type:"warning"};if(_456.duration!=null){args.duration=_456.duration;}this.toastMessage(args);}},toastError:function(_457){this.toastMessage({message:_457,type:"error"});},toastInfo:function(info){this.toastMessage({message:info,type:"warning"});},error:function(_458){this.toastMessage({message:_458,type:"error"});},warning:function(_459){this.toastMessage({message:_459,type:"warning"});}});}if(!dojo._hasResource["plugins.core.Common.Util"]){dojo._hasResource["plugins.core.Common.Util"]=true;dojo.provide("plugins.core.Common.Util");dojo.declare("plugins.core.Common.Util",[],{setLoadPanels:function(args){if(!args.inputs){return;}this.inputs=args.inputs;var _45a=args.inputs.split(";");console.log("Common.Util.setLoadPanels    array: ");console.dir({array:_45a});var _45b={};for(i=0;i<_45a.length+1;i++){console.log("Common.Util.setLoadPanels    array: ");_45b[_45a[i]]=1;}console.log("Common.Util.setLoadPanels    loadPanels: ");console.dir({loadPanels:_45b});this.loadPanels=_45b;},doPut:function(_45c){console.log("    Common.Util.doPut    inputs: ");console.dir({inputs:_45c});var _45d=function(){};if(_45c.callback!=null){_45d=_45c.callback;}var _45e=true;if(_45c.doToast!=null){_45e=_45c.doToast;}var url=_45c.url;url+="?";url+=Math.floor(Math.random()*100000);var _45f=_45c.query;var _460=_45c.timeout?_45c.timeout:null;var _461=_45c.handleAs?_45c.handleAs:"json";var sync=_45c.sync?_45c.sync:false;dojo.xhrPut({url:url,contentType:"text",preventCache:true,sync:sync,handleAs:_461,putData:dojo.toJson(_45f),timeout:_460,load:function(_462,_463){console.log("    Common.Util.doPut    response: ");console.dir({response:_462});if(_462.error){if(_45e){console.log("    Common.Util.doPut    DOING Agua.toastMessage ERROR");Agua.toastMessage({message:_462.error,type:"error",duration:10000});}}else{if(_462.status){if(_45e){console.log("    Common.Util.doPut    DOING Agua.toastMessage STATUS");Agua.toastMessage({message:_462.status,type:"warning",duration:10000});if(Agua.loader!=null){Agua.loader._hide();}}}console.log("    Common.Util.doPut    DOING callback(response, inputs)");_45d(_462,_45c);}},error:function(_464,_465){console.log("    Common.Util.doPut    Error with put. Response: "+_464);return _464;}});},getClassName:function(_466){var _467=new String(_466);var name;if(_467.match(/^\[Widget\s+(\S+),/)){name=_467.match(/^\[Widget\s+(\S+),/)[1];}return name;},showMessage:function(_468,_469){console.log("    Common.Util.showMessage    Polling message: "+_468);},downloadFile:function(_46a,_46b){var _46c="?mode=downloadFile";if(_46b!=null){_46c+="&username="+_46b;_46c+="&requestor="+Agua.cookie("username");}else{_46c+="&username="+Agua.cookie("username");}_46c+="&sessionid="+Agua.cookie("sessionid");_46c+="&filepath="+_46a;var url=Agua.cgiUrl+"download.cgi";var args={method:"GET",url:url+_46c,handleAs:"json",timeout:10000,load:this.handleDownload};console.log("ParameterRow.downloadFile     args: ",args);console.log("ParameterRow.downloadFile     Doing dojo.io.iframe.send(args))");var _46d=dojo.io.iframe.send(args);},loadCSS:function(_46e){if(_46e==null){_46e=this.cssFiles;}for(var i in _46e){this.loadCSSFile(_46e[i]);}},loadCSSFile:function(_46f){if(Agua.loadedCssFiles==null||!Agua.loadedCssFiles){Agua.loadedCssFiles=new Object;}if(!Agua.loadedCssFiles[_46f]){console.log("    Common.Util.loadCSSFile    Loading cssFile: "+_46f);var _470=document.createElement("link");_470.type="text/css";_470.rel="stylesheet";_470.href=_46f;document.getElementsByTagName("head")[0].appendChild(_470);Agua.loadedCssFiles[_46f]=1;}else{}return Agua.loadedCssFiles;},randomiseUrl:function(url){url+="?dojo.preventCache=1266358799763";url+=Math.floor(Math.random()*1000000000000);return url;},killPopup:function(_471){var _472="widget_"+_471.id+"_dropdown";var _473=dojo.byId(_472);if(_473!=null){var _474=dijit.byNode(_473.childNodes[0]);dijit.popup.close(_474);}},});}if(!dojo._hasResource["plugins.core.Common"]){dojo._hasResource["plugins.core.Common"]=true;dojo.provide("plugins.core.Common");dojo.declare("plugins.core.Common",[plugins.core.Common.Array,plugins.core.Common.ComboBox,plugins.core.Common.Date,plugins.core.Common.Sort,plugins.core.Common.Text,plugins.core.Common.Toast,plugins.core.Common.Util],{loadedCssFiles:null,});}if(!dojo._hasResource["dojo.regexp"]){dojo._hasResource["dojo.regexp"]=true;dojo.provide("dojo.regexp");dojo.getObject("regexp",true,dojo);dojo.regexp.escapeString=function(str,_475){return str.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,function(ch){if(_475&&_475.indexOf(ch)!=-1){return ch;}return "\\"+ch;});};dojo.regexp.buildGroupRE=function(arr,re,_476){if(!(arr instanceof Array)){return re(arr);}var b=[];for(var i=0;i<arr.length;i++){b.push(re(arr[i]));}return dojo.regexp.group(b.join("|"),_476);};dojo.regexp.group=function(_477,_478){return "("+(_478?"?:":"")+_477+")";};}if(!dojo._hasResource["dijit.Tooltip"]){dojo._hasResource["dijit.Tooltip"]=true;dojo.provide("dijit.Tooltip");dojo.declare("dijit._MasterTooltip",[dijit._Widget,dijit._Templated],{duration:dijit.defaultDuration,templateString:dojo.cache("dijit","templates/Tooltip.html","<div class=\"dijitTooltip dijitTooltipLeft\" id=\"dojoTooltip\"\n\t><div class=\"dijitTooltipContainer dijitTooltipContents\" dojoAttachPoint=\"containerNode\" role='alert'></div\n\t><div class=\"dijitTooltipConnector\" dojoAttachPoint=\"connectorNode\"></div\n></div>\n"),postCreate:function(){dojo.body().appendChild(this.domNode);this.bgIframe=new dijit.BackgroundIframe(this.domNode);this.fadeIn=dojo.fadeIn({node:this.domNode,duration:this.duration,onEnd:dojo.hitch(this,"_onShow")});this.fadeOut=dojo.fadeOut({node:this.domNode,duration:this.duration,onEnd:dojo.hitch(this,"_onHide")});},show:function(_479,_47a,_47b,rtl){if(this.aroundNode&&this.aroundNode===_47a){return;}this.domNode.width="auto";if(this.fadeOut.status()=="playing"){this._onDeck=arguments;return;}this.containerNode.innerHTML=_479;var pos=dijit.placeOnScreenAroundElement(this.domNode,_47a,dijit.getPopupAroundAlignment((_47b&&_47b.length)?_47b:dijit.Tooltip.defaultPosition,!rtl),dojo.hitch(this,"orient"));dojo.style(this.domNode,"opacity",0);this.fadeIn.play();this.isShowingNow=true;this.aroundNode=_47a;},orient:function(node,_47c,_47d,_47e,_47f){this.connectorNode.style.top="";var _480=_47e.w-this.connectorNode.offsetWidth;node.className="dijitTooltip "+{"BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft"}[_47c+"-"+_47d];this.domNode.style.width="auto";var size=dojo.contentBox(this.domNode);var _481=Math.min((Math.max(_480,1)),size.w);var _482=_481<size.w;this.domNode.style.width=_481+"px";if(_482){this.containerNode.style.overflow="auto";var _483=this.containerNode.scrollWidth;this.containerNode.style.overflow="visible";if(_483>_481){_483=_483+dojo.style(this.domNode,"paddingLeft")+dojo.style(this.domNode,"paddingRight");this.domNode.style.width=_483+"px";}}if(_47d.charAt(0)=="B"&&_47c.charAt(0)=="B"){var mb=dojo.marginBox(node);var _484=this.connectorNode.offsetHeight;if(mb.h>_47e.h){var _485=_47e.h-(_47f.h/2)-(_484/2);this.connectorNode.style.top=_485+"px";this.connectorNode.style.bottom="";}else{this.connectorNode.style.bottom=Math.min(Math.max(_47f.h/2-_484/2,0),mb.h-_484)+"px";this.connectorNode.style.top="";}}else{this.connectorNode.style.top="";this.connectorNode.style.bottom="";}return Math.max(0,size.w-_480);},_onShow:function(){if(dojo.isIE){this.domNode.style.filter="";}},hide:function(_486){if(this._onDeck&&this._onDeck[1]==_486){this._onDeck=null;}else{if(this.aroundNode===_486){this.fadeIn.stop();this.isShowingNow=false;this.aroundNode=null;this.fadeOut.play();}else{}}},_onHide:function(){this.domNode.style.cssText="";this.containerNode.innerHTML="";if(this._onDeck){this.show.apply(this,this._onDeck);this._onDeck=null;}}});dijit.showTooltip=function(_487,_488,_489,rtl){if(!dijit._masterTT){dijit._masterTT=new dijit._MasterTooltip();}return dijit._masterTT.show(_487,_488,_489,rtl);};dijit.hideTooltip=function(_48a){if(!dijit._masterTT){dijit._masterTT=new dijit._MasterTooltip();}return dijit._masterTT.hide(_48a);};dojo.declare("dijit.Tooltip",dijit._Widget,{label:"",showDelay:400,connectId:[],position:[],_setConnectIdAttr:function(_48b){dojo.forEach(this._connections||[],function(_48c){dojo.forEach(_48c,dojo.hitch(this,"disconnect"));},this);var ary=dojo.isArrayLike(_48b)?_48b:(_48b?[_48b]:[]);this._connections=dojo.map(ary,function(id){var node=dojo.byId(id);return node?[this.connect(node,"onmouseenter","_onTargetMouseEnter"),this.connect(node,"onmouseleave","_onTargetMouseLeave"),this.connect(node,"onfocus","_onTargetFocus"),this.connect(node,"onblur","_onTargetBlur")]:[];},this);this._set("connectId",_48b);this._connectIds=ary;},addTarget:function(node){var id=node.id||node;if(dojo.indexOf(this._connectIds,id)==-1){this.set("connectId",this._connectIds.concat(id));}},removeTarget:function(node){var id=node.id||node,idx=dojo.indexOf(this._connectIds,id);if(idx>=0){this._connectIds.splice(idx,1);this.set("connectId",this._connectIds);}},buildRendering:function(){this.inherited(arguments);dojo.addClass(this.domNode,"dijitTooltipData");},startup:function(){this.inherited(arguments);var ids=this.connectId;dojo.forEach(dojo.isArrayLike(ids)?ids:[ids],this.addTarget,this);},_onTargetMouseEnter:function(e){this._onHover(e);},_onTargetMouseLeave:function(e){this._onUnHover(e);},_onTargetFocus:function(e){this._focus=true;this._onHover(e);},_onTargetBlur:function(e){this._focus=false;this._onUnHover(e);},_onHover:function(e){if(!this._showTimer){var _48d=e.target;this._showTimer=setTimeout(dojo.hitch(this,function(){this.open(_48d);}),this.showDelay);}},_onUnHover:function(e){if(this._focus){return;}if(this._showTimer){clearTimeout(this._showTimer);delete this._showTimer;}this.close();},open:function(_48e){if(this._showTimer){clearTimeout(this._showTimer);delete this._showTimer;}dijit.showTooltip(this.label||this.domNode.innerHTML,_48e,this.position,!this.isLeftToRight());this._connectNode=_48e;this.onShow(_48e,this.position);},close:function(){if(this._connectNode){dijit.hideTooltip(this._connectNode);delete this._connectNode;this.onHide();}if(this._showTimer){clearTimeout(this._showTimer);delete this._showTimer;}},onShow:function(_48f,_490){},onHide:function(){},uninitialize:function(){this.close();this.inherited(arguments);}});dijit.Tooltip.defaultPosition=["after","before"];}if(!dojo._hasResource["dijit.form.ValidationTextBox"]){dojo._hasResource["dijit.form.ValidationTextBox"]=true;dojo.provide("dijit.form.ValidationTextBox");dojo.declare("dijit.form.ValidationTextBox",dijit.form.TextBox,{templateString:dojo.cache("dijit.form","templates/ValidationTextBox.html","<div class=\"dijit dijitReset dijitInlineTable dijitLeft\"\n\tid=\"widget_${id}\" role=\"presentation\"\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class=\"dijitReset dijitInputInner\" dojoAttachPoint='textbox,focusNode' autocomplete=\"off\"\n\t\t\t${!nameAttrSetting} type='${type}'\n\t/></div\n></div>\n"),baseClass:"dijitTextBox dijitValidationTextBox",required:false,promptMessage:"",invalidMessage:"$_unset_$",missingMessage:"$_unset_$",message:"",constraints:{},regExp:".*",regExpGen:function(_491){return this.regExp;},state:"",tooltipPosition:[],_setValueAttr:function(){this.inherited(arguments);this.validate(this._focused);},validator:function(_492,_493){return (new RegExp("^(?:"+this.regExpGen(_493)+")"+(this.required?"":"?")+"$")).test(_492)&&(!this.required||!this._isEmpty(_492))&&(this._isEmpty(_492)||this.parse(_492,_493)!==undefined);},_isValidSubset:function(){return this.textbox.value.search(this._partialre)==0;},isValid:function(_494){var _495=this.validator(this.textbox.value,this.constraints);return _495;},_isEmpty:function(_496){var _497=(this.trim?/^\s*$/:/^$/).test(_496);return (this.trim?/^\s*$/:/^$/).test(_496);},getErrorMessage:function(_498){return (this.required&&this._isEmpty(this.textbox.value))?this.missingMessage:this.invalidMessage;},getPromptMessage:function(_499){return this.promptMessage;},_maskValidSubsetError:true,validate:function(_49a){var _49b="";var _49c=this.disabled||this.isValid(_49a);if(_49c){this._maskValidSubsetError=true;}var _49d=this._isEmpty(this.textbox.value);var _49e=!_49c&&_49a&&this._isValidSubset();this._set("state",_49c?"":(((((!this._hasBeenBlurred||_49a)&&_49d)||_49e)&&this._maskValidSubsetError)?"Incomplete":"Error"));dijit.setWaiState(this.focusNode,"invalid",_49c?"false":"true");if(this.state=="Error"){this._maskValidSubsetError=_49a&&_49e;_49b=this.getErrorMessage(_49a);}else{if(this.state=="Incomplete"){_49b=this.getPromptMessage(_49a);this._maskValidSubsetError=!this._hasBeenBlurred||_49a;}else{if(_49d){_49b=this.getPromptMessage(_49a);}}}this.set("message",_49b);return _49c;},displayMessage:function(_49f){dijit.hideTooltip(this.domNode);if(_49f&&this._focused){dijit.showTooltip(_49f,this.domNode,this.tooltipPosition,!this.isLeftToRight());}},_refreshState:function(){this.validate(this._focused);this.inherited(arguments);},constructor:function(){this.constraints={};},_setConstraintsAttr:function(_4a0){if(!_4a0.locale&&this.lang){_4a0.locale=this.lang;}this._set("constraints",_4a0);this._computePartialRE();},_computePartialRE:function(){var p=this.regExpGen(this.constraints);this.regExp=p;var _4a1="";if(p!=".*"){this.regExp.replace(/\\.|\[\]|\[.*?[^\\]{1}\]|\{.*?\}|\(\?[=:!]|./g,function(re){switch(re.charAt(0)){case "{":case "+":case "?":case "*":case "^":case "$":case "|":case "(":_4a1+=re;break;case ")":_4a1+="|$)";break;default:_4a1+="(?:"+re+"|$)";break;}});}try{"".search(_4a1);}catch(e){_4a1=this.regExp;console.warn("RegExp error in "+this.declaredClass+": "+this.regExp);}this._partialre="^(?:"+_4a1+")$";},postMixInProperties:function(){this.inherited(arguments);this.messages=dojo.i18n.getLocalization("dijit.form","validate",this.lang);if(this.invalidMessage=="$_unset_$"){this.invalidMessage=this.messages.invalidMessage;}if(!this.invalidMessage){this.invalidMessage=this.promptMessage;}if(this.missingMessage=="$_unset_$"){this.missingMessage=this.messages.missingMessage;}if(!this.missingMessage){this.missingMessage=this.invalidMessage;}this._setConstraintsAttr(this.constraints);},_setDisabledAttr:function(_4a2){this.inherited(arguments);this._refreshState();},_setRequiredAttr:function(_4a3){this._set("required",_4a3);dijit.setWaiState(this.focusNode,"required",_4a3);this._refreshState();},_setMessageAttr:function(_4a4){this._set("message",_4a4);this.displayMessage(_4a4);},reset:function(){this._maskValidSubsetError=true;this.inherited(arguments);},_onBlur:function(){this.displayMessage("");this.inherited(arguments);}});dojo.declare("dijit.form.MappedTextBox",dijit.form.ValidationTextBox,{postMixInProperties:function(){this.inherited(arguments);this.nameAttrSetting="";},serialize:function(val,_4a5){return val.toString?val.toString():"";},toString:function(){var val=this.filter(this.get("value"));return val!=null?(typeof val=="string"?val:this.serialize(val,this.constraints)):"";},validate:function(){this.valueNode.value=this.toString();return this.inherited(arguments);},buildRendering:function(){this.inherited(arguments);this.valueNode=dojo.place("<input type='hidden'"+(this.name?" name='"+this.name.replace(/'/g,"&quot;")+"'":"")+"/>",this.textbox,"after");},reset:function(){this.valueNode.value="";this.inherited(arguments);}});dojo.declare("dijit.form.RangeBoundTextBox",dijit.form.MappedTextBox,{rangeMessage:"",rangeCheck:function(_4a6,_4a7){return ("min" in _4a7?(this.compare(_4a6,_4a7.min)>=0):true)&&("max" in _4a7?(this.compare(_4a6,_4a7.max)<=0):true);},isInRange:function(_4a8){return this.rangeCheck(this.get("value"),this.constraints);},_isDefinitelyOutOfRange:function(){var val=this.get("value");var _4a9=false;var _4aa=false;if("min" in this.constraints){var min=this.constraints.min;min=this.compare(val,((typeof min=="number")&&min>=0&&val!=0)?0:min);_4a9=(typeof min=="number")&&min<0;}if("max" in this.constraints){var max=this.constraints.max;max=this.compare(val,((typeof max!="number")||max>0)?max:0);_4aa=(typeof max=="number")&&max>0;}return _4a9||_4aa;},_isValidSubset:function(){return this.inherited(arguments)&&!this._isDefinitelyOutOfRange();},isValid:function(_4ab){return this.inherited(arguments)&&((this._isEmpty(this.textbox.value)&&!this.required)||this.isInRange(_4ab));},getErrorMessage:function(_4ac){var v=this.get("value");if(v!==null&&v!==""&&v!==undefined&&(typeof v!="number"||!isNaN(v))&&!this.isInRange(_4ac)){return this.rangeMessage;}return this.inherited(arguments);},postMixInProperties:function(){this.inherited(arguments);if(!this.rangeMessage){this.messages=dojo.i18n.getLocalization("dijit.form","validate",this.lang);this.rangeMessage=this.messages.rangeMessage;}},_setConstraintsAttr:function(_4ad){this.inherited(arguments);if(this.focusNode){if(this.constraints.min!==undefined){dijit.setWaiState(this.focusNode,"valuemin",this.constraints.min);}else{dijit.removeWaiState(this.focusNode,"valuemin");}if(this.constraints.max!==undefined){dijit.setWaiState(this.focusNode,"valuemax",this.constraints.max);}else{dijit.removeWaiState(this.focusNode,"valuemax");}}},_setValueAttr:function(_4ae,_4af){dijit.setWaiState(this.focusNode,"valuenow",_4ae);this.inherited(arguments);}});}if(!dojo._hasResource["dijit.form.ComboBox"]){dojo._hasResource["dijit.form.ComboBox"]=true;dojo.provide("dijit.form.ComboBox");dojo.declare("dijit.form.ComboBoxMixin",dijit._HasDropDown,{item:null,pageSize:Infinity,store:null,fetchProperties:{},query:{},autoComplete:true,highlightMatch:"first",searchDelay:100,searchAttr:"name",labelAttr:"",labelType:"text",queryExpr:"${0}*",ignoreCase:true,hasDownArrow:true,templateString:dojo.cache("dijit.form","templates/DropDownBox.html","<div class=\"dijit dijitReset dijitInlineTable dijitLeft\"\n\tid=\"widget_${id}\"\n\trole=\"combobox\"\n\t><div class='dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer'\n\t\tdojoAttachPoint=\"_buttonNode, _popupStateNode\" role=\"presentation\"\n\t\t><input class=\"dijitReset dijitInputField dijitArrowButtonInner\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t\t${_buttonInputDisabled}\n\t/></div\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class='dijitReset dijitInputInner' ${!nameAttrSetting} type=\"text\" autocomplete=\"off\"\n\t\t\tdojoAttachPoint=\"textbox,focusNode\" role=\"textbox\" aria-haspopup=\"true\"\n\t/></div\n></div>\n"),baseClass:"dijitTextBox dijitComboBox",dropDownClass:"dijit.form._ComboBoxMenu",cssStateNodes:{"_buttonNode":"dijitDownArrowButton"},maxHeight:-1,_stopClickEvents:false,_getCaretPos:function(_4b0){var pos=0;if(typeof (_4b0.selectionStart)=="number"){pos=_4b0.selectionStart;}else{if(dojo.isIE){var tr=dojo.doc.selection.createRange().duplicate();var ntr=_4b0.createTextRange();tr.move("character",0);ntr.move("character",0);try{ntr.setEndPoint("EndToEnd",tr);pos=String(ntr.text).replace(/\r/g,"").length;}catch(e){}}}return pos;},_setCaretPos:function(_4b1,_4b2){_4b2=parseInt(_4b2);dijit.selectInputText(_4b1,_4b2,_4b2);},_setDisabledAttr:function(_4b3){this.inherited(arguments);dijit.setWaiState(this.domNode,"disabled",_4b3);},_abortQuery:function(){if(this.searchTimer){clearTimeout(this.searchTimer);this.searchTimer=null;}if(this._fetchHandle){if(this._fetchHandle.abort){this._fetchHandle.abort();}this._fetchHandle=null;}},_onInput:function(evt){if(!this.searchTimer&&(evt.type=="paste"||evt.type=="input")&&this._lastInput!=this.textbox.value){this.searchTimer=setTimeout(dojo.hitch(this,function(){this._onKey({charOrCode:229});}),100);}this.inherited(arguments);},_onKey:function(evt){var key=evt.charOrCode;if(evt.altKey||((evt.ctrlKey||evt.metaKey)&&(key!="x"&&key!="v"))||key==dojo.keys.SHIFT){return;}var _4b4=false;var pw=this.dropDown;var dk=dojo.keys;var _4b5=null;this._prev_key_backspace=false;this._abortQuery();this.inherited(arguments);if(this._opened){_4b5=pw.getHighlightedOption();}switch(key){case dk.PAGE_DOWN:case dk.DOWN_ARROW:case dk.PAGE_UP:case dk.UP_ARROW:if(this._opened){this._announceOption(_4b5);}dojo.stopEvent(evt);break;case dk.ENTER:if(_4b5){if(_4b5==pw.nextButton){this._nextSearch(1);dojo.stopEvent(evt);break;}else{if(_4b5==pw.previousButton){this._nextSearch(-1);dojo.stopEvent(evt);break;}}}else{this._setBlurValue();this._setCaretPos(this.focusNode,this.focusNode.value.length);}if(this._opened||this._fetchHandle){evt.preventDefault();}case dk.TAB:var _4b6=this.get("displayedValue");if(pw&&(_4b6==pw._messages["previousMessage"]||_4b6==pw._messages["nextMessage"])){break;}if(_4b5){this._selectOption();}if(this._opened){this._lastQuery=null;this.closeDropDown();}break;case " ":if(_4b5){dojo.stopEvent(evt);this._selectOption();this.closeDropDown();}else{_4b4=true;}break;case dk.DELETE:case dk.BACKSPACE:this._prev_key_backspace=true;_4b4=true;break;default:_4b4=typeof key=="string"||key==229;}if(_4b4){this.item=undefined;this.searchTimer=setTimeout(dojo.hitch(this,"_startSearchFromInput"),1);}},_autoCompleteText:function(text){var fn=this.focusNode;dijit.selectInputText(fn,fn.value.length);var _4b7=this.ignoreCase?"toLowerCase":"substr";if(text[_4b7](0).indexOf(this.focusNode.value[_4b7](0))==0){var cpos=this._getCaretPos(fn);if((cpos+1)>fn.value.length){fn.value=text;dijit.selectInputText(fn,cpos);}}else{fn.value=text;dijit.selectInputText(fn);}},_openResultList:function(_4b8,_4b9){this._fetchHandle=null;if(this.disabled||this.readOnly||(_4b9.query[this.searchAttr]!=this._lastQuery)){return;}var _4ba=this.dropDown._highlighted_option&&dojo.hasClass(this.dropDown._highlighted_option,"dijitMenuItemSelected");this.dropDown.clearResultList();if(!_4b8.length&&!this._maxOptions){this.closeDropDown();return;}_4b9._maxOptions=this._maxOptions;var _4bb=this.dropDown.createOptions(_4b8,_4b9,dojo.hitch(this,"_getMenuLabelFromItem"));this._showResultList();if(_4b9.direction){if(1==_4b9.direction){this.dropDown.highlightFirstOption();}else{if(-1==_4b9.direction){this.dropDown.highlightLastOption();}}if(_4ba){this._announceOption(this.dropDown.getHighlightedOption());}}else{if(this.autoComplete&&!this._prev_key_backspace&&!/^[*]+$/.test(_4b9.query[this.searchAttr])){this._announceOption(_4bb[1]);}}},_showResultList:function(){this.closeDropDown(true);this.displayMessage("");this.openDropDown();dijit.setWaiState(this.domNode,"expanded","true");},loadDropDown:function(_4bc){this._startSearchAll();},isLoaded:function(){return false;},closeDropDown:function(){this._abortQuery();if(this._opened){this.inherited(arguments);dijit.setWaiState(this.domNode,"expanded","false");dijit.removeWaiState(this.focusNode,"activedescendant");}},_setBlurValue:function(){var _4bd=this.get("displayedValue");var pw=this.dropDown;if(pw&&(_4bd==pw._messages["previousMessage"]||_4bd==pw._messages["nextMessage"])){this._setValueAttr(this._lastValueReported,true);}else{if(typeof this.item=="undefined"){this.item=null;this.set("displayedValue",_4bd);}else{if(this.value!=this._lastValueReported){dijit.form._FormValueWidget.prototype._setValueAttr.call(this,this.value,true);}this._refreshState();}}},_onBlur:function(){this.closeDropDown();this.inherited(arguments);},_setItemAttr:function(item,_4be,_4bf){if(!_4bf){_4bf=this.store.getValue(item,this.searchAttr);}var _4c0=this._getValueField()!=this.searchAttr?this.store.getIdentity(item):_4bf;this._set("item",item);dijit.form.ComboBox.superclass._setValueAttr.call(this,_4c0,_4be,_4bf);},_announceOption:function(node){if(!node){return;}var _4c1;if(node==this.dropDown.nextButton||node==this.dropDown.previousButton){_4c1=node.innerHTML;this.item=undefined;this.value="";}else{_4c1=this.store.getValue(node.item,this.searchAttr).toString();this.set("item",node.item,false,_4c1);}this.focusNode.value=this.focusNode.value.substring(0,this._lastInput.length);dijit.setWaiState(this.focusNode,"activedescendant",dojo.attr(node,"id"));this._autoCompleteText(_4c1);},_selectOption:function(evt){if(evt){this._announceOption(evt.target);}this.closeDropDown();this._setCaretPos(this.focusNode,this.focusNode.value.length);dijit.form._FormValueWidget.prototype._setValueAttr.call(this,this.value,true);},_startSearchAll:function(){this._startSearch("");},_startSearchFromInput:function(){this._startSearch(this.focusNode.value.replace(/([\\\*\?])/g,"\\$1"));},_getQueryString:function(text){return dojo.string.substitute(this.queryExpr,[text]);},_startSearch:function(key){if(!this.dropDown){var _4c2=this.id+"_popup",_4c3=dojo.getObject(this.dropDownClass,false);this.dropDown=new _4c3({onChange:dojo.hitch(this,this._selectOption),id:_4c2,dir:this.dir});dijit.removeWaiState(this.focusNode,"activedescendant");dijit.setWaiState(this.textbox,"owns",_4c2);}var _4c4=dojo.clone(this.query);this._lastInput=key;this._lastQuery=_4c4[this.searchAttr]=this._getQueryString(key);this.searchTimer=setTimeout(dojo.hitch(this,function(_4c5,_4c6){this.searchTimer=null;var _4c7={queryOptions:{ignoreCase:this.ignoreCase,deep:true},query:_4c5,onBegin:dojo.hitch(this,"_setMaxOptions"),onComplete:dojo.hitch(this,"_openResultList"),onError:function(_4c8){_4c6._fetchHandle=null;console.error("dijit.form.ComboBox: "+_4c8);_4c6.closeDropDown();},start:0,count:this.pageSize};dojo.mixin(_4c7,_4c6.fetchProperties);this._fetchHandle=_4c6.store.fetch(_4c7);var _4c9=function(_4ca,_4cb){_4ca.start+=_4ca.count*_4cb;_4ca.direction=_4cb;this._fetchHandle=this.store.fetch(_4ca);this.focus();};this._nextSearch=this.dropDown.onPage=dojo.hitch(this,_4c9,this._fetchHandle);},_4c4,this),this.searchDelay);},_setMaxOptions:function(size,_4cc){this._maxOptions=size;},_getValueField:function(){return this.searchAttr;},constructor:function(){this.query={};this.fetchProperties={};},postMixInProperties:function(){if(!this.store){var _4cd=this.srcNodeRef;this.store=new dijit.form._ComboBoxDataStore(_4cd);if(!("value" in this.params)){var item=(this.item=this.store.fetchSelectedItem());if(item){var _4ce=this._getValueField();this.value=this.store.getValue(item,_4ce);}}}this.inherited(arguments);},postCreate:function(){var _4cf=dojo.query("label[for=\""+this.id+"\"]");if(_4cf.length){_4cf[0].id=(this.id+"_label");dijit.setWaiState(this.domNode,"labelledby",_4cf[0].id);}this.inherited(arguments);},_setHasDownArrowAttr:function(val){this.hasDownArrow=val;this._buttonNode.style.display=val?"":"none";},_getMenuLabelFromItem:function(item){var _4d0=this.labelFunc(item,this.store),_4d1=this.labelType;if(this.highlightMatch!="none"&&this.labelType=="text"&&this._lastInput){_4d0=this.doHighlight(_4d0,this._escapeHtml(this._lastInput));_4d1="html";}return {html:_4d1=="html",label:_4d0};},doHighlight:function(_4d2,find){var _4d3=(this.ignoreCase?"i":"")+(this.highlightMatch=="all"?"g":""),i=this.queryExpr.indexOf("${0}");find=dojo.regexp.escapeString(find);return this._escapeHtml(_4d2).replace(new RegExp((i==0?"^":"")+"("+find+")"+(i==(this.queryExpr.length-4)?"$":""),_4d3),"<span class=\"dijitComboBoxHighlightMatch\">$1</span>");},_escapeHtml:function(str){str=String(str).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");return str;},reset:function(){this.item=null;this.inherited(arguments);},labelFunc:function(item,_4d4){return _4d4.getValue(item,this.labelAttr||this.searchAttr).toString();}});dojo.declare("dijit.form._ComboBoxMenu",[dijit._Widget,dijit._Templated,dijit._CssStateMixin],{templateString:"<ul class='dijitReset dijitMenu' dojoAttachEvent='onmousedown:_onMouseDown,onmouseup:_onMouseUp,onmouseover:_onMouseOver,onmouseout:_onMouseOut' style='overflow: \"auto\"; overflow-x: \"hidden\";'>"+"<li class='dijitMenuItem dijitMenuPreviousButton' dojoAttachPoint='previousButton' role='option'></li>"+"<li class='dijitMenuItem dijitMenuNextButton' dojoAttachPoint='nextButton' role='option'></li>"+"</ul>",_messages:null,baseClass:"dijitComboBoxMenu",postMixInProperties:function(){this.inherited(arguments);this._messages=dojo.i18n.getLocalization("dijit.form","ComboBox",this.lang);},buildRendering:function(){this.inherited(arguments);this.previousButton.innerHTML=this._messages["previousMessage"];this.nextButton.innerHTML=this._messages["nextMessage"];},_setValueAttr:function(_4d5){this.value=_4d5;this.onChange(_4d5);},onChange:function(_4d6){},onPage:function(_4d7){},onClose:function(){this._blurOptionNode();},_createOption:function(item,_4d8){var _4d9=dojo.create("li",{"class":"dijitReset dijitMenuItem"+(this.isLeftToRight()?"":" dijitMenuItemRtl"),role:"option"});var _4da=_4d8(item);if(_4da.html){_4d9.innerHTML=_4da.label;}else{_4d9.appendChild(dojo.doc.createTextNode(_4da.label));}if(_4d9.innerHTML==""){_4d9.innerHTML="&nbsp;";}_4d9.item=item;return _4d9;},createOptions:function(_4db,_4dc,_4dd){this.previousButton.style.display=(_4dc.start==0)?"none":"";dojo.attr(this.previousButton,"id",this.id+"_prev");dojo.forEach(_4db,function(item,i){var _4de=this._createOption(item,_4dd);dojo.attr(_4de,"id",this.id+i);this.domNode.insertBefore(_4de,this.nextButton);},this);var _4df=false;if(_4dc._maxOptions&&_4dc._maxOptions!=-1){if((_4dc.start+_4dc.count)<_4dc._maxOptions){_4df=true;}else{if((_4dc.start+_4dc.count)>_4dc._maxOptions&&_4dc.count==_4db.length){_4df=true;}}}else{if(_4dc.count==_4db.length){_4df=true;}}this.nextButton.style.display=_4df?"":"none";dojo.attr(this.nextButton,"id",this.id+"_next");return this.domNode.childNodes;},clearResultList:function(){while(this.domNode.childNodes.length>2){this.domNode.removeChild(this.domNode.childNodes[this.domNode.childNodes.length-2]);}this._blurOptionNode();},_onMouseDown:function(evt){dojo.stopEvent(evt);},_onMouseUp:function(evt){if(evt.target===this.domNode||!this._highlighted_option){return;}else{if(evt.target==this.previousButton){this._blurOptionNode();this.onPage(-1);}else{if(evt.target==this.nextButton){this._blurOptionNode();this.onPage(1);}else{var tgt=evt.target;while(!tgt.item){tgt=tgt.parentNode;}this._setValueAttr({target:tgt},true);}}}},_onMouseOver:function(evt){if(evt.target===this.domNode){return;}var tgt=evt.target;if(!(tgt==this.previousButton||tgt==this.nextButton)){while(!tgt.item){tgt=tgt.parentNode;}}this._focusOptionNode(tgt);},_onMouseOut:function(evt){if(evt.target===this.domNode){return;}this._blurOptionNode();},_focusOptionNode:function(node){if(this._highlighted_option!=node){this._blurOptionNode();this._highlighted_option=node;dojo.addClass(this._highlighted_option,"dijitMenuItemSelected");}},_blurOptionNode:function(){if(this._highlighted_option){dojo.removeClass(this._highlighted_option,"dijitMenuItemSelected");this._highlighted_option=null;}},_highlightNextOption:function(){if(!this.getHighlightedOption()){var fc=this.domNode.firstChild;this._focusOptionNode(fc.style.display=="none"?fc.nextSibling:fc);}else{var ns=this._highlighted_option.nextSibling;if(ns&&ns.style.display!="none"){this._focusOptionNode(ns);}else{this.highlightFirstOption();}}dojo.window.scrollIntoView(this._highlighted_option);},highlightFirstOption:function(){var _4e0=this.domNode.firstChild;var _4e1=_4e0.nextSibling;this._focusOptionNode(_4e1.style.display=="none"?_4e0:_4e1);dojo.window.scrollIntoView(this._highlighted_option);},highlightLastOption:function(){this._focusOptionNode(this.domNode.lastChild.previousSibling);dojo.window.scrollIntoView(this._highlighted_option);},_highlightPrevOption:function(){if(!this.getHighlightedOption()){var lc=this.domNode.lastChild;this._focusOptionNode(lc.style.display=="none"?lc.previousSibling:lc);}else{var ps=this._highlighted_option.previousSibling;if(ps&&ps.style.display!="none"){this._focusOptionNode(ps);}else{this.highlightLastOption();}}dojo.window.scrollIntoView(this._highlighted_option);},_page:function(up){var _4e2=0;var _4e3=this.domNode.scrollTop;var _4e4=dojo.style(this.domNode,"height");if(!this.getHighlightedOption()){this._highlightNextOption();}while(_4e2<_4e4){if(up){if(!this.getHighlightedOption().previousSibling||this._highlighted_option.previousSibling.style.display=="none"){break;}this._highlightPrevOption();}else{if(!this.getHighlightedOption().nextSibling||this._highlighted_option.nextSibling.style.display=="none"){break;}this._highlightNextOption();}var _4e5=this.domNode.scrollTop;_4e2+=(_4e5-_4e3)*(up?-1:1);_4e3=_4e5;}},pageUp:function(){this._page(true);},pageDown:function(){this._page(false);},getHighlightedOption:function(){var ho=this._highlighted_option;return (ho&&ho.parentNode)?ho:null;},handleKey:function(evt){switch(evt.charOrCode){case dojo.keys.DOWN_ARROW:this._highlightNextOption();return false;case dojo.keys.PAGE_DOWN:this.pageDown();return false;case dojo.keys.UP_ARROW:this._highlightPrevOption();return false;case dojo.keys.PAGE_UP:this.pageUp();return false;default:return true;}}});dojo.declare("dijit.form.ComboBox",[dijit.form.ValidationTextBox,dijit.form.ComboBoxMixin],{_setValueAttr:function(_4e6,_4e7,_4e8){this._set("item",null);if(!_4e6){_4e6="";}dijit.form.ValidationTextBox.prototype._setValueAttr.call(this,_4e6,_4e7,_4e8);}});dojo.declare("dijit.form._ComboBoxDataStore",null,{constructor:function(root){this.root=root;if(root.tagName!="SELECT"&&root.firstChild){root=dojo.query("select",root);if(root.length>0){root=root[0];}else{this.root.innerHTML="<SELECT>"+this.root.innerHTML+"</SELECT>";root=this.root.firstChild;}this.root=root;}dojo.query("> option",root).forEach(function(node){node.innerHTML=dojo.trim(node.innerHTML);});},getValue:function(item,_4e9,_4ea){return (_4e9=="value")?item.value:(item.innerText||item.textContent||"");},isItemLoaded:function(_4eb){return true;},getFeatures:function(){return {"dojo.data.api.Read":true,"dojo.data.api.Identity":true};},_fetchItems:function(args,_4ec,_4ed){if(!args.query){args.query={};}if(!args.query.name){args.query.name="";}if(!args.queryOptions){args.queryOptions={};}var _4ee=dojo.data.util.filter.patternToRegExp(args.query.name,args.queryOptions.ignoreCase),_4ef=dojo.query("> option",this.root).filter(function(_4f0){return (_4f0.innerText||_4f0.textContent||"").match(_4ee);});if(args.sort){_4ef.sort(dojo.data.util.sorter.createSortFunction(args.sort,this));}_4ec(_4ef,args);},close:function(_4f1){return;},getLabel:function(item){return item.innerHTML;},getIdentity:function(item){return dojo.attr(item,"value");},fetchItemByIdentity:function(args){var item=dojo.query("> option[value='"+args.identity+"']",this.root)[0];args.onItem(item);},fetchSelectedItem:function(){var root=this.root,si=root.selectedIndex;return typeof si=="number"?dojo.query("> option:nth-child("+(si!=-1?si+1:1)+")",root)[0]:null;}});dojo.extend(dijit.form._ComboBoxDataStore,dojo.data.util.simpleFetch);}if(!dojo._hasResource["plugins.dnd.Avatar"]){dojo._hasResource["plugins.dnd.Avatar"]=true;dojo.provide("plugins.dnd.Avatar");dojo.declare("plugins.dnd.Avatar",[dojo.dnd.Avatar],{construct:function(){var _4f2="";if(this.manager.nodes[0].data!=null&&this.manager.nodes[0].data.avatarType!=null){_4f2=this.manager.nodes[0].data.avatarType;}this.isA11y=dojo.hasClass(dojo.body(),"dijit_a11y");var a=dojo.create("table",{"class":"dojoDndAvatar "+_4f2,style:{position:"absolute",zIndex:"1999",margin:"0px"}}),_4f3=this.manager.source,node,b=dojo.create("tbody",null,a),k=Math.min(5,this.manager.nodes.length),i=0;for(;i<k;++i){if(_4f3.creator){node=_4f3._normalizedCreator(_4f3.getItem(this.manager.nodes[i].id).data,"avatar").node;}else{node=this.manager.nodes[i].cloneNode(true);if(node.tagName.toLowerCase()=="tr"){var _4f4=dojo.create("table"),_4f5=dojo.create("tbody",null,_4f4);_4f5.appendChild(node);node=_4f4;}}node.id="";tr=dojo.create("tr",null,b);td=dojo.create("td",null,tr);td.appendChild(node);dojo.attr(tr,{"class":"dojoDndAvatarItem",style:{opacity:(9-i)/10}});}this.node=a;}});}if(!dojo._hasResource["plugins.dnd.Manager"]){dojo._hasResource["plugins.dnd.Manager"]=true;dojo.provide("plugins.dnd.Manager");dojo.declare("plugins.dnd.Manager",null,{cssFiles:[dojo.moduleUrl("plugins","dnd/css/dnd.css")],constructor:function(){Agua.loadCSSFile(this.cssFiles[0]);this.avatar=null;this.source=null;this.nodes=[];this.copy=true;this.target=null;this.canDropFlag=false;this.events=[];},OFFSET_X:16,OFFSET_Y:16,overSource:function(_4f6){if(this.avatar){this.target=(_4f6&&_4f6.targetState!="Disabled")?_4f6:null;this.canDropFlag=Boolean(this.target);this.avatar.update();}dojo.publish("/dnd/source/over",[_4f6]);},outSource:function(_4f7){if(this.avatar){if(this.target==_4f7){this.target=null;this.canDropFlag=false;this.avatar.update();dojo.publish("/dnd/source/over",[null]);}}else{dojo.publish("/dnd/source/over",[null]);}},startDrag:function(_4f8,_4f9,copy){this.source=_4f8;this.nodes=_4f9;this.copy=Boolean(copy);this.avatar=this.makeAvatar();dojo.body().appendChild(this.avatar.node);dojo.publish("/dnd/start",[_4f8,_4f9,this.copy]);this.events=[dojo.connect(dojo.doc,"onmousemove",this,"onMouseMove"),dojo.connect(dojo.doc,"onmouseup",this,"onMouseUp"),dojo.connect(dojo.doc,"onkeydown",this,"onKeyDown"),dojo.connect(dojo.doc,"onkeyup",this,"onKeyUp"),dojo.connect(dojo.doc,"ondragstart",dojo.stopEvent),dojo.connect(dojo.body(),"onselectstart",dojo.stopEvent)];var c="dojoDnd"+(copy?"Copy":"Move");dojo.addClass(dojo.body(),c);},canDrop:function(flag){var _4fa=Boolean(this.target&&flag);if(this.canDropFlag!=_4fa){this.canDropFlag=_4fa;this.avatar.update();}},stopDrag:function(){dojo.removeClass(dojo.body(),["dojoDndCopy","dojoDndMove"]);dojo.forEach(this.events,dojo.disconnect);this.events=[];this.avatar.destroy();this.avatar=null;this.source=this.target=null;this.nodes=[];},makeAvatar:function(){return new plugins.dnd.Avatar(this);},updateAvatar:function(){this.avatar.update();},onMouseMove:function(e){var a=this.avatar;if(a){dojo.dnd.autoScrollNodes(e);var s=a.node.style;s.left=(e.pageX+this.OFFSET_X)+"px";s.top=(e.pageY+this.OFFSET_Y)+"px";var copy=Boolean(this.source.copyState(dojo.isCopyKey(e)));if(this.copy!=copy){this._setCopyStatus(copy);}}},onMouseUp:function(e){if(this.avatar){if(this.target&&this.canDropFlag){var copy=Boolean(this.source.copyState(dojo.isCopyKey(e))),_4fb=[this.source,this.nodes,copy,this.target,e];dojo.publish("/dnd/drop/before",_4fb);dojo.publish("/dnd/drop",_4fb);}else{dojo.publish("/dnd/cancel");}this.stopDrag();}},onKeyDown:function(e){if(this.avatar){switch(e.keyCode){case dojo.keys.CTRL:var copy=Boolean(this.source.copyState(true));if(this.copy!=copy){this._setCopyStatus(copy);}break;case dojo.keys.ESCAPE:dojo.publish("/dnd/cancel");this.stopDrag();break;}}},onKeyUp:function(e){if(this.avatar&&e.keyCode==dojo.keys.CTRL){var copy=Boolean(this.source.copyState(false));if(this.copy!=copy){this._setCopyStatus(copy);}}},_setCopyStatus:function(copy){this.copy=copy;this.source._markDndStatus(this.copy);this.updateAvatar();dojo.replaceClass(dojo.body(),"dojoDnd"+(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?"Move":"Copy"));}});dojo.dnd._manager=null;dojo.dnd.manager=function(){if(!dojo.dnd._manager){dojo.dnd._manager=new plugins.dnd.Manager();}return dojo.dnd._manager;};}if(!dojo._hasResource["plugins.dnd.Source"]){dojo._hasResource["plugins.dnd.Source"]=true;dojo.provide("plugins.dnd.Source");dojo.declare("plugins.dnd.Source",[dojo.dnd.Selector,plugins.dnd.Manager],{isSource:true,horizontal:false,copyOnly:false,selfCopy:false,selfAccept:true,skipForm:false,withHandles:false,autoSync:false,delay:0,accept:["text"],generateText:true,creator:function(item,hint){var data=item.data;var node=dojo.doc.createElement("div");node.id=dojo.dnd.getUniqueId();node.className="dojoDndItem";node.data=new Object;for(name in thisObject.formInputs){node.data[name]=item[name];}var _4fc="<table>";var _4fd=true;for(var i=0;i<thisObject.avatarItems.length;i++){var name=thisObject.avatarItems[i];if(_4fd==true){_4fc+="<tr><td><strong style='color: darkred'>";_4fc+=data[name]+"</strong></td></tr>";}else{_4fc+="<tr><td>";_4fc+=data[name]+"</td></tr>";}}_4fc+="</table>";node.innerHTML=_4fc;return {node:node,data:item,type:["draggableItem"]};},startup:function(){if(!this.parent){this.parent=this.node;console.log("plugins.dnd.Source.startup    plugins.dnd.Source.startup()");console.log("plugins.dnd.Source.startup    console.dir(this.parent):");console.dir({parent:this.parent});if(this.parent.tagName!=null){if(this.parent.tagName.toLowerCase()=="table"){var c=this.parent.getElementsByTagName("tbody");if(c&&c.length){this.parent=c[0];}}}}this.defaultCreator=dojo.dnd._defaultCreator(this.parent);this.sync();}});}if(!dojo._hasResource["plugins.form.DndSource"]){dojo._hasResource["plugins.form.DndSource"]=true;dojo.provide("plugins.form.DndSource");dojo.declare("plugins.form.DndSource",[],{rowClass:null,avatarItems:[],formInputs:{},childWidgets:[],constructor:function(args){},postCreate:function(){this.startup();},startup:function(){this.initialiseDragSource();this.setDragSourceCreator();},initialiseDragSource:function(node){if(node==null){node=this.dragSourceNode;}this.dragSource=new dojo.dnd.Source(node,{copyOnly:true,selfAccept:false,accept:["none"]});},setDragSourceCreator:function(){var _4fe=this;this.dragSource.creator=dojo.hitch(this.dragSource,function(item,hint){var data=item.data;var node=dojo.doc.createElement("div");node.id=dojo.dnd.getUniqueId();node.className="dojoDndItem";node.data=new Object;for(name in _4fe.formInputs){node.data[name]=item[name];}var _4ff="<table>";for(var i=0;i<_4fe.avatarItems.length;i++){var name=_4fe.avatarItems[i];if(i==0){_4ff+="<tr><td class='dojoDndAvatarHeader'><strong style='color: darkred'>";_4ff+=data[name]+"</strong></td></tr>";}else{_4ff+="<tr><td>";_4ff+=data[name]+"</td></tr>";}}_4ff+="</table>";node.innerHTML=_4ff;return {node:node,data:item,type:["draggableItem"]};});},getItemArray:function(){},clearDragSource:function(){var _500=this.dragSource.getAllNodes();if(_500!=null){for(var i=0;i<_500.length;i++){var node=_500[i];var item=this.dragSource.getItem(node.id);this.dragSource.delItem(item);dojo.destroy(node);}}if(this.childWidgets.length!=0){for(var i=0;i<this.childWidgets.length;i++){dojo.destroy(this.childWidgets[i]);}}this.childWidgets=[];},setDragSource:function(){if(this.dragSource==null){this.initialiseDragSource();this.setDragSourceCreator();}this.clearDragSource();nodes=this.dragSource.getAllNodes();for(var id in this.dragSource.map){}var _501=this.getItemArray();this.loadDragItems(_501);},loadDragItems:function(_502,_503){this.dragSourceOnchange=false;if(_502==null||_502.length==0){return;}var _504=new Array;for(var j=0;j<_502.length;j++){var data=_502[j];_504.push({data:data,type:["draggableItem"]});}this.dragSource.insertNodes(false,_504);var _505=this.dragSource.getAllNodes();for(var k=0;k<_505.length;k++){var node=_505[k];node.data=_504[k].data;if(this.avatarType!==null){node.data.avatarType=this.avatarType;}var _506=new Object;for(name in this.formInputs){_506[name]=_504[k].data[name];}_506.parentWidget=this;var _507=this.rowClass;var _508=dojo.getObject(_507);var _509=new _508(_506);this.childWidgets.push(_509);node.innerHTML="";node.appendChild(_509.domNode);if(this.contextMenu!=null){this.contextMenu.bind(node);}}}});}if(!dojo._hasResource["plugins.form.EditRow"]){dojo._hasResource["plugins.form.EditRow"]=true;dojo.provide("plugins.form.EditRow");dojo.declare("plugins.form.EditRow",[plugins.core.Common],{editingRow:false,rowWidget:null,node:null,constructor:function(args){this.setTextarea();this.setEventHandlers();},postCreate:function(){this.startup();},startup:function(){},setTextarea:function(){this.textarea=document.createElement("textarea");dojo.addClass(this.textarea,"editRow");dojo.attr(this.textarea,"style","visibility: hidden");},setEventHandlers:function(){dojo.connect(this.textarea,"onblur",dojo.hitch(this,"handleOnBlur"));dojo.connect(this.textarea,"onkeypress",dojo.hitch(this,"handleOnKeyPress"));},editRow:function(_50a,node){if(this.editingRow==true){return;}this.originalText=node.innerHTML;if(this.originalText==null||!this.originalText){this.originalText="";}if(this.originalText.match(/^<i/)||this.originalText.match(/^<br/)||this.originalText.match(/^<fieldset/)||this.originalText.match(/^<textarea/)){return;}this.rowWidget=_50a;this.node=node;this.editingRow=true;this.disableDrag();node.innerHTML="";this.originalText=this.convertString(this.originalText,"htmlToText");this.textarea.value=this.originalText;node.appendChild(this.textarea);dojo.attr(this.textarea,"style","visibility: visible");this.textarea.focus();},handleOnKeyPress:function(_50b){var key=_50b.charOrCode;if(key==null){return;}_50b.stopPropagation();if(key==dojo.keys.ESCAPE){this.handleEscape();}if(key!=13){return;}try{this.freshValue=this.convertAngleBrackets(this.textarea.value,"htmlToText");this.node.removeChild(this.textarea);this.node.focus();this.node.innerHTML=this.freshValue;this.editingRow=false;var key=this.node.getAttribute("class").match(/^(\S+)/)[1];var _50c=this.convertString(this.freshValue,"htmlToText");_50c=this.convertBackslash(_50c,"expand");if((this.isValidInput(key,_50c)==false&&this.requiredInputs[key]!=null)){dojo.addClass(this.node,"invalid");this.node.innerHTML=this.freshValue;this.enableDrag();this.textarea.blur();}else{if(this.originalText==this.freshValue){this.node.innerHTML=this.freshValue;this.enableDrag();this.textarea.blur();}else{dojo.removeClass(this.node,"invalid");this.enableDrag();var _50d=this.getFormInputs(this.rowWidget);if(_50d==null){this.textarea.blur();return;}this.saveInputs(_50d,{reload:false,originator:this});this.textarea.blur();}}}catch(error){this.editingRow=false;}this.enableDrag();},handleEscape:function(){this.editingRow=false;this.enableDrag();this.textarea.blur();this.node.removeChild(this.textarea);this.node.innerHTML=this.originalText;},handleOnBlur:function(_50e){if(this.editingRow==false){return;}var _50f;if(this.textarea!=null){_50f=this.textarea.parentNode;}try{if(_50f!=null&&this.textarea!=null){this.textarea.blur();_50f.removeChild(this.textarea);}_50f.innerHTML=this.originalText;}catch(error){}this.editingRow=false;this.enableDrag();},disableDrag:function(){if(this.dragSourceWidget==null){return;}this.dragSourceWidget.isSource=false;},enableDrag:function(){if(this.dragSourceWidget==null){return;}this.dragSourceWidget.isSource=true;}});}if(!dojo._hasResource["plugins.form.DndTrash"]){dojo._hasResource["plugins.form.DndTrash"]=true;dojo.provide("plugins.form.DndTrash");dojo.declare("plugins.form.DndTrash",[],{dataFields:["name"],constructor:function(args){console.log("Dnd.constructor     plugins.form.DndTrash.constructor");},postCreate:function(){console.log("Dnd.postCreate    ");this.startup();},startup:function(){console.log("Dnd.startup    plugins.form.DndTrash.startup()");this.setTrash(this.dataFields);},setTrash:function(_510){this.trash=new dojo.dnd.Source(this.trashContainer,{accept:["draggableItem"]});var _511=this;dojo.connect(this.trash,"onDndDrop",dojo.hitch(this,function(_512,_513,copy,_514){if(_514==_511.trash){try{var node=_513[0];var _515=new Object;for(var i=0;i<_510.length;i++){_515[_510[i]]=node.data[_510[i]];}node.parentNode.removeChild(node);_511.deleteItem(_515);}catch(error){}while(_511.trashContainer.childNodes.length>2){_511.trashContainer.removeChild(_511.trashContainer.childNodes[2]);}}}));}});}if(!dojo._hasResource["plugins.form.Inputs"]){dojo._hasResource["plugins.form.Inputs"]=true;dojo.provide("plugins.form.Inputs");dojo.declare("plugins.form.Inputs",[plugins.core.Common],{formInputs:{},defaultInputs:{},requiredInputs:{},invalidInputs:{},constructor:function(args){},postCreate:function(){this.startup();},startup:function(){},setClearValues:function(){for(var name in this.invalidInputs){dojo.connect(this[name],"onclick",dojo.hitch(this,"clearValue",this[name],this.invalidInputs[name]));dojo.connect(this[name],"onfocus",dojo.hitch(this,"clearValue",this[name],this.invalidInputs[name]));}},chainInputs:function(_516){for(var i=0;i<_516.length-1;i++){var name=_516[i];var _517=_516[i+1];this.chainOnkey(name,_517);}},chainOnkey:function(_518,next){var _519=this;dojo.connect(this[_518],"onkeypress",this,function(_51a){if(_51a.charOrCode==13){_519[next].focus();setTimeout(function(){_519[_518].scrollTop=0;},50);}});},saveInputs:function(_51b,_51c){if(this.saving==true){return;}this.saving=true;var _51d=false;if(_51b==null){_51d=true;_51b=this.getFormInputs(this);if(_51b==null){this.saving=false;return;}}var _51e=new Object;_51e.username=Agua.cookie("username");_51e.sessionid=Agua.cookie("sessionid");for(var _51f in _51b){_51e[_51f]=_51b[_51f];}this.saving=false;this.addItem(_51e,_51d);},getFormInputs:function(_520){var _521=new Object;for(var name in this.formInputs){_521[name]=this.processWidgetValue(_520,name);_521[name]=this.convertBackslash(_521[name],"expand");_521[name]=this.convertAngleBrackets(_521[name],"htmlToText");_521[name]=this.convertAmpersand(_521[name],"htmlToText");}_521=this.checkInputs(_520,_521);return _521;},processWidgetValue:function(_522,name){console.log("Inputs.processWidgetValue    (widget: "+_522+", name: "+name+")");console.dir({widget:_522});var _523=this.getWidgetValue(_522[name]);console.log("Inputs.processWidgetValue    (name: "+name+", value: "+_523+")");if(_523==null){return _523;}if(_523.replace==null){return _523;}if(_523==null){return null;}if(_522.formInputs[name]=="word"){_523=this.cleanWord(_523);}else{if(_522.formInputs[name]=="phrase"){_523=this.cleanEnds(_523);}}if(_523!=null){this.setWidgetValue(_522[name],_523);}console.log("Inputs.processWidgetValue    widget: "+_522+", name: "+name+". Returning value: "+_523);return _523;},getWidgetValue:function(_524){var _525;if(_524.id!=null&&_524.id.match(/^dijit_form_NumberTextBox/)){_525=String(_524);}else{if(_524.get&&_524.get("value")){_525=_524.get("value");}else{if(_524.getValue){_525=_524.getValue();}else{if(_524.value){_525=String(_524.value.toString());}else{if(_524.innerHTML){if(_524.innerHTML=="<input type=\"checkbox\">"){_525=_524.childNodes[0].checked;}else{_525=_524.innerHTML;}}}}}}if(_525==null){_525="";}return _525;},setWidgetValue:function(_526,_527){if(_526.id!=null&&_526.id.match(/^dijit_form_NumberTextBox/)){_526.set("value",_527);}else{if(_526.set){_526.set("value",_527);}else{if(_526.setValue){_526.setValue(_527);}else{if(_526.value){_526.value=_527;}else{if(_526.innerHTML){_526.innerHTML=_527;}}}}}},clearValue:function(_528,_529){if(_528==null){return;}if(this.getWidgetValue(_528)==_529){this.setWidgetValue(_528,"");}},checkInputs:function(_52a,_52b){console.log("Inputs.checkInputs    plugins.form.Inputs.checkInputs(inputs)");console.log("Inputs.checkInputs    inputs: "+dojo.toJson(_52b));this.allValid=true;for(var key in this.formInputs){var _52c=_52b[key];console.log("Inputs.checkInputs    Checking "+key+": "+_52c);if(this.isValidInput(key,_52c)){console.log("Inputs.checkInputs    removing 'invalid' class for "+key+": "+_52c);this.setValid(_52a[key]);}else{console.log("Inputs.checkInputs    adding 'invalid' class for name "+key+", value "+_52c);this.setInvalid(_52a[key]);this.allValid=false;}}console.log("Inputs.checkInputs    this.allValid: "+this.allValid);if(this.allValid==false){return null;}for(var key in this.formInputs){console.log("Inputs.checkInputs    BEFORE convert, inputs[key]: "+dojo.toJson(_52b[key]));_52b[key]=this.convertAngleBrackets(_52b[key],"htmlToText");console.log("Inputs.checkInputs    AFTER convert, inputs[key]: "+dojo.toJson(_52b[key]));}return _52b;},setValid:function(_52d){this.removeClass(_52d,"invalid");},setInvalid:function(_52e){this.addClass(_52e,"invalid");},removeClass:function(_52f,_530){if(_52f.id!=null&&_52f.id.match(/^dijit_form_/)){dojo.removeClass(_52f.domNode,_530);}else{if(_52f.domNode){dojo.removeClass(_52f.domNode,_530);}else{dojo.removeClass(_52f,_530);}}},addClass:function(_531,_532){if(_531.id!=null&&_531.id.match(/^dijit_form_/)){dojo.addClass(_531.domNode,_532);}else{if(_531.domNode){dojo.addClass(_531.domNode,_532);}else{dojo.addClass(_531,_532);}}},isValidInput:function(name,_533){if(this.invalidInputs[name]==null){return true;}else{if(this.requiredInputs[name]==null){return true;}else{if(_533==null){return false;}else{if(_533==""){return false;}else{if(this.invalidInputs[name]==_533){return false;}}}}}return true;}});}if(!dojo._hasResource["plugins.form.EditForm"]){dojo._hasResource["plugins.form.EditForm"]=true;dojo.provide("plugins.form.EditForm");dojo.declare("plugins.form.EditForm",[plugins.form.EditRow,plugins.form.Inputs,plugins.form.DndTrash,plugins.form.DndSource],{constructor:function(args){},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);}});}if(!dojo._hasResource["dojo.dnd.Mover"]){dojo._hasResource["dojo.dnd.Mover"]=true;dojo.provide("dojo.dnd.Mover");dojo.declare("dojo.dnd.Mover",null,{constructor:function(node,e,host){this.node=dojo.byId(node);var pos=e.touches?e.touches[0]:e;this.marginBox={l:pos.pageX,t:pos.pageY};this.mouseButton=e.button;var h=(this.host=host),d=node.ownerDocument;this.events=[dojo.connect(d,"onmousemove",this,"onFirstMove"),dojo.connect(d,"ontouchmove",this,"onFirstMove"),dojo.connect(d,"onmousemove",this,"onMouseMove"),dojo.connect(d,"ontouchmove",this,"onMouseMove"),dojo.connect(d,"onmouseup",this,"onMouseUp"),dojo.connect(d,"ontouchend",this,"onMouseUp"),dojo.connect(d,"ondragstart",dojo.stopEvent),dojo.connect(d.body,"onselectstart",dojo.stopEvent)];if(h&&h.onMoveStart){h.onMoveStart(this);}},onMouseMove:function(e){dojo.dnd.autoScroll(e);var m=this.marginBox,pos=e.touches?e.touches[0]:e;this.host.onMove(this,{l:m.l+pos.pageX,t:m.t+pos.pageY},e);dojo.stopEvent(e);},onMouseUp:function(e){if(dojo.isWebKit&&dojo.isMac&&this.mouseButton==2?e.button==0:this.mouseButton==e.button){this.destroy();}dojo.stopEvent(e);},onFirstMove:function(e){var s=this.node.style,l,t,h=this.host;switch(s.position){case "relative":case "absolute":l=Math.round(parseFloat(s.left))||0;t=Math.round(parseFloat(s.top))||0;break;default:s.position="absolute";var m=dojo.marginBox(this.node);var b=dojo.doc.body;var bs=dojo.getComputedStyle(b);var bm=dojo._getMarginBox(b,bs);var bc=dojo._getContentBox(b,bs);l=m.l-(bc.l-bm.l);t=m.t-(bc.t-bm.t);break;}this.marginBox.l=l-this.marginBox.l;this.marginBox.t=t-this.marginBox.t;if(h&&h.onFirstMove){h.onFirstMove(this,e);}dojo.disconnect(this.events.shift());dojo.disconnect(this.events.shift());},destroy:function(){dojo.forEach(this.events,dojo.disconnect);var h=this.host;if(h&&h.onMoveStop){h.onMoveStop(this);}this.events=this.node=this.host=null;}});}if(!dojo._hasResource["dojo.dnd.Moveable"]){dojo._hasResource["dojo.dnd.Moveable"]=true;dojo.provide("dojo.dnd.Moveable");dojo.declare("dojo.dnd.Moveable",null,{handle:"",delay:0,skip:false,constructor:function(node,_534){this.node=dojo.byId(node);if(!_534){_534={};}this.handle=_534.handle?dojo.byId(_534.handle):null;if(!this.handle){this.handle=this.node;}this.delay=_534.delay>0?_534.delay:0;this.skip=_534.skip;this.mover=_534.mover?_534.mover:dojo.dnd.Mover;this.events=[dojo.connect(this.handle,"onmousedown",this,"onMouseDown"),dojo.connect(this.handle,"ontouchstart",this,"onMouseDown"),dojo.connect(this.handle,"ondragstart",this,"onSelectStart"),dojo.connect(this.handle,"onselectstart",this,"onSelectStart")];},markupFactory:function(_535,node){return new dojo.dnd.Moveable(node,_535);},destroy:function(){dojo.forEach(this.events,dojo.disconnect);this.events=this.node=this.handle=null;},onMouseDown:function(e){if(this.skip&&dojo.dnd.isFormElement(e)){return;}if(this.delay){this.events.push(dojo.connect(this.handle,"onmousemove",this,"onMouseMove"),dojo.connect(this.handle,"ontouchmove",this,"onMouseMove"),dojo.connect(this.handle,"onmouseup",this,"onMouseUp"),dojo.connect(this.handle,"ontouchend",this,"onMouseUp"));var pos=e.touches?e.touches[0]:e;this._lastX=pos.pageX;this._lastY=pos.pageY;}else{this.onDragDetected(e);}dojo.stopEvent(e);},onMouseMove:function(e){var pos=e.touches?e.touches[0]:e;if(Math.abs(pos.pageX-this._lastX)>this.delay||Math.abs(pos.pageY-this._lastY)>this.delay){this.onMouseUp(e);this.onDragDetected(e);}dojo.stopEvent(e);},onMouseUp:function(e){for(var i=0;i<2;++i){dojo.disconnect(this.events.pop());}dojo.stopEvent(e);},onSelectStart:function(e){if(!this.skip||!dojo.dnd.isFormElement(e)){dojo.stopEvent(e);}},onDragDetected:function(e){new this.mover(this.node,e,this);},onMoveStart:function(_536){dojo.publish("/dnd/move/start",[_536]);dojo.addClass(dojo.body(),"dojoMove");dojo.addClass(this.node,"dojoMoveItem");},onMoveStop:function(_537){dojo.publish("/dnd/move/stop",[_537]);dojo.removeClass(dojo.body(),"dojoMove");dojo.removeClass(this.node,"dojoMoveItem");},onFirstMove:function(_538,e){},onMove:function(_539,_53a,e){this.onMoving(_539,_53a);var s=_539.node.style;s.left=_53a.l+"px";s.top=_53a.t+"px";this.onMoved(_539,_53a);},onMoving:function(_53b,_53c){},onMoved:function(_53d,_53e){}});}if(!dojo._hasResource["dojo.dnd.move"]){dojo._hasResource["dojo.dnd.move"]=true;dojo.provide("dojo.dnd.move");dojo.declare("dojo.dnd.move.constrainedMoveable",dojo.dnd.Moveable,{constraints:function(){},within:false,markupFactory:function(_53f,node){return new dojo.dnd.move.constrainedMoveable(node,_53f);},constructor:function(node,_540){if(!_540){_540={};}this.constraints=_540.constraints;this.within=_540.within;},onFirstMove:function(_541){var c=this.constraintBox=this.constraints.call(this,_541);c.r=c.l+c.w;c.b=c.t+c.h;if(this.within){var mb=dojo._getMarginSize(_541.node);c.r-=mb.w;c.b-=mb.h;}},onMove:function(_542,_543){var c=this.constraintBox,s=_542.node.style;this.onMoving(_542,_543);_543.l=_543.l<c.l?c.l:c.r<_543.l?c.r:_543.l;_543.t=_543.t<c.t?c.t:c.b<_543.t?c.b:_543.t;s.left=_543.l+"px";s.top=_543.t+"px";this.onMoved(_542,_543);}});dojo.declare("dojo.dnd.move.boxConstrainedMoveable",dojo.dnd.move.constrainedMoveable,{box:{},markupFactory:function(_544,node){return new dojo.dnd.move.boxConstrainedMoveable(node,_544);},constructor:function(node,_545){var box=_545&&_545.box;this.constraints=function(){return box;};}});dojo.declare("dojo.dnd.move.parentConstrainedMoveable",dojo.dnd.move.constrainedMoveable,{area:"content",markupFactory:function(_546,node){return new dojo.dnd.move.parentConstrainedMoveable(node,_546);},constructor:function(node,_547){var area=_547&&_547.area;this.constraints=function(){var n=this.node.parentNode,s=dojo.getComputedStyle(n),mb=dojo._getMarginBox(n,s);if(area=="margin"){return mb;}var t=dojo._getMarginExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;if(area=="border"){return mb;}t=dojo._getBorderExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;if(area=="padding"){return mb;}t=dojo._getPadExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;return mb;};}});dojo.dnd.constrainedMover=dojo.dnd.move.constrainedMover;dojo.dnd.boxConstrainedMover=dojo.dnd.move.boxConstrainedMover;dojo.dnd.parentConstrainedMover=dojo.dnd.move.parentConstrainedMover;}if(!dojo._hasResource["dojo.dnd.TimedMoveable"]){dojo._hasResource["dojo.dnd.TimedMoveable"]=true;dojo.provide("dojo.dnd.TimedMoveable");(function(){var _548=dojo.dnd.Moveable.prototype.onMove;dojo.declare("dojo.dnd.TimedMoveable",dojo.dnd.Moveable,{timeout:40,constructor:function(node,_549){if(!_549){_549={};}if(_549.timeout&&typeof _549.timeout=="number"&&_549.timeout>=0){this.timeout=_549.timeout;}},markupFactory:function(_54a,node){return new dojo.dnd.TimedMoveable(node,_54a);},onMoveStop:function(_54b){if(_54b._timer){clearTimeout(_54b._timer);_548.call(this,_54b,_54b._leftTop);}dojo.dnd.Moveable.prototype.onMoveStop.apply(this,arguments);},onMove:function(_54c,_54d){_54c._leftTop=_54d;if(!_54c._timer){var _54e=this;_54c._timer=setTimeout(function(){_54c._timer=null;_548.call(_54e,_54c,_54c._leftTop);},this.timeout);}}});})();}if(!dojo._hasResource["dijit.form._FormMixin"]){dojo._hasResource["dijit.form._FormMixin"]=true;dojo.provide("dijit.form._FormMixin");dojo.declare("dijit.form._FormMixin",null,{state:"",reset:function(){dojo.forEach(this.getDescendants(),function(_54f){if(_54f.reset){_54f.reset();}});},validate:function(){var _550=false;return dojo.every(dojo.map(this.getDescendants(),function(_551){_551._hasBeenBlurred=true;var _552=_551.disabled||!_551.validate||_551.validate();if(!_552&&!_550){dojo.window.scrollIntoView(_551.containerNode||_551.domNode);_551.focus();_550=true;}return _552;}),function(item){return item;});},setValues:function(val){dojo.deprecated(this.declaredClass+"::setValues() is deprecated. Use set('value', val) instead.","","2.0");return this.set("value",val);},_setValueAttr:function(obj){var map={};dojo.forEach(this.getDescendants(),function(_553){if(!_553.name){return;}var _554=map[_553.name]||(map[_553.name]=[]);_554.push(_553);});for(var name in map){if(!map.hasOwnProperty(name)){continue;}var _555=map[name],_556=dojo.getObject(name,false,obj);if(_556===undefined){continue;}if(!dojo.isArray(_556)){_556=[_556];}if(typeof _555[0].checked=="boolean"){dojo.forEach(_555,function(w,i){w.set("value",dojo.indexOf(_556,w.value)!=-1);});}else{if(_555[0].multiple){_555[0].set("value",_556);}else{dojo.forEach(_555,function(w,i){w.set("value",_556[i]);});}}}},getValues:function(){dojo.deprecated(this.declaredClass+"::getValues() is deprecated. Use get('value') instead.","","2.0");return this.get("value");},_getValueAttr:function(){var obj={};dojo.forEach(this.getDescendants(),function(_557){var name=_557.name;if(!name||_557.disabled){return;}var _558=_557.get("value");if(typeof _557.checked=="boolean"){if(/Radio/.test(_557.declaredClass)){if(_558!==false){dojo.setObject(name,_558,obj);}else{_558=dojo.getObject(name,false,obj);if(_558===undefined){dojo.setObject(name,null,obj);}}}else{var ary=dojo.getObject(name,false,obj);if(!ary){ary=[];dojo.setObject(name,ary,obj);}if(_558!==false){ary.push(_558);}}}else{var prev=dojo.getObject(name,false,obj);if(typeof prev!="undefined"){if(dojo.isArray(prev)){prev.push(_558);}else{dojo.setObject(name,[prev,_558],obj);}}else{dojo.setObject(name,_558,obj);}}});return obj;},isValid:function(){return this.state=="";},onValidStateChange:function(_559){},_getState:function(){var _55a=dojo.map(this._descendants,function(w){return w.get("state")||"";});return dojo.indexOf(_55a,"Error")>=0?"Error":dojo.indexOf(_55a,"Incomplete")>=0?"Incomplete":"";},disconnectChildren:function(){dojo.forEach(this._childConnections||[],dojo.hitch(this,"disconnect"));dojo.forEach(this._childWatches||[],function(w){w.unwatch();});},connectChildren:function(_55b){var _55c=this;this.disconnectChildren();this._descendants=this.getDescendants();var set=_55b?function(name,val){_55c[name]=val;}:dojo.hitch(this,"_set");set("value",this.get("value"));set("state",this._getState());var _55d=(this._childConnections=[]),_55e=(this._childWatches=[]);dojo.forEach(dojo.filter(this._descendants,function(item){return item.validate;}),function(_55f){dojo.forEach(["state","disabled"],function(attr){_55e.push(_55f.watch(attr,function(attr,_560,_561){_55c.set("state",_55c._getState());}));});});var _562=function(){if(_55c._onChangeDelayTimer){clearTimeout(_55c._onChangeDelayTimer);}_55c._onChangeDelayTimer=setTimeout(function(){delete _55c._onChangeDelayTimer;_55c._set("value",_55c.get("value"));},10);};dojo.forEach(dojo.filter(this._descendants,function(item){return item.onChange;}),function(_563){_55d.push(_55c.connect(_563,"onChange",_562));_55e.push(_563.watch("disabled",_562));});},startup:function(){this.inherited(arguments);this.connectChildren(true);this.watch("state",function(attr,_564,_565){this.onValidStateChange(_565=="");});},destroy:function(){this.disconnectChildren();this.inherited(arguments);}});}if(!dojo._hasResource["dijit._DialogMixin"]){dojo._hasResource["dijit._DialogMixin"]=true;dojo.provide("dijit._DialogMixin");dojo.declare("dijit._DialogMixin",null,{attributeMap:dijit._Widget.prototype.attributeMap,execute:function(_566){},onCancel:function(){},onExecute:function(){},_onSubmit:function(){this.onExecute();this.execute(this.get("value"));},_getFocusItems:function(){var _567=dijit._getTabNavigable(this.containerNode);this._firstFocusItem=_567.lowest||_567.first||this.closeButtonNode||this.domNode;this._lastFocusItem=_567.last||_567.highest||this._firstFocusItem;}});}if(!dojo._hasResource["dijit.DialogUnderlay"]){dojo._hasResource["dijit.DialogUnderlay"]=true;dojo.provide("dijit.DialogUnderlay");dojo.declare("dijit.DialogUnderlay",[dijit._Widget,dijit._Templated],{templateString:"<div class='dijitDialogUnderlayWrapper'><div class='dijitDialogUnderlay' dojoAttachPoint='node'></div></div>",dialogId:"","class":"",attributeMap:{id:"domNode"},_setDialogIdAttr:function(id){dojo.attr(this.node,"id",id+"_underlay");this._set("dialogId",id);},_setClassAttr:function(_568){this.node.className="dijitDialogUnderlay "+_568;this._set("class",_568);},postCreate:function(){dojo.body().appendChild(this.domNode);},layout:function(){var is=this.node.style,os=this.domNode.style;os.display="none";var _569=dojo.window.getBox();os.top=_569.t+"px";os.left=_569.l+"px";is.width=_569.w+"px";is.height=_569.h+"px";os.display="block";},show:function(){this.domNode.style.display="block";this.layout();this.bgIframe=new dijit.BackgroundIframe(this.domNode);},hide:function(){this.bgIframe.destroy();delete this.bgIframe;this.domNode.style.display="none";}});}if(!dojo._hasResource["dijit.TooltipDialog"]){dojo._hasResource["dijit.TooltipDialog"]=true;dojo.provide("dijit.TooltipDialog");dojo.declare("dijit.TooltipDialog",[dijit.layout.ContentPane,dijit._Templated,dijit.form._FormMixin,dijit._DialogMixin],{title:"",doLayout:false,autofocus:true,baseClass:"dijitTooltipDialog",_firstFocusItem:null,_lastFocusItem:null,templateString:dojo.cache("dijit","templates/TooltipDialog.html","<div role=\"presentation\" tabIndex=\"-1\">\n\t<div class=\"dijitTooltipContainer\" role=\"presentation\">\n\t\t<div class =\"dijitTooltipContents dijitTooltipFocusNode\" dojoAttachPoint=\"containerNode\" role=\"dialog\"></div>\n\t</div>\n\t<div class=\"dijitTooltipConnector\" role=\"presentation\"></div>\n</div>\n"),_setTitleAttr:function(_56a){this.containerNode.title=_56a;this._set("title",_56a);},postCreate:function(){this.inherited(arguments);this.connect(this.containerNode,"onkeypress","_onKey");},orient:function(node,_56b,_56c){var newC="dijitTooltipAB"+(_56c.charAt(1)=="L"?"Left":"Right")+" dijitTooltip"+(_56c.charAt(0)=="T"?"Below":"Above");dojo.replaceClass(this.domNode,newC,this._currentOrientClass||"");this._currentOrientClass=newC;},focus:function(){this._getFocusItems(this.containerNode);dijit.focus(this._firstFocusItem);},onOpen:function(pos){this.orient(this.domNode,pos.aroundCorner,pos.corner);this._onShow();},onClose:function(){this.onHide();},_onKey:function(evt){var node=evt.target;var dk=dojo.keys;if(evt.charOrCode===dk.TAB){this._getFocusItems(this.containerNode);}var _56d=(this._firstFocusItem==this._lastFocusItem);if(evt.charOrCode==dk.ESCAPE){setTimeout(dojo.hitch(this,"onCancel"),0);dojo.stopEvent(evt);}else{if(node==this._firstFocusItem&&evt.shiftKey&&evt.charOrCode===dk.TAB){if(!_56d){dijit.focus(this._lastFocusItem);}dojo.stopEvent(evt);}else{if(node==this._lastFocusItem&&evt.charOrCode===dk.TAB&&!evt.shiftKey){if(!_56d){dijit.focus(this._firstFocusItem);}dojo.stopEvent(evt);}else{if(evt.charOrCode===dk.TAB){evt.stopPropagation();}}}}}});}if(!dojo._hasResource["dijit.Dialog"]){dojo._hasResource["dijit.Dialog"]=true;dojo.provide("dijit.Dialog");dojo.declare("dijit._DialogBase",[dijit._Templated,dijit.form._FormMixin,dijit._DialogMixin,dijit._CssStateMixin],{templateString:dojo.cache("dijit","templates/Dialog.html","<div class=\"dijitDialog\" role=\"dialog\" aria-labelledby=\"${id}_title\">\n\t<div dojoAttachPoint=\"titleBar\" class=\"dijitDialogTitleBar\">\n\t<span dojoAttachPoint=\"titleNode\" class=\"dijitDialogTitle\" id=\"${id}_title\"></span>\n\t<span dojoAttachPoint=\"closeButtonNode\" class=\"dijitDialogCloseIcon\" dojoAttachEvent=\"ondijitclick: onCancel\" title=\"${buttonCancel}\" role=\"button\" tabIndex=\"-1\">\n\t\t<span dojoAttachPoint=\"closeText\" class=\"closeText\" title=\"${buttonCancel}\">x</span>\n\t</span>\n\t</div>\n\t\t<div dojoAttachPoint=\"containerNode\" class=\"dijitDialogPaneContent\"></div>\n</div>\n"),baseClass:"dijitDialog",cssStateNodes:{closeButtonNode:"dijitDialogCloseIcon"},attributeMap:dojo.delegate(dijit._Widget.prototype.attributeMap,{title:[{node:"titleNode",type:"innerHTML"},{node:"titleBar",type:"attribute"}],"aria-describedby":""}),open:false,duration:dijit.defaultDuration,refocus:true,autofocus:true,_firstFocusItem:null,_lastFocusItem:null,doLayout:false,draggable:true,"aria-describedby":"",postMixInProperties:function(){var _56e=dojo.i18n.getLocalization("dijit","common");dojo.mixin(this,_56e);this.inherited(arguments);},postCreate:function(){dojo.style(this.domNode,{display:"none",position:"absolute"});dojo.body().appendChild(this.domNode);this.inherited(arguments);this.connect(this,"onExecute","hide");this.connect(this,"onCancel","hide");this._modalconnects=[];},onLoad:function(){this._position();if(this.autofocus&&dijit._DialogLevelManager.isTop(this)){this._getFocusItems(this.domNode);dijit.focus(this._firstFocusItem);}this.inherited(arguments);},_endDrag:function(e){if(e&&e.node&&e.node===this.domNode){this._relativePosition=dojo.position(e.node);}},_setup:function(){var node=this.domNode;if(this.titleBar&&this.draggable){this._moveable=(dojo.isIE==6)?new dojo.dnd.TimedMoveable(node,{handle:this.titleBar}):new dojo.dnd.Moveable(node,{handle:this.titleBar,timeout:0});this._dndListener=dojo.subscribe("/dnd/move/stop",this,"_endDrag");}else{dojo.addClass(node,"dijitDialogFixed");}this.underlayAttrs={dialogId:this.id,"class":dojo.map(this["class"].split(/\s/),function(s){return s+"_underlay";}).join(" ")};},_size:function(){this._checkIfSingleChild();if(this._singleChild){if(this._singleChildOriginalStyle){this._singleChild.domNode.style.cssText=this._singleChildOriginalStyle;}delete this._singleChildOriginalStyle;}else{dojo.style(this.containerNode,{width:"auto",height:"auto"});}var mb=dojo._getMarginSize(this.domNode);var _56f=dojo.window.getBox();if(mb.w>=_56f.w||mb.h>=_56f.h){var w=Math.min(mb.w,Math.floor(_56f.w*0.75)),h=Math.min(mb.h,Math.floor(_56f.h*0.75));if(this._singleChild&&this._singleChild.resize){this._singleChildOriginalStyle=this._singleChild.domNode.style.cssText;this._singleChild.resize({w:w,h:h});}else{dojo.style(this.containerNode,{width:w+"px",height:h+"px",overflow:"auto",position:"relative"});}}else{if(this._singleChild&&this._singleChild.resize){this._singleChild.resize();}}},_position:function(){if(!dojo.hasClass(dojo.body(),"dojoMove")){var node=this.domNode,_570=dojo.window.getBox(),p=this._relativePosition,bb=p?null:dojo._getBorderBox(node),l=Math.floor(_570.l+(p?p.x:(_570.w-bb.w)/2)),t=Math.floor(_570.t+(p?p.y:(_570.h-bb.h)/2));dojo.style(node,{left:l+"px",top:t+"px"});}},_onKey:function(evt){if(evt.charOrCode){var dk=dojo.keys;var node=evt.target;if(evt.charOrCode===dk.TAB){this._getFocusItems(this.domNode);}var _571=(this._firstFocusItem==this._lastFocusItem);if(node==this._firstFocusItem&&evt.shiftKey&&evt.charOrCode===dk.TAB){if(!_571){dijit.focus(this._lastFocusItem);}dojo.stopEvent(evt);}else{if(node==this._lastFocusItem&&evt.charOrCode===dk.TAB&&!evt.shiftKey){if(!_571){dijit.focus(this._firstFocusItem);}dojo.stopEvent(evt);}else{while(node){if(node==this.domNode||dojo.hasClass(node,"dijitPopup")){if(evt.charOrCode==dk.ESCAPE){this.onCancel();}else{return;}}node=node.parentNode;}if(evt.charOrCode!==dk.TAB){dojo.stopEvent(evt);}else{if(!dojo.isOpera){try{this._firstFocusItem.focus();}catch(e){}}}}}}},show:function(){if(this.open){return;}if(!this._started){this.startup();}if(!this._alreadyInitialized){this._setup();this._alreadyInitialized=true;}if(this._fadeOutDeferred){this._fadeOutDeferred.cancel();}this._modalconnects.push(dojo.connect(window,"onscroll",this,"layout"));this._modalconnects.push(dojo.connect(window,"onresize",this,function(){var _572=dojo.window.getBox();if(!this._oldViewport||_572.h!=this._oldViewport.h||_572.w!=this._oldViewport.w){this.layout();this._oldViewport=_572;}}));this._modalconnects.push(dojo.connect(this.domNode,"onkeypress",this,"_onKey"));dojo.style(this.domNode,{opacity:0,display:""});this._set("open",true);this._onShow();this._size();this._position();var _573;this._fadeInDeferred=new dojo.Deferred(dojo.hitch(this,function(){_573.stop();delete this._fadeInDeferred;}));_573=dojo.fadeIn({node:this.domNode,duration:this.duration,beforeBegin:dojo.hitch(this,function(){dijit._DialogLevelManager.show(this,this.underlayAttrs);}),onEnd:dojo.hitch(this,function(){if(this.autofocus&&dijit._DialogLevelManager.isTop(this)){this._getFocusItems(this.domNode);dijit.focus(this._firstFocusItem);}this._fadeInDeferred.callback(true);delete this._fadeInDeferred;})}).play();return this._fadeInDeferred;},hide:function(){if(!this._alreadyInitialized){return;}if(this._fadeInDeferred){this._fadeInDeferred.cancel();}var _574;this._fadeOutDeferred=new dojo.Deferred(dojo.hitch(this,function(){_574.stop();delete this._fadeOutDeferred;}));_574=dojo.fadeOut({node:this.domNode,duration:this.duration,onEnd:dojo.hitch(this,function(){this.domNode.style.display="none";dijit._DialogLevelManager.hide(this);this.onHide();this._fadeOutDeferred.callback(true);delete this._fadeOutDeferred;})}).play();if(this._scrollConnected){this._scrollConnected=false;}dojo.forEach(this._modalconnects,dojo.disconnect);this._modalconnects=[];if(this._relativePosition){delete this._relativePosition;}this._set("open",false);return this._fadeOutDeferred;},layout:function(){if(this.domNode.style.display!="none"){if(dijit._underlay){dijit._underlay.layout();}this._position();}},destroy:function(){if(this._fadeInDeferred){this._fadeInDeferred.cancel();}if(this._fadeOutDeferred){this._fadeOutDeferred.cancel();}if(this._moveable){this._moveable.destroy();}if(this._dndListener){dojo.unsubscribe(this._dndListener);}dojo.forEach(this._modalconnects,dojo.disconnect);dijit._DialogLevelManager.hide(this);this.inherited(arguments);}});dojo.declare("dijit.Dialog",[dijit.layout.ContentPane,dijit._DialogBase],{});dijit._DialogLevelManager={show:function(_575,_576){var ds=dijit._dialogStack;ds[ds.length-1].focus=dijit.getFocus(_575);var _577=dijit._underlay;if(!_577||_577._destroyed){_577=dijit._underlay=new dijit.DialogUnderlay(_576);}else{_577.set(_575.underlayAttrs);}var _578=ds[ds.length-1].dialog?ds[ds.length-1].zIndex+2:950;if(ds.length==1){_577.show();}dojo.style(dijit._underlay.domNode,"zIndex",_578-1);dojo.style(_575.domNode,"zIndex",_578);ds.push({dialog:_575,underlayAttrs:_576,zIndex:_578});},hide:function(_579){var ds=dijit._dialogStack;if(ds[ds.length-1].dialog==_579){ds.pop();var pd=ds[ds.length-1];if(ds.length==1){if(!dijit._underlay._destroyed){dijit._underlay.hide();}}else{dojo.style(dijit._underlay.domNode,"zIndex",pd.zIndex-1);dijit._underlay.set(pd.underlayAttrs);}if(_579.refocus){var _57a=pd.focus;if(!_57a||(pd.dialog&&!dojo.isDescendant(_57a.node,pd.dialog.domNode))){pd.dialog._getFocusItems(pd.dialog.domNode);_57a=pd.dialog._firstFocusItem;}try{dijit.focus(_57a);}catch(e){}}}else{var idx=dojo.indexOf(dojo.map(ds,function(elem){return elem.dialog;}),_579);if(idx!=-1){ds.splice(idx,1);}}},isTop:function(_57b){var ds=dijit._dialogStack;return ds[ds.length-1].dialog==_57b;}};dijit._dialogStack=[{dialog:null,focus:null,underlayAttrs:null}];}if(!dojo._hasResource["plugins.dijit.SyncDialog"]){dojo._hasResource["plugins.dijit.SyncDialog"]=true;dojo.provide("plugins.dijit.SyncDialog");dojo.declare("plugins.dijit.SyncDialog",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n    <table\n        cellspacing=\"0px\"\n        height=\"300px\" width=\"100%\" style=\"padding: 0; margin: 0;\"\n        class=\"syncDialog\">\n        <tr>\n            <td align=\"center\">\n                \n                <div\n                    dojoAttachPoint=\"dialog\"\n                    dojoType=\"dijit.Dialog\"\n                    closeText=\"false\"\n                    title=\"Sync\"\n                    style=\"margin-right: auto; margin-left: auto; text-align: center;\"\n                    >\n                    \n                    <table\n                        cellpadding=\"0\"\n                        cellspacing=\"0\"\n                        class=\"syncDialog\"\n                        width=\"100%\"\n                        >\n\n                        <tr class=\"header\" align=\"center\">\n                            <td\n                                align=\"center\"\n                                dojoAttachPoint=\"headerNode\"\n                                colspan=\"2\">${header}</td>\n                        </tr>\n\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=center\n                                class=\"sublabel\">Commit Message</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"message\"\n\t\t\t\t\t\t\t\t\tclass=\"message\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tmaxlength=\"52\"\n\t\t\t\t\t\t\t\t\tregExpGen=\"return '[^;^`]{1,52}'\"\n\t\t\t\t\t\t\t\t\tinvalidMessage=\"Max 52 characters, no ';' or '`'\"\n\t\t\t\t\t\t\t\t\tpromptMessage=\"Max 52 characters, no ';' or '`'\"\n\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=center\n                                class=\"sublabel\">Details</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"details\"\n\t\t\t\t\t\t\t\t\tclass=\"details\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%;\";\n\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\trows=\"10\"></textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\n                        \n                        <tr>\n                            <td colspan=\"2\"\n                                align=\"center\"\n                                class=\"enterButton\">\n                                <button\n                                    dojoType=\"dijit.form.Button\"\n                                    type=\"button\"\n                                    label=\"Enter\"\n                                    dojoAttachEvent=\"onClick:doEnter\"\n                                    >\n                                </button>\n                            </td>\n                        </tr>\n                        \n                        \n                    </table>\n\n                </div>\n            \n            </td>\n        </tr>\n    </table>\n</div>\n",cssFiles:[dojo.moduleUrl("plugins","dijit/css/syncdialog.css")],widgetsInTemplate:true,parentWidget:null,message:null,constructor:function(args){console.log("SyncDialog.constructor    args:");console.dir({args:args});this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.setDialogue();this.setKeyListener();this.setNamespaceClass("syncDialog");},setKeyListener:function(){dojo.connect(this.dialog,"onkeypress",dojo.hitch(this,"handleOnKeyPress"));},handleOnKeyPress:function(_57c){var key=_57c.charOrCode;console.log("SyncDialog.handleOnKeyPress    key: "+key);if(key==null){return;}_57c.stopPropagation();if(key==dojo.keys.ESCAPE){this.hide();}},setNamespaceClass:function(_57d){dojo.addClass(this.dialog.domNode,_57d);dojo.addClass(this.dialog.titleNode,_57d);dojo.addClass(this.dialog.closeButtonNode,_57d);},show:function(){this.dialog.show();this.message.focus();},hide:function(){this.dialog.hide();},doEnter:function(type){console.log("SyncDialog.doEnter    plugins.dijit.SyncDialog.doEnter()");var _57e=this.validateInputs(["message","details"]);console.log("SyncDialog.doEnter    inputs:");console.dir({inputs:_57e});if(!_57e){console.log("SyncDialog.doEnter    inputs is null. Returning");return;}this.message.set("value","");this.details.value="";this.hide();this.dialog.enterCallback(_57e);},validateInputs:function(keys){console.log("Hub.validateInputs    keys: ");console.dir({keys:keys});var _57f=new Object;this.isValid=true;for(var i=0;i<keys.length;i++){console.log("Hub.validateInputs    Doing keys["+i+"]: "+keys[i]);_57f[keys[i]]=this.verifyInput(keys[i]);}console.log("Hub.validateInputs    inputs: ");console.dir({inputs:_57f});if(!this.isValid){return null;}return _57f;},verifyInput:function(_580){console.log("Aws.verifyInput    input: ");console.dir({this_input:this[_580]});var _581=this[_580].value;console.log("Aws.verifyInput    value: "+_581);var _582=this.getClassName(this[_580]);console.log("Aws.verifyInput    className: "+_582);if(_582){console.log("Aws.verifyInput    this[input].isValid(): "+this[_580].isValid());if(!_581||!this[_580].isValid()){console.log("Aws.verifyInput    input "+_580+" value is empty. Adding class 'invalid'");dojo.addClass(this[_580].domNode,"invalid");this.isValid=false;}else{console.log("SyncDialog.verifyInput    value is NOT empty. Removing class 'invalid'");dojo.removeClass(this[_580].domNode,"invalid");return _581;}}else{if(_580.match(/;/)||_580.match(/`/)){console.log("SyncDialog.verifyInput    value is INVALID. Adding class 'invalid'");dojo.addClass(this[_580],"invalid");this.isValid=false;return null;}else{console.log("SyncDialog.verifyInput    value is VALID. Removing class 'invalid'");dojo.removeClass(this[_580],"invalid");return _581;}}return null;},doCancel:function(){this.dialog.cancelCallback();this.dialog.hide();},setDialogue:function(){document.body.appendChild(this.dialog.domNode);this.dialog.parentWidget=this;this._fadeOutDeferred=function(){};},load:function(args){console.log("SyncDialog.load    args:");console.dir({args:args});if(args.title){console.log("SyncDialog.load    SETTING TITLE: "+args.title);this.dialog.set("title",args.title);}this.headerNode.innerHTML=args.header;if(args.message){this.message.set("value",args.message);}if(args.details){this.details.value=args.details;}this.dialog.enterCallback=args.enterCallback;this.show();}});}if(!dojo._hasResource["plugins.apps.AppRow"]){dojo._hasResource["plugins.apps.AppRow"]=true;dojo.provide("plugins.apps.AppRow");dojo.declare("plugins.apps.AppRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table width=\"100%\" cellspacing=\"2\">\n        <tr>\n            <td\n                colspan=\"2\"\n                dojoAttachPoint=\"name\"\n                class=\"name\"\n\t\t\t\ttitle=\"name: Name of application\"\n                >${name}</td>\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"type\"\n                class=\"type\"\n\t\t\t\ttitle=\"type: Type of application (e.g., 'pipeline', 'converter', 'utility')\"\n                >${type}</td>\n        </tr>\n\n<!-- TOGGLED PORTION STARTS HERE -->\n<!-- TOGGLED PORTION STARTS HERE -->\n<!-- TOGGLED PORTION STARTS HERE -->\n\n\t\t\n        <tr>\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"executor\"\n                class=\"executor\"\n\t\t\t\ttitle=\"executor: Additional executable used to run application (e.g., '/usr/bin/perl')\"\n            >${executor}</td>\n\n            <td \n                colspan=\"1\"\n                dojoAttachPoint=\"packageCombo\"\n                class=\"package\"\n\t\t\t\ttitle=\"package: Package to which the application belongs\"\n            >${package}</td>\n            \n            <td colspan=\"1\"\n                class=\"localonly\"\n                title=\"localonly: Select to make application only executable locally (e.g., a herder that manages cluster jobs)\"\n                dojoAttachPoint=\"localonlyContainer\"\n            >\n                <span>\n                    Local Only\n                </span>\n                \n                <span\n                    dojoAttachPoint=\"localonly\"\n                    dojoType=\"dijit.form.CheckBox\"\n                    dojoAttachEvent=\"onClick:submitChange\"\n                    checked=\"false\"\n                    class=\"newLocalOnlyCheckbox\"\n                ></span>\n            </td>\n\n        </tr>\n        <tr>\n\n            <td colspan=\"3\"\n                dojoAttachPoint=\"location\"\n                class='location'\n\t\t\t\ttitle=\"location: Absolute path (e.g., '/home/myname/myapp.pl') or path relative to Agua base folder (e.g., 'bin/apps/myScript.pl')\"\n            >${location}</td>\n\t\t\t\t\t\t\t\n\n        </tr>\n        <tr>\n            <td colspan=\"3\"\n                dojoAttachPoint=\"description\"\n                class='description'\n\t\t\t\ttitle=\"description: A brief description of the application\"\n            >${description}</td>\n        </tr>\n        <tr>\n            <td colspan=\"3\"\n                dojoAttachPoint=\"notes\"\n                class='notes'\n\t\t\t\ttitle=\"notes: Notes on the application (e.g., release notes, constraints)\"\n            >${notes}</td>\n        </tr>\n        <tr>\n            <td colspan=\"3\"\n                dojoAttachPoint=\"url\"\n                class='url'\n\t\t\t\ttitle=\"url: Web address of website providing further details (e.g., http://mysite.com/applications)\"\n\t\t\t>${url}</td>\n        </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.checkboxOn=args.submit;this.parentWidget=args.parentWidget;this.formInputs=this.parentWidget.formInputs;},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);var _583=this;dojo.connect(this.name,"onclick",function(_584){_583.toggle();});var _583=this;var _585=["executor","location","description","notes","url"];for(var i in _585){dojo.connect(this[_585[i]],"onclick",function(_586){_583.parentWidget.editRow(_583,_586.target);_586.stopPropagation();});}if(this.checkboxOn!=null&&this.checkboxOn==1){this.localonly.setValue("on");}},submitChange:function(_587){_587.stopPropagation();var _588=this.parentWidget.getFormInputs(this);if(_588==null){return;}this.parentWidget.saveInputs(_588,{reload:false});},toggle:function(){var _589=["executor","packageCombo","location","localonlyContainer","description","notes","url"];for(var i in _589){console.log("AppRow.toggle    this["+_589[i]+"]: "+this[_589[i]]);if(this[_589[i]].style.display=="inline-block"){this[_589[i]].style.display="none";}else{this[_589[i]].style.display="inline-block";}}}});}if(!dojo._hasResource["plugins.apps.App"]){dojo._hasResource["plugins.apps.App"]=true;dojo.provide("plugins.apps.App");dojo.declare("plugins.apps.App",[dijit._Widget,dijit._Templated,plugins.core.Common,plugins.form.EditForm],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- APPS TAB -->\n\t<div\n\t\tdojoAttachPoint=\"mainTab\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Apps\"\n\t\tstyle=\"height: 100% !important; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t>\n\n<table width=\"100%\" class=\"app\">\n\t<tr valign=\"top\" width=\"100%\">\n\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\">\n\t\t\tApps\n\t\t</td>\n\t</tr>\n\n\t<tr valign=\"top\" width=\"95%\">\n\t\t<td width=\"100%\">\n\t\t\t<table width=\"100%\">\n\t\t\t\t<tr>\n\t\t\t\t\t<td\n\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\tdojoAttachPoint=\"syncAppsButton\"\n\t\t\t\t\t\tclass=\"syncAppsButton\"\n\t\t\t\t\t\ttitle=\"Click to sync apps to biorepository\"\n\t\t\t\t\t\tdojoAttachEvent=\"onclick:showSyncDialog\"\n\t\t\t\t\t>\n\t\t\t\t\t\tSync\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr width=\"100%\">\n\n\t\t\t\t\t<td colspan=\"3\" height=\"32px\">\n\t\t\t\t\t\t\n\t\t\t\t\t\t<table cellspacing=\"0\" cellpadding=\"0\" border=\"0\" style=\"padding: 0; margin: 0;\">\n\n\t\t\t\t\t\t\t<tr>\n\n\t\t\t\t\t\t\t\t<td \n\t\t\t\t\t\t\t\t\tstyle=\"padding-right: 10px;\" >\n\t\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"name\"\n\t\t\t\t\t\t\t\t\t\tclass=\"name\"\n\t\t\t\t\t\t\t\t\t\tcols=\"30\"\n\t\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t\ttitle=\"name: Name of application\"\n\t\t\t\t\t\t\t\t\t\t>Name</textarea>\n\t\t\t\t\t\t\t\t</td>\n\t\n\t\t\t\t\t\t\t\t<td height=\"20px\"\n\t\t\t\t\t\t\t\t\twidth=\"120px\"\n\t\t\t\t\t\t\t\t\talign=\"right\">\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"addAppButton\"\n\t\t\t\t\t\t\t\t\t\tclass=\"addAppButton\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tNew App\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\n\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\" height=\"8px\">\n\t\t\t\t\t<td width=\"33%\">Type</td>\n\t\t\t\t\t<td width=\"33%\">Executor</td>\n\t\t\t\t\t<td width=\"33%\">Package</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr width=\"100%\">\n\t\t\t\t\t<td width=\"33%\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"type\"\n\t\t\t\t\t\t\tclass=\"type\"\n\t\t\t\t\t\t\tstyle=\"width: 100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"type: Type of application (e.g., 'pipeline', 'converter', 'utility')\"\n\t\t\t\t\t\t\t>Type</textarea>\n\t\t\t\t\t</td>\n\n\t\t\t\t\t<td width=\"34%\"\n\t\t\t\t\t\tstyle=\"padding-left: 4px; padding-right: 4px;\" >\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"executor\"\n\t\t\t\t\t\t\tclass=\"executor\"\n\t\t\t\t\t\t\tstyle=\"width: 100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"executor: Additional executable used to run application (e.g., '/usr/bin/perl')\"\n\t\t\t\t\t\t\t>Executor</textarea>\n\t\t\t\t\t</td>\n\n\t\t\t\t\t<td width=\"33%\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoAttachPoint=\"packageCombo\"\n\t\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\tclass=\"packageCombo\"\n\t\t\t\t\t\t\tautocomplete=\"true\"\n\t\t\t\t\t\t\thasDownArrow=\"true\"\n\t\t\t\t\t\t\tdisabled=\"false\"\n\t\t\t\t\t\t\tstyle=\"width: 150px;\"\n\t\t\t\t\t\t\ttitle=\"Select the order of the displayed applications\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\" height=\"8px\">\n\t\t\t\t\t<td width=\"67%\" colspan=\"2\">Location</td>\n\t\t\t\t\t<td width=\"33%\">&nbsp;</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr width=\"100%\">\n\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"location\"\n\t\t\t\t\t\t\tclass=\"location\"\n\t\t\t\t\t\t\tstyle=\"width: 100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"location: Absolute path (e.g., '/home/myname/myapp.pl') or path relative to Agua base folder (e.g., 'bin/apps/myScript.pl')\"\n\t\t\t\t\t\t\t>Location</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t<td colspan=\"1\"\n\t\t\t\t\t\ttitle=\"localonly: Select so that application will only run locally (e.g., a herder that submits jobs to the cluster))\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tdojoAttachPoint=\"localonly\"\n\t\t\t\t\t\t\tclass=\"localonly\">\n\t\t\t\t\t\t\tLocal Only\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tdojoAttachPoint=\"localonly\"\n\t\t\t\t\t\t\tdojoType=\"dijit.form.CheckBox\"\n\t\t\t\t\t\t\tchecked=\"false\"\n\t\t\t\t\t\t\tclass=\"localonlyCheckbox\"\n\t\t\t\t\t\t></span>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\n\t\t\t\t<tr class=\"headerRow\">\n\t\t\t\t\t<td width=\"100%\"\n\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\tclass=\"toggleTitle\"\n\t\t\t\t\t\tdojoAttachEvent=\"onclick:toggle\"\n\t\t\t\t\t> Details (Click to toggle)</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t</td>\n\n\t</tr>\n\t<tr class=\"inputs\" >\n\t\t<td>\n\n\t\t\t<table\n\t\t\t\tstyle=\"display: none\"\n\t\t\t\tdojoAttachPoint=\"togglePoint\"\n\t\t\t\twidth=\"100%\"\n\t\t\t\tstyle=\"padding: 0px;\"\n\t\t\t>\n\t\t\t\t\n\t\t\t\t<tr class=\"headerRow\">\n\t\t\t\t\t<td colspan=\"3\">Description</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"description\"\n\t\t\t\t\t\t\tclass=\"description\"\n\t\t\t\t\t\t\tstyle=\"width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"description: A brief description of the application\"\n\t\t\t\t\t\t>Description</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\">\n\t\t\t\t\t<td colspan=\"3\">Notes</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"notes\"\n\t\t\t\t\t\t\tclass=\"notes\"\n\t\t\t\t\t\t\tvalue=\"Notes\"\n\t\t\t\t\t\t\tstyle=\"width: 100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"notes: Notes on the application/build/etc. (e.g., release notes, constraints)\"\n\t\t\t\t\t\t>Notes</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\">\n\t\t\t\t\t<td\n\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\ttitle=\"url: Web address of website providing further details (e.g., http://mysite.com/applications)\"\n\t\t\t\t\t\t>URL</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"url\"\n\t\t\t\t\t\t\tclass=\"url\"\n\t\t\t\t\t\t\tvalue=\"URL\"\n\t\t\t\t\t\t\tstyle=\"width: 100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"url: Web address of website providing further details (e.g., http://mysite.com/applications)\"\n\t\t\t\t\t\t>URL</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t</table>\n\t\t</td>\n\t</tr>\n\t\n\t<tr valign=\"top\" width=\"95%\">\n\t\t<td width=\"95%\">\n\t\t\t<div class=\"label\"> Application List Order </div>\n\t\t</td>\n\t</tr>\n\n\t<tr>\n\t\t<td align=\"center\">\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"appsCombo\"\n\t\t\t\tdojoAttachEvent=\"onChange:changeDragSource\"\n\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t\tclass=\"appsCombo\"\n\t\t\t\tpopupClass=\"sources appsCombo dijitReset dijitMenu\"\n\t\t\t\tautocomplete=\"true\"\n\t\t\t\thasDownArrow=\"true\"\n\t\t\t\tdisabled=\"false\"\n\t\t\t\tstyle=\"width: 250px;\"\n\t\t\t>\n\t\t\t</div>\n\t\t</td>\n\t</tr>\n\t\n\t<tr>\n\t\t<td>\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"dragSourceNode\"\n\t\t\t\tclass=\"dragSource\"\n\t\t\t\tstyle=\"height: 395px; width: 96%;\"\n\t\t\t>\n\t\t\t</div>\n\t\t</td>\n\t</tr>\n\n\t<tr align=\"center\">\n\t\t<td align=\"center\">\n\n\t\t\t<!-- TRASH CONTAINER -->\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"trashContainer\"\n\t\t\t\tclass=\"trash\"\n\t\t\t\tstyle=\"height: 60px; width: 150px; align: center;\" \n\t\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"trashIcon\"\n\t\t\t\t\tclass=\"trashIcon\"\n\t\t\t\t\tstyle=\"height: 60px; width: 60px;\"\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</td>\n\t</tr>\n</table>\n\n\n\n\t</div>\n\t<!-- END SOURCES TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,addingApp:false,cssFiles:[dojo.moduleUrl("plugins","apps/css/app.css")],parentWidget:null,formInputs:{"name":"word","type":"word","executor":"word","package":"word","location":"word","localonly":"word","description":"phrase","notes":"phrase","url":"word"},requiredInputs:{name:1,type:1,location:1},invalidInputs:{name:"Name",type:"Type",executor:"Executor",packageCombo:"Package",location:"Location",description:"Description",notes:"Notes",url:"URL"},defaultInputs:{name:"Name",type:"Type",executor:"Executor",packageCombo:"Package",location:"Location",description:"Description",notes:"Notes",url:"URL"},dataFields:["name","type","location"],avatarItems:["name","description"],rowClass:"plugins.apps.AppRow",dragTypes:["app"],constructor:function(args){this.parentWidget=args.parentWidget;this.apps=args.parentWidget.apps;},postCreate:function(){this.loadCSS();this.startup();},startup:function(){console.group("App-"+this.id+"    startup");this.inherited(arguments);this.tabContainer.addChild(this.mainTab);this.tabContainer.selectChild(this.mainTab);this.setPackageCombo();this.setForm();this.setTrash(this.dataFields);this.setSyncApps();this.setSyncDialog();Agua.updater.subscribe(this,"updateApps");Agua.updater.subscribe(this,"updateSyncApps");console.groupEnd("App-"+this.id+"    startup");},updateApps:function(args){console.log("App.updateApps    Apps.updateApps(args)");console.log("App.updateApps    args:");console.dir(args);if(args!=null&&args.reload==false){return;}console.log("App.updateApps    Calling setDragSource()");this.setAppTypesCombo();},updateSyncApps:function(args){console.warn("App.updateSyncApps    args:");console.dir({args:args});this.setSyncApps();},setSyncApps:function(){var hub=Agua.getHub();console.log("App.setSyncApps    hub:");console.dir({hub:hub});if(!hub.login||!hub.token){this.disableSyncApps();}else{this.enableSyncApps();}},setSyncDialog:function(){console.log("App.loadSyncDialog    plugins.apps.App.setSyncDialog()");var _58a=function(){};var _58b=function(){};var _58c="Sync";var _58d="Sync Apps";this.syncDialog=new plugins.dijit.SyncDialog({title:_58c,header:_58d,parentWidget:this,enterCallback:_58a});console.log("App.loadSyncDialog    this.syncDialog:");console.dir({this_syncDialog:this.syncDialog});},showSyncDialog:function(){var _58e=dojo.hasClass(this.syncAppsButton,"disabled");console.log("App.loadSyncDialog    disabled: "+_58e);if(_58e){console.log("App.loadSyncDialog    SyncApps is disabled. Returning");return;}var _58f="Sync Apps";var _590="";var _591="";var _592="";var _593=dojo.hitch(this,"syncApps");this.loadSyncDialog(_58f,_590,_591,_592,_593);},loadSyncDialog:function(_594,_595,_596,_597,_598){console.log("App.loadSyncDialog    title: "+_594);console.log("App.loadSyncDialog    header: "+_595);console.log("App.loadSyncDialog    message: "+_596);console.log("App.loadSyncDialog    details: "+_597);console.log("App.loadSyncDialog    enterCallback: "+_598);this.syncDialog.load({title:_594,header:_595,message:_596,details:_597,enterCallback:_598});},disableSyncApps:function(){dojo.addClass(this.syncAppsButton,"disabled");dojo.attr(this.syncAppsButton,"title","Input AWS private key and public certificate to enable Sync");},enableSyncApps:function(){dojo.removeClass(this.syncAppsButton,"disabled");dojo.attr(this.syncAppsButton,"title","Click to sync apps to biorepository");},syncApps:function(_599){console.log("Hub.syncApps    inputs: ");console.dir({inputs:_599});if(this.syncingApps==true){console.log("Hub.syncApps    this.syncingApps: "+this.syncingApps+". Returning.");return;}this.syncingApps=true;var _59a=new Object;_59a.username=Agua.cookie("username");_59a.sessionid=Agua.cookie("sessionid");_59a.message=_599.message;_59a.details=_599.details;_59a.hubtype="github";_59a.mode="syncApps";console.log("Hub.syncApps    query: ");console.dir({query:_59a});var url=Agua.cgiUrl+"workflow.cgi?";var _59b=this;dojo.xhrPut({url:url,contentType:"json",putData:dojo.toJson(_59a),load:function(_59c,_59d){_59b.syncingApps=false;console.log("App.syncApps    OK. response:");console.dir({response:_59c});Agua.toast(_59c);},error:function(_59e,_59f){_59b.syncingApps=false;console.log("App.syncApps    ERROR. response:");console.dir({response:_59e});Agua.toast(_59e);}});},toggle:function(){if(this.togglePoint.style.display=="inline-block"){this.togglePoint.style.display="none";}else{this.togglePoint.style.display="inline-block";}},setPackageCombo:function(type){var apps=Agua.getApps();console.log("Parameters.setPackageCombo     apps:");console.dir({apps:apps});var _5a0=this.hashArrayKeyToArray(apps,"package");_5a0=this.uniqueValues(_5a0);console.log("Parameters.setPackageCombo     packageArray:");console.dir({packageArray:_5a0});var data={identifier:"name",items:[]};for(var i=0;i<_5a0.length;i++){data.items[i]={name:_5a0[i]};}var _5a1=new dojo.data.ItemFileWriteStore({data:data});this.packageCombo.store=_5a1;this.packageCombo.startup();var _5a2=_5a0[0];this.packageCombo.set("value",_5a2);this.setAppTypesCombo();},setAppTypesCombo:function(){console.log("App.setAppTypesCombo     plugins.apps.App.setAppTypesCombo()");var apps=Agua.getApps();console.log("App.setAppTypesCombo     this: ");var _5a3=this.packageCombo.get("value");console.log("App.setAppTypesCombo     packageName: "+_5a3);var keys=["package"];var _5a4=[_5a3];apps=this.filterByKeyValues(apps,keys,_5a4);var _5a5=this.hashArrayKeyToArray(apps,"type");_5a5=this.uniqueValues(_5a5);console.log("App.setAppTypesCombo     typesArray.length: "+_5a5.length);_5a5=this.sortNoCase(_5a5);_5a5.splice(0,0,"Order by Type (A-Z)");_5a5.splice(0,0,"Order by Name (A-Z)");var data={identifier:"name",items:[]};for(var i=0;i<_5a5.length;i++){data.items[i]={name:_5a5[i]};}var _5a6=new dojo.data.ItemFileWriteStore({data:data});this.appsCombo.store=_5a6;this.appsCombo.startup();var _5a7=_5a5[0];this.appsCombo.set("value",_5a7);this.setDragSource();},setForm:function(){dojo.connect(this.addAppButton,"onclick",dojo.hitch(this,"saveInputs",null,{reload:true}));this.setClearValues();this.chainInputs(["name","type","executor","package","location","description","notes","url","addAppButton"]);},getItemArray:function(){var _5a8=Agua.getApps();console.log("App.getItemArray    itemArray.length: "+_5a8.length);var type=this.appsCombo.get("value");if(type=="Order by Name (A-Z)"){_5a8=this.sortHasharray(_5a8,"name");}else{if(type=="Order by Type (A-Z)"){_5a8=this.sortHasharray(_5a8,"type");}else{for(var i=0;i<_5a8.length;i++){if(_5a8[i].type!=type){_5a8.splice(i,1);i--;}}}}console.log("App.setAppTypesCombo     RETURNING itemArray.length: "+_5a8.length);return _5a8;},changeDragSource:function(){console.log("App.changeDragSource     plugins.apps.App.changeDragSource()");console.log("App.changeDragSource     this.dragSourceOnchange: "+this.dragSourceOnchange);console.log("App.changeDragSource     Doing this.setDragSource");this.setDragSource();},deleteItem:function(_5a9){_5a9.name=_5a9.name.replace(/\s+$/,"");_5a9.name=_5a9.name.replace(/^\s+/,"");Agua.removeApp(_5a9,"custom");var url=Agua.cgiUrl+"admin.cgi?";var _5aa=new Object;_5aa.username=Agua.cookie("username");_5aa.sessionid=Agua.cookie("sessionid");_5aa.mode="deleteApp";_5aa.data=_5a9;dojo.xhrPut({url:url,contentType:"text",putData:dojo.toJson(_5aa),load:function(_5ab,_5ac){return _5ab;},error:function(_5ad,_5ae){return _5ad;}});Agua.updater.update("updateApps");},saveInputs:function(_5af,_5b0){console.log("App.saveInputs    plugins.apps.App.saveInputs(inputs)");console.log("App.saveInputs    BEFORE inputs: ");console.dir({inputs:_5af});if(this.savingApp==true){return;}this.savingApp=true;if(_5af==null){_5af=this.getFormInputs(this);if(_5af==null){this.savingApp=false;return;}}console.log("App.saveInputs    AFTER inputs: ");console.dir({inputs:_5af});Agua.removeApp({name:_5af.name});Agua.addApp(_5af);var _5b1=new Object;_5b1.username=Agua.cookie("username");_5b1.sessionid=Agua.cookie("sessionid");_5b1.mode="saveApp";_5b1.data=_5af;var url=Agua.cgiUrl+"admin.cgi?";dojo.xhrPut({url:url,contentType:"text",putData:dojo.toJson(_5b1),timeout:15000,load:function(_5b2,_5b3){return _5b2;},error:function(_5b4,_5b5){return _5b4;}});this.savingApp=false;Agua.updater.update("updateApps",_5b0);},getFormInputs:function(_5b6){console.log("App.getFormInputs    plugins.apps.App.getFormInputs(textarea)");console.log("App.getFormInputs    widget: "+_5b6);console.dir({widget:_5b6});var _5b7=new Object;console.log("App.getFormInputs    inputs: "+_5b7);console.dir({inputs:_5b7});for(var name in this.formInputs){console.log("App.getFormInputs    DOING inputs["+name+"]");var _5b8;if(name=="localonly"){_5b8=0;if(_5b6[name].getValue()=="on"){_5b8=1;}}else{if(name=="package"){_5b8=this.processWidgetValue(_5b6,"packageCombo");}else{console.log("App.getFormInputs    DOING processWidgetValue. widget: ");console.dir({widget:_5b6});_5b8=this.processWidgetValue(_5b6,name);}}_5b7[name]=_5b8;console.log("App.getFormInputs    inputs["+name+"]: "+_5b7[name]);}_5b7=this.checkInputs(_5b6,_5b7);console.log("App.getFormInputs    FINAL inputs: ");console.dir({inputs:_5b7});return _5b7;},checkInputs:function(_5b9,_5ba){console.log("App.checkInputs    inputs: ");console.dir({inputs:_5ba});this.allValid=true;for(var key in this.formInputs){var _5bb=_5ba[key];console.log("App.checkInputs    Checking "+key+": "+_5bb);if(key=="package"){if(this.isValidInput("packageCombo",_5bb)){this.setValid(_5b9["packageCombo"]);}else{this.setInvalid(_5b9["packageCombo"]);this.allValid=false;continuev;}}else{if(this.isValidInput(key,_5bb)){console.log("App.checkInputs    removing 'invalid' class for "+key+": "+_5bb);this.setValid(_5b9[key]);}else{console.log("App.checkInputs    adding 'invalid' class for name "+key+", value "+_5bb);this.setInvalid(_5b9[key]);this.allValid=false;}}}console.log("App.checkInputs    this.allValid: "+this.allValid);if(this.allValid==false){return null;}for(var key in this.formInputs){console.log("App.checkInputs    BEFORE convert, inputs[key]: "+dojo.toJson(_5ba[key]));_5ba[key]=this.convertAngleBrackets(_5ba[key],"htmlToText");console.log("App.checkInputs    AFTER convert, inputs[key]: "+dojo.toJson(_5ba[key]));}return _5ba;}});}if(!dojo._hasResource["plugins.apps.Apps"]){dojo._hasResource["plugins.apps.Apps"]=true;dojo.provide("plugins.apps.Apps");dojo.declare("plugins.apps.Apps",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n\t<!-- ADMIN TAB -->\n\t<div\n        dojoAttachPoint=\"mainTab\"\n        class=\"applications\"\n\t\ticonClass=\"appsIcon\"\n        style=\"min-width: 1140px !important; width: 100% !important; height:100% !important; max-height: auto !important; padding: 0px; background: #FFF;\"\n        dojoType=\"dijit.layout.BorderContainer\"\n\t\tclosable=\"true\"\t\t\n        title=\"Apps\"\n        >\n        \n        <!-- LEFT PANE -->\n        <div\n            dojoAttachPoint=\"leftPane\"\n            class=\"leftPane\"\n\t\t\tlayoutAlign=\"left\" \n            dojoType=\"dijit.layout.ContentPane\" \n            style=\"position: absolute !important; width: 390px; height: 100% !important; max-height: auto !important; min-width: 25px; background: #FFF; padding: 0; border: none !important;\"\n            >\n\n            <!-- LEFT TAB CONTAINER-->\n            <div dojoAttachPoint=\"leftTabContainer\"\n                dojoType=\"dijit.layout.TabContainer\"\n                style=\"height: 100%; overflow: visible;\"\n                class=\"infoPane\">\n\n            </div>\n            <!-- END OF LEFT TAB CONTAINER-->\n\t\t\t\n        </div>\n        <!-- END OF LEFT PANE -->\n\n        <!-- MIDDLE PANE -->\n        <div\n            dojoAttachPoint=\"middlePane\"\n\t\t\tlayoutAlign=\"middle\" \n\t\t\tclass=\"middlePane\"\n            dojoType=\"dijit.layout.ContentPane\" \n            style=\"position: absolute !important; left: 390px !important; height: 100% !important; max-height: auto !important; width: 390px; min-width: 25px; background: #FFF; padding: 0; border: none !important;\"\n            >\n\n            <!-- MIDDLE TAB CONTAINER-->\n            <div\n                dojoAttachPoint=\"middleTabContainer\"\n                dojoType=\"dijit.layout.TabContainer\"\n                style=\"height: 100%; overflow: visible;\"\n                class=\"infoPane\">\n\n            </div>\n\n        </div>\n        <!-- END OF MIDDLE PANE -->\n\n\n        <!-- RIGHT PANE -->\n        <div\n            dojoAttachPoint=\"rightPane\" \n            class=\"rightPane\"\n\t\t\tlayoutAlign=\"right\"\n            dojoType=\"dijit.layout.ContentPane\" \n            style=\"position: absolute !important; left: 780px !important; height: 100% !important; max-height: auto !important; width: 390px !important; min-width: 25px; background: #FFF; padding: 0; border: none !important;\"\n            >\n\n            <!-- RIGHT TAB CONTAINER-->\n            <div dojoAttachPoint=\"rightTabContainer\"\n                dojoType=\"dijit.layout.TabContainer\"\n                style=\"height: 100%; overflow: visible; width: 390px !important; \"\n                class=\"infoPane\">\n\n            </div>\n            <!-- END OF RIGHT TAB CONTAINER-->\n\n        </div>\n        <!-- END OF RIGHT PANE -->\n\n\t</div>\n\t<!-- END OF ADMIN TAB -->\n\n</div>\n",widgetsInTemplate:true,paneWidgets:null,core:new Object,cssFiles:[dojo.moduleUrl("plugins","apps/css/apps.css")],panelList:null,inputs:null,loadPanels:null,constructor:function(args){console.log("apps.Apps.constructor    args:");console.dir({args:args});this.setLoadPanels(args);this.loadCSS();},postCreate:function(){this.startup();},startup:function(){Agua.addWidget("apps",this);Agua.tabs.addChild(this.mainTab);Agua.tabs.selectChild(this.mainTab);this.paneWidgets=new Object;this.headings=Agua.getAppHeadings();console.log("Apps.startup    this.headings:");console.dir({this_headings:this.headings});this.loadPanes();},reload:function(_5bc){if(_5bc=="all"){for(var _5bd in this.headings){for(var i in this.headings[_5bd]){this.reloadWidget(this.headings[_5bd][i]);}}}else{if(_5bc=="leftPane"||_5bc=="middlePane"||_5bc=="rightPane"){for(var i in this.headings[_5bc]){this.reloadWidget(this.headings[_5bc][i]);}}else{try{this.reloadWidget(_5bc);}catch(e){}}}},reloadWidget:function(_5be){delete this.paneWidgets[_5be];var _5bf=this;this.paneWidgets[_5be]=new plugins.apps[_5be]({parentWidget:_5bf,tabContainer:_5bf.leftTabContainer});},loadPanes:function(){var _5c0=["left","middle","right"];for(var i=0;i<_5c0.length;i++){this.loadPane(_5c0[i]);}},loadPane:function(side){console.log("Apps.loadPane     side: "+side);console.log("Apps.loadPane     this.loadPanels: ");console.dir({this_loadPanels:this.loadPanels});var pane=side+"Pane";var _5c1=side+"TabContainer";if(this.headings==null||this.headings[pane]==null){return;}for(var i=0;i<this.headings[pane].length;i++){var _5c2=this.headings[pane][i];console.log("Apps.loadPane    dojo.require tabPaneName: "+_5c2);if(this.loadPanels&&!this.loadPanels[_5c2.toLowerCase()]){console.log("Apps.loadPane    Skipping panel: "+_5c2);continue;}var _5c3="plugins.apps."+_5c2;console.log("Apps.loadPane    BEFORE dojo.require moduleName: "+_5c3);dojo["require"](_5c3);console.log("Apps.loadPane    AFTER dojo.require moduleName: "+_5c3);var _5c4=this;var _5c5=new plugins["apps"][_5c2]({parentWidget:_5c4,tabContainer:_5c4[_5c1]});if(this.paneWidgets[_5c3]==null){this.paneWidgets[_5c3]=new Array;}this.paneWidgets[_5c3].push(_5c5);}},destroyRecursive:function(){console.log("Apps.destroyRecursive    this.mainTab: ");console.dir({this_mainTab:this.mainTab});if(Agua&&Agua.tabs){Agua.tabs.removeChild(this.mainTab);}this.inherited(arguments);}});}if(!dojo._hasResource["dojo.cookie"]){dojo._hasResource["dojo.cookie"]=true;dojo.provide("dojo.cookie");dojo.cookie=function(name,_5c6,_5c7){var c=document.cookie;if(arguments.length==1){var _5c8=c.match(new RegExp("(?:^|; )"+dojo.regexp.escapeString(name)+"=([^;]*)"));return _5c8?decodeURIComponent(_5c8[1]):undefined;}else{_5c7=_5c7||{};var exp=_5c7.expires;if(typeof exp=="number"){var d=new Date();d.setTime(d.getTime()+exp*24*60*60*1000);exp=_5c7.expires=d;}if(exp&&exp.toUTCString){_5c7.expires=exp.toUTCString();}_5c6=encodeURIComponent(_5c6);var _5c9=name+"="+_5c6,_5ca;for(_5ca in _5c7){_5c9+="; "+_5ca;var _5cb=_5c7[_5ca];if(_5cb!==true){_5c9+="="+_5cb;}}document.cookie=_5c9;}};dojo.cookie.isSupported=function(){if(!("cookieEnabled" in navigator)){this("__djCookieTest__","CookiesAllowed");navigator.cookieEnabled=this("__djCookieTest__")=="CookiesAllowed";if(navigator.cookieEnabled){this("__djCookieTest__","",{expires:-1});}}return navigator.cookieEnabled;};}if(!dojo._hasResource["dijit.layout.BorderContainer"]){dojo._hasResource["dijit.layout.BorderContainer"]=true;dojo.provide("dijit.layout.BorderContainer");dojo.declare("dijit.layout.BorderContainer",dijit.layout._LayoutWidget,{design:"headline",gutters:true,liveSplitters:true,persist:false,baseClass:"dijitBorderContainer",_splitterClass:"dijit.layout._Splitter",postMixInProperties:function(){if(!this.gutters){this.baseClass+="NoGutter";}this.inherited(arguments);},startup:function(){if(this._started){return;}dojo.forEach(this.getChildren(),this._setupChild,this);this.inherited(arguments);},_setupChild:function(_5cc){var _5cd=_5cc.region;if(_5cd){this.inherited(arguments);dojo.addClass(_5cc.domNode,this.baseClass+"Pane");var ltr=this.isLeftToRight();if(_5cd=="leading"){_5cd=ltr?"left":"right";}if(_5cd=="trailing"){_5cd=ltr?"right":"left";}if(_5cd!="center"&&(_5cc.splitter||this.gutters)&&!_5cc._splitterWidget){var _5ce=dojo.getObject(_5cc.splitter?this._splitterClass:"dijit.layout._Gutter");var _5cf=new _5ce({id:_5cc.id+"_splitter",container:this,child:_5cc,region:_5cd,live:this.liveSplitters});_5cf.isSplitter=true;_5cc._splitterWidget=_5cf;dojo.place(_5cf.domNode,_5cc.domNode,"after");_5cf.startup();}_5cc.region=_5cd;}},layout:function(){this._layoutChildren();},addChild:function(_5d0,_5d1){this.inherited(arguments);if(this._started){this.layout();}},removeChild:function(_5d2){var _5d3=_5d2.region;var _5d4=_5d2._splitterWidget;if(_5d4){_5d4.destroy();delete _5d2._splitterWidget;}this.inherited(arguments);if(this._started){this._layoutChildren();}dojo.removeClass(_5d2.domNode,this.baseClass+"Pane");dojo.style(_5d2.domNode,{top:"auto",bottom:"auto",left:"auto",right:"auto",position:"static"});dojo.style(_5d2.domNode,_5d3=="top"||_5d3=="bottom"?"width":"height","auto");},getChildren:function(){return dojo.filter(this.inherited(arguments),function(_5d5){return !_5d5.isSplitter;});},getSplitter:function(_5d6){return dojo.filter(this.getChildren(),function(_5d7){return _5d7.region==_5d6;})[0]._splitterWidget;},resize:function(_5d8,_5d9){if(!this.cs||!this.pe){var node=this.domNode;this.cs=dojo.getComputedStyle(node);this.pe=dojo._getPadExtents(node,this.cs);this.pe.r=dojo._toPixelValue(node,this.cs.paddingRight);this.pe.b=dojo._toPixelValue(node,this.cs.paddingBottom);dojo.style(node,"padding","0px");}this.inherited(arguments);},_layoutChildren:function(_5da,_5db){if(!this._borderBox||!this._borderBox.h){return;}var _5dc=dojo.map(this.getChildren(),function(_5dd,idx){return {pane:_5dd,weight:[_5dd.region=="center"?Infinity:0,_5dd.layoutPriority,(this.design=="sidebar"?1:-1)*(/top|bottom/.test(_5dd.region)?1:-1),idx]};},this);_5dc.sort(function(a,b){var aw=a.weight,bw=b.weight;for(var i=0;i<aw.length;i++){if(aw[i]!=bw[i]){return aw[i]-bw[i];}}return 0;});var _5de=[];dojo.forEach(_5dc,function(_5df){var pane=_5df.pane;_5de.push(pane);if(pane._splitterWidget){_5de.push(pane._splitterWidget);}});var dim={l:this.pe.l,t:this.pe.t,w:this._borderBox.w-this.pe.w,h:this._borderBox.h-this.pe.h};dijit.layout.layoutChildren(this.domNode,dim,_5de,_5da,_5db);},destroyRecursive:function(){dojo.forEach(this.getChildren(),function(_5e0){var _5e1=_5e0._splitterWidget;if(_5e1){_5e1.destroy();}delete _5e0._splitterWidget;});this.inherited(arguments);}});dojo.extend(dijit._Widget,{region:"",layoutPriority:0,splitter:false,minSize:0,maxSize:Infinity});dojo.declare("dijit.layout._Splitter",[dijit._Widget,dijit._Templated],{live:true,templateString:"<div class=\"dijitSplitter\" dojoAttachEvent=\"onkeypress:_onKeyPress,onmousedown:_startDrag,onmouseenter:_onMouse,onmouseleave:_onMouse\" tabIndex=\"0\" role=\"separator\"><div class=\"dijitSplitterThumb\"></div></div>",postMixInProperties:function(){this.inherited(arguments);this.horizontal=/top|bottom/.test(this.region);this._factor=/top|left/.test(this.region)?1:-1;this._cookieName=this.container.id+"_"+this.region;},buildRendering:function(){this.inherited(arguments);dojo.addClass(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V"));if(this.container.persist){var _5e2=dojo.cookie(this._cookieName);if(_5e2){this.child.domNode.style[this.horizontal?"height":"width"]=_5e2;}}},_computeMaxSize:function(){var dim=this.horizontal?"h":"w",_5e3=dojo.marginBox(this.child.domNode)[dim],_5e4=dojo.filter(this.container.getChildren(),function(_5e5){return _5e5.region=="center";})[0],_5e6=dojo.marginBox(_5e4.domNode)[dim];return Math.min(this.child.maxSize,_5e3+_5e6);},_startDrag:function(e){if(!this.cover){this.cover=dojo.doc.createElement("div");dojo.addClass(this.cover,"dijitSplitterCover");dojo.place(this.cover,this.child.domNode,"after");}dojo.addClass(this.cover,"dijitSplitterCoverActive");if(this.fake){dojo.destroy(this.fake);}if(!(this._resize=this.live)){(this.fake=this.domNode.cloneNode(true)).removeAttribute("id");dojo.addClass(this.domNode,"dijitSplitterShadow");dojo.place(this.fake,this.domNode,"after");}dojo.addClass(this.domNode,"dijitSplitterActive dijitSplitter"+(this.horizontal?"H":"V")+"Active");if(this.fake){dojo.removeClass(this.fake,"dijitSplitterHover dijitSplitter"+(this.horizontal?"H":"V")+"Hover");}var _5e7=this._factor,_5e8=this.horizontal,axis=_5e8?"pageY":"pageX",_5e9=e[axis],_5ea=this.domNode.style,dim=_5e8?"h":"w",_5eb=dojo.marginBox(this.child.domNode)[dim],max=this._computeMaxSize(),min=this.child.minSize||20,_5ec=this.region,_5ed=_5ec=="top"||_5ec=="bottom"?"top":"left",_5ee=parseInt(_5ea[_5ed],10),_5ef=this._resize,_5f0=dojo.hitch(this.container,"_layoutChildren",this.child.id),de=dojo.doc;this._handlers=(this._handlers||[]).concat([dojo.connect(de,"onmousemove",this._drag=function(e,_5f1){var _5f2=e[axis]-_5e9,_5f3=_5e7*_5f2+_5eb,_5f4=Math.max(Math.min(_5f3,max),min);if(_5ef||_5f1){_5f0(_5f4);}_5ea[_5ed]=_5f2+_5ee+_5e7*(_5f4-_5f3)+"px";}),dojo.connect(de,"ondragstart",dojo.stopEvent),dojo.connect(dojo.body(),"onselectstart",dojo.stopEvent),dojo.connect(de,"onmouseup",this,"_stopDrag")]);dojo.stopEvent(e);},_onMouse:function(e){var o=(e.type=="mouseover"||e.type=="mouseenter");dojo.toggleClass(this.domNode,"dijitSplitterHover",o);dojo.toggleClass(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V")+"Hover",o);},_stopDrag:function(e){try{if(this.cover){dojo.removeClass(this.cover,"dijitSplitterCoverActive");}if(this.fake){dojo.destroy(this.fake);}dojo.removeClass(this.domNode,"dijitSplitterActive dijitSplitter"+(this.horizontal?"H":"V")+"Active dijitSplitterShadow");this._drag(e);this._drag(e,true);}finally{this._cleanupHandlers();delete this._drag;}if(this.container.persist){dojo.cookie(this._cookieName,this.child.domNode.style[this.horizontal?"height":"width"],{expires:365});}},_cleanupHandlers:function(){dojo.forEach(this._handlers,dojo.disconnect);delete this._handlers;},_onKeyPress:function(e){this._resize=true;var _5f5=this.horizontal;var tick=1;var dk=dojo.keys;switch(e.charOrCode){case _5f5?dk.UP_ARROW:dk.LEFT_ARROW:tick*=-1;case _5f5?dk.DOWN_ARROW:dk.RIGHT_ARROW:break;default:return;}var _5f6=dojo._getMarginSize(this.child.domNode)[_5f5?"h":"w"]+this._factor*tick;this.container._layoutChildren(this.child.id,Math.max(Math.min(_5f6,this._computeMaxSize()),this.child.minSize));dojo.stopEvent(e);},destroy:function(){this._cleanupHandlers();delete this.child;delete this.container;delete this.cover;delete this.fake;this.inherited(arguments);}});dojo.declare("dijit.layout._Gutter",[dijit._Widget,dijit._Templated],{templateString:"<div class=\"dijitGutter\" role=\"presentation\"></div>",postMixInProperties:function(){this.inherited(arguments);this.horizontal=/top|bottom/.test(this.region);},buildRendering:function(){this.inherited(arguments);dojo.addClass(this.domNode,"dijitGutter"+(this.horizontal?"H":"V"));}});}if(!dojo._hasResource["plugins.apps.Controller"]){dojo._hasResource["plugins.apps.Controller"]=true;dojo.provide("plugins.apps.Controller");var adminController;dojo.declare("plugins.apps.Controller",[dijit._Widget,dijit._Templated],{paneId:null,templateString:"<div dojoAttachPoint=\"containerNode\" class=\"apps\">\n    <button\n        dojoType=\"dijit.form.Button\"\n        dojoAttachPoint=\"menuButton\"\n        class=\"menuButton\"\n        iconClass=\"appsIcon\"\n        type=\"button\"\n        label=\"Apps\"\n        ></button>\n</div>\n        \n",widgetsInTemplate:true,tabPanes:[],inputs:null,constructor:function(args){console.log("admin.Controller.constructor    args:");console.dir({args:args});if(args.inputs){this.inputs=args.inputs;}this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);Agua.toolbar.addChild(this.menuButton);this.menuButton.parentWidget=this;var _5f7=dojo.connect(this.menuButton,"onClick",this,"createTab");},createTab:function(){var _5f8=this.inputs;var _5f9;if(!_5f8){_5f9=new plugins.apps.Apps({});}else{_5f9=new plugins.apps.Apps({inputs:_5f8});}console.log("admin.Controller.createTab    Doing this.tabPanes.push(widget)");this.tabPanes.push(_5f9);this._supportingWidgets.push(_5f9);},createMenu:function(){var _5fa=new dijit.Menu({id:"admin"+this.paneId+"dynamicMenuPopup"});_5fa.addChild(new dijit.MenuItem({label:"Application Menu",disabled:false}));_5fa.addChild(new dijit.MenuSeparator());var _5fb=new dijit.MenuItem({id:"admin"+this.paneId+"remove",label:"Remove",disabled:false});_5fa.addChild(_5fb);dojo.connect(_5fb,"onClick",function(){var _5fc=_5fa.currentTarget.parentNode;_5fc.removeChild(_5fa.currentTarget);});_5fa.addChild(new dijit.MenuSeparator());var _5fd=new dijit.MenuItem({id:"admin"+this.paneId+"run",label:"Run",disabled:false});_5fa.addChild(_5fd);dojo.connect(_5fd,"onClick",function(){var _5fe=_5fa.currentTarget;var _5ff=_5fe.parentNode;});return _5fa;},loadCSS:function(){var _600=["plugins/apps/css/controller.css"];for(var i in _600){var _601=_600[i];var _602=document.createElement("link");_602.type="text/css";_602.rel="stylesheet";_602.href=_601;_602.media="screen";document.getElementsByTagName("head")[0].appendChild(_602);}}});dojo.addOnLoad(function(){});}if(!dojo._hasResource["plugins.apps.PackageRow"]){dojo._hasResource["plugins.apps.PackageRow"]=true;dojo.provide("plugins.apps.PackageRow");dojo.declare("plugins.apps.PackageRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table width=\"100%\" cellspacing=\"2\">\n        <tr>\n            <td\n                dojoAttachPoint=\"package\"\n                class=\"package\"\n\t\t\t\ttitle=\"package: Name of package\"\n                >${package}</td>\n            <td\n                dojoAttachPoint=\"privacy\"\n                class=\"privacy\"\n\t\t\t\ttitle=\"privacy: Name of privacy\"\n                >${privacy}</td>\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"version\"\n                class=\"version\"\n\t\t\t\ttitle=\"version: Version number of package (e.g., '0.8.0')\"\n                >${version}</td>\n        </tr>\n\n\n<!-- TOGGLED PORTION STARTS HERE -->\n<!-- TOGGLED PORTION STARTS HERE -->\n<!-- TOGGLED PORTION STARTS HERE -->\n\n\n        <tr>\n\t\t\t<td\n\t\t\t\talign=\"right\"\n\t\t\t\tcolspan=\"3\"\n\t\t\t\tstyle=\"background-color: AFA !important\"\n\t\t\t>\n\t\t\t\t<table width=\"99%\" style=\"background-color: #FFF;\">\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td\n\t\t\t\t\t\t\tdojoAttachPoint=\"opsdir\"\n\t\t\t\t\t\t\tclass='opsdir'\n\t\t\t\t\t\t\ttitle=\"opsdir: Absolute path to directory containing *.ops file\"\n\t\t\t\t\t\t>${opsdir}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t</td>\n        </tr>\n\n        <tr>\n\t\t\t<td\n\t\t\t\talign=\"right\"\n\t\t\t\tcolspan=\"3\"\n\t\t\t\tstyle=\"background-color: AFA !important\"\n\t\t\t>\n\t\t\t\t<table width=\"99%\" style=\"background-color: #FFF;\">\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td\n\t\t\t\t\t\t\tdojoAttachPoint=\"installdir\"\n\t\t\t\t\t\t\tclass='installdir'\n\t\t\t\t\t\t\ttitle=\"installdir: Absolute path to base installation directory\"\n\t\t\t\t\t\t>${installdir}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t</td>\n        </tr>\n\n        <tr>\n\t\t\t<td\n\t\t\t\talign=\"right\"\n\t\t\t\tcolspan=\"3\"\n\t\t\t\tstyle=\"background-color: AFA !important\"\n\t\t\t>\n\t\t\t\t<table width=\"99%\" style=\"background-color: #FFF;\">\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td\n\t\t\t\t\t\t\tdojoAttachPoint=\"description\"\n\t\t\t\t\t\t\tclass='description'\n\t\t\t\t\t\t\ttitle=\"description: A brief description of the package\"\n\t\t\t\t\t\t>${description}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t</td>\n        </tr>\n\n        <tr>\n\t\t\t<td\n\t\t\t\talign=\"right\"\n\t\t\t\tcolspan=\"3\"\n\t\t\t\tstyle=\"background-color: AFA !important\"\n\t\t\t>\n\t\t\t\t<table width=\"99%\" style=\"background-color: #FFF;\">\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td\n\t\t\t\t\t\t\tdojoAttachPoint=\"notes\"\n\t\t\t\t\t\t\tclass='notes'\n\t\t\t\t\t\t\ttitle=\"notes: Notes on the package (e.g., release notes)\"\n\t\t\t\t\t\t>${notes}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t</td>\n        </tr>\n        <tr>\n\t\t\t<td\n\t\t\t\talign=\"right\"\n\t\t\t\tcolspan=\"3\"\n\t\t\t\tstyle=\"background-color: AFA !important\"\n\t\t\t>\n\t\t\t\t<table width=\"99%\" style=\"background-color: #FFF;\">\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td\n\t\t\t\t\t\t\tdojoAttachPoint=\"url\"\n\t\t\t\t\t\t\tclass='url'\n\t\t\t\t\t\t\ttitle=\"url: Web address of website providing further details (e.g., http://mysite.com/packages)\"\n\t\t\t\t\t\t>${url}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t</td>\n        </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;this.formInputs=this.parentWidget.formInputs;},postCreate:function(){this.startup();},startup:function(){console.log("PackageRow.startup    this: "+this);this.inherited(arguments);this.setToggle();this.setEdit();},setToggle:function(){var _603=this;var _604=["package","version"];for(var i in _604){dojo.connect(this[_604[i]],"onclick",function(_605){_603.toggle();});}},setEdit:function(){var _606=this;var _607=["opsdir","description","notes","url"];for(var i in _607){dojo.connect(this[_607[i]],"onclick",function(_608){_606.parentWidget.editRow(_606,_608.target);_608.stopPropagation();});}},toggle:function(){var _609=["opsdir","installdir","description","notes","url"];for(var i in _609){if(this[_609[i]].style.display=="inline-block"){this[_609[i]].style.display="none";}else{this[_609[i]].style.display="inline-block";}}}});}if(!dojo._hasResource["plugins.apps.Packages"]){dojo._hasResource["plugins.apps.Packages"]=true;dojo.provide("plugins.apps.Packages");dojo.declare("plugins.apps.Packages",[dijit._Widget,dijit._Templated,plugins.core.Common,plugins.form.EditForm],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- APPS TAB -->\n\t<div\n\t\tdojoAttachPoint=\"mainTab\"\n\t\tclass=\"packages\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Packages\"\n\t\tstyle=\"height: 100% !important; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t\t>\n\n<table width=\"100%\">\n\t<tr valign=\"top\" width=\"100%\">\n\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\">\n\t\t\t<!--<div class=\"tabTitleIcon\">-->\n\t\t\t\tPackages\n\t\t\t<!--</div>-->\n\t\t</td>\n\t</tr>\n\n\t<tr valign=\"top\" width=\"95%\">\n\t\t<td width=\"100%\">\n\t\t\t<!--<div class=\"label\"> New Package </div>-->\n\t\t\t<table width=\"100%\">\n\t\t\t\t<tr width=\"100%\">\n\n\t\t\t\t\t<td colspan=\"3\" height=\"32px\">\n\t\t\t\t\t\t\n\t\t\t\t\t\t<table cellspacing=\"0\" cellpadding=\"0\" border=\"0\" style=\"padding: 0; margin: 0;\">\n\n\t\t\t\t\t\t\t<tr>\n\n\t\t\t\t\t\t\t\t<td \n\t\t\t\t\t\t\t\t\tstyle=\"padding-right: 10px;\" >\n\t\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"package\"\n\t\t\t\t\t\t\t\t\t\tclass=\"package\"\n\t\t\t\t\t\t\t\t\t\tcols=\"30\"\n\t\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t\ttitle=\"name: Name of package\"\n\t\t\t\t\t\t\t\t\t\t>Name</textarea>\n\t\t\t\t\t\t\t\t</td>\n\t\n\t\t\t\t\t\t\t\t<td height=\"20px\"\n\t\t\t\t\t\t\t\t\twidth=\"120px\"\n\t\t\t\t\t\t\t\t\talign=\"right\">\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"addPackageButton\"\n\t\t\t\t\t\t\t\t\t\tclass=\"addPackageButton\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tNew Package\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\n\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\" height=\"8px\">\n\t\t\t\t\t<td >Version</td>\n\t\t\t\t\t<td>Privacy</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr width=\"100%\">\n\t\t\t\t\t<td >\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"version\"\n\t\t\t\t\t\t\tclass=\"version\"\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"version: Version of package (format: N.N.N, i.e., major.minor.patch)\"\n\t\t\t\t\t\t\t>Version</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t\t\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<select\n\t\t\t\t\t\t\tclass=\"privacy\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"privacy\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<option value=\"public\">public</option>\n\t\t\t\t\t\t\t<option value=\"private\">private</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\" height=\"8px\">\n\t\t\t\t\t<td width=\"100%\" colspan=\"3\">Opsdir</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr width=\"100%\">\n\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"opsdir\"\n\t\t\t\t\t\t\tclass=\"opsdir\"\n\t\t\t\t\t\t\tstyle=\"width: 100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"opsdir: Absolute path to directory containing *.ops file\"\n\t\t\t\t\t\t\t>Opsdir</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\" height=\"8px\">\n\t\t\t\t\t<td width=\"100%\" colspan=\"3\">Installdir</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr width=\"100%\">\n\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"installdir\"\n\t\t\t\t\t\t\tclass=\"installdir\"\n\t\t\t\t\t\t\tstyle=\"width: 100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"installdir: Absolute path to base installation directory\"\n\t\t\t\t\t\t\t>Installdir</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\">\n\t\t\t\t\t<td colspan=\"3\"\n\t\t\t\t\t\tclass=\"toggleTitle\"\n\t\t\t\t\t\tdojoAttachEvent=\"onclick:toggle\"\n\t\t\t\t\t\ttitle=\"description: A brief description of the package\"\n\t\t\t\t\t> Details (Click to toggle)</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\">\n\t\t\t\t\t<td colspan=\"3\"\n\t\t\t\t\t\tstyle=\"display: none;\"\n\t\t\t\t\t\ttitle=\"notes: A brief description of the package\"\n\t\t\t\t\t\tdojoAttachPoint=\"descriptionTitle\"\n\t\t\t\t\t>Description</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"description\"\n\t\t\t\t\t\t\tclass=\"description\"\n\t\t\t\t\t\t\tstyle=\"display: none; width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"description: A brief description of the package\"\n\t\t\t\t\t\t>Description</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\">\n\t\t\t\t\t<td colspan=\"3\"\n\t\t\t\t\t\tstyle=\"display: none;\"\n\t\t\t\t\t\ttitle=\"notes: Notes on the package (e.g., release notes)\"\n\t\t\t\t\t\tdojoAttachPoint=\"notesTitle\"\n\t\t\t\t\t>Notes</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"notes\"\n\t\t\t\t\t\t\tclass=\"notes\"\n\t\t\t\t\t\t\tvalue=\"Notes\"\n\t\t\t\t\t\t\tstyle=\"display: none; width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"notes: Notes on the package (e.g., release notes)\"\n\t\t\t\t\t\t>Notes</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\">\n\t\t\t\t\t<td\n\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\tstyle=\"display: none;\"\n\t\t\t\t\t\tdojoAttachPoint=\"urlTitle\"\n\t\t\t\t\t\ttitle=\"url: Web address of website providing further details (e.g., http://mysite.com/packages)\"\n\t\t\t\t\t\t>URL</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"url\"\n\t\t\t\t\t\t\tclass=\"url\"\n\t\t\t\t\t\t\tvalue=\"URL\"\n\t\t\t\t\t\t\tstyle=\"display: none; width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"url: Web address of website providing further details (e.g., http://mysite.com/packages)\"\n\t\t\t\t\t\t>URL</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t</table>\n\t\t</td>\n\t</tr>\n\t\n\t<tr>\n\t\t<td>\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"dragSourceNode\"\n\t\t\t\tclass=\"dragSource\"\n\t\t\t\tstyle=\"height: 385px; width: 96%;\"\n\t\t\t>\n\t\t\t</div>\n\t\t</td>\n\t</tr>\n\n\t<tr align=\"center\">\n\t\t<td align=\"center\">\n\n\t\t\t<!-- TRASH CONTAINER -->\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"trashContainer\"\n\t\t\t\tclass=\"trash\"\n\t\t\t\tstyle=\"height: 60px; width: 150px; align: center;\" \n\t\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"trashIcon\"\n\t\t\t\t\tclass=\"trashIcon\"\n\t\t\t\t\tstyle=\"height: 60px; width: 60px;\"\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</td>\n\t</tr>\n</table>\n\n\n\n\t</div>\n\t<!-- END SOURCES TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,addingPackage:false,cssFiles:[dojo.moduleUrl("plugins","apps/css/packages.css")],parentWidget:null,formInputs:{"package":"word","version":"word","privacy":"word","opsdir":"word","installdir":"word","description":"phrase","notes":"phrase","url":"word"},requiredInputs:{"package":1,version:1,opsdir:1,installdir:1},invalidInputs:{"package":"Name",version:"Version",privacy:"Privacy",opsdir:"Opsdir",installdir:"Installdir",description:"Description",notes:"Notes",url:"URL"},defaultInputs:{"package":"Name",version:"Version",privacy:"Privacy",opsdir:"Opsdir",installdir:"Installdir",description:"Description",notes:"Notes",url:"URL"},dataFields:["package","version","privacy","opsdir","installdir"],avatarItems:["package","description"],rowClass:"plugins.apps.PackageRow",constructor:function(args){this.parentWidget=args.parentWidget;this.packages=args.parentWidget.packages;},postCreate:function(){this.loadCSS();this.startup();},startup:function(){this.inherited(arguments);this.tabContainer.addChild(this.mainTab);this.tabContainer.selectChild(this.mainTab);this.setDragSource();this.setForm();Agua.updater.subscribe(this,"updatePackages");this.setTrash(this.dataFields);},updatePackages:function(args){console.log("Packages.updatePackages    Packages.updatePackages(args)");console.log("Packages.updatePackages    args:");console.dir(args);if(args!=null&&args.reload==false){return;}if(args.originator&&args.originator==this){return;}console.log("Packages.updatePackages    Calling setDragSource()");this.setDragSource();},setForm:function(){dojo.connect(this.addPackageButton,"onclick",dojo.hitch(this,"saveInputs",null,{reload:true}));this.setClearValues();this.chainInputs(["package","type","executor","version","location","description","notes","url","addPackageButton"]);},getItemArray:function(){var _60a=Agua.getPackages();console.log("Packages.getItemArray    itemArray.length: "+_60a.length);_60a=_60a.sort();return _60a;},changeDragSource:function(){this.setDragSource();},deleteItem:function(_60b){_60b["package"]=_60b["package"].replace(/\s+$/,"");_60b["package"]=_60b["package"].replace(/^\s+/,"");Agua.removePackage(_60b,"custom");var url=Agua.cgiUrl+"admin.cgi?";var _60c=new Object;_60c.username=Agua.cookie("username");_60c.sessionid=Agua.cookie("sessionid");_60c.mode="removePackage";_60c.data=_60b;console.log("Packages.deleteItem    query: "+dojo.toJson(_60c));this.doPut({url:url,query:_60c,doToast:false});Agua.updater.update("updatePackages",{originator:this});},saveInputs:function(_60d,_60e){console.log("Packages.saveInputs    caller: "+this.saveInputs.caller.nom);console.log("Packages.saveInputs    inputs: ");console.dir({inputs:_60d});if(this.savingPackage==true){return;}this.savingPackage=true;if(_60d==null){_60d=this.getFormInputs(this);if(_60d==null){this.savingPackage=false;return;}}console.log("Packages.saveInputs    FINAL inputs: ");console.dir({inputs:_60d});var _60f=Agua.isPackage(_60d["package"]);console.log("Packages.saveInputs    isPackage: "+_60f);if(_60f){console.log("Packages.saveInputs    package exits already. Returning");this.setInvalid(this["package"]);Agua.toastMessage({message:"Package exists already: "+_60d["package"],type:"error"});this.savingPackage=false;return;}_60d.owner=Agua.cookie("username");_60d.username=Agua.cookie("username");Agua.removePackage({thisPackage:_60d["package"]});Agua.addPackage(_60d);var _610=new Object;_610.username=Agua.cookie("username");_610.sessionid=Agua.cookie("sessionid");_610.mode="addPackage";_610.data=_60d;var url=Agua.cgiUrl+"admin.cgi?";dojo.xhrPut({url:url,contentType:"text",putData:dojo.toJson(_610),handle:function(_611,_612){return _611;},error:function(_613,_614){return _613;}});this.savingPackage=false;Agua.updater.update("updatePackages",_60e);},toggle:function(){var _615=["descriptionTitle","description","notesTitle","notes","urlTitle","url"];for(var i in _615){if(this[_615[i]].style.display=="inline"){this[_615[i]].style.display="none";}else{this[_615[i]].style.display="inline";}}},getFormInputs:function(_616){var _617=new Object;for(var name in this.formInputs){_617[name]=this.processWidgetValue(_616,name);}_617=this.checkInputs(_616,_617);return _617;}});}if(!dojo._hasResource["plugins.apps.ParameterRow"]){dojo._hasResource["plugins.apps.ParameterRow"]=true;dojo.provide("plugins.apps.ParameterRow");dojo.declare("plugins.apps.ParameterRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table class=\"parameterrow\" width=\"100%\" cellspacing=\"2\">\n        <tr>\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"name\"\n                class=\"name\"\n                width=\"100px\"\n                title=\"name: Name of parameter\"\n                >${name}</td>\n\n\n            <td colspan=\"1\"\n                width=\"100px\"\n                class=\"lockedValueTypeContainer\"\n            >\n\n                <table>\n                    <tr>\n                        <td dojoAttachPoint=\"locked\"\n                            dojoAttachEvent=\"onclick:toggleLock\"\n                            class=\"unlocked\"\n                        >\n                        </td>\n                        \n                        <td\n                            colspan=\"1\"\n                        >\n            \n                            <select\n                                dojoAttachPoint=\"paramtype\"\n                                class='paramtype'\n                                title=\"paramtype: Select type of parameter (input, resource or output)\"\n                                >\n                                <option selected=\"true\" class=\"default\" value=\"${paramtype}\">${paramtype}</option>\n                                <option value=\"input\">input</option>\n                                <option value=\"resource\">resource</option>\n                                <option value=\"output\">output</option>\n                            </select>\n                        \n                        </td>\n                    </tr>\n                </table>\n            \n            </td>\n\n            <td\n                colspan=\"1\"\n                width=\"100px\"\n                class=\"discretion\"\n            >\n\n                <select\n                    dojoAttachPoint=\"discretion\"\n                    class='discretionSelect'\n                    title=\"discretion: Select 'optional',  'required' (must not be empty) or 'essential' (file/directory must be present)\"\n                >\n                    <option selected=\"true\" class=\"default\" value=\"${discretion}\">${discretion}</option>\n                    <option value=\"essential\">essential</option>\n                    <option value=\"required\">required</option>\n                    <option value=\"optional\">optional</option>\n                </select>\n            \n            </td>\n        </tr>\n        \n        \n<!-- TOGGLED PORTION STARTS HERE -->\n<!-- TOGGLED PORTION STARTS HERE -->\n<!-- TOGGLED PORTION STARTS HERE -->\n\n        \n        <tr>\n            <td \n                dojoAttachPoint=\"argument\"\n                colspan=\"1\"\n                class=\"argument\"\n                title=\"argument: Command line argument for parameter (e.g., '--inputfile')\"\n                >${argument}</td>\n\n            <td\n                dojoAttachPoint=\"valuetypeToggle\"\n                class=\"valuetype\"\n                colspan=\"1\"\n                >\n\n                <select\n                    dojoAttachPoint=\"valuetype\"\n                    class=\"valuetype\"\n                    title=\"valuetype: Type of parameter may be physical (e.g., file or directory) or abstract (e.g., integer or text string)\"\n                    >\n                    <option selected=\"true\" value=\"${valuetype}\">${valuetype}</option>\n                    <option value=\"file\">file</option>\n                    <option value=\"files\">files</option>\n                    <option value=\"directory\">directory</option>\n                    <option value=\"directories\">directories</option>\n                    <option value=\"integer\">integer</option>\n                    <option value=\"string\">string</option>\n                    <option value=\"flag\">flag</option>\n                </select>            \n            </td>\n\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"category\"\n                class=\"category\"\n                title=\"category: User-defined category for parameter to be used with input/output chaining. (E.g, the category 'inputfile' includes parameters with arguments '-i', '-infile' and '--inputfile'.)\"\n                >${category}</td>\n        </tr>\n        <tr>\n            <td colspan=\"2\"\n                dojoAttachPoint=\"value\"\n                class='value'\n                title=\"value: Default value of parameter (use '%project%/%workflow%/' for default file path)\"\n                >${value}</td>\n\n            <td colspan=\"1\"\n                class=\"ordinal\"\n                dojoAttachPoint=\"ordinalToggle\"\n            >\n                <table>\n                    <tr>\n                        <td>\n                            <select\n                                class=\"ordinal\"\n                                dojoAttachPoint=\"ordinal\"\n                                title=\"ordinal: Adjust the ordinal value if your application requires the parameters to be in a certain order. Parameters with the same ordinal will be grouped together in alphabetical order.\"\n                                >\n                                <option selected=\"true\" value=\"${ordinal}\">${ordinal}</option>\n                                <option value=\"0\">0</option>\n                                <option value=\"1\">1</option>\n                                <option value=\"2\">2</option>\n                                <option value=\"3\">3</option>\n                                <option value=\"4\">4</option>\n                                <option value=\"5\">5</option>\n                                <option value=\"6\">6</option>\n                                <option value=\"7\">7</option>\n                                <option value=\"8\">8</option>\n                                <option value=\"9\">9</option>\n                                <option value=\"10\">10</option>\n                                <option value=\"11\">11</option>\n                                <option value=\"12\">12</option>\n                                <option value=\"13\">13</option>\n                                <option value=\"14\">14</option>\n                                <option value=\"15\">15</option>\n                            </select>            \n            \n            \n                        <td \n                            colspan=\"1\"\n                            dojoAttachPoint=\"format\"\n                            class=\"format\"\n                            title=\"format: Special file format, to be used for parameter chaining or file checking (e.g., FASTA, FASTQ)\"\n                        >${format}</td>\n\n                    </tr>\n                </table>\n\n            </td>\n            \n        </tr>\n\n        <tr>\n            <td colspan=\"3\"\n                dojoAttachPoint=\"description\"\n                class='description'\n                title=\"description: A description of the parameter and its usage\"\n            >${description}</td>\n\n        </tr>\n\n        <tr>\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"args\"\n                class=\"args\"\n                title=\"args: Arguments for input/output chaining function (e.g., 'input.inputfile.value')\"\n            >${args}</td>\n            <td\n                colspan=\"2\"\n                dojoAttachPoint=\"inputParams\"\n                class=\"inputParams\"\n                title=\"inputParams: Comma-separated list of variable names for each arg in the list of args for the paramFunction (e.g., 'inputfile')\"\n            >${inputParams}</td>\n        </tr>\n\n        <tr>\n            <td colspan=\"3\"\n                width=\"360px\"\n                dojoAttachPoint=\"paramFunction\"\n                class='paramFunction'\n                title=\"paramFunction: Input/output chaining function to automatically determine parameter value from the application itself or the preceding application in the workflow (e.g., 'if ( inputfile != null ) return inputfile')\"\n            >${paramFunction}</td>\n        </tr>\n\n    </table>\n</div>\n\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;this.lockedValue=args.locked;},postCreate:function(args){this.formInputs=this.parentWidget.formInputs;this.startup();},startup:function(){this.inherited(arguments);var _618=this;dojo.connect(this.name,"onclick",function(_619){_618.toggle();});this.setRowHeightListeners();if(this.lockedValue==1){dojo.removeClass(this.locked,"unlocked");dojo.addClass(this.locked,"locked");}else{dojo.removeClass(this.locked,"locked");dojo.addClass(this.locked,"unlocked");}var _618=this;var _61a=["argument","category","value","description","format","args","inputParams","paramFunction"];for(var i in _61a){dojo.connect(this[_61a[i]],"onclick",function(_61b){console.log("ParameterRow.startup    onclick listener fired: "+_61a[i]);_618.parentWidget.editRow(_618,_61b.target);_61b.stopPropagation();});}var _618=this;var _61c=["valuetype","ordinal","discretion","paramtype"];for(var i in _61c){dojo.connect(this[_61c[i]],"onchange",function(_61d){console.log("ParameterRow.startup    onchange listener fired: "+_61c[i]);var _61e=_618.parentWidget.getFormInputs(_618);_618.parentWidget.saveInputs(_61e,{originator:_618.parentWidget,reload:false});_61d.stopPropagation();});}},setRowHeightListeners:function(){var _61f=this;dojo.connect(this.args,"onchange",dojo.hitch(function(_620){setTimeout(function(_621){_621.levelRowHeight(_621);},100,_61f);_620.stopPropagation();}));dojo.connect(this.inputParams,"onchange",dojo.hitch(function(_622){setTimeout(function(_623){_623.levelRowHeight(_623);},100,_61f);_622.stopPropagation();}));},levelRowHeight:function(_624){dojo.attr(_624.inputParams,"style","display: inline-block; max-height: "+_624.inputParams.clientHeight+"px !important");dojo.attr(_624.args,"style","display: inline-block; max-height: "+_624.args.clientHeight+"px !important");dojo.attr(_624.inputParams,"style",{display:"inline-block","min-height":"20px !important"});dojo.attr(_624.args,"style",{display:"inline-block","min-height":"20px !important"});if(_624.inputParams.clientHeight<_624.args.clientHeight){dojo.attr(_624.inputParams,"style","display: inline-block; height: 0px !important");dojo.attr(_624.inputParams,"style","display: inline-block; min-height: "+_624.args.offsetHeight+"px !important");}else{if(_624.inputParams.clientHeight>=_624.args.clientHeight){dojo.attr(_624.args,"style","display: inline-block; height: 0px !important");dojo.attr(_624.args,"style","display: inline-block; min-height: "+_624.inputParams.offsetHeight+"px !important");}}},toggle:function(){var _625=["argument","valuetype","valuetypeToggle","category","value","ordinal","ordinalToggle","description","format","args","inputParams","paramFunction"];for(var i in _625){this.toggleNode(this[_625[i]]);}var _626=dojo.attr(this.args,"style");var _627=_626.match(/display:\s*([^;]+)/)[1];if(_627=="inline-block"){this.levelRowHeight(this);}},toggleNode:function(node){if(node.style.display=="inline-block"){node.style.display="none";}else{node.style.display="inline-block";}},toggleLock:function(_628){console.log("ParameterRow.toggleLock    plugins.apps.Parameter.toggleLock(name)");if(dojo.hasClass(this.locked,"locked")){dojo.removeClass(this.locked,"locked");dojo.addClass(this.locked,"unlocked");Agua.toastMessage({message:"ParameterRow has been unlocked. Users can change this parameter",type:warning});}else{dojo.removeClass(this.locked,"unlocked");dojo.addClass(this.locked,"locked");Agua.toastMessage({message:"ParameterRow has been locked. Users cannot change this parameter",type:"warning"});}var _629=this.parentWidget.getFormInputs(this);this.parentWidget.saveInputs(_629,null);_628.stopPropagation();},formInputs:{locked:"",name:"word",argument:"word",type:"word",category:"word",value:"word",discretion:"word",description:"phrase",format:"word",args:"word",inputParams:"phrase",paramFunction:"phrase"}});}if(!dojo._hasResource["plugins.apps.Parameters"]){dojo._hasResource["plugins.apps.Parameters"]=true;dojo.provide("plugins.apps.Parameters");dojo.declare("plugins.apps.Parameters",[plugins.form.DndSource,plugins.form.Inputs,plugins.form.EditRow,plugins.form.DndTrash,plugins.core.Common,dijit._Widget,dijit._Templated],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- SOURCES TAB -->\n\t<div\n\t\tdojoAttachPoint=\"parametersTab\"\n\t\tclass=\"parameters\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Parameters\"\n\t\tstyle=\"height: 100% !important; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t\t>\n\n<table width=\"100%\">\n\t<tr valign=\"top\" width=\"100%\">\n\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\">\n\t\t\tParameters\n\t\t</td>\n\t</tr>\n\n\t<tr class=\"inputs\" valign=\"top\" width=\"95%\">\n\t\t<td>\n\t\t\t<table width=\"100%\" style=\"padding: 0px;\">\n\t\t\t\t<tr width=\"100%\">\n\t\t\t\t\t\n\t\t\t\t\t<td colspan=\"3\" height=\"32px\" width=\"100%\">\n\t\t\t\t\t\t\n\t\t\t\t\t\t<table cellspacing=\"0px\" cellpadding=\"0px\" border=\"0\" style=\"padding: 0; margin: 0;\">\n\t\t\t\t\t\t\t<tr>\n\n\t\t\t\t\t\t\t\t<td align=\"center\" >\n\t\t\t\t\t\t\t\t\t<table>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td align=\"center\">\n\t\t\t\t\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"name\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"name\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"width: 220px !important; font-weight: bolder;\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tcols=\"30\"\n\t\t\t\t\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"name: Name of parameter\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t>Name</textarea>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t<td dojoAttachPoint=\"locked\"\n\t\t\t\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:toggleLock\"\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"unlocked\"\n\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"locked: Click to lock/unlock user access to edit this parameter\">\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t</td>\n\t\n\t\t\t\t\t\t\t\t<td height=\"20px\"\n\t\t\t\t\t\t\t\t\twidth=\"120px\"\n\t\t\t\t\t\t\t\t\talign=\"right\">\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"addParameterButton\"\n\t\t\t\t\t\t\t\t\t\tclass=\"addParameterButton\"\n\t\t\t\t\t\t\t\t\t\ttitle=\"Click to create new parameter\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tNew Param\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\n\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\" height=\"8px\">\n\t\t\t\t\t<td width=\"160px\">Argument</td>\n\t\t\t\t\t<td width=\"100px\">ParamType</td>\n\t\t\t\t\t<td width=\"33%\">Discretion</td>\n\t\t\t\t</tr>\n\t\t\t\t\t\n\t\t\t\t<tr width=\"100%\">\n\n\t\t\t\t\t<td width=\"160px\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"argument\"\n\t\t\t\t\t\t\tclass=\"argument\"\n\t\t\t\t\t\t\tstyle=\"width: 160px !important; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"`\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\ttitle=\"argument: Command line argument for parameter (e.g., '--inputfile')\"\n\t\t\t\t\t\t\t>Argument</textarea>\n\t\t\t\t\t</td>\n\n\n\t\t\t\t\t<td colspan=\"1\" width=\"100px\">\n\t\t\t\t\t\t<select\n\t\t\t\t\t\t\tdojoAttachPoint=\"paramtype\"\n\t\t\t\t\t\t\tclass=\"paramtype\"\n\t\t\t\t\t\t\tvalue=\"Paramtype\"\n\t\t\t\t\t\t\tstyle=\"width: 100px !important; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\ttitle=\"paramtype: Select type of parameter (input, resource or output)\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<option style=\"text-style: italic; text-weight: normal; background-color: #DDD;\" value=\"Paramtype\">Paramtype</option>\n\t\t\t\t\t\t\t<option value=\"input\">input</option>\n\t\t\t\t\t\t\t<option value=\"resource\">resource</option>\n\t\t\t\t\t\t\t<option value=\"output\">output</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</td>\n\n\t\t\t\t\t<td colspan=\"1\" width=\"100px\">\n\t\t\t\t\t\t<select\n\t\t\t\t\t\t\tdojoAttachPoint=\"discretion\"\n\t\t\t\t\t\t\tclass=\"discretion\"\n\t\t\t\t\t\t\tvalue=\"Discretion\"\n\t\t\t\t\t\t\tstyle=\"width: 100px !important; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\ttitle=\"discretion: Select optional, required (must not be empty) or essential (file/directory must be present)\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<option style=\"text-style: italic; text-weight: normal; background-color: #DDD;\" value=\"Discretion\">Discretion</option>\n\t\t\t\t\t\t\t<option value=\"essential\">essential</option>\n\t\t\t\t\t\t\t<option value=\"required\">required</option>\n\t\t\t\t\t\t\t<option value=\"optional\">optional</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</td>\n\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\" width=\"100%\" height=\"8px\">\n\t\t\t\t\t<td width=\"160px\">Value</td>\n\t\t\t\t\t<td width=\"100px\">Ordinal</td>\n\n\t\t\t\t</tr>\n\n\t\t\t\t<tr width=\"100%\">\n\t\t\t\t\t<td colspan=\"1\" width=\"160px\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"value\"\n\t\t\t\t\t\t\tclass=\"value\"\n\t\t\t\t\t\t\tstyle=\"width: 160px !important; font-weight: bolder; font-family: Verdana; overflow: hidden !important;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t                title=\"value: Default value of parameter (use '%project%/%workflow%/' for default file path)\"\n\t\t\t\t\t\t\t>Value</textarea>\n\t\t\t\t\t</td>\n\n\t\t\t\t\t<td width=\"100px\">\n\t\t\t\t\t\t<select\n\t\t\t\t\t\t\tdojoAttachPoint=\"valuetype\"\n\t\t\t\t\t\t\tclass=\"valuetype\"\n\t\t\t\t\t\t\tstyle=\"width: 100px !important; font-weight: bolder; font-family: Verdana;\";\n\t\t                    title=\"valuetype: Type of parameter may be physical (e.g., file or directory) or abstract (e.g., integer or text string)\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<option selected=\"true\" class=\"default\" value=\"Type\">ValueType</option>\n\t\t\t\t\t\t\t<option value=\"file\">file</option>\n\t\t\t\t\t\t\t<option value=\"files\">files</option>\n\t\t\t\t\t\t\t<option value=\"directory\">directory</option>\n\t\t\t\t\t\t\t<option value=\"directories\">directories</option>\n\t\t\t\t\t\t\t<option value=\"integer\">integer</option>\n\t\t\t\t\t\t\t<option value=\"string\">string</option>\n\t\t\t\t\t\t\t<option value=\"flag\">flag</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</td>\n\n\n\t\t\t\t\t<td width=\"100px\"\n\t\t\t\t\t\tstyle=\"padding-left: 5px;\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"category\"\n\t\t\t\t\t\t\tclass=\"category\"\n\t\t\t\t\t\t\tstyle=\"width: 90px !important; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t                title=\"category: User-defined category for parameter to be used with input/output chaining. (E.g, the category 'inputfile' includes parameters with arguments '-i', '-infile' and '--inputfile'.)\"\n\t\t\t\t\t\t\t>Category</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr class=\"headerRow\">\n\t\t\t\t\t<td width=\"100%\"\n\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\tclass=\"toggleTitle\"\n\t\t\t\t\t\tdojoAttachEvent=\"onclick:toggleDescription\"\n\t\t\t\t\t> Details (Click to toggle)</td>\n\t\t\t\t</tr>\n\n\t\t\t</table>\n\t\t</td>\n\n\t</tr>\n\t<tr class=\"inputs\" >\n\t\t<td>\n\n\t\t\t<table\n\t\t\t\tstyle=\"display: none\"\n\t\t\t\tdojoAttachPoint=\"togglePoint\"\n\t\t\t\twidth=\"100%\"\n\t\t\t\tstyle=\"padding: 0px;\"\n\t\t\t>\n\n\t\t\t\t<tr class=\"headerRow\">\n\t\t\t\t\t<td width=\"67%\"\n\t\t\t\t\t\tcolspan=\"2\"\n\t\t\t\t\t>Description</td>\n\n\t\t\t\t\t<td width=\"33%\"\n\t\t\t\t\t>Ordinal</td>\n\n\t\t\t\t</tr>\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td\n\t\t\t\t\tcolspan=\"3\">\n\t\t\t\t\t\t\n\t\t\t\t\t\t<table>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td colspan=\"2\" width=\"270px\">\n\t\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"description\"\n\t\t\t\t\t\t\t\t\t\tclass=\"description\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 270px !important; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\t\tcols=\"24\"\n\t\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t\ttitle=\"description: A brief description of the parameter\"\n\t\t\t\t\t\t\t\t\t>Description</textarea>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\n\t\t\t\t\t\t\t\t<td width=\"100px\">\n\t\t\t\t\t\t\t\t\t<select\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"ordinal\"\n\t\t\t\t\t\t\t\t\t\tclass=\"ordinal\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 100px !important; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\t\ttitle=\"ordinal: Adjust the ordinal value if your application requires the parameters to be in a certain order. Parameters with the same ordinal will be grouped together in alphabetical order.\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<option selected=\"true\" class=\"default\" value=\"1\">Ordinal</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"1\">1</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"2\">2</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"3\">3</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"4\">4</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"5\">5</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"6\">6</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"7\">7</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"8\">8</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"9\">9</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"10\">10</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"11\">11</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"12\">12</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"13\">13</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"14\">14</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"15\">15</option>\n\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\n\t\t\t\t\t\t\t</tr>\n\t\t\t\n\t\t\t\n\t\t\t\t\t\t\t<tr class=\"headerRow\" width=\"100%\" height=\"8px\">\n\t\t\t\t\t\t\t\t<td width=\"160px\">Format</td>\n\t\t\t\t\t\t\t\t<td width=\"100px\">Arguments</td>\n\t\t\t\t\t\t\t\t<td width=\"100px\">Parameters</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\n\t\t\t\t\t\t\t<tr width=\"100%\">\n\t\t\t\t\t\t\t\t<td width=\"162px\">\n\t\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"format\"\n\t\t\t\t\t\t\t\t\t\tclass=\"format\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 162px !important; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\t\tcols=\"24\"\n\t\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t\ttitle=\"format: Special file format, to be used for parameter chaining or file checking (e.g., FASTA, FASTQ)\"\n\t\t\t\t\t\t\t\t\t\t>Format</textarea>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td width=\"100px\"\n\t\t\t\t\t\t\t\t\tstyle=\"padding-left: 4px; padding-right: 4px;\" >\n\t\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"args\"\n\t\t\t\t\t\t\t\t\t\tclass=\"args\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 100px !important; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t\ttitle=\"args: Arguments for input/output chaining function (e.g., 'input.inputfile.value')\"\n\t\t\t\t\t\t\t\t\t\t>Args</textarea>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\n\t\t\t\t\t\t\t\t<td width=\"100px\">\n\t\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"inputParams\"\n\t\t\t\t\t\t\t\t\t\tclass=\"inputParams\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 96px !important; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\t\tcols=\"10\"\n\t\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t\ttitle=\"inputParams: Comma-separated list of variable names for each arg in the list of args for the paramFunction (e.g., 'inputfile')\"\n\t\t\t\t\t\t\t\t\t\t>Params</textarea>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\n\t\t\t\t\t\t\t<tr class=\"headerRow\" width=\"100%\" height=\"8px\">\n\t\t\t\t\t\t\t\t<td colspan=\"3\">Parameter Function</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td colspan=\"3\" width=\"380px\">\n\t\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"paramFunction\"\n\t\t\t\t\t\t\t\t\t\tclass=\"paramFunction\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 380px !important; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t\ttitle=\"paramFunction: Input/output chaining function to automatically determine parameter value from the application itself or the preceding application in the workflow (e.g., 'if ( inputfile != null ) return inputfile')\"\n\t\t\t\t\t\t\t\t\t>ParamFunction</textarea>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t</table>\n\t\t</td>\n\t</tr>\n\t\n\t<tr>\n\t\t<td width=\"50%\" align=\"center\">\n\t\t\t<table>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t\n\n\t\t\t\t\t\t<table>\t\t\t\n\t\t\t\t\t\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t\t\t\t\t\t<td width=\"95%\">\n\t\t\t\t\t\t\t\t\t<div class=\"label\"> Application </div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"appsCombo\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\t\t\tclass=\"appsCombo\"\n\t\t\t\t\t\t\t\t\t\tpopupClass=\"parameters appsCombo dijitReset dijitMenu\"\n\t\t\t\t\t\t\t\t\t\tautocomplete=\"true\"\n\t\t\t\t\t\t\t\t\t\thasDownArrow=\"true\"\n\t\t\t\t\t\t\t\t\t\tdisabled=\"false\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 150px;\"\n\t\t\t\t\t\t\t\t\t\ttitle=\"Select the order of the displayed applications\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td align=\"center\">\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"appNamesCombo\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\t\t\tclass=\"appNamesCombo\"\n\t\t\t\t\t\t\t\t\t\tautocomplete=\"true\"\n\t\t\t\t\t\t\t\t\t\thasDownArrow=\"true\"\n\t\t\t\t\t\t\t\t\t\tdisabled=\"false\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 150px;\"\n\t\t\t\t\t\t\t\t\t\ttitle=\"Select an application to view its inputs below\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td width=\"50%\" align=\"center\" valign=\"top\">\n\t\t\t\t\t\t<table valign=\"top\">\n\t\t\t\t\t\t\t<tr valign=\"top\">\n\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t<div class=\"label paramTypes\"> Parameters </div>\n\t\t\t\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td align=\"center\">\n\t\t\t\t\n\t\t\t\t\t\t\t\t\t<select\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"paramOrderCombo\"\n\t\t\t\t\t\t\t\t\t\tclass='paramOrderCombo'\n\t\t\t\t\t\t\t\t\t\ttitle=\"Filter displayed parameters\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<option \n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"option\"\n\t\t\t\t\t\t\t\t\t\t\t\tselected=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"Order by Name\">Order by Name</option>\n\t\t\t\t\t\t\t\t\t\t<option \n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"option\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"Order by Ordinal\">Order by Ordinal</option>\n\t\t\t\t\t\t\t\t\t\t<option\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"option\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"Order by Type\">Order by Type</option>\n\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td align=\"center\">\n\t\t\t\t\n\t\t\t\t\t\t\t\t\t<select\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"paramFilterCombo\"\n\t\t\t\t\t\t\t\t\t\tclass='paramFilterCombo'\n\t\t\t\t\t\t\t\t\t\ttitle=\"Filter displayed parameters\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<option\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"option\"\n\t\t\t\t\t\t\t\t\t\t\t\tselected=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"All\">All</option>\n\t\t\t\t\t\t\t\t\t\t<option\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"option\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"input\">input</option>\n\t\t\t\t\t\t\t\t\t\t<option\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"option\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"resource\">resource</option>\n\t\t\t\t\t\t\t\t\t\t<option\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"option\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"output\">output</option>\n\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\t\t\t\n\n\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t</td>\n\t</tr>\n\n\t<tr>\n\t\t<td>\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"dragSourceNode\"\n\t\t\t\tclass=\"dragSource\"\n\t\t\t\tstyle=\"height: 361px; width: 94%;\"\n\t\t\t>\n\t\t\t</div>\n\t\t</td>\n\t</tr>\n\n\t<tr align=\"center\">\n\t\t<td align=\"center\">\n\n\t\t\t<!-- TRASH CONTAINER -->\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"trashContainer\"\n\t\t\t\tclass=\"trash\"\n\t\t\t\tstyle=\"height: 60px; width: 150px; align: center;\" \n\t\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"trashIcon\"\n\t\t\t\t\tclass=\"trashIcon\"\n\t\t\t\t\tstyle=\"height: 60px; width: 60px;\"\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</td>\n\t</tr>\n</table>\n\n\n\n\t</div>\n\t<!-- END SOURCES TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,addingParameter:false,cssFiles:[dojo.moduleUrl("plugins","apps/css/parameters.css"),dojo.moduleUrl("dojo","tests/dnd/dndDefault.css")],parentWidget:null,formInputs:{locked:"",name:"word",argument:"word",valuetype:"word",category:"word",value:"word",ordinal:"word",discretion:"word",description:"phrase",paramtype:"paramtype",format:"word",args:"word",inputParams:"phrase",paramFunction:"phrase"},defaultInputs:{name:"Name",argument:"Argument",category:"Category",value:"Value",description:"Description",format:"Format",args:"Args",inputParams:"Params",paramFunction:"ParamFunction"},requiredInputs:{name:1,paramtype:1,valuetype:1,category:1,discretion:1,paramtype:1},invalidInputs:{name:"Name",argument:"Argument",valuetype:"ValueType",category:"Category",value:"Value",discretion:"Discretion",description:"Description",paramtype:"Paramtype",format:"Format",args:"Args",inputParams:"Params",paramFunction:"ParamFunction"},dataFields:["name","appname","paramtype"],rowClass:"plugins.apps.ParameterRow",avatarItems:["name","description"],avatarType:"parameters",childWidgets:[],constructor:function(args){this.parentWidget=args.parentWidget;},postCreate:function(){this.loadCSS();this.inherited(arguments);this.startup();},startup:function(){this.inherited(arguments);this.tabContainer.addChild(this.parametersTab);this.tabContainer.selectChild(this.parametersTab);this.setAppTypesCombo();this.setForm();this.setTrash(this.dataFields);setTimeout(function(_62a){_62a.setComboListeners();},1000,this);Agua.updater.subscribe(this,"updateApps");Agua.updater.subscribe(this,"updateParameters");},updateApps:function(args){this.setAppNamesCombo();this.setAppTypesCombo();this.setDragSource();},updateParameters:function(args){if(args.originator==this){if(args.reload==false){return;}}this.setDragSource();},toggleDescription:function(){console.log("Packages.toggle    this.togglePoint.style.display: "+this.togglePoint.style.display);if(this.togglePoint.style.display=="inline-block"){this.togglePoint.style.display="none";}else{this.togglePoint.style.display="inline-block";}},setAppTypesCombo:function(type){var apps=Agua.getApps();var _62b=this.hashArrayKeyToArray(apps,"type");_62b=this.uniqueValues(_62b);_62b=this.sortNoCase(_62b);_62b.splice(0,0,"Order by Type");_62b.splice(0,0,"Order by Name");var data={identifier:"name",items:[]};for(var i=0;i<_62b.length;i++){data.items[i]={name:_62b[i]};}var _62c=new dojo.data.ItemFileWriteStore({data:data});this.appsCombo.store=_62c;this.appsCombo.startup();var _62d=_62b[0];this.appsCombo.set("value",_62d);this.setAppNamesCombo();},setAppNamesCombo:function(){var type=this.appsCombo.get("value");var _62e=Agua.getApps();var _62f=["type"];var _630=[type];if(type=="Order by Name"){_62e=this.sortHasharray(_62e,"name");}else{if(type=="Order by Type"){_62e=this.sortHasharray(_62e,"name");_62e=this.sortHasharray(_62e,"type");}else{_62e=this.filterByKeyValues(_62e,_62f,_630);}}if(_62e==null||_62e.length==0){return;}var data={identifier:"name",items:[]};for(var i=0;i<_62e.length;i++){data.items[i]={name:_62e[i].name};}var _631=new dojo.data.ItemFileWriteStore({data:data});this.appNamesCombo.store=_631;this.appNamesCombo.startup();var _632=_62e[0].name;this.appNamesCombo.set("value",_632);this.setDragSource();},setComboListeners:function(){dojo.connect(this.paramOrderCombo,"onchange",this,"setDragSource");dojo.connect(this.paramFilterCombo,"onchange",this,"setDragSource");dojo.connect(this.appsCombo,"onChange",dojo.hitch(this,function(){this.setAppNamesCombo();}));var _633=this;dojo.connect(this.appNamesCombo,"onChange",dojo.hitch(this,function(){_633.setDragSource();}));},toggleLock:function(){if(dojo.hasClass(this.locked,"locked")){dojo.removeClass(this.locked,"locked");dojo.addClass(this.locked,"unlocked");Agua.warning("Parameter has been unlocked. Users can change this parameter");}else{dojo.removeClass(this.locked,"unlocked");dojo.addClass(this.locked,"locked");Agua.warning("Parameter has been locked. Users cannot change this parameter");}},setForm:function(){dojo.connect(this.addParameterButton,"onclick",dojo.hitch(this,"saveInputs",null,{originator:this,reload:true}));this.setClearValues();this.chainInputs(["name","argument","valuetype","category","value","ordinal","paramtype","description","discretion","format","args","inputParams","paramFunction","addParameterButton"]);},getItemArray:function(){var _634=this.appNamesCombo.get("value");var _635=Agua.getParametersByAppname(_634);var _636=this.paramOrderCombo.value;if(_636=="Order by Name"){_635=this.sortHasharray(_635,"name");}else{if(_636=="Order by Type"){_635=this.sortHasharray(_635,"paramtype");}else{if(_636=="Order by Ordinal"){_635=this.sortHasharray(_635,"ordinal");}else{_635=this.sortHasharray(_635,"name");}}}var _637=this.paramFilterCombo.value;var _638=["paramtype"];var _639=[_637];if(_637=="All"){}else{_635=this.filterByKeyValues(_635,_638,_639);}return _635;},deleteItem:function(_63a){if(_63a.name==null){return;}if(_63a.appname==null){return;}_63a.owner=Agua.cookie("username");Agua.removeParameter(_63a);Agua.updater.update("updateParameters",{originator:this});},saveInputs:function(_63b,_63c){if(this.savingInputs==true){return;}this.savingInputs=true;if(_63b==null){_63b=this.getFormInputs(this);if(_63b==null||this.allValid==false){this.savingInputs=false;return;}}_63b.owner=Agua.cookie("username");var _63d=this.appNamesCombo.get("value");_63b.appname=_63d;var _63e=Agua.getAppType(_63d);_63b.apptype=_63e;Agua.addParameter(_63b);for(var name in this.invalidInputs){if(_63b[name]==null){_63b[name]="";}if(_63b[name]==this.invalidInputs[name]){_63b[name]="";}_63b[name]=_63b[name].replace(/'/g,"\"");}for(var i=0;i<_63b.length;i++){_63b[i]=this.convertBackslash(_63b[i],"expand");}var url=Agua.cgiUrl+"admin.cgi?";var _63f=new Object;_63f.username=Agua.cookie("username");_63f.sessionid=Agua.cookie("sessionid");_63f.mode="saveParameter";_63f.data=_63b;this.doPut({url:url,query:_63f,sync:false});this.savingInputs=false;Agua.updater.update("updateParameters",_63c);},getFormInputs:function(_640){var _641=new Object;for(var name in this.formInputs){var _642;if(dojo.hasClass(_640[name],"locked")){_642="1";}else{if(dojo.hasClass(_640[name],"unlocked")){_642="0";}else{_642=this.getWidgetValue(_640[name]);}}_641[name]=_642;}_641=this.checkInputs(_640,_641);return _641;},checkInputs:function(_643,_644){var _645=false;var _646=this.paramtype.value;if(_646=="input"){_645=true;}this.allValid=true;for(var key in this.formInputs){if(key=="argument"&&_645==false){dojo.removeClass(_643[key],"invalid");continue;}_644[key]=this.convertString(_644[key],"htmlToText");_644[key]=this.convertBackslash(_644[key],"expand");if((this.isValidInput(key,_644[key])==false&&this.requiredInputs[key]!=null)||(this.requiredInputs[key]!=null&&(_644[key]==null||_644[key]==""))){this.addClass(_643[key],"invalid");this.allValid=false;}else{this.removeClass(_643[key],"invalid");}}this.checkArgsBalance(_643);this.checkSyntax(_643);if(this.allValid==false){return null;}return _644;},checkArgsBalance:function(_647){console.log("Parameters.checkArgsBalance    plugins.apps.Parameters.checkArgsBalance(widget)");console.log("Parameters.checkArgsBalance    console.dir(widget):");console.dir({widget:_647});var args=_647.args.innerHTML;var _648=_647.inputParams.innerHTML;console.log("Parameters.checkArgsBalance    args: "+args);console.log("Parameters.checkArgsBalance    inputParams: "+_648);var _649=args.split(/,/);console.log("Parameters.checkArgsBalance    argsArray.length: "+_649.length);var _64a=_648.split(/,/);console.log("Parameters.checkArgsBalance    paramsArray.length: "+_64a.length);if(_64a==null){return;}if(_64a.length==null||_64a.length==0){return;}if(_649.length==null||_649.length!=_64a.length){this.allValid=false;this.setInvalid(_647.args);this.setInvalid(_647.inputParams);}else{this.setValid(_647.args);this.setValid(_647.inputParams);}console.log("Parameters.checkArgsBalance    FINAL this.allValid: "+this.allValid);},checkSyntax:function(_64b){console.log("Parameters.checkSyntax    plugins.apps.Parameterss.checkSyntax(widget)");console.log("Parameters.checkSyntax    console.dir(widget):");console.dir({widget:_64b});var _64c=_64b.inputParams.innerHTML;var _64d=_64b.paramFunction.innerHTML;console.log("Parameters.checkSyntax    inputParams: "+_64c);console.log("Parameters.checkSyntax    paramFunction: "+_64d);try{var _64e="var func = function("+_64c+") {"+_64d+"}";console.log("Parameters.checkSyntax    funcString: "+_64e);eval(_64e);console.log("Parameters.checkSyntax    eval OK");this.setValid(_64b.paramFunction);}catch(error){console.log("error: "+error);this.allValid=false;this.setInvalid(_64b.paramFunction);}console.log("Parameters.checkArgsBalance    FINAL this.allValid: "+this.allValid);}});}if(!dojo._hasResource["dojo.number"]){dojo._hasResource["dojo.number"]=true;dojo.provide("dojo.number");dojo.getObject("number",true,dojo);dojo.number.format=function(_64f,_650){_650=dojo.mixin({},_650||{});var _651=dojo.i18n.normalizeLocale(_650.locale),_652=dojo.i18n.getLocalization("dojo.cldr","number",_651);_650.customs=_652;var _653=_650.pattern||_652[(_650.type||"decimal")+"Format"];if(isNaN(_64f)||Math.abs(_64f)==Infinity){return null;}return dojo.number._applyPattern(_64f,_653,_650);};dojo.number._numberPatternRE=/[#0,]*[#0](?:\.0*#*)?/;dojo.number._applyPattern=function(_654,_655,_656){_656=_656||{};var _657=_656.customs.group,_658=_656.customs.decimal,_659=_655.split(";"),_65a=_659[0];_655=_659[(_654<0)?1:0]||("-"+_65a);if(_655.indexOf("%")!=-1){_654*=100;}else{if(_655.indexOf("")!=-1){_654*=1000;}else{if(_655.indexOf("")!=-1){_657=_656.customs.currencyGroup||_657;_658=_656.customs.currencyDecimal||_658;_655=_655.replace(/\u00a4{1,3}/,function(_65b){var prop=["symbol","currency","displayName"][_65b.length-1];return _656[prop]||_656.currency||"";});}else{if(_655.indexOf("E")!=-1){throw new Error("exponential notation not supported");}}}}var _65c=dojo.number._numberPatternRE;var _65d=_65a.match(_65c);if(!_65d){throw new Error("unable to find a number expression in pattern: "+_655);}if(_656.fractional===false){_656.places=0;}return _655.replace(_65c,dojo.number._formatAbsolute(_654,_65d[0],{decimal:_658,group:_657,places:_656.places,round:_656.round}));};dojo.number.round=function(_65e,_65f,_660){var _661=10/(_660||10);return (_661*+_65e).toFixed(_65f)/_661;};if((0.9).toFixed()==0){(function(){var _662=dojo.number.round;dojo.number.round=function(v,p,m){var d=Math.pow(10,-p||0),a=Math.abs(v);if(!v||a>=d||a*Math.pow(10,p+1)<5){d=0;}return _662(v,p,m)+(v>0?d:-d);};})();}dojo.number._formatAbsolute=function(_663,_664,_665){_665=_665||{};if(_665.places===true){_665.places=0;}if(_665.places===Infinity){_665.places=6;}var _666=_664.split("."),_667=typeof _665.places=="string"&&_665.places.indexOf(","),_668=_665.places;if(_667){_668=_665.places.substring(_667+1);}else{if(!(_668>=0)){_668=(_666[1]||[]).length;}}if(!(_665.round<0)){_663=dojo.number.round(_663,_668,_665.round);}var _669=String(Math.abs(_663)).split("."),_66a=_669[1]||"";if(_666[1]||_665.places){if(_667){_665.places=_665.places.substring(0,_667);}var pad=_665.places!==undefined?_665.places:(_666[1]&&_666[1].lastIndexOf("0")+1);if(pad>_66a.length){_669[1]=dojo.string.pad(_66a,pad,"0",true);}if(_668<_66a.length){_669[1]=_66a.substr(0,_668);}}else{if(_669[1]){_669.pop();}}var _66b=_666[0].replace(",","");pad=_66b.indexOf("0");if(pad!=-1){pad=_66b.length-pad;if(pad>_669[0].length){_669[0]=dojo.string.pad(_669[0],pad);}if(_66b.indexOf("#")==-1){_669[0]=_669[0].substr(_669[0].length-pad);}}var _66c=_666[0].lastIndexOf(","),_66d,_66e;if(_66c!=-1){_66d=_666[0].length-_66c-1;var _66f=_666[0].substr(0,_66c);_66c=_66f.lastIndexOf(",");if(_66c!=-1){_66e=_66f.length-_66c-1;}}var _670=[];for(var _671=_669[0];_671;){var off=_671.length-_66d;_670.push((off>0)?_671.substr(off):_671);_671=(off>0)?_671.slice(0,off):"";if(_66e){_66d=_66e;delete _66e;}}_669[0]=_670.reverse().join(_665.group||",");return _669.join(_665.decimal||".");};dojo.number.regexp=function(_672){return dojo.number._parseInfo(_672).regexp;};dojo.number._parseInfo=function(_673){_673=_673||{};var _674=dojo.i18n.normalizeLocale(_673.locale),_675=dojo.i18n.getLocalization("dojo.cldr","number",_674),_676=_673.pattern||_675[(_673.type||"decimal")+"Format"],_677=_675.group,_678=_675.decimal,_679=1;if(_676.indexOf("%")!=-1){_679/=100;}else{if(_676.indexOf("")!=-1){_679/=1000;}else{var _67a=_676.indexOf("")!=-1;if(_67a){_677=_675.currencyGroup||_677;_678=_675.currencyDecimal||_678;}}}var _67b=_676.split(";");if(_67b.length==1){_67b.push("-"+_67b[0]);}var re=dojo.regexp.buildGroupRE(_67b,function(_67c){_67c="(?:"+dojo.regexp.escapeString(_67c,".")+")";return _67c.replace(dojo.number._numberPatternRE,function(_67d){var _67e={signed:false,separator:_673.strict?_677:[_677,""],fractional:_673.fractional,decimal:_678,exponent:false},_67f=_67d.split("."),_680=_673.places;if(_67f.length==1&&_679!=1){_67f[1]="###";}if(_67f.length==1||_680===0){_67e.fractional=false;}else{if(_680===undefined){_680=_673.pattern?_67f[1].lastIndexOf("0")+1:Infinity;}if(_680&&_673.fractional==undefined){_67e.fractional=true;}if(!_673.places&&(_680<_67f[1].length)){_680+=","+_67f[1].length;}_67e.places=_680;}var _681=_67f[0].split(",");if(_681.length>1){_67e.groupSize=_681.pop().length;if(_681.length>1){_67e.groupSize2=_681.pop().length;}}return "("+dojo.number._realNumberRegexp(_67e)+")";});},true);if(_67a){re=re.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/g,function(_682,_683,_684,_685){var prop=["symbol","currency","displayName"][_684.length-1],_686=dojo.regexp.escapeString(_673[prop]||_673.currency||"");_683=_683?"[\\s\\xa0]":"";_685=_685?"[\\s\\xa0]":"";if(!_673.strict){if(_683){_683+="*";}if(_685){_685+="*";}return "(?:"+_683+_686+_685+")?";}return _683+_686+_685;});}return {regexp:re.replace(/[\xa0 ]/g,"[\\s\\xa0]"),group:_677,decimal:_678,factor:_679};};dojo.number.parse=function(_687,_688){var info=dojo.number._parseInfo(_688),_689=(new RegExp("^"+info.regexp+"$")).exec(_687);if(!_689){return NaN;}var _68a=_689[1];if(!_689[1]){if(!_689[2]){return NaN;}_68a=_689[2];info.factor*=-1;}_68a=_68a.replace(new RegExp("["+info.group+"\\s\\xa0"+"]","g"),"").replace(info.decimal,".");return _68a*info.factor;};dojo.number._realNumberRegexp=function(_68b){_68b=_68b||{};if(!("places" in _68b)){_68b.places=Infinity;}if(typeof _68b.decimal!="string"){_68b.decimal=".";}if(!("fractional" in _68b)||/^0/.test(_68b.places)){_68b.fractional=[true,false];}if(!("exponent" in _68b)){_68b.exponent=[true,false];}if(!("eSigned" in _68b)){_68b.eSigned=[true,false];}var _68c=dojo.number._integerRegexp(_68b),_68d=dojo.regexp.buildGroupRE(_68b.fractional,function(q){var re="";if(q&&(_68b.places!==0)){re="\\"+_68b.decimal;if(_68b.places==Infinity){re="(?:"+re+"\\d+)?";}else{re+="\\d{"+_68b.places+"}";}}return re;},true);var _68e=dojo.regexp.buildGroupRE(_68b.exponent,function(q){if(q){return "([eE]"+dojo.number._integerRegexp({signed:_68b.eSigned})+")";}return "";});var _68f=_68c+_68d;if(_68d){_68f="(?:(?:"+_68f+")|(?:"+_68d+"))";}return _68f+_68e;};dojo.number._integerRegexp=function(_690){_690=_690||{};if(!("signed" in _690)){_690.signed=[true,false];}if(!("separator" in _690)){_690.separator="";}else{if(!("groupSize" in _690)){_690.groupSize=3;}}var _691=dojo.regexp.buildGroupRE(_690.signed,function(q){return q?"[-+]":"";},true);var _692=dojo.regexp.buildGroupRE(_690.separator,function(sep){if(!sep){return "(?:\\d+)";}sep=dojo.regexp.escapeString(sep);if(sep==" "){sep="\\s";}else{if(sep==""){sep="\\s\\xa0";}}var grp=_690.groupSize,grp2=_690.groupSize2;if(grp2){var _693="(?:0|[1-9]\\d{0,"+(grp2-1)+"}(?:["+sep+"]\\d{"+grp2+"})*["+sep+"]\\d{"+grp+"})";return ((grp-grp2)>0)?"(?:"+_693+"|(?:0|[1-9]\\d{0,"+(grp-1)+"}))":_693;}return "(?:0|[1-9]\\d{0,"+(grp-1)+"}(?:["+sep+"]\\d{"+grp+"})*)";},true);return _691+_692;};}if(!dojo._hasResource["dijit.form.NumberTextBox"]){dojo._hasResource["dijit.form.NumberTextBox"]=true;dojo.provide("dijit.form.NumberTextBox");dojo.declare("dijit.form.NumberTextBoxMixin",null,{regExpGen:dojo.number.regexp,value:NaN,editOptions:{pattern:"#.######"},_formatter:dojo.number.format,_setConstraintsAttr:function(_694){var _695=typeof _694.places=="number"?_694.places:0;if(_695){_695++;}if(typeof _694.max!="number"){_694.max=9*Math.pow(10,15-_695);}if(typeof _694.min!="number"){_694.min=-9*Math.pow(10,15-_695);}this.inherited(arguments,[_694]);if(this.focusNode&&this.focusNode.value&&!isNaN(this.value)){this.set("value",this.value);}},_onFocus:function(){if(this.disabled){return;}var val=this.get("value");if(typeof val=="number"&&!isNaN(val)){var _696=this.format(val,this.constraints);if(_696!==undefined){this.textbox.value=_696;}}this.inherited(arguments);},format:function(_697,_698){var _699=String(_697);if(typeof _697!="number"){return _699;}if(isNaN(_697)){return "";}if(!("rangeCheck" in this&&this.rangeCheck(_697,_698))&&_698.exponent!==false&&/\de[-+]?\d/i.test(_699)){return _699;}if(this.editOptions&&this._focused){_698=dojo.mixin({},_698,this.editOptions);}return this._formatter(_697,_698);},_parser:dojo.number.parse,parse:function(_69a,_69b){var v=this._parser(_69a,dojo.mixin({},_69b,(this.editOptions&&this._focused)?this.editOptions:{}));if(this.editOptions&&this._focused&&isNaN(v)){v=this._parser(_69a,_69b);}return v;},_getDisplayedValueAttr:function(){var v=this.inherited(arguments);return isNaN(v)?this.textbox.value:v;},filter:function(_69c){return (_69c===null||_69c===""||_69c===undefined)?NaN:this.inherited(arguments);},serialize:function(_69d,_69e){return (typeof _69d!="number"||isNaN(_69d))?"":this.inherited(arguments);},_setBlurValue:function(){var val=dojo.hitch(dojo.mixin({},this,{_focused:true}),"get")("value");this._setValueAttr(val,true);},_setValueAttr:function(_69f,_6a0,_6a1){if(_69f!==undefined&&_6a1===undefined){_6a1=String(_69f);if(typeof _69f=="number"){if(isNaN(_69f)){_6a1="";}else{if(("rangeCheck" in this&&this.rangeCheck(_69f,this.constraints))||this.constraints.exponent===false||!/\de[-+]?\d/i.test(_6a1)){_6a1=undefined;}}}else{if(!_69f){_6a1="";_69f=NaN;}else{_69f=undefined;}}}this.inherited(arguments,[_69f,_6a0,_6a1]);},_getValueAttr:function(){var v=this.inherited(arguments);if(isNaN(v)&&this.textbox.value!==""){if(this.constraints.exponent!==false&&/\de[-+]?\d/i.test(this.textbox.value)&&(new RegExp("^"+dojo.number._realNumberRegexp(dojo.mixin({},this.constraints))+"$").test(this.textbox.value))){var n=Number(this.textbox.value);return isNaN(n)?undefined:n;}else{return undefined;}}else{return v;}},isValid:function(_6a2){if(!this._focused||this._isEmpty(this.textbox.value)){return this.inherited(arguments);}else{var v=this.get("value");if(!isNaN(v)&&this.rangeCheck(v,this.constraints)){if(this.constraints.exponent!==false&&/\de[-+]?\d/i.test(this.textbox.value)){return true;}else{return this.inherited(arguments);}}else{return false;}}}});dojo.declare("dijit.form.NumberTextBox",[dijit.form.RangeBoundTextBox,dijit.form.NumberTextBoxMixin],{baseClass:"dijitTextBox dijitNumberTextBox"});}if(!dojo._hasResource["plugins.form.ValidationTextarea"]){dojo._hasResource["plugins.form.ValidationTextarea"]=true;dojo.provide("plugins.form.ValidationTextarea");dojo.declare("plugins.form.ValidationTextarea",[dijit.form.ValidationTextBox,dijit.form.SimpleTextarea],{invalidMessage:"This field is required",regExp:"(.|\\s)*",preamble:function(args){this.invalidMessage=args.invalidMessage;},constructor:function(args){this.invalidMessage=args.invalidMessage;this.promptMessage=args.promptMessage;},postCreate:function(){var _6a3=this.invalidMessage;var _6a4=this.promptMessage;this.inherited(arguments);this.invalidMessage=_6a3;this.promptMessage=_6a4;},validate:function(){this.inherited(arguments);if(arguments.length==0){this.validate(false);}},onFocus:function(){if(!this.isValid()){this.displayMessage(this.getErrorMessage());}},onBlur:function(){this.validate(false);}});}if(!dojo._hasResource["plugins.cloud.AmiRow"]){dojo._hasResource["plugins.cloud.AmiRow"]=true;dojo.provide("plugins.cloud.AmiRow");dojo.declare("plugins.cloud.AmiRow",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n    <table class=\"amiRow\" width=\"100%\">\n        <tr width=\"95%\">\n            \n            <td\n\t\t\t\tdojoAttachEvent=\"onclick:toggle\"\n\t\t\t\talign=\"center\"\n\t\t\t\tclass=\"amiid\"\n\t\t\t\tdojoAttachPoint=\"amiid\"\n\t\t\t>${amiid}\n\t\t\t</td>\n\t\t\t<td\n                dojoAttachPoint=\"cluster\"\n                class=\"aminame\"\n                title=\"AMI Name\"\n            >\n\t\t\t\t<input\n\t\t\t\t\tdojoAttachPoint=\"aminame\"\n\t\t\t\t\tclass=\"aminame\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tvalue=\"${aminame}\"\n\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\tregExp=\"^\\S{1,20}$\"\n\t\t\t\t\tmaxlength=\"20\" \n\t\t\t\t\tpromptMessage=\"AMI name: up to 20 characters (no spaces)\" \n\t\t\t\t\tinvalidMessage=\"AMI name: up to 20 characters (no spaces)\"\n\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t\twrap=\"off\"\n\t\t\t\t\t>\n\t\t\t</td>\n            <td class=\"amitype\">\n                <select\n                    dojoAttachPoint=\"amitype\"\n\t\t\t\t\tclass=\"amitype\"\n\t\t\t\t\ttitle=\"AMI type: EBS-backed (stop/startable, retains its state) or emphemeral S3 type\">\n\t\t\t\t\t<option value=\"${amitype}\">${amitype}</option> \n\t\t\t\t\t<option value=\"S3\">S3</option>\n\t\t\t\t\t<option value=\"EBS\">EBS</option> \n                </select>\n            </td>\n\n\t\t</tr>\n\t\t<tr width=\"95%\">\n\t\t\t<td\n                align=\"center\"\n                colspan=\"3\"\n                dojoAttachPoint=\"description\"\n                dojoAttachEvent=\"onclick:editCluster\"\n                class=\"description\"\n                width=\"100%\"\n                title=\"A brief description of the cluster group\"\n            >${description}</td>\n\t\t</tr>\n    </table>\n\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;this.lockedValue=args.locked;this.args=args;},postCreate:function(){this.formInputs=this.parentWidget.formInputs;this.startup();},startup:function(){this.inherited(arguments);var _6a5={target:{selectedIndex:0,options:[{text:"us-east-1"}]}};this.setOnkeyListeners(["aminame"]);setTimeout(function(_6a6){_6a6.setComboListeners();},2000,this);},setOnkeyListeners:function(_6a7){var _6a8=this;for(var i in _6a7){dojo.connect(_6a8[_6a7[i]],"onKeyPress",function(evt){var key=evt.charOrCode;evt.stopPropagation();if(key==13){_6a8.saveInputs();}});}},setComboListeners:function(){var _6a9=this;dojo.connect(this.amitype,"onchange",function(_6aa){if(_6aa.stopPropagation==null){return;}var _6ab=_6a9.parentWidget.getFormInputs(_6a9);_6a9.parentWidget.saveInputs(_6ab,{reload:false});_6aa.stopPropagation();});},saveInputs:function(){var _6ac=this.parentWidget.getFormInputs(this);this.parentWidget.saveInputs(_6ac,{reload:false});},editCluster:function(_6ad){this.parentWidget.editRow(this,_6ad.target);_6ad.stopPropagation();},toggle:function(){console.log("AmiRow.toggle    plugins.workflow.AmiRow.toggle()");console.log("AmiRow.toggle    this.description: "+this.description);var _6ae=["description"];for(var i in _6ae){console.log("AmiRow.toggle    toggling: "+_6ae[i]);if(this[_6ae[i]].style.display=="table-cell"){this[_6ae[i]].style.display="none";}else{this[_6ae[i]].style.display="table-cell";}}}});}if(!dojo._hasResource["plugins.cloud.Ami"]){dojo._hasResource["plugins.cloud.Ami"]=true;dojo.provide("plugins.cloud.Ami");dojo.declare("plugins.cloud.Ami",[dijit._Widget,dijit._Templated,plugins.core.Common,plugins.form.EditForm],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!--http://aws.amazon.com/ec2/instance-types/-->\n\n\t<!-- ami TAB -->\n\t<div\n\t\tdojoAttachPoint=\"mainTab\"\n\t\tclass=\"ami\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"AMIs\"\n\t\tstyle=\"height: 100% !important; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t>\n\n\t<table align=\"center\" width=\"100%\">\n\n\t\t<tr valign=\"top\" width=\"100%\">\n\t\t\t<td colspan=\"3\" class=\"tabTitle\" align=\"center\">AMIs</td>\n\t\t</tr>\n\n\t\t<tr height=\"20px\">\n\t\t\t<td align=\"center\" colspan=\"3\">\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"addAmiButton\"\n\t\t\t\t\tclass=\"addAmiButton\"\n\t\t\t\t\t>Add AMI</div>\n\t\t\t</td>\n\t\t</tr>\n\n\t\t<tr class=\"headerRow\">\n\t\t\t<td>AMI ID</td>\n\t\t\t<td>AMI Name</td>\n\t\t\t<td>AMI Type</td>\n\t\t</tr>\n\n\t\t<tr>\n\t\t\t<td>\n\t\t\t\t<input\n\t\t\t\t\tdojoAttachPoint=\"amiid\"\n\t\t\t\t\tclass=\"amiid\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tvalue=\"ami-d1c42db8\"\n\t\t\t\t\ttitle=\"AMI ID of the Starcluster image used for all cluster nodes (The base x86_64 StarCluster AMI is ami-d1c42db8)\"\n\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\tregExp=\"^ami-[A-F0-9a-f]{8}$\"\n\t\t\t\t\tmaxlength=\"12\" \n\t\t\t\t\tpromptMessage=\"AMI identifier. Must be 'ami-XXXXXXXX' in hexadecimal (a-f0-09), e.g. ami-d1c42db8\" \n\t\t\t\t\tinvalidMessage=\"AMI identifier. Must be 'ami-XXXXXXXX' in hexadecimal (a-f0-09), e.g., ami-d1c42db8\" \n\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t\twrap=\"off\"\n\t\t\t\t>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t\t<input\n\t\t\t\t\tdojoAttachPoint=\"aminame\"\n\t\t\t\t\tclass=\"aminame\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tvalue=\"myAmi\"\n\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\tregExp=\"^\\S{1,20}$\"\n\t\t\t\t\tmaxlength=\"20\" \n\t\t\t\t\tpromptMessage=\"AMI name: up to 20 characters (no spaces)\" \n\t\t\t\t\tinvalidMessage=\"AMI name: up to 20 characters (no spaces)\"\n\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t\twrap=\"off\"\n\t\t\t\t\t>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t\t<select\n\t\t\t\t\tdojoAttachPoint=\"amitype\"\n\t\t\t\t\tclass=\"amitype\"\n\t\t\t\t\ttitle=\"AMI type: EBS-backed (stop/startable, retains its state) or emphemeral S3 type\">\n\t\t\t\t\t<option value=\"EBS\">EBS</option> \n\t\t\t\t\t<option value=\"S3\">S3</option>\n\t\t\t\t</select>\n\t\t\t</td>\n\t\t</tr>\n\n\t\t<tr class=\"headerRow\" width=\"95%\" height=\"8px\">\n\t\t\t<td colspan=\"3\">Description</td>\n\t\t</tr>\n\n\t\t<tr width=\"95%\" >\n\t\t\t<td align=\"center\" colspan=\"3\">\n\t\t\t\t<textarea\n\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\tdojoAttachPoint=\"description\"\n\t\t\t\t\tclass=\"description\"\n\t\t\t\t\tcols=\"40\"\n\t\t\t\t\trows=\"1\"\n\t\t\t\t\ttitle=\"A brief description of the cluster group\"\n\t\t\t\t>Description</textarea>\n\t\t\t</td>\n\t\t</tr>\n\n\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t<td colspan=\"3\" width=\"95%\">\n\t\t\t\t<div class=\"label\"> AMIs </div>\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"dragSourceNode\"\n\t\t\t\t\tclass=\"dragSource\"\n\t\t\t\t\tstyle=\"height: 327px; width: 95%;\"\n\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t</tr>\n\n\t\t<tr align=\"center\">\n\t\t\t<td colspan=\"3\" align=\"center\">\n\n\t\t\t\t<!-- TRASH CONTAINER -->\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"trashContainer\"\n\t\t\t\t\tclass=\"trash\"\n\t\t\t\t\tstyle=\"height: 60px; width: 150px; align: center;\" \n\t\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoAttachPoint=\"trashIcon\"\n\t\t\t\t\t\tclass=\"trashIcon\"\n\t\t\t\t\t\tstyle=\"height: 60px; width: 60px;\"\n\t\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t</tr>\n\t</table>\n\n\n\t</div>\n\t<!-- END ami TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,addingUser:false,cssFiles:[dojo.moduleUrl("plugins")+"/cloud/css/ami.css"],parentWidget:null,formInputs:{aminame:"word",amiid:"word",amitype:"word",description:"phrase"},defaultInputs:{aminame:"myAmi",amiid:"AMI ID",description:"Description"},requiredInputs:{aminame:1,amiid:1},invalidInputs:{aminame:"myAmi",amiid:"AMI ID",description:"Description"},dataFields:["amiid","aminame"],rowClass:"plugins.cloud.AmiRow",avatarType:"parameters",avatarItems:["aminame","amiid","amitype","description"],constructor:function(args){this.parentWidget=args.parentWidget;this.ami=args.parentWidget.ami;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){console.log("Ami.startup    plugins.cloud.Ami.startup()");this.inherited(arguments);this.tabContainer.addChild(this.mainTab);this.tabContainer.selectChild(this.mainTab);this.setForm();this.setClearValues();this.setDragSource();console.log("Ami.startup    BEFORE this.setTrash(this.dataFields), I.E., plugins.form.DndTrash.startup()");this.setTrash(this.dataFields);console.log("Ami.startup    AFTER this.setTrash(this.dataFields), I.E., plugins.form.DndTrash.startup()");Agua.updater.subscribe(this,"updateAmis");},updateAmis:function(args){console.log("Ami.updateAmis(args)");console.log("Ami.updateAmis    args: ");console.dir(args);if(args.originator==this){if(args.reload==false){return;}}console.log("Ami.updateAmis    Calling setDragSource()");this.setDragSource();},setForm:function(){console.log("Ami.setForm    plugins.cloud.Ami.setForm()");dojo.connect(this.addAmiButton,"onclick",dojo.hitch(this,"saveInputs",null,null));dojo.connect(this.aminame,"onFocus",dojo.hitch(this,"clearValue",this.aminame,this.invalidInputs["aminame"]));this.inherited(arguments);},getItemArray:function(){return Agua.getAmis();},setDragSource:function(){console.log("Ami.setDragSource     plugins.cloud.Ami.setDragSource()");if(this.dragSource==null){this.initialiseDragSource();this.setDragSourceCreator();}this.clearDragSource();var _6af=this.getItemArray();console.log("Ami.setDragSource     itemArray: "+dojo.toJson(_6af));_6af=this.sortHasharray(_6af,"aminame");console.log("Ami.setDragSource    itemArray: "+dojo.toJson(_6af));if(_6af==null){console.log("Ami.setDragSource     itemArray is null or empty. Returning.");return;}this.loadDragItems(_6af);},saveInputs:function(_6b0,_6b1){console.log("Ami.saveInputs    plugins.cloud.Ami.saveInputs(inputs, reload)");console.log("Ami.saveInputs    inputs: "+dojo.toJson(_6b0));console.log("Ami.saveInputs    reload: ");console.dir(_6b1);if(this.saving==true){return;}this.saving=true;if(_6b0==null){_6b0=this.getFormInputs(this);console.log("Ami.saveInputs    inputs: ");console.dir({inputs:_6b0});if(_6b0==null){this.saving=false;return;}}console.log("Ami.saveInputs    inputs: "+dojo.toJson(_6b0));Agua.addAmi(_6b0);this.saving=false;Agua.updater.update("updateAmis",{originator:this,reload:_6b1});},deleteItem:function(_6b2){console.log("Ami.deleteItem    plugins.cloud.Ami.deleteItem(name)");console.log("Ami.deleteItem    amiObject: "+dojo.toJson(_6b2));Agua.removeAmi(_6b2);Agua.updater.update("updateAmis",{originator:this,reload:false});},checkEnter:function(_6b3){console.log("Ami.checkEnter    event.keyCode: "+_6b3.keyCode);if(_6b3.keyCode==dojo.keys.ENTER){this.saveInputs();dojo.stopEvent(_6b3);}},checkEnterNodes:function(_6b4){console.log("Ami.checkEnterNodes    event.keyCode: "+_6b4.keyCode);if(_6b4.keyCode==dojo.keys.ENTER){dojo.stopEvent(_6b4);console.log("Ami.checkEnterNodes    setting document.body.focus()");document.body.focus();this.checkNodeNumbers();this.saveInputs();}},checkNodeNumbers:function(){console.log("Ami.checkNodeNumbers     plugins.cloud.Ami.checkNodeNumbers()");console.log("Ami.checkNodeNumbers     this.minnodes.get('value'): "+this.minnodes.get("value"));console.log("Ami.checkNodeNumbers     this.maxnodes.get('value'): "+this.maxnodes.get("value"));if(this.minnodes.value>this.maxnodes.value){console.log("Ami.checkNodeNumbers     this.minnodes.value > this.maxnodes.value");this.minnodes.set("value",this.maxnodes.value);}}});}if(!dojo._hasResource["plugins.cloud.Aws"]){dojo._hasResource["plugins.cloud.Aws"]=true;dojo.provide("plugins.cloud.Aws");dojo.declare("plugins.cloud.Aws",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t\n\t<!-- settings TAB -->\n\t<div\n\t\tdojoAttachPoint=\"mainTab\"\n\t\tclass=\"aws\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"AWS\"\n\t\tstyle=\"height: 700px; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t\t>\n\n\t\t<table width=\"100%\">\n\t\t\t<tr valign=\"top\" width=\"100%\">\n\t\t\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\"> AWS </td>\n\t\t\t</tr>\n\t\t\t\n\t\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t\t<td width=\"95%\">\n\t\t\t\t\t<div class=\"label\"> Amazon Web Services </div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"subPane\"\n\t\t\t\t\t\tstyle=\"height: 680px; width: 95%;\"\n\t\t\t\t\t>\n\n\t\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\tcolspan=\"2\"\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"addAwsButton\"\n\t\t\t\t\t\t\t\tclass=\"addAwsButton\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:addAws\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tSave\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">Amazon User ID</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"amazonuserid\"\n\t\t\t\t\t\t\t\t\tclass=\"amazonUserId\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\twrap=\"off\"\n\t\t\t\t\t\t\t\t\tregExp=\"^\\d{12}$\"\n\t\t\t\t\t\t\t\t\tmaxlength=\"12\"\n\t\t\t\t\t\t\t\t\tpromptMessage=\"Enter your 12-digit Amazon User ID (numbers only)\" \n\t\t\t\t\t\t\t\t\tinvalidMessage=\"Invalid User ID (Must be 12 digits, numbers only).\"\n\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">AWS Key ID</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"awsaccesskeyid\"\n\t\t\t\t\t\t\t\t\tclass=\"accessKeyId\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tmaxlength=\"24\"\n\t\t\t\t\t\t\t\t\tuppercase=\"true\"\n\t\t\t\t\t\t\t\t\tregExp=\"[A-Z0-9]{16,24}\"\n\t\t\t\t\t\t\t\t\tinvalidMessage=\"16-24 characters: capital letters or numbers\"\n\t\t\t\t\t\t\t\t\tpromptMessage=\"16-24 characters: capital letters or numbers\"\n\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">AWS Secret Key</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"awssecretaccesskey\"\n\t\t\t\t\t\t\t\t\tclass=\"secretAccessKey\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tmaxlength=\"45\"\n\t\t\t\t\t\t\t\t\tregExpGen=\"return '.{35,45}'\"\n\t\t\t\t\t\t\t\t\tinvalidMessage=\"35-45 characters\"\n\t\t\t\t\t\t\t\t\tpromptMessage=\"35-45 characters\"\n\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">Private Key</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"ec2privatekey\"\n\t\t\t\t\t\t\t\t\tclass=\"ec2privatekey\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%;\";\n\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\trows=\"20\"></textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">Public Certificate</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"ec2publiccert\"\n\t\t\t\t\t\t\t\t\tclass=\"ec2publiccert\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%;\";\n\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\trows=\"20\"\n\t\t\t\t\t\t\t\t></textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t</table>\n\n\t\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\n\t\t</table>\n\n\t</div>\n\t<!-- END settings TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,addingUser:false,cssFiles:[dojo.moduleUrl("plugins","cloud/css/aws.css"),],requiredInputs:{amazonuserid:1,awsaccesskeyid:1,awssecretaccesskey:1,ec2privatekey:1,ec2publiccert:1},parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;this.core=args.parentWidget.core;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.tabContainer.addChild(this.mainTab);this.tabContainer.selectChild(this.mainTab);this.initialiseAws();},addAws:function(_6b5){console.clear();console.log("Aws.addAws    plugins.cloud.Aws.addAws(event)");console.log("Aws.addAws    event: "+_6b5);if(this.savingAws==true){console.log("Aws.addAws    this.savingAws: "+this.savingAws+". Returning.");return;}this.savingAws=true;var _6b6=this.validateInputs();if(!_6b6){this.savingAws=false;return;}var _6b7=_6b6;_6b7.username=Agua.cookie("username");_6b7.sessionid=Agua.cookie("sessionid");_6b7.repotype="github";_6b7.mode="addAws";console.log("Aws.addAws    query: ");console.dir({query:_6b7});var url=Agua.cgiUrl+"workflow.cgi?";var _6b8=this;dojo.xhrPut({url:url,contentType:"json",putData:dojo.toJson(_6b7),handleAs:"json",load:function(_6b9,_6ba){console.log("Aws.addAws    STATUS response:");console.dir({response:_6b9});if(!_6b9){Agua.toast({error:"No response from server on 'addAws'"});return;}if(!_6b9.error){console.log("Aws.addAWS    DOING Agua.setAws(inputs)");Agua.setAws(_6b6);}Agua.toast(_6b9);},error:function(_6bb,_6bc){console.log("Aws.addAws    ERROR response:");console.dir({response:_6bb});Agua.toast(_6bb);}});this.savingAws=false;},validateInputs:function(){var _6bd=new Object;this.isValid=true;for(var _6be in this.requiredInputs){_6bd[_6be]=this.verifyInput(_6be);}console.log("Aws.validateInputs    inputs: ");console.dir({inputs:_6bd});if(!this.isValid){return null;}return _6bd;},verifyInput:function(_6bf){console.log("Aws.verifyInput    input: ");console.dir({this_input:this[_6bf]});var _6c0=this[_6bf].value;_6c0=this.cleanEdges(_6c0);console.log("Aws.verifyInput    value: "+_6c0);var _6c1=this.getClassName(this[_6bf]);console.log("Aws.verifyInput    className: "+_6c1);if(_6c1){console.log("Aws.verifyInput    this[input].isValid(): "+this[_6bf].isValid());if(!_6c0||!this[_6bf].isValid()){console.log("Aws.verifyInput    input "+_6bf+" value is empty. Adding class 'invalid'");dojo.addClass(this[_6bf].domNode,"invalid");this.isValid=false;}else{console.log("Aws.verifyInput    value is NOT empty. Removing class 'invalid'");dojo.removeClass(this[_6bf].domNode,"invalid");return _6c0;}}else{if(!_6c0){console.log("Aws.verifyInput    input "+_6bf+" value is EMPTY. Adding class 'invalid'");dojo.addClass(this[_6bf],"invalid");this.isValid=false;return null;}else{if(_6bf=="ec2privatekey"){if(!_6c0.match(/^\s*-----BEGIN PRIVATE KEY-----[\s\S]+-----END PRIVATE KEY-----\S*$/)){console.log("Aws.verifyInput    value is INVALID. Adding class 'invalid'");dojo.addClass(this[_6bf],"invalid");this.isValid=false;return null;}console.log("Aws.verifyInput    value is VALID. Removing class 'invalid'");dojo.removeClass(this[_6bf],"invalid");return _6c0;}else{if(_6bf=="ec2publiccert"){if(!_6c0.match(/^\s*-----BEGIN CERTIFICATE-----[\s\S]+-----END CERTIFICATE-----\S*$/)){console.log("Aws.verifyInput    value is INVALID. Adding class 'invalid'");dojo.addClass(this[_6bf],"invalid");this.isValid=false;return null;}console.log("Aws.verifyInput    value is VALID. Removing class 'invalid'");dojo.removeClass(this[_6bf],"invalid");return _6c0;}}}}return null;},initialiseAws:function(){var aws=Agua.getAws();console.log("Aws.initialiseAws     aws: ");console.dir({aws:aws});this.amazonuserid.set("value",aws.amazonuserid);this.awsaccesskeyid.set("value",aws.awsaccesskeyid);this.awssecretaccesskey.set("value",aws.awssecretaccesskey);this.ec2privatekey.value=aws.ec2privatekey||"";this.ec2publiccert.value=aws.ec2publiccert||"";},cleanEdges:function(_6c2){_6c2=_6c2.toString();if(_6c2==null||!_6c2.replace){return null;}_6c2=_6c2.replace(/^\s+/,"");_6c2=_6c2.replace(/\s+$/,"");return _6c2;}});}if(!dojo._hasResource["plugins.cloud.Cloud"]){dojo._hasResource["plugins.cloud.Cloud"]=true;dojo.provide("plugins.cloud.Cloud");dojo.declare("plugins.cloud.Cloud",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n\t<!-- ADMIN TAB -->\n\t<div\n        dojoAttachPoint=\"mainTab\"\n        class=\"cloud\"\n\t\ticonClass=\"cloudIcon\"\n        style=\"min-width: 1140px !important; width: 100% !important; height:100% !important; max-height: auto !important; padding: 0px; background: #FFF;\"\n        dojoType=\"dijit.layout.BorderContainer\"\n\t\tclosable=\"true\"\t\t\n        title=\"Cloud\"\n        >\n        \n        <!-- LEFT PANE -->\n        <div\n            dojoAttachPoint=\"leftPane\"\n            class=\"leftPane\"\n\t\t\tlayoutAlign=\"left\" \n            dojoType=\"dijit.layout.ContentPane\" \n            style=\"position: absolute !important; width: 390px; height: 100% !important; max-height: auto !important; min-width: 25px; background: #FFF; padding: 0; border: none !important;\"\n            >\n\n            <!-- LEFT TAB CONTAINER-->\n            <div dojoAttachPoint=\"leftTabContainer\"\n                dojoType=\"dijit.layout.TabContainer\"\n                style=\"height: 100%; overflow: visible;\"\n                class=\"infoPane\">\n\n            </div>\n            <!-- END OF LEFT TAB CONTAINER-->\n\t\t\t\n        </div>\n        <!-- END OF LEFT PANE -->\n\n        <!-- MIDDLE PANE -->\n        <div\n            dojoAttachPoint=\"middlePane\"\n\t\t\tlayoutAlign=\"middle\" \n\t\t\tclass=\"middlePane\"\n            dojoType=\"dijit.layout.ContentPane\" \n            style=\"position: absolute !important; left: 390px !important; height: 100% !important; max-height: auto !important; width: 390px; min-width: 25px; background: #FFF; padding: 0; border: none !important;\"\n            >\n\n            <!-- MIDDLE TAB CONTAINER-->\n            <div\n                dojoAttachPoint=\"middleTabContainer\"\n                dojoType=\"dijit.layout.TabContainer\"\n                style=\"height: 100%; overflow: visible;\"\n                class=\"infoPane\">\n\n            </div>\n\n        </div>\n        <!-- END OF MIDDLE PANE -->\n\n\n        <!-- RIGHT PANE -->\n        <div\n            dojoAttachPoint=\"rightPane\" \n            class=\"rightPane\"\n\t\t\tlayoutAlign=\"right\"\n            dojoType=\"dijit.layout.ContentPane\" \n            style=\"position: absolute !important; left: 780px !important; height: 100% !important; max-height: auto !important; width: 390px !important; min-width: 25px; background: #FFF; padding: 0; border: none !important;\"\n            >\n\n            <!-- RIGHT TAB CONTAINER-->\n            <div dojoAttachPoint=\"rightTabContainer\"\n                dojoType=\"dijit.layout.TabContainer\"\n                style=\"height: 100%; overflow: visible; width: 390px !important; \"\n                class=\"infoPane\">\n\n            </div>\n            <!-- END OF RIGHT TAB CONTAINER-->\n\n        </div>\n        <!-- END OF RIGHT PANE -->\n\n\t</div>\n\t<!-- END OF ADMIN TAB -->\n\n</div>\n",widgetsInTemplate:true,paneWidgets:null,core:new Object,cssFiles:[dojo.moduleUrl("plugins","cloud/css/cloud.css")],panelList:null,inputs:null,loadPanels:null,constructor:function(args){console.log("admin.Admin.constructor    args:");console.dir({args:args});this.setLoadPanels(args);this.loadCSS();},postCreate:function(){this.startup();},startup:function(){Agua.addWidget("admin",this);Agua.tabs.addChild(this.mainTab);Agua.tabs.selectChild(this.mainTab);this.paneWidgets=new Object;this.headings=Agua.getCloudHeadings();console.log("Cloud.startup    this.headings:");console.dir({this_headings:this.headings});this.loadPanes();},reload:function(_6c3){if(_6c3=="all"){for(var _6c4 in this.headings){for(var i in this.headings[_6c4]){this.reloadWidget(this.headings[_6c4][i]);}}}else{if(_6c3=="leftPane"||_6c3=="middlePane"||_6c3=="rightPane"){for(var i in this.headings[_6c3]){this.reloadWidget(this.headings[_6c3][i]);}}else{try{this.reloadWidget(_6c3);}catch(e){}}}},reloadWidget:function(_6c5){delete this.paneWidgets[_6c5];var _6c6=this;this.paneWidgets[_6c5]=new plugins.cloud[_6c5]({parentWidget:_6c6,tabContainer:_6c6.leftTabContainer});},loadPanes:function(){var _6c7=["left","middle","right"];for(var i=0;i<_6c7.length;i++){this.loadPane(_6c7[i]);}},loadPane:function(side){console.log("Cloud.loadPane     side: "+side);console.log("Cloud.loadPane     this.loadPanels: ");console.dir({this_loadPanels:this.loadPanels});var pane=side+"Pane";var _6c8=side+"TabContainer";if(this.headings==null||this.headings[pane]==null){return;}for(var i=0;i<this.headings[pane].length;i++){var _6c9=this.headings[pane][i];console.log("Cloud.loadPane    dojo.require tabPaneName: "+_6c9);if(this.loadPanels&&!this.loadPanels[_6c9.toLowerCase()]){console.log("Cloud.loadPane    Skipping panel: "+_6c9);continue;}var _6ca="plugins.cloud."+_6c9;console.log("Cloud.loadPane    BEFORE dojo.require moduleName: "+_6ca);dojo["require"](_6ca);console.log("Cloud.loadPane    AFTER dojo.require moduleName: "+_6ca);var _6cb=this;var _6cc=new plugins["cloud"][_6c9]({parentWidget:_6cb,tabContainer:_6cb[_6c8]});if(this.paneWidgets[_6ca]==null){this.paneWidgets[_6ca]=new Array;}this.paneWidgets[_6ca].push(_6cc);}},destroyRecursive:function(){console.log("Cloud.destroyRecursive    this.mainTab: ");console.dir({this_mainTab:this.mainTab});if(Agua&&Agua.tabs){Agua.tabs.removeChild(this.mainTab);}this.inherited(arguments);}});}if(!dojo._hasResource["plugins.cloud.ClusterRow"]){dojo._hasResource["plugins.cloud.ClusterRow"]=true;dojo.provide("plugins.cloud.ClusterRow");dojo.declare("plugins.cloud.ClusterRow",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table class=\"clusterRow\" width=\"100%\">\n        \n        <tr>\n\t\t\t<td colspan=\"3\" width=\"100%\">\n\t\t\t\n\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t<tr width=\"100%\">\n\t\t\t\t\t\t<td\n\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:toggle\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"cluster\"\n\t\t\t\t\t\t\tclass=\"cluster\"\n\t\t\t\t\t\t\ttitle=\"Cluster Name\"\n\t\t\t\t\t\t>${cluster}</td>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<td class=\"nodesLabel\">Min nodes</td>\n\t\t\t\t\t\t<td class=\"minnodes\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"minnodes\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onKeyPress:checkEnterNodes\"\n\t\t\t\t\t\t\t\tclass=\"minnodes\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tvalue=\"${minnodes}\"\n\t\t\t\t\t\t\t\tdojoType=\"dijit.form.NumberTextBox\"\n\t\t\t\t\t\t\t\tvalue=\"0\"\n\t\t\t\t\t\t\t\tconstraints=\"{min:0,max:99999,places:0}\"\n\t\t\t\t\t\t\t\tmaxlength=\"4\" \n\t\t\t\t\t\t\t\tpromptMessage=\"Minimum nodes: from 1 to 99999\" \n\t\t\t\t\t\t\t\tinvalidMessage=\"Minimum nodes: from 1 to 99999\"\n\t\t\t\t\t\t\t\ttooltipPosition=\"above, below\"\n\t\t\t\t\t\t\t\tstyle=\"display: table-cell; text-align: center; width: 25px !important;\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<td class=\"nodesLabel\">Max nodes</td>\n\t\t\t\t\t\t<td class=\"maxnodes\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"maxnodes\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onKeyPress:checkEnterNodes\"\n\t\t\t\t\t\t\t\tclass=\"maxnodes\"\n\t\t\t\t\t\t\t\tdojoType=\"dijit.form.NumberTextBox\"\n\t\t\t\t\t\t\t\tvalue=\"${maxnodes}\"\n\t\t\t\t\t\t\t\tconstraints=\"{min:0,max:99999,places:0}\"\n\t\t\t\t\t\t\t\tmaxlength=\"4\" \n\t\t\t\t\t\t\t\tpromptMessage=\"Maximum nodes: from 1 to 99999\" \n\t\t\t\t\t\t\t\tinvalidMessage=\"Maximum nodes: from 1 to 99999\"\n\t\t\t\t\t\t\t\ttooltipPosition=\"above, below\"\n\t\t\t\t\t\t\t\tstyle=\"display: table-cell; text-align: center; width: 25px !important;\"\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t</td>\n        </tr>\n            \n        <tr>\n\t\t\t<td colspan=\"3\">\n\t\t\t\t<table>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td\n\t\t\t\t\t\t\tstyle=\"display: none;\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"amiidContainer\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"amiid\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onChange:setAmiInfo\"\n\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\tclass=\"amiid\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tvalue=\"ami-d1c42db8\"\n\t\t\t\t\t\t\t\ttitle=\"AMI ID of the Starcluster image used for all cluster nodes (The base x86_64 StarCluster AMI is ami-d1c42db8)\"\n\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\tregExp=\"^ami-[A-F0-9a-f]{8}$\"\n\t\t\t\t\t\t\t\tmaxlength=\"12\"\n\t\t\t\t\t\t\t\tpromptMessage=\"Amazon Machine Image (AMI) identifier. Must be 'ami-XXXXXXXX' in hexadecimal (a-f0-09), e.g., ami-d1c42db8\" \n\t\t\t\t\t\t\t\tinvalidMessage=\"Amazon Machine Image (AMI) identifier. Must be 'ami-XXXXXXXX' in hexadecimal (a-f0-09), e.g., ami-d1c42db8\" \n\t\t\t\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t\t\t\t\twrap=\"off\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td\n\t\t\t\t\t\t\tdojoAttachPoint=\"aminame\"\n\t\t\t\t\t\t\tclass=\"aminame\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td\n\t\t\t\t\t\t\tdojoAttachPoint=\"amitype\"\n\t\t\t\t\t\t\tclass=\"amitype\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t</td>\n        </tr>\n\n        <tr>\n            <td align=\"center\"\n                dojoAttachPoint=\"instancetypeContainer\"\n                style=\"display: none;\"\n                >\n                <select\n                    dojoAttachPoint=\"instancetype\"\n                    class=\"instancetype\">\n\t\t\t\t\t<option value=\"t1.micro\">t1.micro</option> \n\t\t\t\t\t<option value=\"m1.small\">m1.small</option>\n\t\t\t\t\t<option value=\"m1.large\">m1.large</option>\n\t\t\t\t\t<option value=\"m1.xlarge\">m1.xlarge</option>\n\t\t\t\t\t<option value=\"m1.xlarge\">m2.xlarge</option>\n\t\t\t\t\t<option value=\"m2.2xlarge\">m2.2xlarge</option>\n\t\t\t\t\t<option value=\"m2.4xlarge\">m2.4xlarge</option>\n\t\t\t\t\t<option value=\"c1.medium\">c1.medium</option>\n\t\t\t\t\t<option value=\"c1.xlarge\">c1.xlarge</option>\n\t\t\t\t\t<option value=\"cc1.4xlarge\">cc1.4xlarge</option>\n\t\t\t\t\t<option value=\"cg1.4xlarge\">cg1.4xlarge</option>\n                </select>\n            </td>\n            <td align=\"center\"\n\t\t\t\tdojoAttachPoint=\"regionContainer\"\n\t\t\t\tstyle=\"display: none;\"\n\t\t\t>\n\t\t\t\t<select\n\t\t\t\t\tdojoAttachPoint=\"region\"\n\t\t\t\t\tdojoAttachEvent=\"onchange:setAvailzoneCombo\"\n\t\t\t\t\tclass=\"region\">\n\t\t\t\t\t<option value=\"us-east-1\">us-east-1</option> \n\t\t\t\t\t<option value=\"us-west-1\">us-west-1</option> \n\t\t\t\t\t<option value=\"eu-west-1\">eu-west-1</option> \n\t\t\t\t\t<option value=\"ap-northeast-1\">ap-northeast-1</option> \n\t\t\t\t\t<option value=\"ap-southeast-1\">ap-southeast-1</option> \n\t\t\t\t</select>\n\t\t\t</td>\n\t\t\t<td align=\"center\"\n\t\t\t\tdojoAttachPoint=\"availzoneContainer\"\n\t\t\t\tstyle=\"display: none;\"\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"availzone\"\n\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t                dojoAttachEvent=\"onchange:saveInputs\"\n\t\t\t\t\tclass=\"availzone\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tpopupClass=\"clusters availzone dijitReset dijitMenu\"\n\t\t\t\t\tautocomplete=\"true\"\n\t\t\t\t\thasDownArrow=\"true\"\n\t\t\t\t\tdisabled=\"false\"\n\t\t\t\t\tstyle=\"width: 50px;\">\n\t\t\t\t</div>\n\t\t\t</td>\n        </tr>\n\n\t\t<tr width=\"95%\">\n\t\t\t<td\n                align=\"center\"\n                colspan=\"3\"\n                dojoAttachPoint=\"description\"\n                dojoAttachEvent=\"onclick:editCluster\"\n                class=\"description\"\n                style=\"display: none;\"\n                width=\"100%\"\n                title=\"A brief description of the cluster group\"\n            >${description}</td>\n\t\t</tr>\n\n    </table>\n\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;this.lockedValue=args.locked;this.args=args;},postCreate:function(){this.formInputs=this.parentWidget.formInputs;this.startup();},startup:function(){this.inherited(arguments);var _6cd={target:{selectedIndex:0,options:[{text:"us-east-1"}]}};this.setAvailzoneCombo(_6cd);if(this.args.availzone!=null){this.availzone.set("value",this.args.availzone);}this.setAmiCombo(this.args.amiid);this.setAmiInfo();this.setOnkeyListeners(["amiid"]);setTimeout(function(_6ce){_6ce.setComboListeners();},2000,this);Agua.updater.subscribe(this,"updateClusters");Agua.updater.subscribe(this,"updateAmis");},updateClusters:function(args){console.log("ClusterRow.updateClusters(args)");console.log("ClusterRow.updateClusters    args: ");console.dir(args);if(args==null||args.reload!=false){}},updateAmis:function(args){if(args.originator==this){if(args.reload==false){return;}}this.setAmiCombo();},setComboListeners:function(){var _6cf=this;dojo.connect(this.instancetype,"onchange",function(_6d0){if(_6d0.stopPropagation==null){return;}var _6d1=_6cf.parentWidget.getFormInputs(_6cf);_6cf.parentWidget.saveInputs(_6d1,{reload:false});_6d0.stopPropagation();});dojo.connect(this.availzone,"onChange",function(_6d2){var _6d3=_6cf.parentWidget.getFormInputs(_6cf);_6cf.parentWidget.saveInputs(_6d3,{reload:false});});dojo.connect(this.amiid,"onChange",function(){var _6d4=_6cf.parentWidget.getFormInputs(_6cf);_6cf.parentWidget.saveInputs(_6d4,{reload:false});});},setOnkeyListeners:function(_6d5){var _6d6=this;for(var i in _6d5){dojo.connect(_6d6[_6d5[i]],"onKeyPress",function(evt){var key=evt.charOrCode;evt.stopPropagation();if(key==13){_6d6.saveInputs();}});}},getItemsArray:function(){var amis=Agua.getAmis();return this.hashArrayKeyToArray(amis,["amiid"]);},setAmiCombo:function(_6d7){var amis=this.getItemsArray();var data={identifier:"name",items:[]};for(var i=0;i<amis.length;i++){data.items[i]={name:amis[i]};}var _6d8=new dojo.data.ItemFileWriteStore({data:data});this.amiid.store=_6d8;this.amiid.startup();var _6d9=_6d7;if(_6d9==null){_6d9=amis[0];}this.amiid.setValue(_6d9);this.setAmiInfo();},setAmiInfo:function(){var _6da=this.amiid.get("value");var _6db=Agua.getAmiObjectById(_6da);if(_6db==null){this.aminame.innerHTML="";this.amitype.innerHTML="";}else{this.aminame.innerHTML=_6db.aminame;this.amitype.innerHTML=_6db.amitype;}},setAvailzoneCombo:function(_6dc){var _6dd=this.getSelectedValue(_6dc.target);var _6de=Agua.getAvailzonesByRegion(_6dd);var data={identifier:"name",items:[]};for(var i=0;i<_6de.length;i++){data.items[i]={name:_6de[i]};}var _6df=new dojo.data.ItemFileWriteStore({data:data});this.availzone.store=_6df;this.availzone.startup();var _6e0=_6de[0];this.availzone.set("value",_6e0);},saveInputs:function(){this.setAmiInfo();this.checkNodeNumbers();var _6e1=this.parentWidget.getFormInputs(this);this.parentWidget.saveInputs(_6e1,{reload:false});},checkNodeNumbers:function(){if(this.minnodes.get("value")>this.maxnodes.get("value")){this.minnodes.set("value",this.maxnodes.get("value"));}},editCluster:function(_6e2){this.parentWidget.editRow(this,_6e2.target);_6e2.stopPropagation();},checkEnterNodes:function(_6e3){if(_6e3.keyCode==dojo.keys.ENTER){dojo.stopEvent(_6e3);document.body.focus();this.checkNodeNumbers();var _6e4=this.parentWidget.getFormInputs(this);this.saveInputs(_6e4,null);}},toggle:function(){var _6e5=["aminame","amitype","instancetypeContainer","amiidContainer","regionContainer","availzoneContainer","description"];for(var i in _6e5){if(this[_6e5[i]].style.display=="table-cell"){this[_6e5[i]].style.display="none";}else{this[_6e5[i]].style.display="table-cell";}}}});}if(!dojo._hasResource["plugins.cloud.Clusters"]){dojo._hasResource["plugins.cloud.Clusters"]=true;dojo.provide("plugins.cloud.Clusters");dojo.declare("plugins.cloud.Clusters",[dijit._Widget,dijit._Templated,plugins.core.Common,plugins.form.EditForm],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!--http://aws.amazon.com/ec2/instance-types/-->\n\n\t<!-- clusters TAB -->\n\t<div\n\t\tdojoAttachPoint=\"clustersTab\"\n\t\tclass=\"clusters\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Clusters\"\n\t\tstyle=\"height: 100% !important; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t>\n\n\t<table align=\"center\" width=\"100%\">\n\n\t\t<tr valign=\"top\" width=\"100%\">\n\t\t\t<td colspan=\"3\" class=\"tabTitle\" align=\"center\">Clusters</td>\n\t\t</tr>\n\n\t\t<tr height=\"20px\">\n\t\t\t<td align=\"center\" colspan=\"3\">\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"addClusterButton\"\n\t\t\t\t\tclass=\"addClusterButton\"\n\t\t\t\t\t>Add Cluster</div>\n\t\t\t</td>\n\t\t</tr>\n\n\t\t<tr class=\"headerRow\">\n\t\t\t<td>Name</td>\n\t\t\t<td>Min nodes</td>\n\t\t\t<td>Max nodes</td>\n\t\t</tr>\n\n\t\t<tr align=\"center\">\n\n\t\t\t<td>\n\t\t\t\t<input\n\t\t\t\t\tdojoAttachPoint=\"cluster\"\n\t\t\t\t\tclass=\"cluster\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tvalue=\"myCluster\"\n\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\tregExp=\"^\\S{1,20}$\"\n\t\t\t\t\tmaxlength=\"20\" \n\t\t\t\t\tpromptMessage=\"Cluster name: up to 20 characters (no spaces)\" \n\t\t\t\t\tinvalidMessage=\"Cluster name: up to 20 characters (no spaces)\"\n\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t\twrap=\"off\"\n\t\t\t\t\t>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t\t<input\n\t\t\t\t\tdojoAttachPoint=\"minnodes\"\n\t\t\t\t\tdojoAttachEvent=\"onChange:checkNodeNumbers\"\n\t\t\t\t\tclass=\"minnodes\"\n\t\t\t\t\tdojoType=\"dijit.form.NumberTextBox\"\n\t\t\t\t\tvalue=\"0\"\n\t\t\t\t\tconstraints=\"{min:0,max:99999,places:0}\"\n\t\t\t\t\tmaxlength=\"5\" \n\t\t\t\t\tpromptMessage=\"Minimum nodes: from 0 to 99999\" \n\t\t\t\t\tinvalidMessage=\"Minimum nodes: from 0 to 99999\"\n\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"maxnodes\"\n\t\t\t\t\tdojoAttachEvent=\"onChange:checkNodeNumbers\"\n\t\t\t\t\tclass=\"maxnodes\"\n\t\t\t\t\tdojoType=\"dijit.form.NumberTextBox\"\n\t\t\t\t\tvalue=\"5\"\n\t\t\t\t\tconstraints=\"{min:1,max:99999,places:0}\"\n\t\t\t\t\tmaxlength=\"5\" \n\t\t\t\t\tpromptMessage=\"Maximum nodes: from 1 to 99999\" \n\t\t\t\t\tinvalidMessage=\"Maximum nodes: from 1 to 99999\"\n\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t</tr>\n\n\t\t<tr>\n\t\t\t<td align=\"center\" colspan=\"3\">\n\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t<tr class=\"headerRow\">\n\t\t\t\t\t\t<td\n\t\t\t\t\t\ttitle=\"AMI ID of the Starcluster image used for all cluster nodes (The base x86_64 StarCluster AMI is ami-d1c42db8)\">AMI ID</td>\n\t\t\t\t\t\t<td>AMI Name</td>\n\t\t\t\t\t\t<td>AMI Type</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td align=\"center\" dojoAttachPoint=\"amiidContainer\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"amiid\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onChange:setAmiInfo\"\n\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\tclass=\"amiid\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\tregExp=\"^ami-[A-F0-9a-f]{8}$\"\n\t\t\t\t\t\t\t\tmaxlength=\"12\" \n\t\t\t\t\t\t\t\tpromptMessage=\"Amazon Machine Image (AMI) identifier. Must be 'ami-XXXXXXXX' in hexadecimal (a-f0-09), e.g. ami-d1c42db8\" \n\t\t\t\t\t\t\t\tinvalidMessage=\"Amazon Machine Image (AMI) identifier. Must be 'ami-XXXXXXXX' in hexadecimal (a-f0-09), e.g., ami-d1c42db8\" \n\t\t\t\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t\t\t\t\twrap=\"off\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td\n\t\t\t\t\t\t\tdojoAttachPoint=\"aminame\"\n\t\t\t\t\t\t\tclass=\"aminame\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td\n\t\t\t\t\t\t\tdojoAttachPoint=\"amitype\"\n\t\t\t\t\t\t\tclass=\"amitype\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr class=\"headerRow\">\n\t\t\t\t\t\t<td class=\"info\">Instance Type\n\t\t\t\t\t\t\t<img src=\"plugins/core/images/info-16.png\" onClick=\"window.open('http://aws.amazon.com/ec2/instance-types', '_blank')\"></img>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"info\">Region\n\t\t\t\t\t\t\t<img src=\"plugins/core/images/info-16.png\" onClick=\"window.open('http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/index.html?using-regions-availability-zones.html', '_blank')\"></img>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td>Availability Zone</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td align=\"center\" >\n\t\t\t\t\t\t\t<select\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"instancetype\"\n\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\tclass=\"instancetype\">\n\t\t\t\t\t\t\t\t<option value=\"t1.micro\">t1.micro</option> \n\t\t\t\t\t\t\t\t<option value=\"m1.small\">m1.small</option>\n\t\t\t\t\t\t\t\t<option value=\"m1.large\">m1.large</option>\n\t\t\t\t\t\t\t\t<option value=\"m1.xlarge\">m1.xlarge</option>\n\t\t\t\t\t\t\t\t<option value=\"m1.xlarge\">m2.xlarge</option>\n\t\t\t\t\t\t\t\t<option value=\"m2.4xlarge\">m2.2xlarge</option>\n\t\t\t\t\t\t\t\t<option value=\"m2.4xlarge\">m2.4xlarge</option>\n\t\t\t\t\t\t\t\t<option value=\"c1.medium\">c1.medium</option>\n\t\t\t\t\t\t\t\t<option value=\"c1.xlarge\">c1.xlarge</option>\n\t\t\t\t\t\t\t\t<option value=\"c1.xlarge\">cc1.4xlarge</option>\n\t\t\t\t\t\t\t\t<option value=\"c1.xlarge\">cg1.4xlarge</option>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td align=\"center\" >\n\t\t\t\t\t\t\t<select\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"region\"\n\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t                    dojoAttachEvent=\"onChange:setAvailzoneCombo\"\n\t\t\t\t\t\t\t\tclass=\"region\">\n\t\t\t\t\t\t\t\t<option value=\"us-east-1\">us-east-1</option> \n\t\t\t\t\t\t\t\t<option value=\"us-west-1\">us-west-1</option> \n\t\t\t\t\t\t\t\t<option value=\"eu-west-1\">eu-west-1</option> \n\t\t\t\t\t\t\t\t<option value=\"ap-northeast-1\">ap-northeast-1</option> \n\t\t\t\t\t\t\t\t<option value=\"ap-southeast-1\">ap-southeast-1</option> \n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td align=\"center\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"availzone\"\n\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\tclass=\"availzone\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tpopupClass=\"clusters availzone dijitReset dijitMenu\"\n\t\t\t\t\t\t\t\tautocomplete=\"true\"\n\t\t\t\t\t\t\t\thasDownArrow=\"true\"\n\t\t\t\t\t\t\t\tdisabled=\"false\"\n\t\t\t\t\t\t\t\tstyle=\"width: 150px;\">\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t\n\t\t\t\t</table>\n\t\t\t</td>\n\t\t</tr>\n\n\t\t<tr class=\"headerRow\" width=\"95%\" height=\"8px\">\n\t\t\t<td colspan=\"3\">Description</td>\n\t\t</tr>\n\n\t\t<tr width=\"95%\" >\n\t\t\t<td align=\"center\" colspan=\"3\">\n\t\t\t\t<textarea\n\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\tdojoAttachPoint=\"description\"\n\t\t\t\t\tclass=\"description\"\n\t\t\t\t\tcols=\"40\"\n\t\t\t\t\trows=\"1\"\n\t\t\t\t\ttitle=\"A brief description of the cluster group\"\n\t\t\t\t>Description</textarea>\n\t\t\t</td>\n\t\t</tr>\n\n\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t<td colspan=\"3\" width=\"95%\">\n\t\t\t\t<div class=\"label\"> Clusters </div>\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"dragSourceNode\"\n\t\t\t\t\tclass=\"dragSource\"\n\t\t\t\t\tstyle=\"height: 350px; width: 95%;\"\n\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t</tr>\n\n\t\t<tr align=\"center\">\n\t\t\t<td colspan=\"3\" align=\"center\">\n\n\t\t\t\t<!-- TRASH CONTAINER -->\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"trashContainer\"\n\t\t\t\t\tclass=\"trash\"\n\t\t\t\t\tstyle=\"height: 60px; width: 150px; align: center;\" \n\t\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoAttachPoint=\"trashIcon\"\n\t\t\t\t\t\tclass=\"trashIcon\"\n\t\t\t\t\t\tstyle=\"height: 60px; width: 60px;\"\n\t\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t</tr>\n\t</table>\n\n\n\t</div>\n\t<!-- END clusters TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,addingUser:false,cssFiles:[dojo.moduleUrl("plugins")+"/cloud/css/clusters.css"],parentWidget:null,instancetypeslots:{"t1.micro":1,"m1.small":1,"m1.large":4,"m1.xlarge":8,"m2.xlarge":7,"m2.2xlarge":13,"m2.4xlarge":26,"c1.medium":5,"c1.xlarge":20,"cc1.4xlarge":34,"cg1.4xlarge":34},formInputs:{cluster:"word",minnodes:"number",maxnodes:"number",instancetype:"combo",amiid:"word",availzone:"word",description:"phrase"},defaultInputs:{cluster:"myCluster",minnodes:"minNodes",maxnodes:"maxNodes",instancetype:"instanceType",amiid:"AMI ID",description:"Description",notes:"Notes"},requiredInputs:{cluster:1,minnodes:1,maxnodes:1,amiid:1},invalidInputs:{cluster:"myCluster",minnodes:"",maxnodes:"",amiid:"",description:"Description"},dataFields:["cluster"],rowClass:"plugins.cloud.ClusterRow",avatarType:"parameters",avatarItems:["cluster","minnodes","maxnodes","instancetype","description"],constructor:function(args){this.parentWidget=args.parentWidget;this.clusters=args.parentWidget.clusters;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){console.log("Clusters.startup    plugins.cloud.Clusters.startup()");console.log("Clusters.startup    this: "+this);this.inherited(arguments);this.tabContainer.addChild(this.clustersTab);this.tabContainer.selectChild(this.clustersTab);this.setForm();this.setAmiCombo();this.setDragSource();this.setTrash(this.dataFields);Agua.updater.subscribe(this,"updateClusters");Agua.updater.subscribe(this,"updateAmis");},updateClusters:function(args){console.log("Cluster.updateClusters    args: ");console.dir(args);if(args==null||args.reload!=false){this.setDragSource();}},updateAmis:function(args){console.log("Amis.updateAmis(args)");console.log("Amis.updateAmis    args: ");console.dir(args);if(args.originator==this){if(args.reload==false){return;}}console.log("Amis.updateAmis    Doing this.setAmiCombo()");this.setAmiCombo();},setForm:function(){dojo.connect(this.addClusterButton,"onclick",dojo.hitch(this,"newCluster",null,null));dojo.connect(this.cluster,"onFocus",dojo.hitch(this,"clearValue",this.cluster,this.invalidInputs["cluster"]));var _6e6={target:{selectedIndex:0,options:[{text:"us-east-1"}]}};this.setAvailzoneCombo(_6e6);this.inherited(arguments);},setAmiInfo:function(_6e7){console.log("Clusters.setAmiInfo     plugins.cloud.Clusters.setAmiInfo(event)");var _6e8=this.amiid.get("value");console.log("Clusters.setAmiInfo     amiid: "+_6e8);var _6e9=Agua.getAmiObjectById(_6e8);console.log("Clusters.setAmiInfo     amiObject: "+dojo.toJson(_6e9));this.aminame.innerHTML=_6e9.aminame;this.amitype.innerHTML=_6e9.amitype;this.amiid.focusNode.title=_6e9.description;this.amiidContainer.title=_6e9.description;this.aminame.title=_6e9.description;this.amitype.title=_6e9.description;},setAvailzoneCombo:function(_6ea){var _6eb=this.getSelectedValue(_6ea.target);var _6ec=Agua.getAvailzonesByRegion(_6eb);var data={identifier:"name",items:[]};for(var i=0;i<_6ec.length;i++){data.items[i]={name:_6ec[i]};}var _6ed=new dojo.data.ItemFileWriteStore({data:data});this.availzone.store=_6ed;this.availzone.startup();var _6ee=_6ec[0];this.availzone.setValue(_6ee);},getItemsArray:function(){var amis=Agua.getAmis();console.log("Clusters.getItemsArray     amis: "+dojo.toJson(amis));return this.hashArrayKeyToArray(amis,["amiid"]);},setAmiCombo:function(){console.log("Clusters.setAmiCombo     plugins.cloud.Clusters.setAmiCombo()");var amis=this.getItemsArray();console.log("Clusters.setAmiCombo     amis: "+dojo.toJson(amis));var data={identifier:"name",items:[]};for(var i=0;i<amis.length;i++){data.items[i]={name:amis[i]};}console.log("Clusters.setAmiCombo     data: "+dojo.toJson(data));var _6ef=new dojo.data.ItemFileWriteStore({data:data});this.amiid.store=_6ef;this.amiid.startup();console.log("Clusters.setAmiCombo     AFTER this.amiid.startup()");var _6f0=amis[0];this.amiid.setValue(_6f0);console.log("Clusters.setAmiCombo     AFTER this.amiid.setValue(firstValue)");},getItemArray:function(){return Agua.getClusters();},setDragSource:function(){console.log("Clusters.setDragSource     plugins.cloud.Clusters.setDragSource()");if(this.dragSource==null){this.initialiseDragSource();this.setDragSourceCreator();}this.clearDragSource();var _6f1=this.getItemArray();var _6f2=Agua.cookie("username")+"-";for(var i=0;i<_6f1.length;i++){_6f1[i].cluster=_6f1[i].cluster.replace(_6f2,"");}_6f1=this.sortHasharray(_6f1,"cluster");if(_6f1==null){return;}this.loadDragItems(_6f1);},newCluster:function(_6f3,_6f4){if(this.saving==true){return;}this.saving=true;if(_6f3==null){_6f3=this.getFormInputs(this);if(_6f3==null){this.saving=false;return;}}_6f3.cluster=Agua.getClusterLongName(_6f3.cluster);Agua.newCluster(_6f3);this.saving=false;Agua.updater.update("updateClusters",_6f4);},saveInputs:function(_6f5,_6f6){if(this.saving==true){return;}this.saving=true;if(_6f5==null){_6f5=this.getFormInputs(this);if(_6f5==null){this.saving=false;return;}}_6f5.cluster=Agua.getClusterLongName(_6f5.cluster);Agua.addCluster(_6f5);this.saving=false;Agua.updater.update("updateClusters",_6f6);},deleteItem:function(_6f7){_6f7.cluster=Agua.cookie("username")+"-"+_6f7.cluster;Agua.removeCluster(_6f7);Agua.updater.update("updateClusters",{originator:this,reload:false});Agua.updater.update("updateAmis",{originator:this,reload:false});},checkEnter:function(_6f8){if(_6f8.keyCode==dojo.keys.ENTER){this.saveInputs();dojo.stopEvent(_6f8);}},checkEnterNodes:function(_6f9){if(_6f9.keyCode==dojo.keys.ENTER){dojo.stopEvent(_6f9);document.body.focus();this.checkNodeNumbers();this.saveInputs();}},checkNodeNumbers:function(){if(this.minnodes.value>this.maxnodes.value){this.minnodes.set("value",this.maxnodes.value);}}});}if(!dojo._hasResource["plugins.cloud.Controller"]){dojo._hasResource["plugins.cloud.Controller"]=true;dojo.provide("plugins.cloud.Controller");var adminController;dojo.declare("plugins.cloud.Controller",[dijit._Widget,dijit._Templated],{paneId:null,templateString:"<div dojoAttachPoint=\"containerNode\" class=\"cloud\">\n    <button\n        dojoType=\"dijit.form.Button\"\n        dojoAttachPoint=\"menuButton\"\n        class=\"menuButton\"\n        iconClass=\"cloudIcon\"\n        type=\"button\"\n        label=\"Cloud\"\n        ></button>\n</div>\n        \n",widgetsInTemplate:true,tabPanes:[],inputs:null,constructor:function(args){console.log("admin.Controller.constructor    args:");console.dir({args:args});if(args.inputs){this.inputs=args.inputs;}this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);Agua.toolbar.addChild(this.menuButton);this.menuButton.parentWidget=this;var _6fa=dojo.connect(this.menuButton,"onClick",this,"createTab");},createTab:function(){var _6fb=this.inputs;var _6fc;if(!_6fb){_6fc=new plugins.cloud.Cloud({});}else{_6fc=new plugins.cloud.Cloud({inputs:_6fb});}console.log("admin.Controller.createTab    Doing this.tabPanes.push(widget)");this.tabPanes.push(_6fc);this._supportingWidgets.push(_6fc);},createMenu:function(){var _6fd=new dijit.Menu({id:"admin"+this.paneId+"dynamicMenuPopup"});_6fd.addChild(new dijit.MenuItem({label:"Application Menu",disabled:false}));_6fd.addChild(new dijit.MenuSeparator());var _6fe=new dijit.MenuItem({id:"admin"+this.paneId+"remove",label:"Remove",disabled:false});_6fd.addChild(_6fe);dojo.connect(_6fe,"onClick",function(){var _6ff=_6fd.currentTarget.parentNode;_6ff.removeChild(_6fd.currentTarget);});_6fd.addChild(new dijit.MenuSeparator());var _700=new dijit.MenuItem({id:"admin"+this.paneId+"run",label:"Run",disabled:false});_6fd.addChild(_700);dojo.connect(_700,"onClick",function(){var _701=_6fd.currentTarget;var _702=_701.parentNode;});return _6fd;},loadCSS:function(){var _703=["plugins/cloud/css/controller.css"];for(var i in _703){var _704=_703[i];var _705=document.createElement("link");_705.type="text/css";_705.rel="stylesheet";_705.href=_704;_705.media="screen";document.getElementsByTagName("head")[0].appendChild(_705);}}});dojo.addOnLoad(function(){});}if(!dojo._hasResource["plugins.cloud.Hub"]){dojo._hasResource["plugins.cloud.Hub"]=true;dojo.provide("plugins.cloud.Hub");dojo.declare("plugins.cloud.Hub",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- settings TAB -->\n\t<div\n\t\tdojoAttachPoint=\"mainTab\"\n\t\tclass=\"hub\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Hub\"\n\t\tstyle=\"height: 700px; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t\t>\n\n\t\t<table width=\"100%\">\n\t\t\t<tr valign=\"top\" width=\"100%\">\n\t\t\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\"> GitHub </td>\n\t\t\t</tr>\n\t\t\t\n\t\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t\t<td width=\"95%\">\n\t\t\t\t\t<div class=\"label\"> GitHub Account Info </div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"subPane\"\n\t\t\t\t\t>\n\n\t\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td\tdojoAttachPoint=\"addHubButton\"\n\t\t\t\t\t\t\t\tclass=\"addHubButton\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:addHub\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tSave\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"subLabel\">GitHub User ID</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"login\"\n\t\t\t\t\t\t\t\t\tclass=\"login\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\tmissingMessage=\"Please input your GitHub Login ID\"\n\t\t\t\t\t\t\t\t\tpromptMessage=\"Please input your GitHub Login ID\"\n\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td\tdojoAttachPoint=\"addTokenButton\"\n\t\t\t\t\t\t\t\tclass=\"addTokenButton\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:toggleAddToken\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tCreate GitHub Token\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr dojoAttachPoint=\"addToken\"\n\t\t\t\t\t\t\tclass=\"addToken\"\n\t\t\t\t\t\t\twidth=\"100%\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<td width=\"10%\">\n\t\t\t\t\t\t\t\t<table class=\"subPane\" width=\"100%\">\n\t\t\t\t\t\t\t\t\t<tr align=\"center\">\n\t\t\t\t\t\t\t\t\t\t<td class=\"subSubLabel\"\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"Enter GitHub password. Password will not be stored on server\">\n\t\t\t\t\t\t\t\t\t\t\tGitHub password\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"password\"\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"password\"\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t\t\t<tr align=\"center\">\n\n\t\t\t\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"goButton\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"goButton\"\n\t\t\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:addHubToken\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\tGenerate Token\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"subLabel\">GitHub Token</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"token\"\n\t\t\t\t\t\t\t\t\tclass=\"token\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tmaxlength=\"40\"\n\t\t\t\t\t\t\t\t\tuppercase=\"false\"\n\t\t\t\t\t\t\t\t\tregExp=\"[a-z0-9]{40}\"\n\t\t\t\t\t\t\t\t\tinvalidMessage=\"GitHub OAuth access token - 40 characters: letters or lowercase numbers\"\n\t\t\t\t\t\t\t\t\tpromptMessage=\"GitHub OAuth access token - 40 characters: letters or lowercase numbers\"\n\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td\tdojoAttachPoint=\"addHubCertificateButton\"\n\t\t\t\t\t\t\t\tclass=\"addHubCertificateButton\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:addHubCertificate\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tCreate Public Certificate\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td >\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"publiccert\"\n\t\t\t\t\t\t\t\t\tclass=\"publiccert\"\n\t\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t</table>\n\n\t\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\n\t\t</table>\n\n\t</div>\n\t<!-- END settings TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,addingUser:false,cssFiles:[dojo.moduleUrl("plugins","cloud/css/hub.css"),],parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;this.core=args.parentWidget.core;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.tabContainer.addChild(this.mainTab);this.tabContainer.selectChild(this.mainTab);Agua.updater.subscribe(this,"updateSyncWorkflows");Agua.updater.subscribe(this,"updateSyncApps");this.initialise();},updateSyncApps:function(args){console.warn("Hub.updateSyncApps    args:");console.dir({args:args});},updateSyncWorkflows:function(args){console.warn("Hub.updateSyncWorkflows    args:");console.dir({args:args});},initialise:function(){var hub=Agua.getHub();console.log("Hub.initialiseHub     hub: ");console.dir({hub:hub});hub.login=hub.login||"";this.login.set("value",hub.login);hub.token=hub.token||"";this.token.set("value",hub.token);hub.publiccert=hub.publiccert||"";this.publiccert.innerHTML=hub.publiccert;},addHub:function(_706){console.log("Hub.addHub    plugins.cloud.Hub.addHub(event)");if(this.addingHub==true){console.log("Hub.addHub    this.addingHub: "+this.addingHub+". Returning.");return;}this.addingHub=true;var _707=this.validateInputs(["login","token"]);if(!_707){this.addingHub=false;return;}var hub={login:this.login.value,token:this.token.value,hubtype:"github"};var _708=_707;_708.username=Agua.cookie("username");_708.sessionid=Agua.cookie("sessionid");_708.login=this.login.value;_708.token=this.token.value;_708.hubtype="github";_708.mode="addHub";console.log("Hub.addHub    query: ");console.dir({query:_708});var url=Agua.cgiUrl+"workflow.cgi?";var _709=this;dojo.xhrPut({url:url,contentType:"json",putData:dojo.toJson(_708),timeout:15000,load:function(_70a,_70b){console.log("Hub.addHub    OK. response:");console.dir({response:_70a});_709.addingHub=false;Agua.setHub(hub);Agua.updater.update("updateSyncWorkflows",{originator:_709,reload:false});Agua.updater.update("updateSyncWorkflows",{originator:_709,reload:false});Agua.toast(_70a);},error:function(_70c,_70d){_709.addingHub=false;console.log("Hub.addHub    ERROR. response:");console.dir({response:_70c});Agua.toast(_70c);}});},addHubCertificate:function(){console.log("Hub.addHubCertificate");if(this.creatingCert){console.log("Hub.addHubCertificate    this.creatingCert: "+this.creatingCert+". Returning.");return;}this.creatingCert=true;var aws=Agua.getAws();console.log("Hub.addHubCertificate    aws:");console.dir({aws:aws});if(!aws||!aws.ec2privatekey){Agua.toastError("Please input EC2 Private Key in 'AWS' panel and press 'Save'");this.creatingToken=false;return;}var _70e=this.validateInputs(["login"]);if(!_70e){this.creatingCert=false;return;}var _70f=_70e;_70f.username=Agua.cookie("username");_70f.sessionid=Agua.cookie("sessionid");_70f.hubtype="github";_70f.mode="addHubCertificate";console.log("Hub.addHubCertificate    query: ");console.dir({query:_70f});var url=Agua.cgiUrl+"workflow.cgi?";var _710=this;dojo.xhrPut({url:url,contentType:"json",putData:dojo.toJson(_70f),handleAs:"json",load:function(_711,_712){_710.creatingCert=false;console.log("Hub.addHubCertificate    response:");console.dir({response:_711});var _713=_711.data.publiccert;console.log("Hub.addHubCertificate    publiccert:");console.dir({publiccert:_713});Agua.setHubCertificate(_713);_710.publiccert.innerHTML=_713;},error:function(_714,_715){_710.creatingCert=false;console.log("Hub.addHubCertificate    ERROR response:");console.dir({response:_714});}});},toggleAddToken:function(){console.log("Hub.showCreateToken    this.password:"+this.password);console.log("Hub.showCreateToken    dojo.hasClass:"+dojo.hasClass(this.password,"showCreateToken"));if(!dojo.hasClass(this.addToken,"showAddToken")){this.addTokenButton.innerHTML="Hide Panel";dojo.addClass(this.addToken,"showAddToken");}else{this.addTokenButton.innerHTML="Add GitHub Token";dojo.removeClass(this.addToken,"showAddToken");}},closeAddToken:function(){console.log("Hub.closeAddToken    Removing class 'showAddToken'");this.addTokenButton.innerHTML="Add GitHub Token";dojo.removeClass(this.addToken,"showAddToken");},addHubToken:function(){console.log("Hub.addHubToken");if(this.addingToken==true){console.log("Hub.addHubToken    this.addingToken: "+this.addingToken+". Returning.");return;}this.addingToken=true;var _716=this.validateInputs(["login","password"]);if(!_716){this.addingToken=false;return;}var _717=_716;_717.username=Agua.cookie("username");_717.sessionid=Agua.cookie("sessionid");_717.hubtype="github";_717.mode="addHubToken";console.log("Hub.addHubToken    query: ");console.dir({query:_717});var url=Agua.cgiUrl+"workflow.cgi?";var _718=this;dojo.xhrPut({url:url,contentType:"json",putData:dojo.toJson(_717),handleAs:"json",load:function(_719,_71a){console.log("Hub.addHubToken    response:");console.dir({response:_719});_718.addingToken=false;if(_719.error){Agua.toastError(_719.error);return;}_718.closeAddToken();var _71b=_719.data.token;console.log("Hub.addHubToken    token:");console.dir({token:_71b});_718.token.set("value",_71b);Agua.updater.update("updateSyncWorkflows");},error:function(_71c,_71d){_718.addingToken=false;console.log("Hub.addHubToken    ERROR response:");console.dir({response:_71c});return _71c;}});},validateInputs:function(keys){console.log("Hub.validateInputs    keys: ");console.dir({keys:keys});var _71e=new Object;this.isValid=true;for(var i=0;i<keys.length;i++){_71e[keys[i]]=this.verifyInput(keys[i]);}console.log("Hub.validateInputs    inputs: ");console.dir({inputs:_71e});if(!this.isValid){return null;}return _71e;},verifyInput:function(_71f){console.log("Hub.verifyInput    input: ");console.dir({this_input:this[_71f]});var _720=this[_71f].value;_720=this.cleanEdges(_720);console.log("Hub.verifyInput    value: "+_720);var _721=this.getClassName(this[_71f]);console.log("Hub.verifyInput    className: "+_721);if(_721){console.log("Hub.verifyInput    this[input].isValid(): "+this[_71f].isValid());if(!_720||!this[_71f].isValid()){console.log("Hub.verifyInput    input "+_71f+" value is empty. Adding class 'invalid'");dojo.addClass(this[_71f].domNode,"invalid");this.isValid=false;}else{console.log("Hub.verifyInput    value is NOT empty. Removing class 'invalid'");dojo.removeClass(this[_71f].domNode,"invalid");return _720;}}else{if(!_720){console.log("Hub.verifyInput    input "+_71f+" value is empty. Adding class 'invalid'");dojo.addClass(this[_71f],"invalid");this.isValid=false;return null;}else{console.log("Hub.verifyInput    value is NOT empty. Removing class 'invalid'");dojo.removeClass(this[_71f],"invalid");return _720;}}return null;},clearInvalid:function(){var _722=["login","token",""];console.log("Hub.clearInvalid    input: ");console.dir({this_input:this[input]});var _723=this[input].value;_723=this.cleanEdges(_723);console.log("Hub.clearInvalid    value: "+_723);var _724=this.getClassName(this[input]);console.log("Hub.clearInvalid    className: "+_724);if(_724){console.log("Hub.clearInvalid    this[input].isValid(): "+this[input].isValid());if(!_723||!this[input].isValid()){console.log("Hub.clearInvalid    input "+input+" value is empty. Adding class 'invalid'");dojo.addClass(this[input].domNode,"invalid");this.isValid=false;}else{console.log("Hub.clearInvalid    value is NOT empty. Removing class 'invalid'");dojo.removeClass(this[input].domNode,"invalid");return _723;}}else{if(!_723){console.log("Hub.clearInvalid    input "+input+" value is empty. Adding class 'invalid'");dojo.addClass(this[input],"invalid");this.isValid=false;return null;}else{console.log("Hub.clearInvalid    value is NOT empty. Removing class 'invalid'");dojo.removeClass(this[input],"invalid");return _723;}}return null;},cleanEdges:function(_725){_725=_725.toString();if(_725==null||!_725.replace){return null;}_725=_725.replace(/^\s+/,"");_725=_725.replace(/\s+$/,"");return _725;}});}if(!dojo._hasResource["plugins.dijit.form.ValidationTextBox"]){dojo._hasResource["plugins.dijit.form.ValidationTextBox"]=true;dojo.provide("plugins.dijit.form.ValidationTextBox");dojo.declare("plugins.dijit.form.ValidationTextBox",[dijit.form.ValidationTextBox],{validate:function(_726){if(this.parentWidget==null){return;}if(this.target!=null){var _727=this.target.validate(_726);console.log("plugins.dijit.form.ValidationTextBox.validate    TARGET isValid: "+_727);if(!_727){this.state="Error";}else{this.state="Incomplete";}this._setStateClass();}var _728="";var _727=this.parentWidget.passwordsMatch();if(_727){this._maskValidSubsetError=true;}var _729=this._isEmpty(this.textbox.value);var _72a=!_727&&!_729&&_726&&this._isValidSubset();this.state=((_727||((!this._hasBeenBlurred||_726)&&_729)||_72a)&&this._maskValidSubsetError)?"":"Error";if(!_727){this.state="Error";}else{this.state="Incomplete";}if(this.state=="Error"){this._maskValidSubsetError=_726;}this._setStateClass();dijit.setWaiState(this.focusNode,"invalid",_727?"false":"true");if(_726){if(this.state=="Error"){_728=this.getErrorMessage(true);}else{_728=this.getPromptMessage(true);}this._maskValidSubsetError=true;}this.displayMessage(_728);if(this.source){if(!_727){this.source.state="Error";}else{this.source.state="Incomplete";}this.source._setStateClass();}return _727;}});}if(!dojo._hasResource["plugins.cloud.UserRow"]){dojo._hasResource["plugins.cloud.UserRow"]=true;dojo.provide("plugins.cloud.UserRow");dojo.declare("plugins.cloud.UserRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table width=\"100%\">\n        <tr class=\"username\" width=\"100%\">\n            <td\n                width=\"100%\"\n                colspan=\"2\"\n                dojoAttachPoint=\"username\"\n                class=\"username\"\n            >${username}</td>\n        </tr>\n        <tr class='firstname' width=\"100%\">\n            <td \n                dojoAttachPoint=\"firstname\"\n                class='firstname'\n                style=\"display: none;\"\n                width=\"100%\" colspan=\"2\"\n            >${firstname}</td>\n        </tr>\n        <tr class='lastname' width=\"100%\">\n            <td \n                dojoAttachPoint=\"lastname\"\n                class='lastname'\n                style=\"display: none;\"\n                width=\"100%\" colspan=\"2\"\n            >${lastname}</td>\n        </tr>\n        <tr class=\"email\" width=\"100%\">\n            <td \n                dojoAttachPoint=\"email\"\n                class='email'\n                style=\"display: none;\"\n                width=\"100%\" colspan=\"2\"\n            >${email}</td>\n        </tr>\n        <tr class=\"password\" width=\"100%\">\n            <td \n                dojoAttachPoint=\"password\"\n                class='password'\n                style=\"display: none;\"\n                type=\"password\"\n                value=\"its-a-secret\"\n                width=\"100%\" colspan=\"2\"\n            >reset-password</td>\n        </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;},postCreate:function(){this.formInputs=this.parentWidget.formInputs;this.startup();},startup:function(){this.inherited(arguments);var _72b=this;dojo.connect(this.username,"onclick",function(_72c){_72b.toggle();_72c.stopPropagation();});var _72b=this;dojo.connect(this.firstname,"onclick",function(_72d){_72b.parentWidget.editRow(_72b,_72d.target);_72d.stopPropagation();});dojo.connect(this.lastname,"onclick",function(_72e){_72b.parentWidget.editRow(_72b,_72e.target);_72e.stopPropagation();});dojo.connect(this.email,"onclick",function(_72f){_72b.parentWidget.editRow(_72b,_72f.target);_72f.stopPropagation();});dojo.connect(this.password,"onclick",function(_730){_72b.clearValue(_730.target);_72b.parentWidget.editRow(_72b,_730.target);_730.stopPropagation();});},toggle:function(){if(this.firstname.style.display=="block"){this.firstname.style.display="none";}else{this.firstname.style.display="block";}if(this.lastname.style.display=="block"){this.lastname.style.display="none";}else{this.lastname.style.display="block";}if(this.email.style.display=="block"){this.email.style.display="none";}else{this.email.style.display="block";}if(this.password.style.display=="block"){this.password.style.display="none";}else{this.password.style.display="block";}},clearValue:function(_731){if(_731.clicked==true){return;}_731.clicked=true;_731.innerHTML="";_731.focus();}});}if(!dojo._hasResource["plugins.cloud.Settings"]){dojo._hasResource["plugins.cloud.Settings"]=true;dojo.provide("plugins.cloud.Settings");dojo.declare("plugins.cloud.Settings",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t\n\t<!-- settings TAB -->\n\t<div\n\t\tdojoAttachPoint=\"mainTab\"\n\t\tclass=\"settings\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Settings\"\n\t\tstyle=\"height: 700px; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t\t>\n\n\t\t<table>\n\t\t\t<tr valign=\"top\" width=\"100%\">\n\t\t\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\"> Settings </td>\n\t\t\t</tr>\n\t\t\t\n\t\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t\t<td width=\"95%\">\n\t\t\t\t\t<div class=\"label\"> Personal Info </div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"subPane\"\n\t\t\t\t\t\tstyle=\"height: 195px; width: 95%;\"\n\t\t\t\t\t>\n\n\t\t\t\t\t<table>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">Username</td>\n\t\t\t\t\t\t\t<td\tdojoAttachPoint=\"username\"\n\t\t\t\t\t\t\t\t\tclass=\"username\"\n\t\t\t\t\t\t\t></td>\n\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"updateUserButton\"\n\t\t\t\t\t\t\t\tclass=\"addUserButton\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tSave\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">Firstname</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"firstname\"\n\t\t\t\t\t\t\t\t\tclass=\"firstname\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">Lastname</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"lastname\"\n\t\t\t\t\t\t\t\t\tclass=\"lastname\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">Email</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"email\"\n\t\t\t\t\t\t\t\t\tclass=\"email\"\n\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">Old Password</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"oldPassword\"\n\t\t\t\t\t\t\t\t\tclass=\"password\"\n\t\t\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\n\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">New Password</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"newPassword\"\n\t\t\t\t\t\t\t\t\tdojoType=\"plugins.dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\tinvalidMessage=\"Passwords don't match\"\n\t\t\t\t\t\t\t\t\tclass=\"newPassword\"\n\t\t\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"sublabel\">Confirm Password</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"confirmPassword\"\n\t\t\t\t\t\t\t\t\tdojoType=\"plugins.dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\tinvalidMessage=\"Passwords don't match\"\n\t\t\t\t\t\t\t\t\tclass=\"confirmPassword\"\n\t\t\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t\t\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t\n\t\t</table>\n\n\t</div>\n\t<!-- END settings TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,addingUser:false,cssFiles:[dojo.moduleUrl("plugins","cloud/css/settings.css"),],parentWidget:null,constructor:function(args){console.log("Settings.constructor     plugins.cloud.Settings.constructor");this.parentWidget=args.parentWidget;this.settings=args.parentWidget.settings;this.loadCSS();},postCreate:function(){console.log("Controller.postCreate    plugins.cloud.Controller.postCreate()");this.startup();},startup:function(){console.log("Settings.startup    plugins.cloud.GroupSettings.startup()");console.log("Settings.startup    BEFORE inherited(arguments)");this.inherited(arguments);console.log("Settings.startup    AFTER inherited(arguments)");this.tabContainer.addChild(this.mainTab);this.tabContainer.selectChild(this.mainTab);console.log("Settings.startup    BEFORE dojo.connect");dojo.connect(this.updateUserButton,"onClick",dojo.hitch(this,"updateUser"));console.log("Settings.startup    AFTER dojo.connect");console.log("Settings.startup    this.confirmPassword: "+this.confirmPassword);this.confirmPassword.parentWidget=this;this.newPassword.parentWidget=this;this.newPassword.target=this.confirmPassword;this.initialiseSettings();},passwordsMatch:function(){console.log("Settings.confirmPassword    plugins.cloud.GroupSettings.confirmPassword()");var _732=this.newPassword.textbox.value;console.log("Settings.confirmPassword    newPassword: "+_732);var _733=this.confirmPassword.textbox.value;console.log("Settings.confirmPassword    confirmPassword: "+_733);return _732==_733;},getInputValue:function(name){console.log("Settings.getInputValue    name: "+name);var _734=this[name];var _735=_734.get?_734.get("value"):_734;console.log("Settings.getInputValue    value: "+_735);_735=this.cleanEdges(_735);return _735;},getTextAreaValue:function(name){console.log("Settings.getTextAreaValue    name: "+name);var _736=this[name].value;_736=this.cleanEdges(_736);this[name].value=_736;return _736;},updateUser:function(_737){console.log("Settings.updateUser    plugins.cloud.Settings.updateUser(event)");console.log("Settings.updateUser    event: "+_737);console.log("Settings.updateUser    this.savingUser: "+this.savingUser+". Returning.");if(this.savingUser==true){return;}this.savingUser=true;var _738=this.cleanEdges(this.oldPassword.value);var _739=this.cleanEdges(this.newPassword.value);var _73a=this.cleanEdges(this.confirmPassword.value);if(!(_738==""&&_739==""&&_73a=="")){if(_738==""){dojo.addClass(this.oldPassword,"invalid");}else{dojo.removeClass(this.oldPassword,"invalid");}if(_739==""){dojo.addClass(this.newPassword,"invalid");}else{dojo.removeClass(this.newPassword,"invalid");}if(_73a==""){dojo.addClass(this.confirmPassword,"invalid");}else{dojo.removeClass(this.confirmPassword,"invalid");}if(_738==""||_739==""||_73a==""){return;}}if(_739!=_73a){console.log("Users.updateUser    passwords do not match. Adding class 'invalid'");dojo.addClass(this.newPassword,"invalid");dojo.addClass(this.confirmPassword,"invalid");console.log("Users.updateUser    Finished adding class 'invalid'");this.savingUser=false;return;}else{console.log("Users.updateUser    passwords match. Removing class 'invalid'");dojo.removeClass(this.newPassword,"invalid");dojo.removeClass(this.confirmPassword,"invalid");}var user=new Object;user.username=Agua.cookie("username");user.firstname=this.cleanEdges(this.firstname.value);user.lastname=this.cleanEdges(this.lastname.value);user.email=this.cleanEdges(this.email.value);user.oldpassword=_738;user.newpassword=_739;console.log("Settings.updateUser    user: "+dojo.toJson(user));var url=Agua.cgiUrl+"admin.cgi?";var _73b=new Object;_73b.username=Agua.cookie("username");_73b.sessionid=Agua.cookie("sessionid");_73b.mode="updateUser";_73b.data=user;var _73c=this;dojo.xhrPut({url:url,contentType:"text",handleAs:"json",putData:dojo.toJson(_73b),timeout:15000,load:function(_73d,_73e){console.log("Settings.updateUser    response: "+_73d);if(_73d.error!=null){dojo.addClass(_73c.oldPassword,"invalid");}},error:function(_73f,_740){}});this.savingUser=false;},cleanEdges:function(_741){_741=_741.toString();if(_741==null||!_741.replace){return null;}_741=_741.replace(/^\s+/,"");_741=_741.replace(/\s+$/,"");return _741;},initialiseSettings:function(){console.log("Settings.initialiseSettings     plugins.cloud.GroupSettings.initialiseSettings()");var _742=Agua.cookie("username");console.log("Settings.initialiseSettings     username: "+_742);this.username.innerHTML=_742;var user=Agua.getUser(_742);console.log("Settings.initialiseSettings     user: "+dojo.toJson(user));this.firstname.value=user["firstname"]||"";this.lastname.value=user["lastname"];this.email.value=user["email"];},reloadSettingsTabs:function(){console.log("Settings.reloadSettingsTabs    plugins.cloud.Settings.reloadSettingsTabs()");console.log("Settings.reloadSettingsTabs    this.parentWidget: "+this.parentWidget);console.log("Settings.reloadSettingsTabs    this.parentWidget.paneWidgets: "+this.parentWidget.paneWidgets);var _743=["plugins.cloud.GroupSettings"];for(var i in _743){if(this.parentWidget.paneWidgets[_743[i]]!=null){console.log("Settings.reloadSettingsTabs    this.parentWidget.paneWidgets['"+_743[i]+"']: "+this.parentWidget.paneWidgets[_743[i]]);this.parentWidget.paneWidgets[_743[i]].reload();}}},setTable:function(){console.log("Settings.setTable     plugins.cloud.GroupSettings.setTable()");while(this.mainTable.firstChild){this.mainTable.removeChild(this.mainTable.firstChild);}},});}if(!dojo._hasResource["dijit._KeyNavContainer"]){dojo._hasResource["dijit._KeyNavContainer"]=true;dojo.provide("dijit._KeyNavContainer");dojo.declare("dijit._KeyNavContainer",dijit._Container,{tabIndex:"0",_keyNavCodes:{},connectKeyNavHandlers:function(_744,_745){var _746=(this._keyNavCodes={});var prev=dojo.hitch(this,this.focusPrev);var next=dojo.hitch(this,this.focusNext);dojo.forEach(_744,function(code){_746[code]=prev;});dojo.forEach(_745,function(code){_746[code]=next;});_746[dojo.keys.HOME]=dojo.hitch(this,"focusFirstChild");_746[dojo.keys.END]=dojo.hitch(this,"focusLastChild");this.connect(this.domNode,"onkeypress","_onContainerKeypress");this.connect(this.domNode,"onfocus","_onContainerFocus");},startupKeyNavChildren:function(){dojo.forEach(this.getChildren(),dojo.hitch(this,"_startupChild"));},addChild:function(_747,_748){dijit._KeyNavContainer.superclass.addChild.apply(this,arguments);this._startupChild(_747);},focus:function(){this.focusFirstChild();},focusFirstChild:function(){var _749=this._getFirstFocusableChild();if(_749){this.focusChild(_749);}},focusLastChild:function(){var _74a=this._getLastFocusableChild();if(_74a){this.focusChild(_74a);}},focusNext:function(){var _74b=this._getNextFocusableChild(this.focusedChild,1);this.focusChild(_74b);},focusPrev:function(){var _74c=this._getNextFocusableChild(this.focusedChild,-1);this.focusChild(_74c,true);},focusChild:function(_74d,last){if(this.focusedChild&&_74d!==this.focusedChild){this._onChildBlur(this.focusedChild);}_74d.set("tabIndex",this.tabIndex);_74d.focus(last?"end":"start");this._set("focusedChild",_74d);},_startupChild:function(_74e){_74e.set("tabIndex","-1");this.connect(_74e,"_onFocus",function(){_74e.set("tabIndex",this.tabIndex);});this.connect(_74e,"_onBlur",function(){_74e.set("tabIndex","-1");});},_onContainerFocus:function(evt){if(evt.target!==this.domNode){return;}this.focusFirstChild();dojo.attr(this.domNode,"tabIndex","-1");},_onBlur:function(evt){if(this.tabIndex){dojo.attr(this.domNode,"tabIndex",this.tabIndex);}this.inherited(arguments);},_onContainerKeypress:function(evt){if(evt.ctrlKey||evt.altKey){return;}var func=this._keyNavCodes[evt.charOrCode];if(func){func();dojo.stopEvent(evt);}},_onChildBlur:function(_74f){},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1);},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1);},_getNextFocusableChild:function(_750,dir){if(_750){_750=this._getSiblingOfChild(_750,dir);}var _751=this.getChildren();for(var i=0;i<_751.length;i++){if(!_750){_750=_751[(dir>0)?0:(_751.length-1)];}if(_750.isFocusable()){return _750;}_750=this._getSiblingOfChild(_750,dir);}return null;}});}if(!dojo._hasResource["dijit.ToolbarSeparator"]){dojo._hasResource["dijit.ToolbarSeparator"]=true;dojo.provide("dijit.ToolbarSeparator");dojo.declare("dijit.ToolbarSeparator",[dijit._Widget,dijit._Templated],{templateString:"<div class=\"dijitToolbarSeparator dijitInline\" role=\"presentation\"></div>",buildRendering:function(){this.inherited(arguments);dojo.setSelectable(this.domNode,false);},isFocusable:function(){return false;}});}if(!dojo._hasResource["dijit.Toolbar"]){dojo._hasResource["dijit.Toolbar"]=true;dojo.provide("dijit.Toolbar");dojo.declare("dijit.Toolbar",[dijit._Widget,dijit._Templated,dijit._KeyNavContainer],{templateString:"<div class=\"dijit\" role=\"toolbar\" tabIndex=\"${tabIndex}\" dojoAttachPoint=\"containerNode\">"+"</div>",baseClass:"dijitToolbar",postCreate:function(){this.inherited(arguments);this.connectKeyNavHandlers(this.isLeftToRight()?[dojo.keys.LEFT_ARROW]:[dojo.keys.RIGHT_ARROW],this.isLeftToRight()?[dojo.keys.RIGHT_ARROW]:[dojo.keys.LEFT_ARROW]);},startup:function(){if(this._started){return;}this.startupKeyNavChildren();this.inherited(arguments);}});}if(!dojo._hasResource["dijit.layout.StackController"]){dojo._hasResource["dijit.layout.StackController"]=true;dojo.provide("dijit.layout.StackController");dojo.declare("dijit.layout.StackController",[dijit._Widget,dijit._Templated,dijit._Container],{templateString:"<span role='tablist' dojoAttachEvent='onkeypress' class='dijitStackController'></span>",containerId:"",buttonWidget:"dijit.layout._StackButton",constructor:function(){this.pane2button={};this.pane2connects={};this.pane2watches={};},buildRendering:function(){this.inherited(arguments);dijit.setWaiRole(this.domNode,"tablist");},postCreate:function(){this.inherited(arguments);this.subscribe(this.containerId+"-startup","onStartup");this.subscribe(this.containerId+"-addChild","onAddChild");this.subscribe(this.containerId+"-removeChild","onRemoveChild");this.subscribe(this.containerId+"-selectChild","onSelectChild");this.subscribe(this.containerId+"-containerKeyPress","onContainerKeyPress");},onStartup:function(info){dojo.forEach(info.children,this.onAddChild,this);if(info.selected){this.onSelectChild(info.selected);}},destroy:function(){for(var pane in this.pane2button){this.onRemoveChild(dijit.byId(pane));}this.inherited(arguments);},onAddChild:function(page,_752){var cls=dojo.getObject(this.buttonWidget);var _753=new cls({id:this.id+"_"+page.id,label:page.title,dir:page.dir,lang:page.lang,showLabel:page.showTitle,iconClass:page.iconClass,closeButton:page.closable,title:page.tooltip});dijit.setWaiState(_753.focusNode,"selected","false");var _754=["title","showTitle","iconClass","closable","tooltip"],_755=["label","showLabel","iconClass","closeButton","title"];this.pane2watches[page.id]=dojo.map(_754,function(_756,idx){return page.watch(_756,function(name,_757,_758){_753.set(_755[idx],_758);});});this.pane2connects[page.id]=[this.connect(_753,"onClick",dojo.hitch(this,"onButtonClick",page)),this.connect(_753,"onClickCloseButton",dojo.hitch(this,"onCloseButtonClick",page))];this.addChild(_753,_752);this.pane2button[page.id]=_753;page.controlButton=_753;if(!this._currentChild){_753.focusNode.setAttribute("tabIndex","0");dijit.setWaiState(_753.focusNode,"selected","true");this._currentChild=page;}if(!this.isLeftToRight()&&dojo.isIE&&this._rectifyRtlTabList){this._rectifyRtlTabList();}},onRemoveChild:function(page){if(this._currentChild===page){this._currentChild=null;}dojo.forEach(this.pane2connects[page.id],dojo.hitch(this,"disconnect"));delete this.pane2connects[page.id];dojo.forEach(this.pane2watches[page.id],function(w){w.unwatch();});delete this.pane2watches[page.id];var _759=this.pane2button[page.id];if(_759){this.removeChild(_759);delete this.pane2button[page.id];_759.destroy();}delete page.controlButton;},onSelectChild:function(page){if(!page){return;}if(this._currentChild){var _75a=this.pane2button[this._currentChild.id];_75a.set("checked",false);dijit.setWaiState(_75a.focusNode,"selected","false");_75a.focusNode.setAttribute("tabIndex","-1");}var _75b=this.pane2button[page.id];_75b.set("checked",true);dijit.setWaiState(_75b.focusNode,"selected","true");this._currentChild=page;_75b.focusNode.setAttribute("tabIndex","0");var _75c=dijit.byId(this.containerId);dijit.setWaiState(_75c.containerNode,"labelledby",_75b.id);},onButtonClick:function(page){var _75d=dijit.byId(this.containerId);_75d.selectChild(page);},onCloseButtonClick:function(page){var _75e=dijit.byId(this.containerId);_75e.closeChild(page);if(this._currentChild){var b=this.pane2button[this._currentChild.id];if(b){dijit.focus(b.focusNode||b.domNode);}}},adjacent:function(_75f){if(!this.isLeftToRight()&&(!this.tabPosition||/top|bottom/.test(this.tabPosition))){_75f=!_75f;}var _760=this.getChildren();var _761=dojo.indexOf(_760,this.pane2button[this._currentChild.id]);var _762=_75f?1:_760.length-1;return _760[(_761+_762)%_760.length];},onkeypress:function(e){if(this.disabled||e.altKey){return;}var _763=null;if(e.ctrlKey||!e._djpage){var k=dojo.keys;switch(e.charOrCode){case k.LEFT_ARROW:case k.UP_ARROW:if(!e._djpage){_763=false;}break;case k.PAGE_UP:if(e.ctrlKey){_763=false;}break;case k.RIGHT_ARROW:case k.DOWN_ARROW:if(!e._djpage){_763=true;}break;case k.PAGE_DOWN:if(e.ctrlKey){_763=true;}break;case k.HOME:case k.END:var _764=this.getChildren();if(_764&&_764.length){_764[e.charOrCode==k.HOME?0:_764.length-1].onClick();}dojo.stopEvent(e);break;case k.DELETE:if(this._currentChild.closable){this.onCloseButtonClick(this._currentChild);}dojo.stopEvent(e);break;default:if(e.ctrlKey){if(e.charOrCode===k.TAB){this.adjacent(!e.shiftKey).onClick();dojo.stopEvent(e);}else{if(e.charOrCode=="w"){if(this._currentChild.closable){this.onCloseButtonClick(this._currentChild);}dojo.stopEvent(e);}}}}if(_763!==null){this.adjacent(_763).onClick();dojo.stopEvent(e);}}},onContainerKeyPress:function(info){info.e._djpage=info.page;this.onkeypress(info.e);}});dojo.declare("dijit.layout._StackButton",dijit.form.ToggleButton,{tabIndex:"-1",buildRendering:function(evt){this.inherited(arguments);dijit.setWaiRole((this.focusNode||this.domNode),"tab");},onClick:function(evt){dijit.focus(this.focusNode);},onClickCloseButton:function(evt){evt.stopPropagation();}});}if(!dojo._hasResource["dijit.layout.StackContainer"]){dojo._hasResource["dijit.layout.StackContainer"]=true;dojo.provide("dijit.layout.StackContainer");dojo.declare("dijit.layout.StackContainer",dijit.layout._LayoutWidget,{doLayout:true,persist:false,baseClass:"dijitStackContainer",buildRendering:function(){this.inherited(arguments);dojo.addClass(this.domNode,"dijitLayoutContainer");dijit.setWaiRole(this.containerNode,"tabpanel");},postCreate:function(){this.inherited(arguments);this.connect(this.domNode,"onkeypress",this._onKeyPress);},startup:function(){if(this._started){return;}var _765=this.getChildren();dojo.forEach(_765,this._setupChild,this);if(this.persist){this.selectedChildWidget=dijit.byId(dojo.cookie(this.id+"_selectedChild"));}else{dojo.some(_765,function(_766){if(_766.selected){this.selectedChildWidget=_766;}return _766.selected;},this);}var _767=this.selectedChildWidget;if(!_767&&_765[0]){_767=this.selectedChildWidget=_765[0];_767.selected=true;}dojo.publish(this.id+"-startup",[{children:_765,selected:_767}]);this.inherited(arguments);},resize:function(){var _768=this.selectedChildWidget;if(_768&&!this._hasBeenShown){this._hasBeenShown=true;this._showChild(_768);}this.inherited(arguments);},_setupChild:function(_769){this.inherited(arguments);dojo.replaceClass(_769.domNode,"dijitHidden","dijitVisible");_769.domNode.title="";},addChild:function(_76a,_76b){this.inherited(arguments);if(this._started){dojo.publish(this.id+"-addChild",[_76a,_76b]);this.layout();if(!this.selectedChildWidget){this.selectChild(_76a);}}},removeChild:function(page){this.inherited(arguments);if(this._started){dojo.publish(this.id+"-removeChild",[page]);}if(this._beingDestroyed){return;}if(this.selectedChildWidget===page){this.selectedChildWidget=undefined;if(this._started){var _76c=this.getChildren();if(_76c.length){this.selectChild(_76c[0]);}}}if(this._started){this.layout();}},selectChild:function(page,_76d){page=dijit.byId(page);if(this.selectedChildWidget!=page){var d=this._transition(page,this.selectedChildWidget,_76d);this._set("selectedChildWidget",page);dojo.publish(this.id+"-selectChild",[page]);if(this.persist){dojo.cookie(this.id+"_selectedChild",this.selectedChildWidget.id);}}return d;},_transition:function(_76e,_76f,_770){if(_76f){this._hideChild(_76f);}var d=this._showChild(_76e);if(_76e.resize){if(this.doLayout){_76e.resize(this._containerContentBox||this._contentBox);}else{_76e.resize();}}return d;},_adjacent:function(_771){var _772=this.getChildren();var _773=dojo.indexOf(_772,this.selectedChildWidget);_773+=_771?1:_772.length-1;return _772[_773%_772.length];},forward:function(){return this.selectChild(this._adjacent(true),true);},back:function(){return this.selectChild(this._adjacent(false),true);},_onKeyPress:function(e){dojo.publish(this.id+"-containerKeyPress",[{e:e,page:this}]);},layout:function(){if(this.doLayout&&this.selectedChildWidget&&this.selectedChildWidget.resize){this.selectedChildWidget.resize(this._containerContentBox||this._contentBox);}},_showChild:function(page){var _774=this.getChildren();page.isFirstChild=(page==_774[0]);page.isLastChild=(page==_774[_774.length-1]);page._set("selected",true);dojo.replaceClass(page.domNode,"dijitVisible","dijitHidden");return page._onShow()||true;},_hideChild:function(page){page._set("selected",false);dojo.replaceClass(page.domNode,"dijitHidden","dijitVisible");page.onHide();},closeChild:function(page){var _775=page.onClose(this,page);if(_775){this.removeChild(page);page.destroyRecursive();}},destroyDescendants:function(_776){dojo.forEach(this.getChildren(),function(_777){this.removeChild(_777);_777.destroyRecursive(_776);},this);}});dojo.extend(dijit._Widget,{selected:false,closable:false,iconClass:"",showTitle:true});}if(!dojo._hasResource["dijit.layout._TabContainerBase"]){dojo._hasResource["dijit.layout._TabContainerBase"]=true;dojo.provide("dijit.layout._TabContainerBase");dojo.declare("dijit.layout._TabContainerBase",[dijit.layout.StackContainer,dijit._Templated],{tabPosition:"top",baseClass:"dijitTabContainer",tabStrip:false,nested:false,templateString:dojo.cache("dijit.layout","templates/TabContainer.html","<div class=\"dijitTabContainer\">\n\t<div class=\"dijitTabListWrapper\" dojoAttachPoint=\"tablistNode\"></div>\n\t<div dojoAttachPoint=\"tablistSpacer\" class=\"dijitTabSpacer ${baseClass}-spacer\"></div>\n\t<div class=\"dijitTabPaneWrapper ${baseClass}-container\" dojoAttachPoint=\"containerNode\"></div>\n</div>\n"),postMixInProperties:function(){this.baseClass+=this.tabPosition.charAt(0).toUpperCase()+this.tabPosition.substr(1).replace(/-.*/,"");this.srcNodeRef&&dojo.style(this.srcNodeRef,"visibility","hidden");this.inherited(arguments);},buildRendering:function(){this.inherited(arguments);this.tablist=this._makeController(this.tablistNode);if(!this.doLayout){dojo.addClass(this.domNode,"dijitTabContainerNoLayout");}if(this.nested){dojo.addClass(this.domNode,"dijitTabContainerNested");dojo.addClass(this.tablist.containerNode,"dijitTabContainerTabListNested");dojo.addClass(this.tablistSpacer,"dijitTabContainerSpacerNested");dojo.addClass(this.containerNode,"dijitTabPaneWrapperNested");}else{dojo.addClass(this.domNode,"tabStrip-"+(this.tabStrip?"enabled":"disabled"));}},_setupChild:function(tab){dojo.addClass(tab.domNode,"dijitTabPane");this.inherited(arguments);},startup:function(){if(this._started){return;}this.tablist.startup();this.inherited(arguments);},layout:function(){if(!this._contentBox||typeof (this._contentBox.l)=="undefined"){return;}var sc=this.selectedChildWidget;if(this.doLayout){var _778=this.tabPosition.replace(/-h/,"");this.tablist.layoutAlign=_778;var _779=[this.tablist,{domNode:this.tablistSpacer,layoutAlign:_778},{domNode:this.containerNode,layoutAlign:"client"}];dijit.layout.layoutChildren(this.domNode,this._contentBox,_779);this._containerContentBox=dijit.layout.marginBox2contentBox(this.containerNode,_779[2]);if(sc&&sc.resize){sc.resize(this._containerContentBox);}}else{if(this.tablist.resize){var s=this.tablist.domNode.style;s.width="0";var _77a=dojo.contentBox(this.domNode).w;s.width="";this.tablist.resize({w:_77a});}if(sc&&sc.resize){sc.resize();}}},destroy:function(){if(this.tablist){this.tablist.destroy();}this.inherited(arguments);}});}if(!dojo._hasResource["dijit.MenuItem"]){dojo._hasResource["dijit.MenuItem"]=true;dojo.provide("dijit.MenuItem");dojo.declare("dijit.MenuItem",[dijit._Widget,dijit._Templated,dijit._Contained,dijit._CssStateMixin],{templateString:dojo.cache("dijit","templates/MenuItem.html","<tr class=\"dijitReset dijitMenuItem\" dojoAttachPoint=\"focusNode\" role=\"menuitem\" tabIndex=\"-1\"\n\t\tdojoAttachEvent=\"onmouseenter:_onHover,onmouseleave:_onUnhover,ondijitclick:_onClick\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon dijitMenuItemIcon\" dojoAttachPoint=\"iconNode\"/>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" dojoAttachPoint=\"containerNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" dojoAttachPoint=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">\n\t\t<div dojoAttachPoint=\"arrowWrapper\" style=\"visibility: hidden\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuExpand\"/>\n\t\t\t<span class=\"dijitMenuExpandA11y\">+</span>\n\t\t</div>\n\t</td>\n</tr>\n"),attributeMap:dojo.delegate(dijit._Widget.prototype.attributeMap,{label:{node:"containerNode",type:"innerHTML"},iconClass:{node:"iconNode",type:"class"}}),baseClass:"dijitMenuItem",label:"",iconClass:"",accelKey:"",disabled:false,_fillContent:function(_77b){if(_77b&&!("label" in this.params)){this.set("label",_77b.innerHTML);}},buildRendering:function(){this.inherited(arguments);var _77c=this.id+"_text";dojo.attr(this.containerNode,"id",_77c);if(this.accelKeyNode){dojo.attr(this.accelKeyNode,"id",this.id+"_accel");_77c+=" "+this.id+"_accel";}dijit.setWaiState(this.domNode,"labelledby",_77c);dojo.setSelectable(this.domNode,false);},_onHover:function(){this.getParent().onItemHover(this);},_onUnhover:function(){this.getParent().onItemUnhover(this);this._set("hovering",false);},_onClick:function(evt){this.getParent().onItemClick(this,evt);dojo.stopEvent(evt);},onClick:function(evt){},focus:function(){try{if(dojo.isIE==8){this.containerNode.focus();}dijit.focus(this.focusNode);}catch(e){}},_onFocus:function(){this._setSelected(true);this.getParent()._onItemFocus(this);this.inherited(arguments);},_setSelected:function(_77d){dojo.toggleClass(this.domNode,"dijitMenuItemSelected",_77d);},setLabel:function(_77e){dojo.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",_77e);},setDisabled:function(_77f){dojo.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",_77f);},_setDisabledAttr:function(_780){dijit.setWaiState(this.focusNode,"disabled",_780?"true":"false");this._set("disabled",_780);},_setAccelKeyAttr:function(_781){this.accelKeyNode.style.display=_781?"":"none";this.accelKeyNode.innerHTML=_781;dojo.attr(this.containerNode,"colSpan",_781?"1":"2");this._set("accelKey",_781);}});}if(!dojo._hasResource["dijit.PopupMenuItem"]){dojo._hasResource["dijit.PopupMenuItem"]=true;dojo.provide("dijit.PopupMenuItem");dojo.declare("dijit.PopupMenuItem",dijit.MenuItem,{_fillContent:function(){if(this.srcNodeRef){var _782=dojo.query("*",this.srcNodeRef);dijit.PopupMenuItem.superclass._fillContent.call(this,_782[0]);this.dropDownContainer=this.srcNodeRef;}},startup:function(){if(this._started){return;}this.inherited(arguments);if(!this.popup){var node=dojo.query("[widgetId]",this.dropDownContainer)[0];this.popup=dijit.byNode(node);}dojo.body().appendChild(this.popup.domNode);this.popup.startup();this.popup.domNode.style.display="none";if(this.arrowWrapper){dojo.style(this.arrowWrapper,"visibility","");}dijit.setWaiState(this.focusNode,"haspopup","true");},destroyDescendants:function(){if(this.popup){if(!this.popup._destroyed){this.popup.destroyRecursive();}delete this.popup;}this.inherited(arguments);}});}if(!dojo._hasResource["dijit.CheckedMenuItem"]){dojo._hasResource["dijit.CheckedMenuItem"]=true;dojo.provide("dijit.CheckedMenuItem");dojo.declare("dijit.CheckedMenuItem",dijit.MenuItem,{templateString:dojo.cache("dijit","templates/CheckedMenuItem.html","<tr class=\"dijitReset dijitMenuItem\" dojoAttachPoint=\"focusNode\" role=\"menuitemcheckbox\" tabIndex=\"-1\"\n\t\tdojoAttachEvent=\"onmouseenter:_onHover,onmouseleave:_onUnhover,ondijitclick:_onClick\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuItemIcon dijitCheckedMenuItemIcon\" dojoAttachPoint=\"iconNode\"/>\n\t\t<span class=\"dijitCheckedMenuItemIconChar\">&#10003;</span>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" dojoAttachPoint=\"containerNode,labelNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" dojoAttachPoint=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">&nbsp;</td>\n</tr>\n"),checked:false,_setCheckedAttr:function(_783){dojo.toggleClass(this.domNode,"dijitCheckedMenuItemChecked",_783);dijit.setWaiState(this.domNode,"checked",_783);this._set("checked",_783);},onChange:function(_784){},_onClick:function(e){if(!this.disabled){this.set("checked",!this.checked);this.onChange(this.checked);}this.inherited(arguments);}});}if(!dojo._hasResource["dijit.MenuSeparator"]){dojo._hasResource["dijit.MenuSeparator"]=true;dojo.provide("dijit.MenuSeparator");dojo.declare("dijit.MenuSeparator",[dijit._Widget,dijit._Templated,dijit._Contained],{templateString:dojo.cache("dijit","templates/MenuSeparator.html","<tr class=\"dijitMenuSeparator\">\n\t<td class=\"dijitMenuSeparatorIconCell\">\n\t\t<div class=\"dijitMenuSeparatorTop\"></div>\n\t\t<div class=\"dijitMenuSeparatorBottom\"></div>\n\t</td>\n\t<td colspan=\"3\" class=\"dijitMenuSeparatorLabelCell\">\n\t\t<div class=\"dijitMenuSeparatorTop dijitMenuSeparatorLabel\"></div>\n\t\t<div class=\"dijitMenuSeparatorBottom\"></div>\n\t</td>\n</tr>\n"),buildRendering:function(){this.inherited(arguments);dojo.setSelectable(this.domNode,false);},isFocusable:function(){return false;}});}if(!dojo._hasResource["dijit.Menu"]){dojo._hasResource["dijit.Menu"]=true;dojo.provide("dijit.Menu");dojo.declare("dijit._MenuBase",[dijit._Widget,dijit._Templated,dijit._KeyNavContainer],{parentMenu:null,popupDelay:500,startup:function(){if(this._started){return;}dojo.forEach(this.getChildren(),function(_785){_785.startup();});this.startupKeyNavChildren();this.inherited(arguments);},onExecute:function(){},onCancel:function(_786){},_moveToPopup:function(evt){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled){this.focusedChild._onClick(evt);}else{var _787=this._getTopMenu();if(_787&&_787._isMenuBar){_787.focusNext();}}},_onPopupHover:function(evt){if(this.currentPopup&&this.currentPopup._pendingClose_timer){var _788=this.currentPopup.parentMenu;if(_788.focusedChild){_788.focusedChild._setSelected(false);}_788.focusedChild=this.currentPopup.from_item;_788.focusedChild._setSelected(true);this._stopPendingCloseTimer(this.currentPopup);}},onItemHover:function(item){if(this.isActive){this.focusChild(item);if(this.focusedChild.popup&&!this.focusedChild.disabled&&!this.hover_timer){this.hover_timer=setTimeout(dojo.hitch(this,"_openPopup"),this.popupDelay);}}if(this.focusedChild){this.focusChild(item);}this._hoveredChild=item;},_onChildBlur:function(item){this._stopPopupTimer();item._setSelected(false);var _789=item.popup;if(_789){this._stopPendingCloseTimer(_789);_789._pendingClose_timer=setTimeout(function(){_789._pendingClose_timer=null;if(_789.parentMenu){_789.parentMenu.currentPopup=null;}dijit.popup.close(_789);},this.popupDelay);}},onItemUnhover:function(item){if(this.isActive){this._stopPopupTimer();}if(this._hoveredChild==item){this._hoveredChild=null;}},_stopPopupTimer:function(){if(this.hover_timer){clearTimeout(this.hover_timer);this.hover_timer=null;}},_stopPendingCloseTimer:function(_78a){if(_78a._pendingClose_timer){clearTimeout(_78a._pendingClose_timer);_78a._pendingClose_timer=null;}},_stopFocusTimer:function(){if(this._focus_timer){clearTimeout(this._focus_timer);this._focus_timer=null;}},_getTopMenu:function(){for(var top=this;top.parentMenu;top=top.parentMenu){}return top;},onItemClick:function(item,evt){if(typeof this.isShowingNow=="undefined"){this._markActive();}this.focusChild(item);if(item.disabled){return false;}if(item.popup){this._openPopup();}else{this.onExecute();item.onClick(evt);}},_openPopup:function(){this._stopPopupTimer();var _78b=this.focusedChild;if(!_78b){return;}var _78c=_78b.popup;if(_78c.isShowingNow){return;}if(this.currentPopup){this._stopPendingCloseTimer(this.currentPopup);dijit.popup.close(this.currentPopup);}_78c.parentMenu=this;_78c.from_item=_78b;var self=this;dijit.popup.open({parent:this,popup:_78c,around:_78b.domNode,orient:this._orient||(this.isLeftToRight()?{"TR":"TL","TL":"TR","BR":"BL","BL":"BR"}:{"TL":"TR","TR":"TL","BL":"BR","BR":"BL"}),onCancel:function(){self.focusChild(_78b);self._cleanUp();_78b._setSelected(true);self.focusedChild=_78b;},onExecute:dojo.hitch(this,"_cleanUp")});this.currentPopup=_78c;_78c.connect(_78c.domNode,"onmouseenter",dojo.hitch(self,"_onPopupHover"));if(_78c.focus){_78c._focus_timer=setTimeout(dojo.hitch(_78c,function(){this._focus_timer=null;this.focus();}),0);}},_markActive:function(){this.isActive=true;dojo.replaceClass(this.domNode,"dijitMenuActive","dijitMenuPassive");},onOpen:function(e){console.log("dijit.Menu.onOpen");this.isShowingNow=true;this._markActive();},_markInactive:function(){console.log("dijit.Menu._markInactive");this.isActive=false;dojo.replaceClass(this.domNode,"dijitMenuPassive","dijitMenuActive");},onClose:function(){this._stopFocusTimer();this._markInactive();this.isShowingNow=false;this.parentMenu=null;},_closeChild:function(){this._stopPopupTimer();var _78d=this.focusedChild&&this.focusedChild.from_item;if(this.currentPopup){if(dijit._curFocus&&dojo.isDescendant(dijit._curFocus,this.currentPopup.domNode)){this.focusedChild.focusNode.focus();}dijit.popup.close(this.currentPopup);this.currentPopup=null;}if(this.focusedChild){this.focusedChild._setSelected(false);this.focusedChild._onUnhover();this.focusedChild=null;}},_onItemFocus:function(item){if(this._hoveredChild&&this._hoveredChild!=item){this._hoveredChild._onUnhover();}},_onBlur:function(){this._cleanUp();this.inherited(arguments);},_cleanUp:function(){this._closeChild();if(typeof this.isShowingNow=="undefined"){this._markInactive();}}});dojo.declare("dijit.Menu",dijit._MenuBase,{constructor:function(){this._bindings=[];},templateString:dojo.cache("dijit","templates/Menu.html","<table class=\"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable\" role=\"menu\" tabIndex=\"${tabIndex}\" dojoAttachEvent=\"onkeypress:_onKeyPress\" cellspacing=\"0\">\n\t<tbody class=\"dijitReset\" dojoAttachPoint=\"containerNode\"></tbody>\n</table>\n"),baseClass:"dijitMenu",targetNodeIds:[],contextMenuForWindow:false,leftClickToOpen:false,refocus:true,postCreate:function(){if(this.contextMenuForWindow){this.bindDomNode(dojo.body());}else{dojo.forEach(this.targetNodeIds,this.bindDomNode,this);}var k=dojo.keys,l=this.isLeftToRight();this._openSubMenuKey=l?k.RIGHT_ARROW:k.LEFT_ARROW;this._closeSubMenuKey=l?k.LEFT_ARROW:k.RIGHT_ARROW;this.connectKeyNavHandlers([k.UP_ARROW],[k.DOWN_ARROW]);},_onKeyPress:function(evt){if(evt.ctrlKey||evt.altKey){return;}switch(evt.charOrCode){case this._openSubMenuKey:this._moveToPopup(evt);dojo.stopEvent(evt);break;case this._closeSubMenuKey:if(this.parentMenu){if(this.parentMenu._isMenuBar){this.parentMenu.focusPrev();}else{this.onCancel(false);}}else{dojo.stopEvent(evt);}break;}},_iframeContentWindow:function(_78e){var win=dojo.window.get(this._iframeContentDocument(_78e))||this._iframeContentDocument(_78e)["__parent__"]||(_78e.name&&dojo.doc.frames[_78e.name])||null;return win;},_iframeContentDocument:function(_78f){var doc=_78f.contentDocument||(_78f.contentWindow&&_78f.contentWindow.document)||(_78f.name&&dojo.doc.frames[_78f.name]&&dojo.doc.frames[_78f.name].document)||null;return doc;},bindDomNode:function(node){node=dojo.byId(node);var cn;if(node.tagName.toLowerCase()=="iframe"){var _790=node,win=this._iframeContentWindow(_790);cn=dojo.withGlobal(win,dojo.body);}else{cn=(node==dojo.body()?dojo.doc.documentElement:node);}var _791={node:node,iframe:_790};dojo.attr(node,"_dijitMenu"+this.id,this._bindings.push(_791));var _792=dojo.hitch(this,function(cn){return [dojo.connect(cn,this.leftClickToOpen?"onclick":"oncontextmenu",this,function(evt){dojo.stopEvent(evt);this._scheduleOpen(evt.target,_790,{x:evt.pageX,y:evt.pageY});}),dojo.connect(cn,"onkeydown",this,function(evt){if(evt.shiftKey&&evt.keyCode==dojo.keys.F10){dojo.stopEvent(evt);this._scheduleOpen(evt.target,_790);}})];});_791.connects=cn?_792(cn):[];if(_790){_791.onloadHandler=dojo.hitch(this,function(){var win=this._iframeContentWindow(_790);cn=dojo.withGlobal(win,dojo.body);_791.connects=_792(cn);});if(_790.addEventListener){_790.addEventListener("load",_791.onloadHandler,false);}else{_790.attachEvent("onload",_791.onloadHandler);}}},unBindDomNode:function(_793){var node;try{node=dojo.byId(_793);}catch(e){return;}var _794="_dijitMenu"+this.id;if(node&&dojo.hasAttr(node,_794)){var bid=dojo.attr(node,_794)-1,b=this._bindings[bid];dojo.forEach(b.connects,dojo.disconnect);var _795=b.iframe;if(_795){if(_795.removeEventListener){_795.removeEventListener("load",b.onloadHandler,false);}else{_795.detachEvent("onload",b.onloadHandler);}}dojo.removeAttr(node,_794);delete this._bindings[bid];}},_scheduleOpen:function(_796,_797,_798){if(!this._openTimer){this._openTimer=setTimeout(dojo.hitch(this,function(){delete this._openTimer;this._openMyself({target:_796,iframe:_797,coords:_798});}),1);}},_openMyself:function(args){var _799=args.target,_79a=args.iframe,_79b=args.coords;if(_79b){if(_79a){var od=_799.ownerDocument,ifc=dojo.position(_79a,true),win=this._iframeContentWindow(_79a),_79c=dojo.withGlobal(win,"_docScroll",dojo);var cs=dojo.getComputedStyle(_79a),tp=dojo._toPixelValue,left=(dojo.isIE&&dojo.isQuirks?0:tp(_79a,cs.paddingLeft))+(dojo.isIE&&dojo.isQuirks?tp(_79a,cs.borderLeftWidth):0),top=(dojo.isIE&&dojo.isQuirks?0:tp(_79a,cs.paddingTop))+(dojo.isIE&&dojo.isQuirks?tp(_79a,cs.borderTopWidth):0);_79b.x+=ifc.x+left-_79c.x;_79b.y+=ifc.y+top-_79c.y;}}else{_79b=dojo.position(_799,true);_79b.x+=10;_79b.y+=10;}var self=this;var _79d=dijit.getFocus(this);function _79e(){if(self.refocus){dijit.focus(_79d);}dijit.popup.close(self);};dijit.popup.open({popup:this,x:_79b.x,y:_79b.y,onExecute:_79e,onCancel:_79e,orient:this.isLeftToRight()?"L":"R"});this.focus();this._onBlur=function(){this.inherited("_onBlur",arguments);dijit.popup.close(this);};},uninitialize:function(){dojo.forEach(this._bindings,function(b){if(b){this.unBindDomNode(b.node);}},this);this.inherited(arguments);}});}if(!dojo._hasResource["dijit.layout.TabController"]){dojo._hasResource["dijit.layout.TabController"]=true;dojo.provide("dijit.layout.TabController");dojo.declare("dijit.layout.TabController",dijit.layout.StackController,{templateString:"<div role='tablist' dojoAttachEvent='onkeypress:onkeypress'></div>",tabPosition:"top",buttonWidget:"dijit.layout._TabButton",_rectifyRtlTabList:function(){if(0>=this.tabPosition.indexOf("-h")){return;}if(!this.pane2button){return;}var _79f=0;for(var pane in this.pane2button){var ow=this.pane2button[pane].innerDiv.scrollWidth;_79f=Math.max(_79f,ow);}for(pane in this.pane2button){this.pane2button[pane].innerDiv.style.width=_79f+"px";}}});dojo.declare("dijit.layout._TabButton",dijit.layout._StackButton,{baseClass:"dijitTab",cssStateNodes:{closeNode:"dijitTabCloseButton"},templateString:dojo.cache("dijit.layout","templates/_TabButton.html","<div role=\"presentation\" dojoAttachPoint=\"titleNode\" dojoAttachEvent='onclick:onClick'>\n    <div role=\"presentation\" class='dijitTabInnerDiv' dojoAttachPoint='innerDiv'>\n        <div role=\"presentation\" class='dijitTabContent' dojoAttachPoint='tabContent'>\n        \t<div role=\"presentation\" dojoAttachPoint='focusNode'>\n\t\t        <img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon dijitTabButtonIcon\" dojoAttachPoint='iconNode' />\n\t\t        <span dojoAttachPoint='containerNode' class='tabLabel'></span>\n\t\t        <span class=\"dijitInline dijitTabCloseButton dijitTabCloseIcon\" dojoAttachPoint='closeNode'\n\t\t        \t\tdojoAttachEvent='onclick: onClickCloseButton' role=\"presentation\">\n\t\t            <span dojoAttachPoint='closeText' class='dijitTabCloseText'>[x]</span\n\t\t        ></span>\n\t\t\t</div>\n        </div>\n    </div>\n</div>\n"),scrollOnFocus:false,buildRendering:function(){this.inherited(arguments);dojo.setSelectable(this.containerNode,false);},startup:function(){this.inherited(arguments);var n=this.domNode;setTimeout(function(){n.className=n.className;},1);},_setCloseButtonAttr:function(disp){this._set("closeButton",disp);dojo.toggleClass(this.innerDiv,"dijitClosable",disp);this.closeNode.style.display=disp?"":"none";if(disp){var _7a0=dojo.i18n.getLocalization("dijit","common");if(this.closeNode){dojo.attr(this.closeNode,"title",_7a0.itemClose);}var _7a0=dojo.i18n.getLocalization("dijit","common");this._closeMenu=new dijit.Menu({id:this.id+"_Menu",dir:this.dir,lang:this.lang,targetNodeIds:[this.domNode]});this._closeMenu.addChild(new dijit.MenuItem({label:_7a0.itemClose,dir:this.dir,lang:this.lang,onClick:dojo.hitch(this,"onClickCloseButton")}));}else{if(this._closeMenu){this._closeMenu.destroyRecursive();delete this._closeMenu;}}},_setLabelAttr:function(_7a1){this.inherited(arguments);if(this.showLabel==false&&!this.params.title){this.iconNode.alt=dojo.trim(this.containerNode.innerText||this.containerNode.textContent||"");}},destroy:function(){if(this._closeMenu){this._closeMenu.destroyRecursive();delete this._closeMenu;}this.inherited(arguments);}});}if(!dojo._hasResource["dijit.layout.ScrollingTabController"]){dojo._hasResource["dijit.layout.ScrollingTabController"]=true;dojo.provide("dijit.layout.ScrollingTabController");dojo.declare("dijit.layout.ScrollingTabController",dijit.layout.TabController,{templateString:dojo.cache("dijit.layout","templates/ScrollingTabController.html","<div class=\"dijitTabListContainer-${tabPosition}\" style=\"visibility:hidden\">\n\t<div dojoType=\"dijit.layout._ScrollingTabControllerMenuButton\"\n\t\t\tclass=\"tabStripButton-${tabPosition}\"\n\t\t\tid=\"${id}_menuBtn\" containerId=\"${containerId}\" iconClass=\"dijitTabStripMenuIcon\"\n\t\t\tdropDownPosition=\"below-alt, above-alt\"\n\t\t\tdojoAttachPoint=\"_menuBtn\" showLabel=\"false\">&#9660;</div>\n\t<div dojoType=\"dijit.layout._ScrollingTabControllerButton\"\n\t\t\tclass=\"tabStripButton-${tabPosition}\"\n\t\t\tid=\"${id}_leftBtn\" iconClass=\"dijitTabStripSlideLeftIcon\"\n\t\t\tdojoAttachPoint=\"_leftBtn\" dojoAttachEvent=\"onClick: doSlideLeft\" showLabel=\"false\">&#9664;</div>\n\t<div dojoType=\"dijit.layout._ScrollingTabControllerButton\"\n\t\t\tclass=\"tabStripButton-${tabPosition}\"\n\t\t\tid=\"${id}_rightBtn\" iconClass=\"dijitTabStripSlideRightIcon\"\n\t\t\tdojoAttachPoint=\"_rightBtn\" dojoAttachEvent=\"onClick: doSlideRight\" showLabel=\"false\">&#9654;</div>\n\t<div class='dijitTabListWrapper' dojoAttachPoint='tablistWrapper'>\n\t\t<div role='tablist' dojoAttachEvent='onkeypress:onkeypress'\n\t\t\t\tdojoAttachPoint='containerNode' class='nowrapTabStrip'></div>\n\t</div>\n</div>\n"),useMenu:true,useSlider:true,tabStripClass:"",widgetsInTemplate:true,_minScroll:5,attributeMap:dojo.delegate(dijit._Widget.prototype.attributeMap,{"class":"containerNode"}),buildRendering:function(){this.inherited(arguments);var n=this.domNode;this.scrollNode=this.tablistWrapper;this._initButtons();if(!this.tabStripClass){this.tabStripClass="dijitTabContainer"+this.tabPosition.charAt(0).toUpperCase()+this.tabPosition.substr(1).replace(/-.*/,"")+"None";dojo.addClass(n,"tabStrip-disabled");}dojo.addClass(this.tablistWrapper,this.tabStripClass);},onStartup:function(){this.inherited(arguments);dojo.style(this.domNode,"visibility","visible");this._postStartup=true;},onAddChild:function(page,_7a2){this.inherited(arguments);dojo.forEach(["label","iconClass"],function(attr){this.pane2watches[page.id].push(this.pane2button[page.id].watch(attr,dojo.hitch(this,function(name,_7a3,_7a4){if(this._postStartup&&this._dim){this.resize(this._dim);}})));},this);dojo.style(this.containerNode,"width",(dojo.style(this.containerNode,"width")+200)+"px");},onRemoveChild:function(page,_7a5){var _7a6=this.pane2button[page.id];if(this._selectedTab===_7a6.domNode){this._selectedTab=null;}this.inherited(arguments);},_initButtons:function(){this._btnWidth=0;this._buttons=dojo.query("> .tabStripButton",this.domNode).filter(function(btn){if((this.useMenu&&btn==this._menuBtn.domNode)||(this.useSlider&&(btn==this._rightBtn.domNode||btn==this._leftBtn.domNode))){this._btnWidth+=dojo._getMarginSize(btn).w;return true;}else{dojo.style(btn,"display","none");return false;}},this);},_getTabsWidth:function(){var _7a7=this.getChildren();if(_7a7.length){var _7a8=_7a7[this.isLeftToRight()?0:_7a7.length-1].domNode,_7a9=_7a7[this.isLeftToRight()?_7a7.length-1:0].domNode;return _7a9.offsetLeft+dojo.style(_7a9,"width")-_7a8.offsetLeft;}else{return 0;}},_enableBtn:function(_7aa){var _7ab=this._getTabsWidth();_7aa=_7aa||dojo.style(this.scrollNode,"width");return _7ab>0&&_7aa<_7ab;},resize:function(dim){if(this.domNode.offsetWidth==0){return;}this._dim=dim;this.scrollNode.style.height="auto";this._contentBox=dijit.layout.marginBox2contentBox(this.domNode,{h:0,w:dim.w});this._contentBox.h=this.scrollNode.offsetHeight;dojo.contentBox(this.domNode,this._contentBox);var _7ac=this._enableBtn(this._contentBox.w);this._buttons.style("display",_7ac?"":"none");this._leftBtn.layoutAlign="left";this._rightBtn.layoutAlign="right";this._menuBtn.layoutAlign=this.isLeftToRight()?"right":"left";dijit.layout.layoutChildren(this.domNode,this._contentBox,[this._menuBtn,this._leftBtn,this._rightBtn,{domNode:this.scrollNode,layoutAlign:"client"}]);if(this._selectedTab){if(this._anim&&this._anim.status()=="playing"){this._anim.stop();}var w=this.scrollNode,sl=this._convertToScrollLeft(this._getScrollForSelectedTab());w.scrollLeft=sl;}this._setButtonClass(this._getScroll());this._postResize=true;return {h:this._contentBox.h,w:dim.w};},_getScroll:function(){var sl=(this.isLeftToRight()||dojo.isIE<8||(dojo.isIE&&dojo.isQuirks)||dojo.isWebKit)?this.scrollNode.scrollLeft:dojo.style(this.containerNode,"width")-dojo.style(this.scrollNode,"width")+(dojo.isIE==8?-1:1)*this.scrollNode.scrollLeft;return sl;},_convertToScrollLeft:function(val){if(this.isLeftToRight()||dojo.isIE<8||(dojo.isIE&&dojo.isQuirks)||dojo.isWebKit){return val;}else{var _7ad=dojo.style(this.containerNode,"width")-dojo.style(this.scrollNode,"width");return (dojo.isIE==8?-1:1)*(val-_7ad);}},onSelectChild:function(page){var tab=this.pane2button[page.id];if(!tab||!page){return;}var node=tab.domNode;if(this._postResize&&node!=this._selectedTab){this._selectedTab=node;var sl=this._getScroll();if(sl>node.offsetLeft||sl+dojo.style(this.scrollNode,"width")<node.offsetLeft+dojo.style(node,"width")){this.createSmoothScroll().play();}}this.inherited(arguments);},_getScrollBounds:function(){var _7ae=this.getChildren(),_7af=dojo.style(this.scrollNode,"width"),_7b0=dojo.style(this.containerNode,"width"),_7b1=_7b0-_7af,_7b2=this._getTabsWidth();if(_7ae.length&&_7b2>_7af){return {min:this.isLeftToRight()?0:_7ae[_7ae.length-1].domNode.offsetLeft,max:this.isLeftToRight()?(_7ae[_7ae.length-1].domNode.offsetLeft+dojo.style(_7ae[_7ae.length-1].domNode,"width"))-_7af:_7b1};}else{var _7b3=this.isLeftToRight()?0:_7b1;return {min:_7b3,max:_7b3};}},_getScrollForSelectedTab:function(){var w=this.scrollNode,n=this._selectedTab,_7b4=dojo.style(this.scrollNode,"width"),_7b5=this._getScrollBounds();var pos=(n.offsetLeft+dojo.style(n,"width")/2)-_7b4/2;pos=Math.min(Math.max(pos,_7b5.min),_7b5.max);return pos;},createSmoothScroll:function(x){if(arguments.length>0){var _7b6=this._getScrollBounds();x=Math.min(Math.max(x,_7b6.min),_7b6.max);}else{x=this._getScrollForSelectedTab();}if(this._anim&&this._anim.status()=="playing"){this._anim.stop();}var self=this,w=this.scrollNode,anim=new dojo._Animation({beforeBegin:function(){if(this.curve){delete this.curve;}var oldS=w.scrollLeft,newS=self._convertToScrollLeft(x);anim.curve=new dojo._Line(oldS,newS);},onAnimate:function(val){w.scrollLeft=val;}});this._anim=anim;this._setButtonClass(x);return anim;},_getBtnNode:function(e){var n=e.target;while(n&&!dojo.hasClass(n,"tabStripButton")){n=n.parentNode;}return n;},doSlideRight:function(e){this.doSlide(1,this._getBtnNode(e));},doSlideLeft:function(e){this.doSlide(-1,this._getBtnNode(e));},doSlide:function(_7b7,node){if(node&&dojo.hasClass(node,"dijitTabDisabled")){return;}var _7b8=dojo.style(this.scrollNode,"width");var d=(_7b8*0.75)*_7b7;var to=this._getScroll()+d;this._setButtonClass(to);this.createSmoothScroll(to).play();},_setButtonClass:function(_7b9){var _7ba=this._getScrollBounds();this._leftBtn.set("disabled",_7b9<=_7ba.min);this._rightBtn.set("disabled",_7b9>=_7ba.max);}});dojo.declare("dijit.layout._ScrollingTabControllerButtonMixin",null,{baseClass:"dijitTab tabStripButton",templateString:dojo.cache("dijit.layout","templates/_ScrollingTabControllerButton.html","<div dojoAttachEvent=\"onclick:_onButtonClick\">\n\t<div role=\"presentation\" class=\"dijitTabInnerDiv\" dojoattachpoint=\"innerDiv,focusNode\">\n\t\t<div role=\"presentation\" class=\"dijitTabContent dijitButtonContents\" dojoattachpoint=\"tabContent\">\n\t\t\t<img role=\"presentation\" alt=\"\" src=\"${_blankGif}\" class=\"dijitTabStripIcon\" dojoAttachPoint=\"iconNode\"/>\n\t\t\t<span dojoAttachPoint=\"containerNode,titleNode\" class=\"dijitButtonText\"></span>\n\t\t</div>\n\t</div>\n</div>\n"),tabIndex:"",isFocusable:function(){return false;}});dojo.declare("dijit.layout._ScrollingTabControllerButton",[dijit.form.Button,dijit.layout._ScrollingTabControllerButtonMixin]);dojo.declare("dijit.layout._ScrollingTabControllerMenuButton",[dijit.form.Button,dijit._HasDropDown,dijit.layout._ScrollingTabControllerButtonMixin],{containerId:"",tabIndex:"-1",isLoaded:function(){return false;},loadDropDown:function(_7bb){this.dropDown=new dijit.Menu({id:this.containerId+"_menu",dir:this.dir,lang:this.lang});var _7bc=dijit.byId(this.containerId);dojo.forEach(_7bc.getChildren(),function(page){var _7bd=new dijit.MenuItem({id:page.id+"_stcMi",label:page.title,iconClass:page.iconClass,dir:page.dir,lang:page.lang,onClick:function(){_7bc.selectChild(page);}});this.dropDown.addChild(_7bd);},this);_7bb();},closeDropDown:function(_7be){this.inherited(arguments);if(this.dropDown){this.dropDown.destroyRecursive();delete this.dropDown;}}});}if(!dojo._hasResource["dijit.layout.TabContainer"]){dojo._hasResource["dijit.layout.TabContainer"]=true;dojo.provide("dijit.layout.TabContainer");dojo.declare("dijit.layout.TabContainer",dijit.layout._TabContainerBase,{useMenu:true,useSlider:true,controllerWidget:"",_makeController:function(_7bf){var cls=this.baseClass+"-tabs"+(this.doLayout?"":" dijitTabNoLayout"),_7c0=dojo.getObject(this.controllerWidget);return new _7c0({id:this.id+"_tablist",dir:this.dir,lang:this.lang,tabPosition:this.tabPosition,doLayout:this.doLayout,containerId:this.id,"class":cls,nested:this.nested,useMenu:this.useMenu,useSlider:this.useSlider,tabStripClass:this.tabStrip?this.baseClass+(this.tabStrip?"":"No")+"Strip":null},_7bf);},postMixInProperties:function(){this.inherited(arguments);if(!this.controllerWidget){this.controllerWidget=(this.tabPosition=="top"||this.tabPosition=="bottom")&&!this.nested?"dijit.layout.ScrollingTabController":"dijit.layout.TabController";}}});}if(!dojo._hasResource["dojox.widget.Standby"]){dojo._hasResource["dojox.widget.Standby"]=true;dojo.provide("dojox.widget.Standby");dojo.experimental("dojox.widget.Standby");dojo.declare("dojox.widget.Standby",[dijit._Widget,dijit._Templated],{templateString:"<div>"+"<div style=\"display: none; opacity: 0; z-index: 9999; "+"position: absolute; cursor:wait;\" dojoAttachPoint=\"_underlayNode\"></div>"+"<img src=\"${image}\" style=\"opacity: 0; display: none; z-index: -10000; "+"position: absolute; top: 0px; left: 0px; cursor:wait;\" "+"dojoAttachPoint=\"_imageNode\">"+"<div style=\"opacity: 0; display: none; z-index: -10000; position: absolute; "+"top: 0px;\" dojoAttachPoint=\"_textNode\"></div>"+"</div>",_underlayNode:null,_imageNode:null,_textNode:null,_centerNode:null,image:dojo.moduleUrl("dojox","widget/Standby/images/loading.gif").toString(),imageText:"Please Wait...",text:"Please wait...",centerIndicator:"image",_displayed:false,_resizeCheck:null,target:"",color:"#C0C0C0",duration:500,_started:false,_parent:null,zIndex:"auto",startup:function(args){if(!this._started){if(typeof this.target==="string"){var w=dijit.byId(this.target);if(w){this.target=w.domNode;}else{this.target=dojo.byId(this.target);}}if(this.text){this._textNode.innerHTML=this.text;}if(this.centerIndicator==="image"){this._centerNode=this._imageNode;dojo.attr(this._imageNode,"src",this.image);dojo.attr(this._imageNode,"alt",this.imageText);}else{this._centerNode=this._textNode;}dojo.style(this._underlayNode,{display:"none",backgroundColor:this.color});dojo.style(this._centerNode,"display","none");this.connect(this._underlayNode,"onclick","_ignore");if(this.domNode.parentNode&&this.domNode.parentNode!=dojo.body()){dojo.body().appendChild(this.domNode);}if(dojo.isIE==7){this._ieFixNode=dojo.doc.createElement("div");dojo.style(this._ieFixNode,{opacity:"0",zIndex:"-1000",position:"absolute",top:"-1000px"});dojo.body().appendChild(this._ieFixNode);}}},show:function(){if(!this._displayed){if(this._anim){this._anim.stop();delete this._anim;}this._displayed=true;this._size();this._disableOverflow();this._fadeIn();}},hide:function(){if(this._displayed){if(this._anim){this._anim.stop();delete this._anim;}this._size();this._fadeOut();this._displayed=false;if(this._resizeCheck!==null){clearInterval(this._resizeCheck);this._resizeCheck=null;}}},isVisible:function(){return this._displayed;},onShow:function(){},onHide:function(){},uninitialize:function(){this._displayed=false;if(this._resizeCheck){clearInterval(this._resizeCheck);}dojo.style(this._centerNode,"display","none");dojo.style(this._underlayNode,"display","none");if(dojo.isIE==7){dojo.body().removeChild(this._ieFixNode);delete this._ieFixNode;}if(this._anim){this._anim.stop();delete this._anim;}this.target=null;this._imageNode=null;this._textNode=null;this._centerNode=null;this.inherited(arguments);},_size:function(){if(this._displayed){var dir=dojo.attr(dojo.body(),"dir");if(dir){dir=dir.toLowerCase();}var _7c1;var _7c2=this._scrollerWidths();var _7c3=this.target;var _7c4=dojo.style(this._centerNode,"display");dojo.style(this._centerNode,"display","block");var box=dojo.position(_7c3,true);if(_7c3===dojo.body()||_7c3===dojo.doc){box=dojo.window.getBox();box.x=box.l;box.y=box.t;}var _7c5=dojo.marginBox(this._centerNode);dojo.style(this._centerNode,"display",_7c4);if(this._ieFixNode){_7c1=-this._ieFixNode.offsetTop/1000;box.x=Math.floor((box.x+0.9)/_7c1);box.y=Math.floor((box.y+0.9)/_7c1);box.w=Math.floor((box.w+0.9)/_7c1);box.h=Math.floor((box.h+0.9)/_7c1);}var zi=dojo.style(_7c3,"zIndex");var ziUl=zi;var ziIn=zi;if(this.zIndex==="auto"){if(zi!="auto"){ziUl=parseInt(ziUl,10)+1;ziIn=parseInt(ziIn,10)+2;}else{var _7c6=_7c3.parentNode;var _7c7=-100000;while(_7c6&&_7c6!==dojo.body()){zi=dojo.style(_7c6,"zIndex");if(!zi||zi==="auto"){_7c6=_7c6.parentNode;}else{var _7c8=parseInt(zi,10);if(_7c7<_7c8){_7c7=_7c8;ziUl=_7c8+1;ziIn=_7c8+2;}_7c6=_7c6.parentNode;}}}}else{ziUl=parseInt(this.zIndex,10)+1;ziIn=parseInt(this.zIndex,10)+2;}dojo.style(this._centerNode,"zIndex",ziIn);dojo.style(this._underlayNode,"zIndex",ziUl);var pn=_7c3.parentNode;if(pn&&pn!==dojo.body()&&_7c3!==dojo.body()&&_7c3!==dojo.doc){var obh=box.h;var obw=box.w;var _7c9=dojo.position(pn,true);if(this._ieFixNode){_7c1=-this._ieFixNode.offsetTop/1000;_7c9.x=Math.floor((_7c9.x+0.9)/_7c1);_7c9.y=Math.floor((_7c9.y+0.9)/_7c1);_7c9.w=Math.floor((_7c9.w+0.9)/_7c1);_7c9.h=Math.floor((_7c9.h+0.9)/_7c1);}_7c9.w-=pn.scrollHeight>pn.clientHeight&&pn.clientHeight>0?_7c2.v:0;_7c9.h-=pn.scrollWidth>pn.clientWidth&&pn.clientWidth>0?_7c2.h:0;if(dir==="rtl"){if(dojo.isOpera){box.x+=pn.scrollHeight>pn.clientHeight&&pn.clientHeight>0?_7c2.v:0;_7c9.x+=pn.scrollHeight>pn.clientHeight&&pn.clientHeight>0?_7c2.v:0;}else{if(dojo.isIE){_7c9.x+=pn.scrollHeight>pn.clientHeight&&pn.clientHeight>0?_7c2.v:0;}else{if(dojo.isWebKit){}}}}if(_7c9.w<box.w){box.w=box.w-_7c9.w;}if(_7c9.h<box.h){box.h=box.h-_7c9.h;}var _7ca=_7c9.y;var _7cb=_7c9.y+_7c9.h;var bTop=box.y;var _7cc=box.y+obh;var _7cd=_7c9.x;var _7ce=_7c9.x+_7c9.w;var _7cf=box.x;var _7d0=box.x+obw;var _7d1;if(_7cc>_7ca&&bTop<_7ca){box.y=_7c9.y;_7d1=_7ca-bTop;var _7d2=obh-_7d1;if(_7d2<_7c9.h){box.h=_7d2;}else{box.h-=2*(pn.scrollWidth>pn.clientWidth&&pn.clientWidth>0?_7c2.h:0);}}else{if(bTop<_7cb&&_7cc>_7cb){box.h=_7cb-bTop;}else{if(_7cc<=_7ca||bTop>=_7cb){box.h=0;}}}if(_7d0>_7cd&&_7cf<_7cd){box.x=_7c9.x;_7d1=_7cd-_7cf;var _7d3=obw-_7d1;if(_7d3<_7c9.w){box.w=_7d3;}else{box.w-=2*(pn.scrollHeight>pn.clientHeight&&pn.clientHeight>0?_7c2.w:0);}}else{if(_7cf<_7ce&&_7d0>_7ce){box.w=_7ce-_7cf;}else{if(_7d0<=_7cd||_7cf>=_7ce){box.w=0;}}}}if(box.h>0&&box.w>0){dojo.style(this._underlayNode,{display:"block",width:box.w+"px",height:box.h+"px",top:box.y+"px",left:box.x+"px"});var _7d4=["borderRadius","borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"];this._cloneStyles(_7d4);if(!dojo.isIE){_7d4=["MozBorderRadius","MozBorderRadiusTopleft","MozBorderRadiusTopright","MozBorderRadiusBottomleft","MozBorderRadiusBottomright","WebkitBorderRadius","WebkitBorderTopLeftRadius","WebkitBorderTopRightRadius","WebkitBorderBottomLeftRadius","WebkitBorderBottomRightRadius"];this._cloneStyles(_7d4,this);}var _7d5=(box.h/2)-(_7c5.h/2);var _7d6=(box.w/2)-(_7c5.w/2);if(box.h>=_7c5.h&&box.w>=_7c5.w){dojo.style(this._centerNode,{top:(_7d5+box.y)+"px",left:(_7d6+box.x)+"px",display:"block"});}else{dojo.style(this._centerNode,"display","none");}}else{dojo.style(this._underlayNode,"display","none");dojo.style(this._centerNode,"display","none");}if(this._resizeCheck===null){var self=this;this._resizeCheck=setInterval(function(){self._size();},100);}}},_cloneStyles:function(list){dojo.forEach(list,function(_7d7){dojo.style(this._underlayNode,_7d7,dojo.style(this.target,_7d7));},this);},_fadeIn:function(){var self=this;var _7d8=dojo.animateProperty({duration:self.duration,node:self._underlayNode,properties:{opacity:{start:0,end:0.75}}});var _7d9=dojo.animateProperty({duration:self.duration,node:self._centerNode,properties:{opacity:{start:0,end:1}},onEnd:function(){self.onShow();delete self._anim;}});this._anim=dojo.fx.combine([_7d8,_7d9]);this._anim.play();},_fadeOut:function(){var self=this;var _7da=dojo.animateProperty({duration:self.duration,node:self._underlayNode,properties:{opacity:{start:0.75,end:0}},onEnd:function(){dojo.style(this.node,{"display":"none","zIndex":"-1000"});}});var _7db=dojo.animateProperty({duration:self.duration,node:self._centerNode,properties:{opacity:{start:1,end:0}},onEnd:function(){dojo.style(this.node,{"display":"none","zIndex":"-1000"});self.onHide();self._enableOverflow();delete self._anim;}});this._anim=dojo.fx.combine([_7da,_7db]);this._anim.play();},_ignore:function(_7dc){if(_7dc){dojo.stopEvent(_7dc);}},_scrollerWidths:function(){var div=dojo.doc.createElement("div");dojo.style(div,{position:"absolute",opacity:0,overflow:"hidden",width:"50px",height:"50px",zIndex:"-100",top:"-200px",left:"-200px",padding:"0px",margin:"0px"});var iDiv=dojo.doc.createElement("div");dojo.style(iDiv,{width:"200px",height:"10px"});div.appendChild(iDiv);dojo.body().appendChild(div);var b=dojo.contentBox(div);dojo.style(div,"overflow","scroll");var a=dojo.contentBox(div);dojo.body().removeChild(div);return {v:b.w-a.w,h:b.h-a.h};},_setTextAttr:function(text){this._textNode.innerHTML=text;this.text=text;},_setColorAttr:function(c){dojo.style(this._underlayNode,"backgroundColor",c);this.color=c;},_setImageTextAttr:function(text){dojo.attr(this._imageNode,"alt",text);this.imageText=text;},_setImageAttr:function(url){dojo.attr(this._imageNode,"src",url);this.image=url;},_setCenterIndicatorAttr:function(_7dd){this.centerIndicator=_7dd;if(_7dd==="image"){this._centerNode=this._imageNode;dojo.style(this._textNode,"display","none");}else{this._centerNode=this._textNode;dojo.style(this._imageNode,"display","none");}},_disableOverflow:function(){if(this.target===dojo.body()||this.target===dojo.doc){this._overflowDisabled=true;var body=dojo.body();if(body.style&&body.style.overflow){this._oldOverflow=dojo.style(body,"overflow");}else{this._oldOverflow="";}if(dojo.isIE&&!dojo.isQuirks){if(body.parentNode&&body.parentNode.style&&body.parentNode.style.overflow){this._oldBodyParentOverflow=body.parentNode.style.overflow;}else{try{this._oldBodyParentOverflow=dojo.style(body.parentNode,"overflow");}catch(e){this._oldBodyParentOverflow="scroll";}}dojo.style(body.parentNode,"overflow","hidden");}dojo.style(body,"overflow","hidden");}},_enableOverflow:function(){if(this._overflowDisabled){delete this._overflowDisabled;var body=dojo.body();if(dojo.isIE&&!dojo.isQuirks){body.parentNode.style.overflow=this._oldBodyParentOverflow;delete this._oldBodyParentOverflow;}dojo.style(body,"overflow",this._oldOverflow);if(dojo.isWebKit){var div=dojo.create("div",{style:{height:"2px"}});body.appendChild(div);setTimeout(function(){body.removeChild(div);},0);}delete this._oldOverflow;}}});}if(!dojo._hasResource["plugins.core.Updater"]){dojo._hasResource["plugins.core.Updater"]=true;dojo.provide("plugins.core.Updater");dojo.declare("plugins.core.Updater",null,{loadedCssFiles:null,updates:null,constructor:function(){this.startup();},startup:function(){this.updates=new Object;},subscribe:function(_7de,_7df){if(_7de[_7df]==null){return;}if(this.updates[_7df]==null){this.updates[_7df]=new Array;}for(currentSubscriber in this.updates[_7df]){if(currentSubscriber==_7de){return;}}this.updates[_7df].push(_7de);},update:function(_7e0,args){console.log("core.Updater.update    subscription: "+_7e0);console.log("core.Updater.update    args: ");console.dir(args);var _7e1=this.getSubscribers(_7e0);console.log("core.Updater.update    subscribers: ");console.dir({subscribers:_7e1});for(var i in _7e1){var _7e2=_7e1[i];console.log("core.Updater.update    subscriber: ");console.dir({subscriber:_7e2});_7e2[_7e0](args);}},getSubscribers:function(_7e3){return this.updates[_7e3];},unsubscribe:function(_7e4,_7e5){if(_7e4[_7e5]==null){return;}if(this.updates[_7e5]==null){this.updates=new Array;}for(var i=0;i<this.updates[_7e5].length;i++){if(this.updates[_7e5][i]==_7e4){this.updates[_7e5].splice(i,1);break;}}}});}if(!dojo._hasResource["plugins.core.Agua.Data"]){dojo._hasResource["plugins.core.Agua.Data"]=true;dojo.provide("plugins.core.Agua.Data");dojo.declare("plugins.core.Agua.Data",[],{cloneData:function(name){var _7e6=this.cloneData.caller.nom;if(this.data[name]!=null){return dojo.clone(this.data[name]);}else{return [];}},getData:function(name){if(this.data[name]==null){this.data[name]=[];}return this.data[name];},setData:function(name,_7e7){this.data[name]=_7e7;},addData:function(name,_7e8,keys){return this._addObjectToArray(this.data[name],_7e8,keys);},removeData:function(name,_7e9,keys){return this._removeObjectFromArray(this.data[name],_7e9,keys);},removeArrayFromData:function(name,_7ea,keys){return this._removeArrayFromArray(this.data[name],_7ea,keys);},addArrayToData:function(name,_7eb,keys){return this._addArrayToArray(this.data[name],_7eb,keys);},removeObjectsFromData:function(name,_7ec,keys){console.log("Data.removeObjectsFromData    BEFORE REMOVE, this.data["+name+"]");console.dir({this_data:this.data[name]});return this._removeObjectsFromArray(this.data[name],_7ec,keys);},sortData:function(name,key){this.sortHasharray(this.getData(name),key);},loadData:function(data){Agua.data=dojo.clone(data);},});}if(!dojo._hasResource["plugins.core.Agua.Access"]){dojo._hasResource["plugins.core.Agua.Access"]=true;dojo.provide("plugins.core.Agua.Access");dojo.declare("plugins.core.Agua.Access",[],{getAccess:function(){return this.cloneData("access");}});}if(!dojo._hasResource["plugins.core.Agua.Ami"]){dojo._hasResource["plugins.core.Agua.Ami"]=true;dojo.provide("plugins.core.Agua.Ami");dojo.declare("plugins.core.Agua.Ami",[],{getAmis:function(){return this.cloneData("amis");},getAmiObjectById:function(_7ed){var amis=this.getAmis();return this._getObjectByKeyValue(amis,["amiid"],_7ed);},addAmi:function(_7ee){this._removeAmi(_7ee);this._addAmi(_7ee);var url=this.cgiUrl+"workflow.cgi?";_7ee.username=this.cookie("username");_7ee.sessionid=this.cookie("sessionid");_7ee.mode="addAmi";console.log("Agua.Ami.addAmi    amiObject: "+dojo.toJson(_7ee));this.doPut({url:url,query:_7ee,sync:false,timeout:15000});},removeAmi:function(_7ef){console.log("Agua.Ami.removeAmi    Agua.removeAmi(amiObject)");var _7f0=this._removeAmi(_7ef);if(_7f0==false){console.log("this.removeAmi    this._removeAmi(amiObject) returned false for ami: "+_7ef.ami);return;}var url=this.cgiUrl+"sharing.cgi?";_7ef.username=this.cookie("username");_7ef.sessionid=this.cookie("sessionid");_7ef.mode="removeAmi";this.doPut({url:url,query:_7ef,sync:false,timeout:15000});},_removeAmi:function(_7f1){console.log("Agua.Ami._removeAmi    plugins.core.Data._removeAmi(amiObject)");var _7f2=["amiid"];return this.removeData("amis",_7f1,_7f2);},_addAmi:function(_7f3){console.log("Agua.Ami._addAmi    plugins.core.Data._addAmi(amiObject)");var _7f4=["amiid"];return this.addData("amis",_7f3,_7f4);}});}if(!dojo._hasResource["plugins.core.Agua.App"]){dojo._hasResource["plugins.core.Agua.App"]=true;dojo.provide("plugins.core.Agua.App");dojo.declare("plugins.core.Agua.App",[],{getAppHeadings:function(){console.log("Agua.App.getAppHeadings    plugins.core.Data.getAppHeadings()");var _7f5=this.cloneData("appheadings");console.log("Agua.App.getAppHeadings    headings: "+dojo.toJson(_7f5));return _7f5;},getApps:function(){return this.cloneData("apps");},getAppTypes:function(apps){var _7f6=new Object;for(var i=0;i<apps.length;i++){_7f6[apps[i].type]=1;}var _7f7=this.hashkeysToArray(_7f6);_7f7=this.sortNoCase(_7f7);return _7f7;},getAppType:function(_7f8){console.log("Agua.App.getAppType    plugins.core.Data.getAppType(appName)");var apps=this.cloneData("apps");for(var i in apps){var app=apps[i];if(app.name.toLowerCase()==_7f8.toLowerCase()){return app.type;}}return null;},hasApps:function(){if(this.getData("apps").length==0){return false;}return true;},addApp:function(_7f9){console.log("Agua.App.addApp    plugins.core.Data.addApp(appObject)");var _7fa=this.addData("apps",_7f9,["name"]);if(_7fa==true){this.sortData("apps","name");}return _7fa;},removeApp:function(_7fb){console.log("Agua.App.removeApp    plugins.core.Data.removeApp(appObject)");var _7fc=this.removeData("apps",_7fb,["name"]);return _7fc;},isApp:function(_7fd){console.log("Agua.App.isApp    plugins.core.Data.isApp(appName, appObject)");console.log("Agua.App.isApp    appName: *"+_7fd+"*");var apps=this.getApps();for(var i in apps){var app=apps[i];console.log("Agua.App.isApp    Checking app.name: *"+app.name+"*");if(app.name.toLowerCase()==_7fd.toLowerCase()){return true;}}return false;}});}if(!dojo._hasResource["plugins.core.Agua.Aws"]){dojo._hasResource["plugins.core.Agua.Aws"]=true;dojo.provide("plugins.core.Agua.Aws");dojo.declare("plugins.core.Agua.Aws",[],{getAws:function(){return this.cloneData("aws");},setAws:function(aws){console.log("Agua.Aws.setAws    plugins.core.Data.setAws(aws)");console.log("Agua.Aws.setAws    aws: "+dojo.toJson(aws));if(aws==null){console.log("Agua.Aws.setAws    aws is null. Returning");return;}if(aws.amazonuserid==null){console.log("Agua.Aws.setAws    aws.amazonuserid is null. Returning");return;}this.setData("aws",aws);return aws;},getAvailzonesByRegion:function(_7fe){if(_7fe==null){return;}var _7ff=this.cloneData("regionzones");if(_7ff[_7fe]!=null){return _7ff[_7fe];}return [];}});}if(!dojo._hasResource["plugins.core.Agua.Cloud"]){dojo._hasResource["plugins.core.Agua.Cloud"]=true;dojo.provide("plugins.core.Agua.Cloud");dojo.declare("plugins.core.Agua.Cloud",[],{getCloudHeadings:function(){console.log("Agua.Cloud.getCloudHeadings    plugins.core.Data.getCloudHeadings()");var _800=this.cloneData("cloudheadings");console.log("Agua.Cloud.getCloudHeadings    headings: "+dojo.toJson(_800));return _800;}});}if(!dojo._hasResource["plugins.core.Agua.Cluster"]){dojo._hasResource["plugins.core.Agua.Cluster"]=true;dojo.provide("plugins.core.Agua.Cluster");dojo.declare("plugins.core.Agua.Cluster",[],{getClusterObject:function(_801){console.log("Agua.Cluster.getClusterObject    plugins.core.Data.getClusterObject(clusterName)");console.log("Agua.Cluster.getClusterObject    clusterName: "+_801);var _802=this.getClusters();console.log("Agua.Cluster.getClusterObject    clusters: "+dojo.toJson(_802));if(_802==null){return [];}var _803=["cluster"];var _804=[_801];_802=this.filterByKeyValues(_802,_803,_804);console.log("Agua.Cluster.getClusterObject    FILTERED clusters: "+dojo.toJson(_802));if(_802!=null&&_802.length!=0){return _802[0];}return null;},getClusters:function(){return this.cloneData("clusters");},getClusterByWorkflow:function(_805,_806){var _807=this.cloneData("clusterworkflows");_807=this.filterByKeyValues(_807,["project","workflow"],[_805,_806]);if(_807!=null&&_807.length>0){return _807[0].cluster;}return null;},isClusterWorkflow:function(_808){var _809=this.cloneData("clusterworkflows");_809=this.filterByKeyValues(_809,["project","workflow","cluster"],[_808.project,_808.workflow,_808.cluster]);if(_809!=null&&_809.length>0){return 1;}return 0;},getClusterObjectByWorkflow:function(_80a,_80b){var _80c=this.getClusterByWorkflow(_80a,_80b);if(_80c==null||!_80c){return null;}console.log("Agua.Cluster.getClusterObjectByWorkflow    clusterName: "+_80c);return this.getClusterObject(_80c);},getClusterLongName:function(_80d){var _80e=this.cookie("username");var _80f="";if(_80d!=null&&_80d){_80f=_80e+"-"+_80d;}return _80f;},isCluster:function(_810){var _811=this.getClusters();var _812=this._objectInArray(_811,{cluster:_810},["cluster"]);return _812;},addCluster:function(_813){console.log("Agua.Cluster.newCluster    clusterObject:");console.dir({clusterObject:_813});this._removeCluster(_813);this._addCluster(_813);var url=this.cgiUrl+"workflow.cgi?";_813.username=this.cookie("username");_813.sessionid=this.cookie("sessionid");_813.mode="addCluster";console.log("Agua.Cluster.addCluster    clusterObject: "+dojo.toJson(_813));this.doPut({url:url,query:_813,sync:false,timeout:15000,callback:null});},newCluster:function(_814){console.log("Agua.Cluster.newCluster    core.Data.newCluster(clusterObject)");console.log("Agua.Cluster.newCluster    clusterObject: "+dojo.toJson(_814));this._removeCluster(_814);this._addCluster(_814);var url=this.cgiUrl+"workflow.cgi?";_814.username=this.cookie("username");_814.sessionid=this.cookie("sessionid");_814.mode="newCluster";console.log("Agua.Cluster.newCluster    clusterObject: "+dojo.toJson(_814));this.doPut({url:url,query:_814,sync:false,timeout:15000,callback:dojo.hitch(this,"toast")});},removeCluster:function(_815){var _816=this._removeCluster(_815);if(_816==false){console.log("this.removeCluster    this._removeCluster(clusterObject) returned false for cluster: "+_815.cluster);return;}var url=this.cgiUrl+"workflow.cgi?";_815.username=this.cookie("username");_815.sessionid=this.cookie("sessionid");_815.mode="removeCluster";console.log("this.removeCluster    clusterObject: "+dojo.toJson(_815));this.doPut({url:url,query:_815,sync:false,timeout:15000});},_removeCluster:function(_817){console.log("Agua.Cluster._removeCluster    plugins.core.Data._removeCluster(clusterObject)");console.log("Agua.Cluster._removeCluster    clusterObject: "+dojo.toJson(_817));var _818=["cluster"];return this.removeData("clusters",_817,_818);},_addCluster:function(_819){console.log("Agua.Cluster._addCluster    plugins.core.Data._addCluster(clusterObject)");var _81a=["cluster"];return this.addData("clusters",_819,_81a);},_removeClusterWorkflow:function(_81b){console.log("Agua.Cluster._removeClusterWorkflow    plugins.core.Data._removeClusterWorkflow(clusterObject)");var _81c=["project","workflow"];return this.removeData("clusterworkflows",_81b,_81c);},_addClusterWorkflow:function(_81d){console.log("Agua.Cluster._addClusterWorkflow    plugins.core.Data._addClusterWorkflow(clusterObject)");console.log("Agua.Cluster._addClusterWorkflow    clusterObject: "+dojo.toJson(_81d));var _81e=["cluster","project","workflow"];return this.addData("clusterworkflows",_81d,_81e);},});}if(!dojo._hasResource["plugins.core.Agua.Feature"]){dojo._hasResource["plugins.core.Agua.Feature"]=true;dojo.provide("plugins.core.Agua.Feature");dojo.declare("plugins.core.Agua.Feature",[],{getViewFeatures:function(_81f,_820){console.log("Agua.View.getViewFeatures     plugins.core.Data.getViewFeatures(projectName, viewName)");console.log("Agua.View.getViewFeatures    projectName: "+_81f);console.log("Agua.View.getViewFeatures    viewName: "+_820);if(_81f==null||!_81f){return;}var _821=this.cloneData("viewfeatures");console.log("Agua.View.getViewFeatures    viewfeatures: ");console.dir({viewfeatures:_821});var _822=["project","view"];var _823=[_81f,_820];_821=this.filterByKeyValues(_821,_822,_823);return _821;},hasViewFeature:function(_824,_825,_826){console.log("Agua.View.hasViewFeature    projectName: "+_824);console.log("Agua.View.hasViewFeature    viewName: "+_825);console.log("Agua.View.hasViewFeature    featureName: "+_826);var _827=this.getViewFeatures(_824,_825);console.log("Agua.View.hasViewFeature    features: ");console.dir({features:_827});if(_827==null||_827==[]){return;}var _828={project:_824,view:_825,feature:_826};var keys=["project","view","feature"];return this._objectInArray(_827,_828,keys);},getFeatureProjects:function(){var _829=this.cloneData("features");var _82a=this.hashArrayKeyToArray(_829,"project");console.log("Agua.Feature.getFeatureProjects     projects: ");console.dir({projects:_82a});_82a=this.uniqueValues(_82a);return _82a;},getViewProjectWorkflows:function(_82b){if(_82b==null||!_82b){console.log("Agua.Feature.getViewProjectWorkflows     projectName is null or empty. Returning");return;}var _82c=this.cloneData("features");var _82d=["project"];var _82e=[_82b];_82c=this.filterByKeyValues(_82c,_82d,_82e);var _82f=new Array;for(var i=0;i<_82c.length;i++){_82f.push(_82c[i].workflow);}_82f=this.uniqueValues(_82f);return _82f;},getViewWorkflowFeatures:function(_830,_831){var _832=this.cloneData("features");var _833=["project","workflow"];var _834=[_830,_831];_832=this.filterByKeyValues(_832,_833,_834);return _832;},getViewSpeciesFeatureNames:function(_835,_836,_837,_838){var _839=this.getViewSpeciesFeatures(_835,_836,_837,_838);var _83a=new Array;for(var i=0;i<_839.length;i++){_83a.push(_839[i].feature);}_83a=this.uniqueValues(_83a);return _83a;},getViewSpeciesFeatures:function(_83b,_83c,_83d,_83e){if(_83b==null||!_83b||_83c==null||!_83c||_83d==null||!_83d){console.log("Agua.Feature.getViewSpeciesFeatures     projectName is null or empty. Returning");return;}var _83f=this.cloneData("features");var _840=["project","workflow","species","build"];var _841=[_83b,_83c,_83d,_83e];_83f=this.filterByKeyValues(_83f,_840,_841);return _83f;},_removeViewFeature:function(_842){var _843=["project","view","feature"];var _844=Agua.removeData("viewfeatures",_842,_843);if(!_844){return;}var _845=Agua.getViewObject(_842.project,_842.view);var _846=_845.tracklist;console.log("Agua.Feature.removeViewFeature    BEFORE tracklist: "+dojo.toJson(_846));var _847=_846.split(/,/);for(var i=0;i<_847.length;i++){if(_847[i]==_842.feature){console.log("matched feature in array["+i+"]: "+_847[i]);_847.splice(i,1);}}_846=_847.join(",");_845.tracklist=_846;console.log("Agua.Feature.removeViewFeature    AFTER tracklist: "+dojo.toJson(_846));Agua.removeData("views",_845,["project","view"]);Agua.addData("views",_845,["project","view"]);views=Agua.getData("views");console.dir({views:views});return true;},isFeature:function(_848){var _849=this.getViewFeatures(_848.project,_848.view);if(this._objectInArray(_849,_848,["project","view","feature","species","build"])){return true;}return false;},_addViewFeature:function(_84a){if(this.isFeature(_84a)){return;}var _84b=["project","view","feature","species","build"];return this.addData("viewfeatures",_84a,_84b);}});}if(!dojo._hasResource["plugins.core.Agua.File"]){dojo._hasResource["plugins.core.Agua.File"]=true;dojo.provide("plugins.core.Agua.File");dojo.declare("plugins.core.Agua.File",[],{getFoldersUrl:function(){return Agua.cgiUrl+"folders.cgi?";},setFileCaches:function(url){console.log("Agua.File.setFileCache    url: "+url);var _84c=dojo.hitch(this,function(data){this.setData("filecaches",data);});this.fetchJson(url,_84c);},fetchJson:function(url,_84d){console.log("Agua.File.fetchJson    url: "+url);var _84e=this;dojo.xhrGet({url:url,sync:false,handleAs:"json",handle:function(data){_84d(data);},error:function(_84f){console.log("Agua.File.fetchJson    Error with JSON Post, response: "+_84f);}});},getFileCache:function(_850,_851){console.log("Agua.File.getFileCache    username: "+_850);console.log("Agua.File.getFileCache    location: "+_851);var _852=this.cloneData("filecaches");console.log("Agua.File.getFileCache    fileCaches: ");console.dir({fileCaches:_852});if(!_852[_850]){return null;}return _852[_850][_851];},setFileCache:function(_853,_854,item){console.log("Agua.File.setFileCache    username: "+_853);console.log("Agua.File.setFileCache    location: "+_854);console.log("Agua.File.setFileCache    item: ");console.dir({item:item});var _855=this.getData("filecaches");if(!_855){_855={};}if(!_855[_853]){_855[_853]={};}_855[_853][_854]=item;var _856=this.getParentDir(_854);console.log("Agua.File.setFileCache    parentDir: "+_856);if(!_856){return;}var _857=_855[_853][_856];if(!_857){return;}console.log("Agua.File.setFileCache    parent: "+_857);this.addItemToParent(_857,item);console.log("Agua.File.setFileCache    parent: "+_857);console.dir({parent:_857});},addItemToParent:function(_858,item){_858.items.push(item);},getFileSystem:function(_859,_85a,_85b){console.log("Agua.File.getFileSystem    caller: "+this.getFileSystem.caller.nom);console.log("Agua.File.getFileSystem    putData:");console.dir({putData:_859});console.log("Agua.File.getFileSystem    callback: "+_85a);console.dir({callback:_85a});console.log("Agua.File.getFileSystem    request:");console.dir({request:_85b});if(!_85b){_85b=new Array;}var _85c="";if(_859.location||_859.query){_85c=_859.query||_859.location;}console.log("Agua.File.getFileSystem    location: "+_85c);var _85d=_859.username;console.log("Agua.File.getFileSystem    username: "+_85d);var _85e=this.getFileCache(_85d,_85c);console.log("Agua.File.getFileSystem    fileCache:");console.dir({fileCache:_85e});if(_85e){console.log("Agua.File.getFileSystem    fileCache IS DEFINED. Doing setTimeout callback(fileCache, request)");setTimeout(function(){_85a(_85e,_85b);},10,this);return;}else{console.log("Agua.File.getFileSystem    fileCache NOT DEFINED. Doing remote query");this.queryFileSystem(_859,_85a,_85b);}},queryFileSystem:function(_85f,_860,_861){console.log("Agua.File.queryFileSystem    putData:");console.dir({putData:_85f});console.log("Agua.File.queryFileSystem    callback:");console.dir({callback:_860});console.log("Agua.File.queryFileSystem    request:");console.dir({request:_861});var _862="";if(_85f.location||_85f.query){_862=_85f.query;}if(!_85f.path&&_862){_85f.path=_862;}console.log("Agua.File.queryFileSystem    location: "+_862);var _863=_85f.username;var url=this.cgiUrl+"folders.cgi";var _864=this;var _865={url:url,contentType:"text",sync:false,preventCache:true,handleAs:"json-comment-optional",putData:dojo.toJson(_85f),handle:function(_866){console.log("Agua.File.queryFileSystem    handle response:");console.dir({response:_866});_864.setFileCache(_863,_862,dojo.clone(_866));_860(_866,_861);}};var _867=dojo.xhrPut(_865);_867.addCallback(_860);var _868=_861.scope||dojo.global;_867.addErrback(function(_869){if(_861.onError){_861.onError.call(_868,_869,_861);}});},removeFileTree:function(_86a,_86b){console.log("Agua.File.removeFileTree    username: "+_86a);console.log("Agua.File.removeFileTree    location: "+_86b);var _86c=this.getData("filecaches");console.log("Agua.File.removeFileTree    fileCaches: ");console.dir({fileCaches:_86c});if(!_86c){console.log("Agua.File.removeFileTree    fileCaches is null. Returning");return;}var _86d=_86c[_86a];console.log("Agua.File.removeFileTree    rootTree: ");console.dir({rootTree:_86d});if(!_86d){console.log("Agua.File.removeFileTree    rootTree is null. Returning");return;}for(var _86e in _86c[_86a]){if(_86e.match("^"+_86b+"$")||_86e.match("^"+_86b+"/")){console.log("Agua.File.removeFileTree    DELETING fileRoot: "+_86e);}}if(!_86b.match(/^(.+)\/[^\/]+$/)){console.log("Agua.File.removeFileTree    No parentDir. Returning");return;}var _86f=_86b.match(/^(.+)\/[^\/]+$/)[1];var _870=_86b.match(/^.+\/([^\/]+)$/)[1];console.log("Agua.File.removeFileTree    parentDir: "+_86f);console.log("Agua.File.removeFileTree    child: "+_870);this.removeItemFromParent(_86c[_86a][_86f],_870);var _871=_86c[_86a][_86f];console.log("Agua.File.removeFileTree    project1: "+_871);console.dir({project1:_871});console.log("Agua.File.removeFileTree    END");},removeItemFromParent:function(_872,_873){for(i=0;i<_872.items.length;i++){var _874=_872.items[i];if(_874.name==_873){_872.items.splice(i,1);break;}}},removeRemoteFile:function(_875,_876,_877){console.log("Agua.File.removeRemoteFile    username: "+_875);console.log("Agua.File.removeRemoteFile    location: "+_876);console.log("Agua.File.removeRemoteFile    callback: "+_877);var url=this.getFoldersUrl();var _878=new Object;_878.mode="removeFile";_878.sessionid=Agua.cookie("sessionid");_878.username=Agua.cookie("username");_878.file=_876;var _879=this;dojo.xhrPut({url:url,putData:dojo.toJson(_878),handleAs:"json",sync:false,handle:function(_87a){if(_877){_877(_87a);}}});},renameFileTree:function(_87b,_87c,_87d){console.log("Agua.File.renameFileTree    username: "+_87b);console.log("Agua.File.renameFileTree    oldLocation: "+_87c);console.log("Agua.File.renameFileTree    newLocation: "+_87d);var _87e=this.getData("filecaches");console.log("Agua.File.renameFileTree    fileCaches: ");console.dir({fileCaches:_87e});if(!_87e){console.log("Agua.File.renameFileTree    fileCaches is null. Returning");return;}var _87f=_87e[_87b];console.log("Agua.File.renameFileTree    rootTree: ");console.dir({rootTree:_87f});if(!_87f){console.log("Agua.File.renameFileTree    rootTree is null. Returning");return;}for(var _880 in _87e[_87b]){if(_880.match("^"+_87c+"$")||_880.match("^"+_87c+"/")){console.log("Agua.File.renameFileTree    DELETING fileRoot: "+_880);var _881=_87e[_87b][_880];var re=new RegExp("^"+_87c);var _882=_880.replace(re,_87d);console.log("Agua.File.renameFileTree    ADDING newRoot: "+_882);delete _87e[_87b][_880];_87e[_87b][_882]=_881;}}var _883=this.getParentDir(_87c);if(!_883){return;}console.log("Agua.File.renameFileTree    Doing this.renameItemInParent()");var _884=this.getChild(_87c);var _885=_87d.match(/^.+\/([^\/]+)$/)[1];console.log("Agua.File.renameFileTree    parentDir: "+_883);console.log("Agua.File.renameFileTree    child: "+_884);console.log("Agua.File.renameFileTree    newChild: "+_885);var _886=_87e[_87b][_883];this.renameItemInParent(_886,_884,_885);console.log("Agua.File.renameFileTree    parent: "+_886);console.dir({parent:_886});console.log("Agua.File.renameFileTree    END");},renameItemInParent:function(_887,_888,_889){for(i=0;i<_887.items.length;i++){var _88a=_887.items[i];if(_88a.name==_888){var re=new RegExp(_888+"$");_887.items[i].name=_887.items[i].name.replace(re,_889);console.log("Agua.File.renameItemInParent    NEW parent.items["+i+"].name: "+_887.items[i].name);_887.items[i].path=_887.items[i].path.replace(re,_889);console.log("Agua.File.repathItemInParent    NEW parent.items["+i+"].path: "+_887.items[i].path);break;}}},getParentDir:function(_88b){if(!_88b.match(/^(.+)\/[^\/]+$/)){return null;}return _88b.match(/^(.+)\/[^\/]+$/)[1];},getChild:function(_88c){if(!_88c.match(/^.+\/([^\/]+)$/)){return null;}return _88c.match(/^.+\/([^\/]+)$/)[1];},isDirectory:function(_88d,_88e){var _88f=this.getFileCache(_88d,_88e);console.log("Agua.File.isDirectory    username: "+_88d);console.log("Agua.File.isDirectory    location: "+_88e);console.log("Agua.File.isDirectory    fileCache: ");console.dir({fileCache:_88f});if(_88f){return _88f.directory;}return null;},isFileCacheItem:function(_890,_891,_892){console.log("Agua.isFileCacheItem     username: "+_890);console.log("Agua.isFileCacheItem     directory: "+_891);console.log("Agua.isFileCacheItem     itemName: "+_892);var _893=this.getFileCache(_890,_891);console.log("Agua.isFileCacheItem     fileCache: "+_893);console.dir({fileCache:_893});if(!_893||!_893.items){return false;}for(var i=0;i<_893.items.length;i++){if(_893.items[i].name==_892){return true;}}return false;},renameFile:function(_894,_895){var url=this.getFoldersUrl();var _896=new Object;_896.mode="renameFile";_896.sessionid=Agua.cookie("sessionid");_896.username=Agua.cookie("username");_896.oldpath=_894;_896.newpath=_895;this.doPut({url:url,query:_896,sync:false});},createFolder:function(_897){var url=this.getFoldersUrl();var _898=new Object;_898.mode="newFolder";_898.sessionid=Agua.cookie("sessionid");_898.username=Agua.cookie("username");_898.folderpath=_897;this.doPut({url:url,query:_898,sync:false});},getFileInfo:function(_899,_89a){if(_89a!=null){console.log("Agua.File.getFileInfo    fileinfo parameter is present. Should you be using setFileInfo instead?. Returning null.");return null;}return this._fileInfo(_899,_89a);},setFileInfo:function(_89b,_89c){if(!_89b){return;}if(_89c==null){console.log("Agua.File.setFileInfo    fileinfo is null. Returning null.");return null;}return this._fileInfo(_89b,_89c);},_fileInfo:function(_89d,_89e){console.log("Agua.File._fileInfo    plugins.core.Data._fileInfo()");console.log("Agua.File._fileInfo    stageParameterObject: ");console.dir({stageParameterObject:_89d});console.log("Agua.File._fileInfo    fileinfo: ");console.dir({fileinfo:_89e});var _89f=["username","project","workflow","appname","appnumber","name","paramtype"];var _8a0=new Array;for(var i=0;i<_89f.length;i++){_8a0.push(_89d[_89f[i]]);}var _8a1=this.getEntry(this.cloneData("stageparameters"),_89f,_8a0);console.log("Agua.File._fileInfo    stageParameter found: ");console.dir({stageParameter:_8a1});if(_8a1==null){console.log("Agua.File._fileInfo    stageParameter is null. Returning null");return null;}if(_89e==null){console.log("Agua.File._fileInfo    DOING the GETTER. Returning stageParameter.exists: "+_8a1.fileinfo.exists);return _8a1.fileinfo.exists;}console.log("Agua.File._fileInfo    DOING the SETTER");_8a1.fileinfo=_89e;var _8a2=this._removeStageParameter(_8a1);if(_8a2==false){console.log("Agua.File._fileInfo    Could not remove stage parameter. Returning null");return null;}console.log("Agua.File._fileInfo    \tBEFORE success = this._addStageParameter(stageParameter)");_8a2=this._addStageParameter(_8a1);if(_8a2==false){console.log("Agua.File._fileInfo    Could not add stage parameter. Returning null");return null;}return true;},getParameterValidity:function(_8a3,_8a4){if(_8a4!=null){return null;}var _8a5=this._parameterValidity(_8a3,_8a4);return _8a5;},setParameterValidity:function(_8a6,_8a7){if(_8a7==null){return null;}var _8a8=this._parameterValidity(_8a6,_8a7);return _8a8;},_parameterValidity:function(_8a9,_8aa){var _8ab=["project","workflow","appname","appnumber","name","paramtype"];var _8ac=new Array;for(var i=0;i<_8ab.length;i++){_8ac.push(_8a9[_8ab[i]]);}var _8ad=this.getEntry(this._getStageParameters(),_8ab,_8ac);if(_8ad==null){return null;}if(_8aa==null){return _8ad.isValid;}_8ad.isValid=_8aa;var _8ae=this._removeStageParameter(_8ad);if(_8ae==false){return null;}_8ae=this._addStageParameter(_8ad);if(_8ae==false){return null;}return true;}});}if(!dojo._hasResource["plugins.core.Agua.Group"]){dojo._hasResource["plugins.core.Agua.Group"]=true;dojo.provide("plugins.core.Agua.Group");dojo.declare("plugins.core.Agua.Group",[],{getGroups:function(){console.log("Agua.Group.getGroups    plugins.core.Data.getGroups()");return this.cloneData("groups");},addGroup:function(_8af){console.log("Agua.Group.addGroup    plugins.core.Data.addGroup(groupObject)");console.log("Agua.Group.addGroup    groupObject: "+dojo.toJson(_8af));this.removeData("groups",_8af,["groupname"]);if(!this.addData("groups",_8af,["groupname"])){return;}this.sortData("groups","groupname");_8af.groupname=this.jsonSafe(_8af.groupname,"toJson");_8af.description=this.jsonSafe(_8af.description,"toJson");_8af.notes=this.jsonSafe(_8af.notes,"toJson");var url=Agua.cgiUrl+"sharing.cgi?";var _8b0=new Object;_8b0.username=this.cookie("username");_8b0.sessionid=this.cookie("sessionid");_8b0.mode="addGroup";_8b0.data=_8af;this.doPut({url:url,query:_8b0});if(Agua.isAccess(_8af)){return;}var _8b1=new Object;_8b1.groupname=_8af.groupname;_8b1.owner=this.cookie("username");_8b1.groupwrite=0;_8b1.groupcopy=1;_8b1.groupview=1;_8b1.worldwrite=0;_8b1.worldcopy=0;_8b1.worldview=0;console.log("Agua.Group.addGroup    Adding accessObject: "+dojo.toJson(_8b1));this.addData("access",_8b1,["groupname"]);this.sortData("access","groupname");},removeGroup:function(_8b2){console.log("Agua.Group.removeGroup    plugins.core.Data.removeGroup(groupObject)");console.log("Agua.Group.removeGroup    groupObject: "+dojo.toJson(_8b2));if(!this._removeGroup(_8b2)){return;}this.sortData("groups","groupname");this._removeAccess(_8b2);this._removeGroupMembers(_8b2);var url=Agua.cgiUrl+"sharing.cgi?";var _8b3=new Object;_8b3.username=this.cookie("username");_8b3.sessionid=this.cookie("sessionid");_8b3.mode="removeGroup";_8b3.data=_8b2;this.doPut({url:url,query:_8b3,sync:false});},_removeGroup:function(_8b4){return this.removeData("groups",_8b4,["groupname"]);},_removeGroupMembers:function(_8b5){console.log("Agua.Group._removeGroupMembers    plugins.core.Data._removeGroupMembers(groupObject)");console.log("Agua.Group._removeGroupMembers    groupObject: "+dojo.toJson(_8b5));return this._removeObjectsFromData("groupmembers",_8b5,["groupname"]);},_removeAccess:function(_8b6){this.removeData("access",_8b6,["groupname"]);},isAccess:function(_8b7){var _8b8=this.cloneData(_8b8);return this._objectInArray(_8b8,_8b7,["groupname"]);},isGroup:function(_8b9){console.log("Agua.Group.isGroup    plugins.core.Data.isGroup(groupObject, groupObject)");console.log("Agua.Group.isGroup    groupObject: "+dojo.toJson(_8b9));var _8ba=this.getGroups();if(this._getIndexInArray(_8ba,_8b9,["groupname"])){return true;}return false;},getGroupNames:function(){console.log("Agua.Group.getGroupNames    plugins.core.Data.getGroupNames()");var _8bb=this.getGroups();var _8bc=new Array;var _8bb=this.getGroups();for(var i in _8bb){_8bc.push(_8bb[i].groupname);}return _8bc;},getGroupMembers:function(_8bd){var _8be=this.cloneData("groupmembers");var _8bf=["type"];var _8c0=[_8bd];return this.filterByKeyValues(_8be,_8bf,_8c0);},getGroupMembersHash:function(_8c1){console.log("Agua.Group.getGroupMembersHash    plugins.core.Data.getGroupMembersHash(memberType)");console.log("Agua.Group.getGroupMembersHash    memberType"+_8c1);var _8c2=this.cloneData("groupmembers");for(var _8c3 in _8c2){for(var j=0;j<_8c2[_8c3].length;j++){if(_8c2[_8c3][j].type!=_8c1){_8c2[_8c3].splice(j,1);j--;}}}return _8c2;},getGroupSources:function(){return this.getGroupMembers("source");},getGroupUsers:function(){return this.getGroupMembers("user");},getGroupProjects:function(){return this.getGroupMembers("project");}});}if(!dojo._hasResource["plugins.core.Agua.Hub"]){dojo._hasResource["plugins.core.Agua.Hub"]=true;dojo.provide("plugins.core.Agua.Hub");dojo.declare("plugins.core.Agua.Hub",[],{getHub:function(){return this.cloneData("hub");},setHub:function(hub){console.log("Agua.Hub.setHub    plugins.core.Data.setHub(hub)");console.log("Agua.Hub.setHub    hub: "+dojo.toJson(hub));if(hub==null){console.log("Agua.Hub.setHub    hub is null. Returning");return;}if(hub.login==null){console.log("Agua.Hub.setHub    hub.login is null. Returning");return;}this.setData("hub",hub);return hub;},setHubCertificate:function(_8c4){console.log("Agua.Hub.setHubCertificate    publiccert: "+_8c4);if(!_8c4){console.log("Agua.Hub.setHubCertificate    publiccert is null. Returning");return;}var hub=this.getData("hub");console.log("Agua.Hub.setHubCertificate    hub: ");console.dir({hub:hub});if(!hub){console.log("Agua.Hub.setHubCertificate    hub is null. Returning");return;}if(!hub.login){console.log("Agua.Hub.setHubCertificate    hub.login is null. Returning");return;}hub.publiccert=_8c4;this.setData("hub",hub);return hub;}});}if(!dojo._hasResource["plugins.core.Agua.Package"]){dojo._hasResource["plugins.core.Agua.Package"]=true;dojo.provide("plugins.core.Agua.Package");dojo.declare("plugins.core.Agua.Package",[],{getPackages:function(){console.log("Agua.Package.getPackages    plugins.core.Data.getPackages()");return this.cloneData("packages");},getPackageTypes:function(_8c5){var _8c6=new Object;for(var i=0;i<_8c5.length;i++){_8c6[_8c5[i].type]=1;}var _8c7=this.hashkeysToArray(_8c6);_8c7=this.sortNoCase(_8c7);return _8c7;},getPackageType:function(_8c8){console.log("Agua.Package.getPackageType    plugins.core.Data.getPackageType(packageName)");var _8c9=this.cloneData("packages");for(var i in _8c9){var _8ca=_8c9[i];if(_8ca["package"].toLowerCase()==_8c8.toLowerCase()){return _8ca.type;}}return null;},hasPackages:function(){if(this.getData("packages").length==0){return false;}return true;},addPackage:function(_8cb){var _8cc=this.getData("packages");var _8cd=this.addData("packages",_8cb,["package","owner","installdir"]);if(_8cd==true){this.sortData("packages","package");}_8cc=this.getData("packages");return _8cd;},removePackage:function(_8ce){var _8cf=this.getData("packages");var _8d0=this.removeData("packages",_8ce,["package","owner","installdir"]);_8cf=this.getData("packages");return _8d0;},isPackage:function(_8d1){console.log("Agua.Package.isPackage    packageName: *"+_8d1+"*");var _8d2=this.getPackages();for(var i in _8d2){var _8d3=_8d2[i];console.log("Agua.Package.isPackage    Checking package.package: *"+_8d3["package"]+"*");if(_8d3["package"].toLowerCase()==_8d1.toLowerCase()){return true;}}return false;}});}if(!dojo._hasResource["plugins.core.Agua.Parameter"]){dojo._hasResource["plugins.core.Agua.Parameter"]=true;dojo.provide("plugins.core.Agua.Parameter");dojo.declare("plugins.core.Agua.Parameter",[],{addParameter:function(_8d4){console.log("Agua.Parameter.addParameter    plugins.core.Data.addParameter(parameterObject)");var _8d5=this.removeData("parameters",_8d4,["appname","name","paramtype"]);var _8d6=["appname","name","paramtype"];return _8d5=this.addData("parameters",_8d4,_8d6);},removeParameter:function(_8d7){console.log("Agua.Parameter.removeParameter    plugins.core.Data.removeParameter(parameterObject)");console.log("Agua.Parameter.removeParameter    parameterObject: "+dojo.toJson(_8d7));if(!this._removeParameter(_8d7)){return false;}var url=Agua.cgiUrl+"workflow.cgi";var _8d8=new Object;_8d8.username=this.cookie("username");_8d8.sessionid=this.cookie("sessionid");_8d8.mode="deleteParameter";_8d8.data=_8d7;this.doPut({url:url,query:_8d8});return true;},_removeParameter:function(_8d9){return this.removeData("parameters",_8d9,["appname","name","paramtype"]);},isParameter:function(_8da,_8db){console.log("Agua.Parameter.isParameter    plugins.core.Data.isParameter(parameterName, parameterObject)");console.log("Agua.Parameter.isParameter    parameterName: *"+_8db+"*");var _8dc=getParametersByAppname(_8da);if(_8dc==null){return false;}for(var i in _8dc){if(_8dc[i].name.toLowerCase()==_8db.toLowerCase()){return true;}}return false;},getParametersByAppname:function(_8dd){if(_8dd==null){return null;}var _8de=new Array;var _8df=this.cloneData("parameters");for(var i=0;i<_8df.length;i++){var _8e0=_8df[i];if(_8e0.appname==_8dd){_8de.push(_8e0);}}return _8de;},getParameter:function(_8e1,_8e2){if(_8e1==null){return null;}if(_8e2==null){return null;}var _8e3=getParametersByAppname(_8e1);if(_8e3==null){return false;}for(var i in _8e3){if(_8e3[i].name.toLowerCase()==_8e2.toLowerCase()){return _8e3[i];}}return null;}});}if(!dojo._hasResource["plugins.core.Agua.Project"]){dojo._hasResource["plugins.core.Agua.Project"]=true;dojo.provide("plugins.core.Agua.Project");dojo.declare("plugins.core.Agua.Project",[],{getProjects:function(){var _8e4=this.cloneData("projects");return this.sortHasharray(_8e4,"name");},getProjectNames:function(_8e5){console.log("Agua.Project.getProjectNames    plugins.core.Data.getProjectNames()");if(_8e5==null){_8e5=this.getProjects();}return this.hashArrayKeyToArray(_8e5,"name");},addProject:function(_8e6){console.log("Agua.Project.addProject    plugins.core.Data.addProject(projectName)");console.log("Agua.Project.addProject    projectObject: "+dojo.toJson(_8e6));_8e6.description=_8e6.description||"";_8e6.notes=_8e6.notes||"";console.log("Agua.Project.addProject    this.addingProject: "+this.addingProject);if(this.addingProject==true){return;}this.addingProject==true;this.removeData("projects",_8e6,["name"]);if(!this.addData("projects",_8e6,["name"])){console.log("Agua.Project.addProject    Could not add project to projects: "+projectName);this.addingProject==false;return;}this.sortData("projects","name");this.addingProject==false;var url=Agua.cgiUrl+"workflow.cgi";var _8e7=dojo.clone(_8e6);_8e7.username=this.cookie("username");_8e7.sessionid=this.cookie("sessionid");_8e7.mode="addProject";console.log("Agua.Project.addProject    query: "+dojo.toJson(_8e7,true));this.doPut({url:url,query:_8e7,sync:false});},copyProject:function(_8e8,_8e9,_8ea,_8eb,_8ec){console.log("Agua.Project.copyProject    plugins.folders.Agua.copyProject(sourceUser, sourceProject, sourceProject, targetUser, targetProject, targetProject)");console.log("Agua.Project.copyProject    sourceUser: "+_8e8);console.log("Agua.Project.copyProject    sourceProject: "+_8e9);console.log("Agua.Project.copyProject    targetUser: "+_8ea);console.log("Agua.Project.copyProject    targetProject: "+_8eb);console.log("Agua.Project.copyProject    copyFiles: "+_8ec);if(this.isProject(_8eb)==true){console.log("Agua.Project.copyProject    Project '"+_8eb+"' already exists. Returning.");return;}var _8ed=this.getSharedProjectsByUsername(_8e8);console.log("Agua.Project.copyProject    projects: "+dojo.toJson(_8ed));_8ed=this.filterByKeyValues(_8ed,["project"],[_8e9]);if(!_8ed||_8ed.length==0){console.log("Agua.Project.copyProject    Returning becacuse  projects is null or empty: "+dojo.toJson(_8ed));}var _8ee=_8ed[0];var date=this.currentMysqlDate();_8ee=this.setProvenance(_8ee,date);_8ee.name=_8eb;_8ee.project=_8eb;_8ee.username=_8ea;console.dir({projectObject:_8ee});var keys=["name"];var _8ef=this.addData("projects",_8ee,keys);if(_8ef==false){console.log("Agua.Project.copyProject    Could not copy project "+_8ee.name+" to projects");return;}var _8f0=this.getSharedWorkflowsByProject(_8e8,_8e9);for(var i=0;i<_8f0.length;i++){var _8f1=_8f0[i].name;console.log("Agua.Project.copyProject    workflows["+i+"]: "+dojo.toJson(_8f0[i]));this._copyWorkflow(_8f0[i],_8ea,_8eb,_8f1,date);}var url=Agua.cgiUrl+"workflow.cgi";var _8f2=new Object;_8f2.sourceuser=_8e8;_8f2.targetuser=_8ea;_8f2.sourceproject=_8e9;_8f2.targetproject=_8eb;_8f2.copyfiles=_8ec;_8f2.date=date;_8f2.provenance=_8ee.provenance;_8f2.username=this.cookie("username");_8f2.sessionid=this.cookie("sessionid");_8f2.mode="copyProject";console.log("Agua.Project.copyProject    query: "+dojo.toJson(_8f2,true));this.doPut({url:url,query:_8f2,sync:false});},removeProject:function(_8f3){console.log("Agua.Project.removeProject    plugins.core.Data.removeProject(projectObject)");console.log("Agua.Project.removeProject    projectObject: "+dojo.toJson(_8f3));_8f3.project=_8f3.name;_8f3.owner=this.cookie("username");_8f3.type="project";var _8f4=this.removeData("projects",_8f3,["name"]);if(_8f4==true){console.log("Agua.Project.removeProject    Removed project from projects: "+_8f3.name);}else{console.log("Agua.Project.removeProject    Could not remove project from projects: "+_8f3.name);}this.removeData("workflows",_8f3,["project"]);var keys=["owner","name","type"];this.removeData("groupmembers",_8f3,keys);var keys=["project"];this.removeData("stages",_8f3,keys);var keys=["project"];this.removeData("stageparameters",_8f3,keys);var url=Agua.cgiUrl+"workflow.cgi";var _8f5=_8f3;_8f5.username=this.cookie("username");_8f5.sessionid=this.cookie("sessionid");_8f5.mode="removeProject";console.log("Agua.Project.removeProject    query: "+dojo.toJson(_8f5,true));this.doPut({url:url,query:_8f5,sync:false});},isProject:function(_8f6){var _8f7=this.getProjects();for(var i in _8f7){var _8f8=_8f7[i];if(_8f8.name.toLowerCase()==_8f6.toLowerCase()){return true;}}return false;},isGroupProject:function(_8f9,_8fa){console.log("Agua.Project.isGroupProject    plugins.core.Data.isGroupProject(groupName, projectObject)");console.log("Agua.Project.isGroupProject    groupName: "+_8f9);console.log("Agua.Project.isGroupProject    projectObject: "+dojo.toJson(_8fa));var _8fb=this.getGroupProjects();if(_8fb==null){return false;}_8fb=this.filterByKeyValues(_8fb,["groupname"],[_8f9]);return this._objectInArray(_8fb,_8fa,["groupname","name"]);},addProjectToGroup:function(_8fc,_8fd){console.log("Agua.Project.addProjectToGroup    caller: "+this.addProjectToGroup.caller.nom);console.log("Agua.Project.addProjectToGroup    groupName: "+_8fc);console.log("Agua.Project.addProjectToGroup    projectObject: "+dojo.toJson(_8fd));if(this.isGroupProject(_8fc,_8fd)==true){console.log("Agua.Project.addProjectToGroup     project already exists in projects: "+_8fd.name+". Returning.");return false;}_8fd.owner=_8fd.username;_8fd.groupname=_8fc;_8fd.type="project";var _8fe=this.getGroups();console.log("Agua.Project.addProjectToGroup    groups: "+dojo.toJson(_8fe));var _8ff=this._getObjectByKeyValue(_8fe,"groupname",_8fc);if(_8ff==null){return false;}console.log("Agua.Project.addProjectToGroup    group: "+dojo.toJson(_8ff));_8fd.groupdesc=_8ff.description;console.log("Agua.Project.addProjectToGroup    New projectObject: "+dojo.toJson(_8fd));var _900=["owner","groupname","name","type"];return this.addData("groupmembers",_8fd,_900);},removeProjectFromGroup:function(_901,_902){console.log("Agua.Project.removeProjectFromGroup     caller: "+this.removeProjectFromGroup.caller.nom);console.log("Agua.Project.removeProjectFromGroup     groupName: "+_901);console.log("Agua.Project.removeProjectFromGroup     projectObject: "+dojo.toJson(_902));_902.owner=_902.username;_902.groupname=_901;_902.type="project";var _903=this.getGroups();console.log("Agua.Project.removeProjectFromGroup    groups: "+dojo.toJson(_903));var _904=this._getObjectByKeyValue(_903,"groupname",_901);if(_904==null){return false;}console.log("Agua.Project.removeProjectFromGroup    group: "+dojo.toJson(_904));_902.groupdesc=_904.description;var _905=["owner","groupname","name","type"];return this.removeData("groupmembers",_902,_905);},getProjectsByGroup:function(_906){var _907=this.getGroupProjects();if(_907==null){return null;}var _908=["groupname"];var _909=[_906];var _90a=this.filterByKeyValues(_907,_908,_909);return this.sortHasharray(_90a,"name");},getGroupsByProject:function(_90b){var _90c=this.getGroupProjects();if(_90c==null){return null;}var _90d=["type","name"];var _90e=["project",_90b];return this.filterByKeyValues(_90c,_90d,_90e);}});}if(!dojo._hasResource["plugins.core.Agua.Report"]){dojo._hasResource["plugins.core.Agua.Report"]=true;dojo.provide("plugins.core.Agua.Report");dojo.declare("plugins.core.Agua.Report",[],{getReports:function(){console.log("Agua.Report.getReports    plugins.core.Data.getReports()");var _90f=this.getStages();if(_90f==null){return;}var keys=["type"];var _910=["report"];var _911=this.filterByKeyValues(_90f,keys,_910);return _911;},getReportsByWorkflow:function(_912,_913){var _914=this.getReports();if(_914==null){return null;}var _915=["project","workflow"];var _916=[_912,_913];return this.filterByKeyValues(_914,_915,_916);},removeReport:function(_917){console.log("Agua.Report.removeReport    plugins.core.Data.removeReport(reportObject)");console.log("Agua.Report.removeReport    reportObject: "+dojo.toJson(_917));var _918=["project","workflow","name"];var _919=this.removeData("reports",_917,_918);if(_919==true){console.log("Agua.Report.removeReport    Removed report from this.reports: "+_917.name);}else{console.log("Agua.Report.removeReport    Could not remove report from this.reports: "+_917.name);}var _91a=this.getGroupsByReport(_917.name);console.log("Agua.Report.removeReport    groupNames: "+dojo.toJson(_91a));for(var i=0;i<_91a.length;i++){if(this.removeReportFromGroup(_91a[i],_917)==false){_919=false;}}return _919;},isReport:function(_91b){console.log("Agua.Report.isReport    plugins.core.Data.isReport(reportName)");console.log("Agua.Report.isReport    reportName: *"+_91b+"*");var _91c=this.getReports();for(var i in _91c){var _91d=_91c[i];if(_91d.name.toLowerCase()==_91b.toLowerCase()){console.log("Agua.Report.isReport    report.name is a report: *"+_91d.name+"*");return true;}}return false;},addReport:function(_91e){console.log("Agua.Report.addReport+     plugins.core.Data.addReport(projectName)");console.log("Agua.Report.addReport    reportObject: "+dojo.toJson(_91e));var _91f=["project","workflow","name"];var _920=this.addData("reports",_91e,_91f);if(_920==true){console.log("Agua.Report.addReport    Added report to this.reports["+_91e.name);}else{console.log("Agua.Report.addReport    Could not add report to this.reports["+_91e.name);}return _920;}});}if(!dojo._hasResource["plugins.core.Agua.Shared"]){dojo._hasResource["plugins.core.Agua.Shared"]=true;dojo.provide("plugins.core.Agua.Shared");dojo.declare("plugins.core.Agua.Shared",[],{getSharedSources:function(){return this.cloneData("sharedsources");},getSharedSourcesByUsername:function(_921){var _922=this.cloneData("sharedsources");if(!_922||!_922[_921]){return [];}else{return _922[_921];}},getSharedUsernames:function(){console.log("Agua.Shared.getSharedUsernames    plugins.core.Data.getSharedUsernames()");var _923=this.getSharedProjects();var _924=new Array;for(var name in _923){_924.push(name);}_924=_924.sort();console.log("Agua.Shared.getSharedUsernames    usernames: "+dojo.toJson(_924));return _924;},getSharedProjects:function(){console.log("Agua.Shared.getSharedProjects    plugins.core.Data.getSharedProjects()");var _925=this.cloneData("sharedprojects");console.log("Agua.Shared.getSharedProjects    sharedProjects: ");console.dir({sharedProjects:_925});return _925;},getSharedProjectsByUsername:function(_926){var _927=this.cloneData("sharedprojects");if(!_927||!_927[_926]){return [];}else{return _927[_926];}},getSharedStagesByUsername:function(_928){var _929=this.cloneData("sharedstages");if(_929==null||_929[_928]==null){return [];}else{return _929[_928];}},getSharedWorkflowsByProject:function(_92a,_92b){console.log("Agua.Shared.getSharedWorkflowsByProject    plugins.core.Data.getSharedWorkflowsByProject(username, project)");console.log("Agua.Shared.getSharedWorkflowsByProject    username: "+_92a);console.log("Agua.Shared.getSharedWorkflowsByProject    project: "+_92b);var _92c=this.cloneData("sharedworkflows")||[];_92c=_92c[_92a]||[];console.dir({sharedWorkflows:_92c});_92c=this.filterByKeyValues(_92c,["project"],[_92b]);console.log("Agua.Shared.getSharedWorkflowsByProject    sharedWorkflows: ");console.dir({sharedWorkflows:_92c});return _92c;},getSharedStagesByWorkflow:function(_92d,_92e,_92f){console.log("Agua.Shared.getSharedStagesByWorkflow    plugins.core.Data.getSharedStagesByWorkflow(username, project, workflow)");console.log("Agua.Shared.getSharedStagesByWorkflow    username: "+_92d);console.log("Agua.Shared.getSharedStagesByWorkflow    project: "+_92e);console.log("Agua.Shared.getSharedStagesByWorkflow    workflow: "+_92f);var _930=this.getSharedStagesByUsername(_92d);console.log("Agua.Shared.getSharedStagesByWorkflow    BEFORE FILTER PROJECT, sharedStages: ");console.dir({sharedStages:_930});_930=this.filterByKeyValues(_930,["project"],[_92e]);console.log("Agua.Shared.getSharedStagesByWorkflow    BEFORE FILTER WORKFLOW, sharedStages: ");console.dir({sharedStages:_930});_930=this.filterByKeyValues(_930,["workflow"],[_92f]);console.log("Agua.Shared.getSharedStagesByWorkflow    AFTER sharedStages: ");console.dir({sharedStages:_930});return _930;},getSharedParametersByAppname:function(_931,_932){if(_931==null){return null;}var _933=this.cloneData("sharedparameters");var keys=["owner","appname"];var _934=[_932,_931];var _935=this.filterByKeyValues(_933,keys,_934);return _935;},getSharedStageParameters:function(_936){var keys=["username","project","workflow","name","number"];var _937=this.notDefined(_936,keys);console.log("Agua.Shared.getSharedStageParameters    notDefined: "+dojo.toJson(_937));if(_937.length!=0){console.log("Agua.Shared.getSharedStageParameters    not defined: "+dojo.toJson(_937));return;}var _938=_936.username;var _939=this.cloneData("sharedstageparameters");if(_939==null||_939[_938]==null){return [];}var _93a=_939[_938];_936.appname=_936.name;_936.appnumber=_936.number;var _93b=["username","project","workflow","appname","appnumber"];var _93c=[_936.username,_936.project,_936.workflow,_936.name,_936.number];_93a=this.filterByKeyValues(_93a,_93b,_93c);return _93a;},getSharedViews:function(_93d){console.log("Agua.Shared.getSharedViews    plugins.core.Data.getSharedViews(viewObject)");console.log("Agua.Shared.getSharedViews    viewObject: "+dojo.toJson(_93d));var keys=["project","username"];var _93e=this.notDefined(_93d,keys);console.log("Agua.Shared.getSharedViews    notDefined: "+dojo.toJson(_93e));if(_93e.length!=0){console.log("Agua.Shared.getSharedViews    not defined: "+dojo.toJson(_93e));return;}var _93f=_93d.username;var _940=this.cloneData("sharedsharedViews");if(_940==null||_940[_93f]==null){return [];}var _941=_940[_93f];console.log("Agua.Shared.getSharedViews    BEFORE views: "+dojo.toJson(_941,true));var _942=["project","username"];var _943=[_93d.username,_93d.project,_93d.workflow,_93d.name,_93d.number];_941=this.filterByKeyValues(_941,_942,_943);console.log("Agua.Shared.getSharedViews    AFTER  views: "+dojo.toJson(_941));return _941;},getSharedApps:function(){return this.cloneData("sharedapps");}});}if(!dojo._hasResource["plugins.core.Agua.Sharing"]){dojo._hasResource["plugins.core.Agua.Sharing"]=true;dojo.provide("plugins.core.Agua.Sharing");dojo.declare("plugins.core.Agua.Sharing",[],{getSharingHeadings:function(){console.log("Agua.Sharing.getSharingHeadings    plugins.core.Data.getSharingHeadings()");var _944=this.cloneData("sharingheadings");console.log("Agua.Sharing.getSharingHeadings    headings: "+dojo.toJson(_944));return _944;},getAccess:function(){return this.cloneData("access");}});}if(!dojo._hasResource["plugins.core.Agua.Source"]){dojo._hasResource["plugins.core.Agua.Source"]=true;dojo.provide("plugins.core.Agua.Source");dojo.declare("plugins.core.Agua.Source",[],{getSources:function(){var _945=this.cloneData("sources");return this.sortHasharray(_945,"name");},isSource:function(_946){console.log("Agua.Source.isSource    plugins.core.Data.isSource(sourceObject)");console.log("Agua.Source.isSource    sourceObject: "+dojo.toJson(_946));var _947=this.getSources();if(_947==null){return false;}return this._objectInArray(_947,_946,["name"]);},addSource:function(_948){console.log("Agua.Source.addSource    plugins.core.Data.addSource(sourceObject)");console.log("Agua.Source.addSource    sourceObject: "+dojo.toJson(_948));this._removeSource(_948);if(!this._addSource(_948)){return false;}var url=Agua.cgiUrl+"sharing.cgi?";var _949=new Object;_949.username=this.cookie("username");_949.sessionid=this.cookie("sessionid");_949.mode="addSource";_949.data=_948;this.doPut({url:url,query:_949,sync:false});},_addSource:function(_94a){console.log("Agua.Source._addSource    plugins.core.Data._addSource(sourceObject)");console.log("Agua.Source._addSource    sourceObject: "+dojo.toJson(_94a));return this.addData("sources",_94a,["name","description","location"]);},removeSource:function(_94b){if(!this._removeSource(_94b)){console.log("Agua.Source.removeSource    FAILED TO REMOVE sourceObject: "+dojo.toJson(_94b));return false;}_94b.username=this.cookie("username");_94b.type="source";var _94c=["username","name","type"];this.removeData("groupmembers",_94b,_94c);var url=Agua.cgiUrl+"sharing.cgi?";var _94d=new Object;_94d.username=this.cookie("username");_94d.sessionid=this.cookie("sessionid");_94d.mode="removeSource";_94d.data=_94b;this.doPut({url:url,query:_94d,sync:false});},_removeSource:function(_94e){return this.removeData("sources",_94e,["name"]);},isGroupSource:function(_94f,_950){console.log("Agua.Source.isGroupSource    plugins.core.Data.isGroupSource(groupName, sourceObject)");var _951=this.getGroupSources();if(_951==null){return false;}_951=this.filterByKeyValues(_951,["groupname"],[_94f]);return this._objectInArray(_951,_950,["name"]);},addSourceToGroup:function(_952,_953){console.log("Agua.Source.addSourceToGroup     plugins.core.Data.addSourceToGroup");if(this.isGroupSource(_952,_953)==true){console.log("Agua.Source.addSourceToGroup     source already exists in sources: "+_953.name+". Returning.");return false;}var _954=this.getGroups();var _955=this._getObjectByKeyValue(_954,"groupname",_952);if(_955==null){return null;}_953.username=_955.username;_953.groupname=_952;_953.groupdesc=_955.description;_953.type="source";var _956=["username","groupname","name","type"];return this.addData("groupmembers",_953,_956);},removeSourceFromGroup:function(_957,_958){console.log("Agua.Source.removeSourceFromGroup     groupName: "+_957);console.log("Agua.Source.removeSourceFromGroup     sourceObject: ");console.dir({sourceObject:_958});var _959=this.getGroups();console.log("Agua.Source.removeSourceFromGroup     groups: ");console.dir({groups:_959});var _95a=this._getObjectByKeyValue(_959,"groupname",_957);console.log("Agua.Source.removeSourceFromGroup     group: ");console.dir({group:_95a});if(_95a==null){console.log("Agua.Source.removeSourceFromGroup     group is null. Returning.");return null;}_958.owner=_95a.username;_958.groupname=_957;_958.groupdesc=_95a.description;_958.type="source";console.log("Agua.Source.removeSourceFromGroup     BEFORE removeData, sourceObject: ");console.dir({sourceObject:_958});var _95b=["username","groupname","name","type"];return this.removeData("groupmembers",_958,_95b);},getSourcesByGroup:function(_95c){var _95d=this.getGroupSources();var _95e=["groupname"];var _95f=[_95c];return this.filterByKeyValues(_95d,_95e,_95f);}});}if(!dojo._hasResource["plugins.core.Agua.Stage"]){dojo._hasResource["plugins.core.Agua.Stage"]=true;dojo.provide("plugins.core.Agua.Stage");dojo.declare("plugins.core.Agua.Stage",[],{addStage:function(_960){console.log("Agua.Stage.addStage    stageObject: ");console.dir({stageObject:_960});var _961=this._addStage(_960);if(_961==true){_961=this.addStageParametersForStage(_960);}if(_961==false){return;}var url=Agua.cgiUrl+"workflow.cgi";var _962=_960;_962.username=this.cookie("username");_962.sessionid=this.cookie("sessionid");_962.mode="addStage";this.doPut({url:url,query:_962});return _961;},_addStage:function(_963){var _964=["project","workflow","name","number"];var _965=this.addData("stages",_963,_964);if(_965==false){return false;}return _965;},insertStage:function(_966){console.log("Agua.Stage.insertStage    plugins.core.Data.insertStage(stageObject)");delete _966.avatarType;console.log("Agua.Stage.insertStage    stageObject: ");console.dir({stageObject:_966});var _967=Agua.getWorkflowNumber(_966.project,_966.workflow);_966.workflownumber=_967;if(_966==null){return;}var _968=this.getStagesByWorkflow(_966.project,_966.workflow);_968=this.sortHasharray(_968,"number");var _969=_966.number-1;var _96a=_966.owner;var _96b=_966.username;var _96c=true;for(var i=_968.length-1;i>_969-1;i--){var _96d=this.getStageParameters(_968[i]);if(_96d==null){console.log("Agua.Stage.insertStage    Result = false because no stage parameters for stage: "+dojo.toJson(_968[i],true));_96c=false;}var _96e=this;for(var j=0;j<_96d.length;j++){if(_96e._removeStageParameter(_96d[j])==false){console.log("Agua.Stage.insertStage    Result = false because there was a problem removing stageParameter: "+dojo.toJson(_96d[j],true));_96c=false;}_96d[j].appnumber=(i+2).toString();if(_96e._addStageParameter(_96d[j])==false){console.log("Agua.Stage.insertStage    Result = false because there was a problem adding stageParameter: "+dojo.toJson(_96d[j],true));_96c=false;}}}if(_96c==false){console.log("Agua.Stage.insertStage    Returning because there was a problem updating the stage parameters");return false;}for(var i=_968.length-1;i>_969-1;i--){if(this._removeStage(_968[i])==false){console.log("Agua.Stage.spliceStage    Returning because there was a problem removing stages["+i+"]: "+dojo.toJson(_968[i]));return false;}_968[i].number=(i+2).toString();if(this._addStage(_968[i])==false){console.log("Agua.Stage.spliceStage    Returning because there was a problem adding back stages["+i+"]: "+dojo.toJson(_968[i]));return false;}}_96c=this._addStage(_966);if(_96c==false){console.log("Agua.Stage.insertStage    Returning FALSE because there was a problem adding the stage to stages: "+dojo.toJson(_966));return false;}if(_96c==true){_96c=this.addStageParametersForStage(_966);}if(_96c==false){console.log("Agua.Stage.insertStage    Returning because there was a problem copying parameters for the stage:"+dojo.toJson(_966));return false;}var url=Agua.cgiUrl+"workflow.cgi";var _96f=_966;_96f.username=this.cookie("username");_96f.sessionid=this.cookie("sessionid");_96f.mode="insertStage";this.doPut({url:url,query:_96f});return true;},removeStage:function(_970){console.log("Agua.Stage.removeStage    plugins.core.Data.removeStage(stageObject)");console.log("Agua.Stage.removeStage    stageObject: "+_970);var _971=this._removeStage(_970);console.log("Agua.Stage.removeStage    Doing this.removeStageParameters(stageObject)");if(_971==true){_971=this.removeStageParameters(_970);}if(_971==false){console.log("Agua.Stage.removeStage    Problem removing stage or stageparameters. Returning.");return;}var url=Agua.cgiUrl+"workflow.cgi";var _972=_970;_972.username=this.cookie("username");_972.sessionid=this.cookie("sessionid");_972.mode="removeStage";this.doPut({url:url,query:_972});return _971;},_removeStage:function(_973){var _974=["project","workflow","name","number"];var _975=this.removeData("stages",_973,_974);if(_975==false){return false;}return _975;},updateStagesStatus:function(_976){if(_976==null||_976.length==0){return;}var _977=this.getData("stages");_977=this.sortNumericHasharray(_977,"number");var _978=_977[0].project;var _979=_977[0].workflow;var _97a=0;for(var i=0;i<_977.length;i++){if(_977[i].project!=_978){continue;}if(_977[i].workflow!=_979){continue;}_97a++;}for(var i=0;i<_977.length;i++){if(_977[i].project!=_978){continue;}if(_977[i].workflow!=_979){continue;}for(var k=0;k<_976.length;k++){if(_977[i].number==_976[k].number){_977[i].status=_976[k].status;_977[i].started=_976[k].started;_977[i].completed=_976[k].completed;continue;}}}_977=this.getData("stages");_977=this.sortNumericHasharray(_977,"number");_97a=0;for(var i=0;i<_977.length;i++){if(_977[i].project!=_978){continue;}if(_977[i].workflow!=_979){continue;}_97a++;}},updateStageSubmit:function(_97b){var _97c=this.getData("stages");var _97d=this._getIndexInArray(_97c,_97b,["project","workflow","number"]);if(_97d==null){return 0;}_97c[_97d].submit=_97b.submit;var url=Agua.cgiUrl+"workflow.cgi";_97b.username=this.cookie("username");_97b.sessionid=this.cookie("sessionid");_97b.mode="updateStageSubmit";this.doPut({url:url,query:_97b});return 1;},spliceStage:function(_97e){if(_97e==null){return;}var _97f=this.getStagesByWorkflow(_97e.project,_97e.workflow);_97f=this.sortHasharray(_97f,"number");var _980=_97e.number-1;_97f.splice(_980,1);var _981=this._removeStage(_97e);if(_981==false){return false;}_981=this.removeStageParameters(_97e);if(_981==false){console.log("Agua.Stage.spliceStage    Returning because there was a problem removing parameters for the stage:"+dojo.toJson(_97e));return false;}for(var i=_980;i<_97f.length;i++){this._removeStage(_97f[i]);_97f[i].number=(i+1).toString();this._addStage(_97f[i]);}var _982=this.getStagesByWorkflow(_97e.project,_97e.workflow);for(var i=0;i<_982.length;i++){}for(var i=_97f.length-1;i>_980-1;i--){_97f[i].number=(i+2).toString();var _983=this.getStageParameters(_97f[i]);if(_983==null){return false;}var _984=this;for(var j=0;j<_983.length;j++){if(_984._removeStageParameter(_983[j])==false){_981=false;}_983[j].appnumber=(i+1).toString();if(_984._addStageParameter(_983[j])==false){_981=false;}}_97f[i].number=(i+1).toString();}if(_981==false){return false;}var url=Agua.cgiUrl+"workflow.cgi";var _985=_97e;_985.username=this.cookie("username");_985.sessionid=this.cookie("sessionid");_985.mode="removeStage";this.doPut({url:url,query:_985});},isStage:function(_986){var _987=this.getStages();for(var i in _987){var _988=_987[i];if(_988.name.toLowerCase()==_986.toLowerCase()){return true;}}return false;},getStageType:function(_989){var _98a=this.getStages();for(var i in _98a){var _98b=_98a[i];if(_98b.name.toLowerCase()==_989.toLowerCase()){return _98b.type;}}return null;},getStages:function(){return this.cloneData("stages");},getStagesByWorkflow:function(_98c,_98d){if(_98c==null){return;}if(_98d==null){return;}var _98e=this.cloneData("stages");var _98f=["project","workflow"];var _990=[_98c,_98d];_98e=this.filterByKeyValues(_98e,_98f,_990);return _98e;}});}if(!dojo._hasResource["plugins.core.Agua.StageParameter"]){dojo._hasResource["plugins.core.Agua.StageParameter"]=true;dojo.provide("plugins.core.Agua.StageParameter");dojo.declare("plugins.core.Agua.StageParameter",[],{addStageParameter:function(_991){this._removeStageParameter(_991);var _992=this._addStageParameter(_991);if(_992==false){console.log("Agua.StageParameteraddStageParameter    result of _addStageParameter is "+_992+". Returning");return _992;}var url=this.cgiUrl+"workflow.cgi";var _993=_991;_993.username=this.cookie("username");_993.sessionid=this.cookie("sessionid");_993.mode="addStageParameter";this.doPut({url:url,query:_993});return _992;},_addStageParameter:function(_994){if(_994.chained==null){_994.chained="0";}var _995=["project","workflow","appname","appnumber","name","paramtype"];return this.addData("stageparameters",_994,_995);},removeStageParameter:function(_996){var _997=this._removeStageParameter(_996);if(_997==false){return _997;}var url=this.cgiUrl+"workflow.cgi";var _998=_996;_998.username=this.cookie("username");_998.sessionid=this.cookie("sessionid");_998.mode="addStageParameter";this.doPut({url:url,query:_998,timeout:15000});return _997;},_removeStageParameter:function(_999){var _99a=["project","workflow","appname","appnumber","name","paramtype"];return this.removeData("stageparameters",_999,_99a);},getStageParameters:function(_99b){if(_99b==null){return;}var keys=["project","workflow","name","number"];var _99c=this.notDefined(_99b,keys);if(_99c.length!=0){console.log("Agua.StageParametergetStageParameters    not defined: "+dojo.toJson(_99c));return;}_99b.appnumber=_99b.number;_99b.appname=_99b.name;var _99d=this._getStageParameters();var _99e=["project","workflow","appname","appnumber"];var _99f=[_99b.project,_99b.workflow,_99b.name,_99b.number];_99d=this.filterByKeyValues(_99d,_99e,_99f);return _99d;},_getStageParameters:function(){return this.cloneData("stageparameters");},addStageParametersForStage:function(_9a0){if(_9a0.name==null){return null;}if(_9a0.number==null){return null;}var _9a1;if(_9a0.owner==this.cookie("username")){_9a1=dojo.clone(this.getParametersByAppname(_9a0.name));}else{_9a1=dojo.clone(this.getSharedParametersByAppname(_9a0.name,_9a0.owner));}dojo.forEach(_9a1,function(_9a2){_9a2.project=_9a0.project;_9a2.workflow=_9a0.workflow;_9a2.appnumber=_9a0.number;_9a2.appname=_9a0.name;});var _9a3=Agua.cloneData("stageparameters");var _9a4=["owner","project","workflow","appname","appnumber","name","paramtype"];var _9a5=true;var _9a6=this;dojo.forEach(_9a1,function(_9a7){if(_9a6.addData("stageparameters",_9a7,_9a4)==false){_9a5=false;}_9a3=Agua.cloneData("stageparameters");});if(!_9a5){return;}return _9a5;},removeStageParameters:function(_9a8){if(_9a8.name==null){console.log("Agua.StageParameterremoveStageParameters    stageObject.name is null. Returning.");return null;}if(_9a8.number==null){console.log("Agua.StageParameterremoveStageParameters    stageObject.number is null. Returning.");return null;}var keys=["owner","project","workflow","appname","appnumber"];var _9a9=[_9a8.owner,_9a8.project,_9a8.workflow,_9a8.name,_9a8.number];var _9aa=this.filterByKeyValues(this._getStageParameters(),keys,_9a9);var _9ab=["project","workflow","appname","appnumber","name"];var _9ac=this.removeArrayFromData("stageparameters",_9aa,_9ab);console.log("Agua.StageParameterremoveStageParameters    removeOk: "+_9ac);if(_9ac==false){console.log("Agua.StageParameterremoveStageParameters    Could not remove one or more parameters from stageparameters");return false;}return true;},getStageParametersByApp:function(_9ad){var _9ae=new Array;dojo.forEach(this.getStageParameters(),function(_9af){if(_9af.appname==_9ad){_9ae.push(_9af);}});return _9ae;}});}if(!dojo._hasResource["plugins.core.Agua.User"]){dojo._hasResource["plugins.core.Agua.User"]=true;dojo.provide("plugins.core.Agua.User");dojo.declare("plugins.core.Agua.User",[],{getUser:function(_9b0){console.log("Agua.User.getUser    plugins.core.Data.getUser(username)");console.log("Agua.User.getUser    username: "+_9b0);var _9b1=this.getUsers();console.log("Agua.User.getUser    users: "+dojo.toJson(_9b1));var _9b2=this._getIndexInArray(_9b1,{"username":_9b0},["username"]);console.log("Agua.User.getUser    index: "+_9b2);if(_9b2!=null){return _9b1[_9b2];}return null;},getUsers:function(){console.log("Agua.User.getUsers    plugins.core.Data.getUsers(userObject)");this.sortData("users","username");return this.cloneData("users");},addUser:function(_9b3){console.log("Agua.User.addUser    plugins.core.Data.addUser(userObject)");this._removeUser(_9b3);if(!Agua._addUser(_9b3)){return;}var url=Agua.cgiUrl+"workflow.cgi?";var _9b4=new Object;_9b4.username=this.cookie("username");_9b4.sessionid=this.cookie("sessionid");_9b4.mode="addUser";_9b4.data=_9b3;console.log("query: ");console.dir(_9b4);console.log("Users.saveUser    query: "+dojo.toJson(_9b4));this.doPut({url:url,query:_9b4,sync:false});},_addUser:function(_9b5){console.log("Agua.User._addUser    plugins.core.Data._addUser(userObject)");if(!this.addData("users",_9b5,["username"])){return false;}this.sortData("users","username");return true;},isUser:function(_9b6){var _9b7=this.getUsers();if(this._getIndexInArray(_9b7,_9b6,["username"])){return true;}return false;},removeUser:function(_9b8){console.log("Agua.User.removeUser    plugins.core.Data.removeUser(userObject)");if(!this._removeUser(_9b8)){return;}var url=Agua.cgiUrl+"sharing.cgi?";var _9b9=new Object;_9b9.username=this.cookie("username");_9b9.sessionid=this.cookie("sessionid");_9b9.mode="removeUser";_9b9.data=_9b8;this.doPut({url:url,query:_9b9,sync:false});},_removeUser:function(_9ba){console.log("Agua.User._removeUser    plugins.core.Data._removeUser(userObject)");if(!this.removeData("users",_9ba,["username"])){return false;}this._removeUserFromGroups(_9ba);return true;},_removeUserFromGroups:function(_9bb){console.log("Agua.User._removeUserFromGroups    plugins.core.Data._removeUserFromGroups");_9bb.type="user";_9bb.name=_9bb.username;return this._removeObjectsFromData("groupmembers",_9bb,["name","type"]);},isGroupUser:function(_9bc,_9bd){var _9be=this.getGroupUsers();if(_9be==null){return false;}_9be=this.filterByKeyValues(_9be,["groupname"],[_9bc]);return this._objectInArray(_9be,_9bd,["name"]);},addUserToGroup:function(_9bf,_9c0){if(this.isGroupUser(_9bf,_9c0)==true){return false;}var _9c1=this.getGroups();var _9c2=this._getObjectByKeyValue(_9c1,"groupname",_9bf);if(_9c2==null){return false;}_9c0.username=_9c2.username;_9c0.groupname=_9bf;_9c0.groupdesc=_9c2.description;_9c0.type="user";var _9c3=["username","groupname","name","type"];return this.addData("groupmembers",_9c0,_9c3);},removeUserFromGroup:function(_9c4,_9c5){var _9c6=this.getGroups();var _9c7=this._getObjectByKeyValue(_9c6,"groupname",_9c4);if(_9c7==null){return false;}_9c5.owner=_9c7.username;_9c5.groupname=_9c4;_9c5.groupdesc=_9c7.description;_9c5.type="user";var _9c8=["username","groupname","name","type"];return this.removeData("groupmembers",_9c5,_9c8);}});}if(!dojo._hasResource["plugins.core.Agua.View"]){dojo._hasResource["plugins.core.Agua.View"]=true;dojo.provide("plugins.core.Agua.View");dojo.declare("plugins.core.Agua.View",[],{getViewObject:function(_9c9,_9ca){var _9cb=this.getViews();if(_9cb==null){return [];}var _9cc=["project","view"];var _9cd=[_9c9,_9ca];var _9cb=this.filterByKeyValues(_9cb,_9cc,_9cd);if(_9cb==null||_9cb.length==0){return null;}return _9cb[0];},getViews:function(){return this.cloneData("views");},getPreviousView:function(_9ce){var _9cf=this.getViews();if(!_9cf||_9cf.length==0){return;}var _9d0=dojo.clone(_9cf);var _9d1=this.filterByKeyValues(_9d0,["project"],[_9ce.project]);if(!_9d1||_9d1.length==0){_9cf.push(_9ce);var _9d2=this;_9cf.sort(function(a,b){return _9d2.sortObjectsNaturally(a,b,"project");});var _9d3=this.hashArrayKeyToArray(dojo.clone(_9cf),"project");_9d3=this.uniqueValues(_9d3);if(_9d3.length==1){return;}var _9d4=this._getIndex(_9d3,_9ce.project);var _9d5;if(_9d4==0){_9d5=_9d3[1];var _9d1=this.filterByKeyValues(_9cf,["project"],[_9d5]);_9d1.sort(function(a,b){return _9d2.sortObjectsNaturally(a,b,"view");});return _9d1[0];}else{_9d5=_9d3[_9d4-1];var _9d1=this.filterByKeyValues(_9cf,["project"],[_9d5]);_9d1.sort(function(a,b){return _9d2.sortObjectsNaturally(a,b,"view");});return _9d1[(_9d1.length-1)];}}else{_9cf.push(_9ce);var _9d2=this;_9cf.sort(function(a,b){return _9d2.sortObjectsNaturally(a,b,"view");});var _9d4=this._getIndexInArray(_9cf,_9ce,["project","view"]);if(_9d4==0){return _9cf[1];}else{return _9cf[_9d4-1];}}},removeView:function(_9d6){this._removeView(_9d6);this._removeViewFeatures(_9d6);return true;},_removeView:function(_9d7){console.log("Agua.View._removeView    viewObject: "+dojo.toJson(_9d7));var _9d8=["project","view"];if(!this.removeData("views",_9d7,_9d8)){console.log("Agua.View.removeView    Could not remove view from views table: "+_9d7.name);return false;}return true;},_removeViewFeatures:function(_9d9){var _9da=["project","view"];this.removeObjectsFromData("viewfeatures",_9d9,_9da);return true;},isView:function(_9db,_9dc){var _9dd=this.getViewsByProject(_9db);for(var i in _9dd){var _9de=_9dd[i];if(_9de.view.toLowerCase()==_9dc.toLowerCase()){console.log("Agua.View.isView    Match found for view: *"+_9de.view+"*");return true;}}return false;},_addView:function(_9df){var _9e0=["project","view"];return this.addData("views",_9df,_9e0);},getViewNames:function(_9e1){var _9e2=this.getViewsByProject(_9e1);return this.hashArrayKeyToArray(_9e2,"view");},getViewsByProject:function(_9e3){var _9e4=this.getViews();if(_9e4==null){return [];}var _9e5=["project"];var _9e6=[_9e3];var _9e4=this.filterByKeyValues(_9e4,_9e5,_9e6);return _9e4;},getViewSpecies:function(_9e7,_9e8){if(_9e7==null||!_9e7){return;}var _9e9=this.getViewFeatures(_9e7,_9e8);if(_9e9==null||_9e9.length==0){return new Array;}var _9ea=new Object;_9ea.species=_9e9[0].species;_9ea.build=_9e9[0].build;return _9ea;},getViewProjects:function(){var _9eb=this.cloneData("viewfeatures");var _9ec=this.hashArrayKeyToArray(_9eb,"project");_9ec=this.uniqueValues(_9ec);return _9ec;},getSpeciesBuilds:function(){var _9ed=this.cloneData("features");var _9ee=new Array;for(var i=1;i<_9ed.length;i++){_9ee.push(_9ed[i].species+"("+_9ed[i].build+")");}_9ee=this.uniqueValues(_9ee);return _9ee;},getSpecies:function(_9ef,_9f0){var _9f1=this.cloneData("views");_9f1=this.filterByKeyValues(_9f1,["project","view"],[_9ef,_9f0]);if(_9f1==null||_9f1.length==0){return;}return _9f1[0].species;},getBuild:function(_9f2,_9f3){var _9f4=this.cloneData("views");_9f4=this.filterByKeyValues(_9f4,["project","view"],[_9f2,_9f3]);if(_9f4==null||_9f4.length==0){return;}return _9f4[0].build;}});}if(!dojo._hasResource["plugins.core.Agua.Workflow"]){dojo._hasResource["plugins.core.Agua.Workflow"]=true;dojo.provide("plugins.core.Agua.Workflow");dojo.declare("plugins.core.Agua.Workflow",[],{getWorkflows:function(){var _9f5=this.cloneData("workflows");return this.sortHasharray(_9f5,"name");},getWorkflowNamesByProject:function(_9f6){var _9f7=this.getWorkflowsByProject(_9f6);_9f7=this.sortNumericHasharray(_9f7,"number");return this.hashArrayKeyToArray(_9f7,"name");},getWorkflowsByProject:function(_9f8){var _9f9=this.cloneData("workflows");return this.filterByKeyValues(_9f9,["project"],[_9f8]);},getWorkflow:function(_9fa){console.log("Agua.Workflow.getWorkflow     plugins.core.Data.getWorkflow(workflowObject)");console.log("Agua.Workflow.getWorkflow     workflowObject: ");console.dir({workflowObject:_9fa});var _9fb=this._getWorkflow(_9fa);if(!_9fb){console.log("Agua.Workflow.getWorkflow     No workflowObject.name "+_9fa.name+" found. Returning");return null;}console.log("Agua.Workflow.getWorkflow     object.name: "+_9fb.name);console.log("Agua.Workflow.getWorkflow     object: ");console.dir({object:_9fb});return _9fb;},_getWorkflow:function(_9fc){console.log("Agua.Workflow._getWorkflow     plugins.core.Data._getWorkflow(workflowObject)");console.log("Agua.Workflow._getWorkflow     workflowObject: "+dojo.toJson(_9fc));if(!this.isProject(_9fc.project)){console.log("Agua.Workflow._getWorkflow     No project found in workflowObject. Returning false.");return false;}var _9fd=this.getWorkflows();if(_9fd==null){console.log("Agua.Workflow._getWorkflow     workflows is null. Returning false.");return false;}var _9fe=["project","name"];var _9ff=[_9fc.project,_9fc.name];var _9fd=this.filterByKeyValues(_9fd,_9fe,_9ff);if(!_9fd||_9fd.length==0){return;}return _9fd[0];},isWorkflow:function(_a00){console.log("Agua.Workflow.isWorkflow     caller: "+this.isWorkflow.caller.nom);var _a01=this._getWorkflow(_a00);if(!_a01){console.log("Agua.Workflow.isWorkflow     Returning false");return false;}console.log("Agua.Workflow.isWorkflow     Returning true");return true;},getWorkflowNumber:function(_a02,_a03){var _a04=this._getWorkflow({project:_a02,name:_a03});if(!_a04){return null;}console.log("Agua.Workflow.getWorkflowNumber    workflowObject:");console.dir({workflowObject:_a04});return _a04.number;},getMaxWorkflowNumber:function(_a05){console.log("Agua.Workflow.getMaxWorkflowNumber     plugins.core.Data.getMaxWorkflowNumber(projectName)");console.log("Agua.Workflow.getMaxWorkflowNumber     projectName: "+_a05);var _a06=this.getWorkflowsByProject(_a05);if(_a06==null){return null;}if(_a06.length==0){return null;}console.log("Agua.Workflow.getMaxWorkflowNumber     Returning workflowObjects.length: "+_a06.length);return _a06.length;},moveWorkflow:function(_a07,_a08){console.log("Agua.Workflow.moveWorkflow    workflowObject: "+dojo.toJson(_a07,true));var _a09=_a07.number;if(_a09==null){return false;}if(_a09==_a08){return false;}var _a0a=this.getData("workflows");_a0a=this.sortNumericHasharray(_a0a,"number");for(var i=0;i<_a0a.length;i++){if(_a0a[i].project!=_a0b){continue;}_a0c++;}var _a0b=_a07.project;var _a0c=0;for(var i=0;i<_a0a.length;i++){if(_a0a[i].project!=_a0b){continue;}_a0c++;if(_a0c<_a09&&_a0c<_a08){_a0a[i].number=_a0c;}else{if(_a09<_a08){if(_a0c==_a09){_a0a[i].number=_a08;}else{if(_a0c<=_a08){_a0a[i].number=_a0c-1;}else{_a0a[i].number=_a0c;}}}else{if(_a0c<_a09){_a0a[i].number=_a0c+1;}else{if(_a09==_a0c){_a0a[i].number=_a08;}else{_a0a[i].number=_a0c;}}}}}var _a0d=_a07;_a0d.newnumber=_a08;_a0d.mode="moveWorkflow";_a0d.username=Agua.cookie("username");_a0d.sessionid=Agua.cookie("sessionid");var url=Agua.cgiUrl+"workflow.cgi";this.doPut({url:url,query:_a0d,sync:false});},renumberWorkflows:function(_a0e){console.log("Agua.Workflow.renumberWorkflows     plugins.core.Data.renumberWorkflows(projectName)");console.log("Agua.Workflow.renumberWorkflows     projectName: "+_a0e);var _a0f=this.getWorkflowsByProject(_a0e);console.log("Agua.Workflow.renumberWorkflows     workflows.length: "+_a0f.length);this.printObjectKeys(_a0f,"number","UNSORTED workflows");console.log("Agua.Workflow.renumberWorkflows     workflows.length: "+_a0f.length);this.printObjectKeys(_a0f,"name","UNSORTED workflows");console.log("Agua.Workflow.renumberWorkflows     workflows.length: "+_a0f.length);_a0f=this.sortHasharrayByKeys(_a0f,["number"]);console.log("Agua.Workflow.renumberWorkflows     workflows.length: "+_a0f.length);this.printObjectKeys(_a0f,"number","SORTED workflows");console.log("Agua.Workflow.renumberWorkflows     workflows.length: "+_a0f.length);this.printObjectKeys(_a0f,"name","SORTED workflows");console.log("Agua.Workflow.renumberWorkflows     workflows.length: "+_a0f.length);console.log("Agua.Workflow.renumberWorkflows     RENUMBERING workflows");var _a10=0;for(var i=0;i<_a0f.length;i++){console.log("Agua.Workflow.renumberWorkflows     REMOVING workflow ["+i+"].number: "+_a0f[i].number);this._removeWorkflow(_a0f[i]);_a10++;_a0f[i].number=_a10;console.log("Agua.Workflow.renumberWorkflows     ADDING workflows ["+i+"].number: "+_a0f[i].number);this._addWorkflow(_a0f[i]);}_a0f=this.getWorkflowsByProject(_a0e);console.log("Agua.Workflow.renumberWorkflows     BEFORE FILTER workflows.length: "+_a0f.length);_a0f=this.filterByKeyValues(_a0f,["project"],[_a0e]);console.log("Agua.Workflow.renumberWorkflows     AFTER FILTER workflows.length: "+_a0f.length);},addWorkflow:function(_a11){console.log("Agua.Workflow.addWorkflow    plugins.workflow.Agua.addWorkflow(workflowObject)");console.log("Agua.Workflow.addWorkflow    workflowObject: "+dojo.toJson(_a11));var _a12=_a11.project;var _a13=_a11.name;if(this.isWorkflow(_a11)==true){console.log("Agua.Workflow.addWorkflow    Workflow '"+_a13+"' already exists in project '"+_a12+"'. Returning.");return;}var _a14=this.getMaxWorkflowNumber(_a12);console.log("Agua.Workflow.addWorkflow    maxNumber: "+_a14);var _a15;if(_a14==null){_a15=1;}else{_a15=_a14+1;}_a11.number=_a15;console.log("Agua.Workflow.addWorkflow    workflowObject.number: "+_a11.number);var _a16=this._addWorkflow(_a11);if(_a16==false){console.log("Agua.Workflow.addWorkflow    Could not add workflow "+_a13+" to workflows");return;}var url=Agua.cgiUrl+"workflow.cgi";var _a17=new Object;_a17.project=_a12;_a17.name=_a13;_a17.number=_a15;_a17.username=this.cookie("username");_a17.sessionid=this.cookie("sessionid");_a17.mode="addWorkflow";console.log("Agua.Workflow.addWorkflow    query: "+dojo.toJson(_a17,true));this.doPut({url:url,query:_a17,sync:false});},_addWorkflow:function(_a18){var keys=["project","name","number"];var _a19=this.addData("workflows",_a18,keys);},removeWorkflow:function(_a1a){console.log("Agua.Workflow.removeWorkflow    caller: "+this.removeWorkflow.caller.nom);console.log("Agua.Workflow.removeWorkflow    workflowObject: "+dojo.toJson(_a1a));this._removeWorkflow(_a1a);this.renumberWorkflows(_a1a.project);var url=Agua.cgiUrl+"workflow.cgi";var _a1b=new Object;_a1b.project=_a1a.project;_a1b.name=_a1a.name;_a1b.number=_a1a.number;_a1b.username=this.cookie("username");_a1b.sessionid=this.cookie("sessionid");_a1b.mode="removeWorkflow";console.log("Agua.Workflow.removeWorkflow    query: "+dojo.toJson(_a1b,true));this.doPut({url:url,query:_a1b,sync:false});},_removeWorkflow:function(_a1c){console.log("Agua.Workflow._removeWorkflow    BEFORE delete workflows.length: "+this.getWorkflows().length);var keys=["project","number","name"];var _a1d=this.removeData("workflows",_a1c,keys);console.log("Agua.Workflow._removeWorkflow    delete result: "+_a1d);console.log("Agua.Workflow._removeWorkflow    AFTER delete workflows.length: "+this.getWorkflows().length);_a1c.workflow=_a1c.name;keys=["project","workflow"];this.removeObjectsFromData("stages",_a1c,keys);this.removeObjectsFromData("stageparameters",_a1c,keys);},renameWorkflow:function(_a1e,_a1f,_a20,_a21){console.log("Agua.Workflow.renameWorkflow    plugins.core.Data.renameWorkflow(workflowObject, newName)");console.log("Agua.Workflow.renameWorkflow    workflowObject: "+dojo.toJson(_a1e));console.log("Agua.Workflow.renameWorkflow    newName: "+_a1f);console.log("Agua.Workflow.renameWorkflow    callback: "+_a20);if(_a1e.name==null){return;}if(_a1e.project==null){return;}if(_a1f==null){return;}var _a22=this.cookie("username");var date=this.currentMysqlDate();this._copyWorkflow(_a1e,_a22,_a1e.project,_a1f,date,_a1e.number);this._removeWorkflow(_a1e);var url=Agua.cgiUrl+"workflow.cgi";var _a23=new Object;_a23.project=_a1e.project;_a23.name=_a1e.name;_a23.newname=_a1f;_a23.username=this.cookie("username");_a23.sessionid=this.cookie("sessionid");_a23.mode="renameWorkflow";console.log("Agua.Workflow.renameWorkflow    query: "+dojo.toJson(_a23,true));this.doPut({url:url,query:_a23,sync:false,callback:_a20});},copyWorkflow:function(_a24,_a25,_a26,_a27,_a28,_a29,_a2a){console.log("Agua.Workflow.copyWorkflow    plugins.workflow.Agua.copyWorkflow(sourceUser, sourceProject, sourceWorkflow, targetUser, targetProject, targetWorkflow)");console.log("Agua.Workflow.copyWorkflow    sourceUser: "+_a24);console.log("Agua.Workflow.copyWorkflow    sourceProject: "+_a25);console.log("Agua.Workflow.copyWorkflow    sourceWorkflow: "+_a26);console.log("Agua.Workflow.copyWorkflow    targetUser: "+_a27);console.log("Agua.Workflow.copyWorkflow    targetProject: "+_a28);console.log("Agua.Workflow.copyWorkflow    targetWorkflow: "+_a29);console.log("Agua.Workflow.copyWorkflow    copyFiles: "+_a2a);if(this.isWorkflow({project:_a28,name:_a29})==true){console.log("Agua.Workflow.copyWorkflow    Workflow "+_a29+" already exists in project "+_a28+". Returning FALSE.");return false;}var _a2b=this.getSharedWorkflowsByProject(_a24,_a25);_a2b=this.filterByKeyValues(_a2b,["name"],[_a26]);if(!_a2b||_a2b.length==0){console.log("Agua.Workflow.copyWorkflow    Returning because workflows is not defined or empty");return;}var _a2c=_a2b[0];var date=this.currentMysqlDate();var _a2d=this._copyWorkflow(_a2c,_a27,_a28,_a29,date);if(_a2d==false){console.log("Agua.Workflow.copyWorkflow    Failed to copy workflow: "+dojo.toJson(_a2c));return false;}_a2c=this.setProvenance(_a2c,date);var url=Agua.cgiUrl+"workflow.cgi";var _a2e=new Object;_a2e.sourceuser=_a24;_a2e.targetuser=_a27;_a2e.sourceworkflow=_a26;_a2e.sourceproject=_a25;_a2e.targetworkflow=_a29;_a2e.targetproject=_a28;_a2e.copyfiles=_a2a;_a2e.date=date;_a2e.provenance=_a2c.provenance;_a2e.username=this.cookie("username");_a2e.sessionid=this.cookie("sessionid");_a2e.mode="copyWorkflow";console.log("Agua.Workflow.copyWorkflow    query: "+dojo.toJson(_a2e,true));this.doPut({url:url,query:_a2e,sync:false});return _a2d;},_copyWorkflow:function(_a2f,_a30,_a31,_a32,date,_a33){console.log("XXXXXXXXXXXX Data._copyWorkflow    Data._copyWorkflow(sourceUser, sourceProject, sourceWorkflow, targetUser, targetProject, targetWorkflow, copyFiles, workflowNumber)");console.log("Agua.Workflow._copyWorkflow    BEFORE workflowObject: "+dojo.toJson(_a2f));console.dir({workflowObject:_a2f});console.log("Agua.Workflow._copyWorkflow    BEFORE workflowObject.name: "+_a2f.name);console.log("Agua.Workflow._copyWorkflow    targetUser: "+_a30);console.log("Agua.Workflow._copyWorkflow    targetProject: "+_a31);console.log("Agua.Workflow._copyWorkflow    targetWorkflow: "+_a32);console.log("Agua.Workflow._copyWorkflow    date: "+date);var _a34=_a2f.username;var _a35=_a2f.name;var _a36=_a2f.project;console.log("Agua.Workflow._copyWorkflow    sourceWorkflow: "+_a35);_a2f=this.setProvenance(_a2f,date);var _a37=this.getMaxWorkflowNumber(_a31);var _a38;if(_a33){_a38=_a33;}else{if(!_a37){_a38=1;}else{_a38=_a37+1;}}var _a39=dojo.clone(_a2f);_a39.name=_a32;_a39.project=_a31;_a39.username=_a30;_a39.number=_a38;console.log("Agua.Workflow._copyWorkflow    AFTER newObject: ");console.dir({newObject:_a39});console.dir({workflowObject:_a2f});var keys=["project","name","number"];var _a3a=this.addData("workflows",_a39,keys);if(_a3a==false){console.log("Agua.Workflow._copyWorkflow    Could not copy workflow to targetWorkflow: "+_a32);return false;}var _a3b;if(_a34!=_a30){_a3b=this.getSharedStagesByWorkflow(_a34,_a36,_a35);}else{_a3b=this.getStagesByWorkflow(_a36,_a35);}console.log("Agua.Workflow._copyWorkflow    stages.length: "+_a3b.length);for(var i=0;i<_a3b.length;i++){console.log("Agua.Workflow._copyWorkflow    stages["+i+"]: "+_a3b[i]);var _a3c=dojo.clone(_a3b[i]);_a3c.project=_a31;_a3c.workflow=_a32;this._addStage(_a3c);var _a3d;if(_a34!=_a30){_a3d=this.getSharedStageParameters(_a3b[i]);}else{_a3d=this.getStageParameters(_a3b[i]);}console.log("Agua.Workflow._copyWorkflow    stageparams.length: "+_a3d.length);var _a3e=this;var _a3f=_a36+"/"+_a35;var _a40=_a31+"/"+_a32;dojo.forEach(_a3d,function(_a41,j){_a3d[j].project=_a31;_a3d[j].workflow=_a32;if(_a3d[j].value!=null&&_a3d[j].value.replace){_a3d[j].value=_a3d[j].value.replace(_a3f,_a40);}_a3e._addStageParameter(_a3d[j]);});}var _a42=this.getSharedViews({username:_a34,project:_a36});if(_a42==null){_a42=[];}for(var i=0;i<_a42.length;i++){this._addStage(_a42[i]);}return true;},getWorkflowSubmit:function(_a43){if(!_a43){return;}var _a44=0;var _a45=this.getStagesByWorkflow(_a43.project,_a43.workflow);if(!_a45){return 1;}for(var i=0;i<_a45.length;i++){if(_a45[i].submit==1){return 1;}}return 0;},setProvenance:function(_a46,date){var _a47=_a46.provenance;var _a48;if(!_a47){_a48=[];}else{_a48=dojo.fromJson(_a47);}if(!date){date=this.currentMysqlDate();}var item={copiedby:Agua.cookie("username"),original:dojo.clone(_a46),date:date};_a48.push(item);_a47=dojo.toJson(_a48);_a46.provenance=_a47;return _a46;}});}if(!dojo._hasResource["plugins.core.Plugin"]){dojo._hasResource["plugins.core.Plugin"]=true;dojo.provide("plugins.core.Plugin");dojo.declare("plugins.core.Plugin",null,{installed:false,setInstalled:function(){if(this.installed!=false&&installed!=true){return 0;}this.installed=true;return 1;},getInstalled:function(){return this.installed;},getVersion:function(){return this.version;},getDescription:function(){return this.description;},getPluginUrl:function(){return this.pluginUrl;},getInfo:function(){var info="";info+="Status: ";info+=this.getInstalled();info+="\n";info+="Version: ";info+=this.version();info+="\n";info+="Description: ";info+=this.description();info+="\n";info+="Plugin Url: ";info+=this.pluginUrl();info+="\n";return info;}});}if(!dojo._hasResource["plugins.core.PluginManager"]){dojo._hasResource["plugins.core.PluginManager"]=true;dojo.provide("plugins.core.PluginManager");dojo.declare("plugins.core.PluginManager",null,{_installedPlugins:{},plugins:[],parentWidget:null,pluginsList:null,pluginsArgs:null,constructor:function(args){if(args.pluginsList!=null&&args.pluginsList){this.pluginsList=args.pluginsList;}if(args.pluginsArgs!=null&&args.pluginsArgs){this.pluginsArgs=args.pluginsArgs;}if(args.parentWidget!=null&&args.parentWidget){this.parentWidget=args.parentWidget;}Agua.controllers["core"]=Agua;this.loadPlugins();},loadPlugins:function(){console.group("PluginManager.loadPlugins    this.pluginsList: ");console.dir({this_pluginsList:this.pluginsList});var _a49=this.pluginsList.length;if(!_a49){return;}var _a4a=2*_a49;for(var i=0;i<this.pluginsList.length;i++){var _a4b=parseInt((i*2)+1);this.percentProgress(_a4a,_a4b);console.log("PluginManager.loadPlugins    ******* plugin number"+_a4b);var _a4c=this.pluginsList[i];console.log("PluginManager.loadPlugins     this.pluginsList["+i+"]:  "+_a4c);var _a4d=_a4c.match(/^plugins\.([^\.]+)\./)[1];dojo["require"](_a4c);var args="";if(this.pluginsArgs&&this.pluginsArgs[i]){args=this.pluginsArgs[i];}console.log("PluginManager.loadPlugins    args: ");console.dir({args:args});var _a4e="new "+_a4c+"({ inputs: '"+args+"'})";console.log("PluginManager.loadPlugins    command: "+_a4e);var _a4f=eval(_a4e);Agua.controllers[_a4d]=_a4f;console.log("PluginManager.loadPlugins    DOING newPlugin.postLoad: "+_a4f.postLoad);if(_a4f.postLoad){_a4f.postLoad();}var _a50=this.checkDependencies(_a4f.dependencies);var _a4b=parseInt((i*2)+2);this.percentProgress(_a4a,_a4b);}console.log("PluginManager.loadPlugins    \tFINAL Agua.data: "+Agua.data);},percentProgress:function(_a51,_a52){var _a53=0;if(_a51==_a52){_a53=100;}else{_a53=parseInt((_a52/_a51)*100);}console.log("PluginManager.percentProgress    percent: "+_a53);if(!Agua.login){return;}Agua.login.progressBar.set({value:_a53,progress:_a53});},checkDependencies:function(_a54){return 1;if(!_a54){return 1;}for(var i=0;i<_a54.length;i++){var _a55=_a54[i].name;var _a56=_a54[i].version;if(_a55){var _a57=Agua.controllers[_a55];if(_a57.version>=_a56){if(!_a57.installed){return 0;}else{}}else{return 0;}}else{return 0;}}return 1;},getInstalledPlugins:function(){return this._installedPlugins;}});}if(!dojo._hasResource["plugins.core.Agua"]){dojo._hasResource["plugins.core.Agua"]=true;dojo.provide("plugins.core.Agua");if(1){}dojo.declare("plugins.core.Agua",[dijit._Widget,dijit._Templated,plugins.core.Common,plugins.core.Agua.Data,plugins.core.Agua.Access,plugins.core.Agua.App,plugins.core.Agua.Ami,plugins.core.Agua.Aws,plugins.core.Agua.Cloud,plugins.core.Agua.Cluster,plugins.core.Agua.Feature,plugins.core.Agua.File,plugins.core.Agua.Group,plugins.core.Agua.Hub,plugins.core.Agua.Package,plugins.core.Agua.Parameter,plugins.core.Agua.Project,plugins.core.Agua.Report,plugins.core.Agua.Shared,plugins.core.Agua.Sharing,plugins.core.Agua.Source,plugins.core.Agua.Stage,plugins.core.Agua.StageParameter,plugins.core.Agua.User,plugins.core.Agua.View,plugins.core.Agua.Workflow],{name:"plugins.core.Agua",version:"0.01",description:"Create widget for positioning Plugin buttons and tab container for displaying Plugin tabs",url:"",dependencies:[],pluginsList:["plugins.data.Controller","plugins.files.Controller","plugins.cloud.Controller","plugins.apps.Controller","plugins.sharing.Controller","plugins.folders.Controller","plugins.workflow.Controller","plugins.view.Controller","plugins.home.Controller"],templateString:"<div dojoAttachPoint=\"containerNode\">\n\n\t<div\n\t\tdojoAttachPoint=\"controls\"\n\t\tclass=\"controls\"\n\t\tstyle=\"min-height: 100% !important; min-width: 100% !important;\"\t\t\n\t>\n\n\t\t<div\n            dojoAttachPoint=\"toolbar\"\n            dojoType=\"dijit.Toolbar\"\n            class=\"toolbar\"\n        >\n        </div>\n\n\t\t<div\n\t\t\tdojoAttachPoint=\"tabs\"\n\t\t\tdojoType=\"dijit.layout.TabContainer\"\n\t\t\tclass=\"tabs\"\n\t\t\tuseSlider=\"false\"\n\t\t\ttabPosition=\"top\"\n\t\t\ttabStrip=\"false\"\n\t\t\tstyle=\"position: relative; top: 0px; left: 0px; height: 100% !important; min-height: 850px !important; width: 1200px !important; min-width: 100% !important; right: auto; bottom: auto;\"\n\t\t>\n\t\t</div>\n\t\n<!--\t\t<div\n\t\t\tdojoAttachPoint=\"toaster\"\n\t\t\tdojoType=\"dojox.widget.Toaster\"\n\t\t\tclass=\"toaster\" \n\t\t\tpositionDirection=\"bl-right\"\n\t\t\tduration=\"500\" \n\t\t\tmessageTopic=\"toastTopic\"\n\t\t></div> \n-->\t\t\n\t</div>\n\t\n\t<div dojoAttachPoint=\"fileManagerNode\"></div>\n\n</div>\n",cssFiles:[dojo.moduleUrl("plugins","core/css/agua.css"),dojo.moduleUrl("plugins","core/css/controls.css"),],widgetsInTemplate:true,controllers:new Object(),splashNode:null,messageNode:null,pluginManager:null,cookies:new Object,css:new Object,cgiUrl:null,htmlUrl:null,widgets:new Object,testing:false,constructor:function(args){console.log("Agua.constructor     plugins.core.Agua.constructor    args:");console.dir({args:args});this.cgiUrl=args.cgiUrl;this.htmlUrl=args.htmlUrl;if(args.pluginsList!=null){this.pluginsList=args.pluginsList;}this.database=args.database;this.dataUrl=args.dataUrl;console.log("Agua.constructor     this.database: "+this.database);console.log("Agua.constructor     this.testing: "+this.testing);console.log("Agua.constructor     this.dataUrl: "+this.dataUrl);},postCreate:function(){this.startup();},startup:function(){console.log("Agua.startup    plugins.core.Agua.startup()");console.log("Agua.startup    BEFORE loadCSS()");this.loadCSS();console.log("Agua.startup    AFTER loadCSS()");var _a58=dojo.byId("attachPoint");_a58.appendChild(this.containerNode);var _a59=dojo.connect(this.aguaButton,"onClick",this,"reload");this.inherited(arguments);this.updater=new plugins.core.Updater();this.setStandby();this.setToaster();console.log("Agua.startup    AFTER this.setToaster()");},displayVersion:function(){console.log("Agua.displayVersion     plugins.core.Agua.displayVersion()");var _a5a=this.getPackages();console.log("Agua.displayVersion    packages: ");console.dir({packages:_a5a});var _a5b=this._getObjectByKeyValue(_a5a,"package","agua");console.log("Agua.displayVersion    packageObject:");console.dir({packageObject:_a5b});if(!_a5b){return;}var _a5c=_a5b.version;console.log("Agua.displayVersion     version: "+_a5c);console.log("this.login.statusBar:");console.dir({statusBar:this.login.statusBar});var _a5d=dojo.byId("aguaVersion");_a5d.innerHTML=_a5c;},startPlugins:function(){console.log("Agua.startPlugins     plugins.core.Agua.startPlugins()");return this.loadPlugins(this.pluginsList);},loadPlugins:function(_a5e,_a5f){console.log("Agua.loadPlugins    pluginsList: "+dojo.toJson(_a5e));console.log("Agua.loadPlugins    pluginsArgs: "+dojo.toJson(_a5f));if(_a5e==null){_a5e=this.pluginsList;}if(_a5f==null){_a5f=this.pluginsArgs;}this.setStandby();console.dir({standby:this.standby});console.log("DOING this.standby.show()");this.standby.show();console.log("Agua.loadPlugins    Creating pluginsManager...");this.pluginManager=new plugins.core.PluginManager({parentWidget:this,pluginsList:_a5e,pluginsArgs:_a5f});console.log("Agua.loadPlugins    After load PluginManager");if(this.controllers["home"]){console.log("Agua.loadPlugins    this.controllers[home].createTab()");this.controllers["home"].createTab();}},setStandby:function(){console.log("Agua.setStandby    _GroupDragPane.setStandby()");if(this.standby!=null){return this.standby;}var id=dijit.getUniqueId("dojox_widget_Standby");this.standby=new dojox.widget.Standby({target:this.containerNode,centerIndicator:"text",text:"Waiting for remote featureName",id:id,url:"plugins/core/images/agua-biwave-24.png"});document.body.appendChild(this.standby.domNode);dojo.addClass(this.standby.domNode,"view");dojo.addClass(this.standby.domNode,"standby");console.log("Agua.setStandby    this.standby: "+this.standby);return this.standby;},addWidget:function(type,_a60){if(Agua.widgets[type]==null){Agua.widgets[type]=new Array;}Agua.widgets[type].push(_a60);},removeWidget:function(type,_a61){console.log("Agua.removeWidget    core.Agua.removeWidget(type, widget)");console.log("Agua.removeWidget    type: "+type);console.log("Agua.removeWidget    widget: "+_a61);if(Agua.widgets[type]==null){console.log("Agua.removeWidget    No widgets of type: "+type);return;}console.log("Agua.removeWidget    BEFORE Agua.widgets[type].length: "+Agua.widgets[type].length);for(var i=0;i<Agua.widgets[type].length;i++){if(Agua.widgets[type][i].id==_a61.id){Agua.widgets[type].splice(i,1);}}console.log("Agua.removeWidget    AFTER Agua.widgets[type].length: "+Agua.widgets[type].length);},addToolbarButton:function(_a62){console.log("Agua.addToolbarButton    label: "+_a62);console.log("Agua.addToolbarButton    this.toolbar: "+this.toolbar);if(this.toolbar==null){return;}var _a63=new dijit.form.Button({label:_a62,showLabel:true,iconClass:"dijitEditorIcon dijitEditorIcon"+_a62});this.toolbar.addChild(_a63);return _a63;},cookie:function(name,_a64){if(_a64!=null){this.cookies[name]=_a64;}else{if(name!=null){return this.cookies[name];}}return 0;},loadCSSFile:function(_a65){if(this.loadedCssFiles==null||!this.loadedCssFiles){this.loadedCssFiles=new Object;}if(!this.loadedCssFiles[_a65]){console.log("Agua.loadCSSFile    Loading cssFile: "+_a65);var _a66=document.createElement("link");_a66.type="text/css";_a66.rel="stylesheet";_a66.href=_a65;document.getElementsByTagName("head")[0].appendChild(_a66);this.loadedCssFiles[_a65]=1;}else{}return this.loadedCssFiles;},fetchJsonData:function(){console.log("Agua.fetchJsonData    plugins.core.Agua.fetchJsonData()");var url=this.dataUrl;console.log("Agua.fetchJsonData    url: "+url);var _a67=this;dojo.xhrGet({url:url,sync:true,handleAs:"json",handle:function(data){console.log("Agua.fetchJsonData    Setting this.data: "+data);_a67.data=data;},error:function(){console.log("Agua.Error with JSON Post, response: "+response);}});},reload:function(){var url=window.location;window.open(location,"_blank","toolbar=1,location=0,directories=0,status=0,menubar=1,scrollbars=1,resizable=1,navigation=0");},logout:function(){console.clear();var _a68=Agua.toolbar.getChildren();if(!_a68){return;}for(var i=0;i<_a68.length;i++){var _a69=_a68[i];controller=_a69.parentWidget;console.log("Agua.logout    controller "+i);console.dir({controller:controller});var name=controller.id.match(/plugins_([^_]+)/)[1];console.log("Agua.logout    Doing delete Agua.controllers["+name+"]");delete Agua.controllers[name];console.log("Agua.logout    Doing controllers.destroyRecursive()");controller.destroyRecursive();}delete this.data;}});}if(!dojo._hasResource["plugins.core.Agua.Admin"]){dojo._hasResource["plugins.core.Agua.Admin"]=true;dojo.provide("plugins.core.Agua.Admin");dojo.declare("plugins.core.Agua.Admin",[],{getAdminHeadings:function(){console.log("Agua.Admin.getAdminHeadings    plugins.core.Data.getAdminHeadings()");var _a6a=this.cloneData("adminheadings");console.log("Agua.Admin.getAdminHeadings    headings: "+dojo.toJson(_a6a));return _a6a;},getAccess:function(){return this.cloneData("access");}});}if(!dojo._hasResource["plugins.core.PluginController"]){dojo._hasResource["plugins.core.PluginController"]=true;dojo.provide("plugins.core.PluginController");dojo.declare("plugins.core.PluginController",[dijit._Widget,dijit._Templated,plugins.core.Common],{paneId:null,templatePath:null,widgetsInTemplate:true,cssFiles:[],tabPanes:[],tabClass:null,constructor:function(args){this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);Agua.toolbar.addChild(this.menuButton);this.menuButton.parentWidget=this;var _a6b=dojo.connect(this.menuButton,"onClick",this,"createTab",{});},createTab:function(args){console.log("core.Controller.createTab    args: ");console.dir({args:args});window.getSelection().removeAllRanges();if(!args){args={};}var _a6c=dojo.getObject(this.tabClass);var _a6d=new _a6c(args);this.tabPanes.push(_a6d);this._supportingWidgets.push(_a6d);}});dojo.addOnLoad(function(){});}if(!dojo._hasResource["plugins.data.Controller"]){dojo._hasResource["plugins.data.Controller"]=true;dojo.provide("plugins.data.Controller");dojo.declare("plugins.data.Controller",[plugins.core.Common],{name:"plugins.data.Controller",version:"0.01",description:"Load data from remote host",url:"",dependencies:[],data:null,constructor:function(args){console.log("data.Controller.constructor     plugins.data.Controller.constructor");this.startup();},startup:function(){console.log("data.Controller.startup    plugins.data.Controller.startup()");console.log("data.Controller.startup    Data: "+Data);if(Data!=null){if(Data.data!=null){console.log("data.Controller.startup    Data.data: ");console.dir({data:Data.data});this.data=Data.data;Agua.data=Data.data;}else{this.getData();}}else{this.getData();}Data=this;},getData:function(){console.log("data.Controller.getData    plugins.data.Controller.getData()");console.log("data.Controller.getData    Agua.dataUrl: "+Agua.dataUrl);if(Agua.dataUrl!=null){return this.fetchJsonData();}var url=Agua.cgiUrl+"workflow.cgi";var _a6e=new Object;_a6e.username=Agua.cookie("username");_a6e.sessionid=Agua.cookie("sessionid");if(Agua.database){_a6e.database=Agua.database;}_a6e.mode="getData";console.log("data.Controller.getData    query: ");console.dir({query:_a6e});if(Data==null){Data=new Object;}var _a6f=this;dojo.xhrPut({url:url,putData:dojo.toJson(_a6e),handleAs:"json",preventCache:true,sync:true,load:function(_a70,_a71){if(_a70.error){Agua.error(_a70.error);}else{Data.data=_a70;_a6f.data=_a70;Agua.data=_a70;console.log("data.Controller.getData    BEFORE thisObject.responseToData(response)");Agua.displayVersion();}},error:function(_a72,_a73){console.log("Error with JSON Post, response: "+dojo.toJson(_a72)+", ioArgs: "+dojo.toJson(_a73));}});if(this.testing){Agua.cgiUrl="../";}return null;},fetchJsonData:function(){console.log("data.Controller.fetchJsonData    plugins.data.Controller.fetchJsonData()");var url=Agua.dataUrl;console.log("data.Controller.fetchJsonData    url: "+url);console.log("data.Controller.fetchJsonData    DOING dojo.xhrGet");var _a74=this;dojo.xhrGet({url:url,sync:true,handleAs:"json",load:function(_a75){console.log("data.Controller.fetchJsonData    response: ",dojo.toJson(_a75));if(Data!=null){Data.data=_a75;}Agua.data=_a75;},error:function(){Agua.error("Failed to fetch data");}});},getTable:function(_a76){console.log("data.Controller.getTable    plugins.data.Controller.getTable(table)");console.log("data.Controller.getTable    table: "+_a76);if(Agua.dataUrl!=null){console.log("data.Controller.getTable    Agua.dataUrl: "+Agua.dataUrl);console.log("data.Controller.getTable    Agua.dataUrl not null. Doing return this.fetchJsonData()");return this.fetchJsonData();}var url=Agua.cgiUrl+"workflow.cgi";var _a77=new Object;_a77.username=Agua.cookie("username");_a77.sessionid=Agua.cookie("sessionid");if(this.database!=null){_a77.database=this.database;}_a77.mode="getTable";_a77.table=_a76;console.log("data.Controller.getTable    query: "+dojo.toJson(_a77,true));var _a78=this;dojo.xhrPut({url:url,putData:dojo.toJson(_a77),handleAs:"json",sync:true,load:function(_a79,_a7a){console.log("data.Controller.JSON Post worked.");if(_a79.error){console.log("data.Controller.getTable    xhrPut error: "+_a79.error);}else{_a78.responseToData(_a79);}},error:function(_a7b,_a7c){console.log("data.Controller.Error with JSON Post, response: "+_a7b+", ioArgs: "+_a7c);}});},responseToData:function(_a7d){console.log("data.Controller.responseToData    response: "+_a7d);console.log("data.Controller.responseToData    response: "+dojo.toJson(_a7d));var keys=this.hashkeysToArray(_a7d);keys.sort();var _a7e=this;dojo.forEach(keys,function(key){console.log("data.Controller.getData    storing key: "+key);Agua.data[key]=_a7d[key];});},destroyRecursive:function(){dojo.destroy(this);}});}if(!dojo._hasResource["dojox.data.FileStore"]){dojo._hasResource["dojox.data.FileStore"]=true;dojo.provide("dojox.data.FileStore");dojo.declare("dojox.data.FileStore",null,{constructor:function(args){if(args&&args.label){this.label=args.label;}if(args&&args.url){this.url=args.url;}if(args&&args.options){if(dojo.isArray(args.options)){this.options=args.options;}else{if(dojo.isString(args.options)){this.options=args.options.split(",");}}}if(args&&args.pathAsQueryParam){this.pathAsQueryParam=true;}if(args&&"urlPreventCache" in args){this.urlPreventCache=args.urlPreventCache?true:false;}},url:"",_storeRef:"_S",label:"name",_identifier:"path",_attributes:["children","directory","name","path","modified","size","parentDir"],pathSeparator:"/",options:[],failOk:false,urlPreventCache:true,_assertIsItem:function(item){if(!this.isItem(item)){throw new Error("dojox.data.FileStore: a function was passed an item argument that was not an item");}},_assertIsAttribute:function(_a7f){if(typeof _a7f!=="string"){throw new Error("dojox.data.FileStore: a function was passed an attribute argument that was not an attribute name string");}},pathAsQueryParam:false,getFeatures:function(){return {"dojo.data.api.Read":true,"dojo.data.api.Identity":true};},getValue:function(item,_a80,_a81){var _a82=this.getValues(item,_a80);if(_a82&&_a82.length>0){return _a82[0];}return _a81;},getAttributes:function(item){return this._attributes;},hasAttribute:function(item,_a83){this._assertIsItem(item);this._assertIsAttribute(_a83);return (_a83 in item);},getIdentity:function(item){console.log("dojox.data.FileStore.getIdentity    caller: "+this.isItem.caller.nom);console.log("dojox.data.FileStore.getIdentity    item: "+dojo.toJson(item));return this.getValue(item,this._identifier);},getIdentityAttributes:function(item){return [this._identifier];},isItemLoaded:function(item){var _a84=this.isItem(item);if(_a84&&typeof item._loaded=="boolean"&&!item._loaded){_a84=false;}return _a84;},loadItem:function(_a85){var item=_a85.item;var self=this;var _a86=_a85.scope||dojo.global;var _a87={};if(this.options.length>0){_a87.options=dojo.toJson(this.options);}if(this.pathAsQueryParam){_a87.path=item.parentPath+this.pathSeparator+item.name;}var _a88={url:this.pathAsQueryParam?this.url:this.url+"/"+item.parentPath+"/"+item.name,handleAs:"json-comment-optional",content:_a87,preventCache:this.urlPreventCache,failOk:this.failOk};var _a89=dojo.xhrGet(_a88);_a89.addErrback(function(_a8a){if(_a85.onError){_a85.onError.call(_a86,_a8a);}});_a89.addCallback(function(data){delete item.parentPath;delete item._loaded;dojo.mixin(item,data);self._processItem(item);if(_a85.onItem){_a85.onItem.call(_a86,item);}});},getLabel:function(item){return this.getValue(item,this.label);},getLabelAttributes:function(item){return [this.label];},containsValue:function(item,_a8b,_a8c){var _a8d=this.getValues(item,_a8b);for(var i=0;i<_a8d.length;i++){if(_a8d[i]==_a8c){return true;}}return false;},getValues:function(item,_a8e){this._assertIsItem(item);this._assertIsAttribute(_a8e);var _a8f=item[_a8e];if(typeof _a8f!=="undefined"&&!dojo.isArray(_a8f)){_a8f=[_a8f];}else{if(typeof _a8f==="undefined"){_a8f=[];}}return _a8f;},isItem:function(item){console.log("dojox.data.FileStore.isItem    caller: "+this.isItem.caller.nom);console.log("dojox.data.FileStore.isItem    item: ");console.dir({item:item});console.log("dojox.data.FileStore.isItem    this._storeRef: "+this._storeRef);console.log("dojox.data.FileStore.isItem    item[this._storeRef]: "+item[this._storeRef]);if(item&&item[this._storeRef]===this){return true;}return false;},close:function(_a90){},fetch:function(_a91){console.log("dojox.data.FileStore.fetch    caller: "+this.fetch.caller.nom);console.log("dojox.data.FileStore.fetch    request: ");console.dir({request:_a91});_a91=_a91||{};if(!_a91.store){_a91.store=this;}var self=this;var _a92=_a91.scope||dojo.global;var _a93={};if(_a91.query){_a93.query=dojo.toJson(_a91.query);}if(_a91.sort){_a93.sort=dojo.toJson(_a91.sort);}if(_a91.queryOptions){_a93.queryOptions=dojo.toJson(_a91.queryOptions);}if(typeof _a91.start=="number"){_a93.start=""+_a91.start;}if(typeof _a91.count=="number"){_a93.count=""+_a91.count;}if(this.options.length>0){_a93.options=dojo.toJson(this.options);}console.log("dojox.data.FileStore.fetch    reqParams:");console.dir({reqParams:_a93});var _a94={url:this.url,preventCache:this.urlPreventCache,failOk:this.failOk,handleAs:"json-comment-optional",content:_a93};var _a95=dojo.xhrGet(_a94);_a95.addCallback(function(data){self._processResult(data,_a91);});_a95.addErrback(function(_a96){if(_a91.onError){_a91.onError.call(_a92,_a96,_a91);}});},fetchItemByIdentity:function(_a97){var path=_a97.identity;var self=this;var _a98=_a97.scope||dojo.global;var _a99={};if(this.options.length>0){_a99.options=dojo.toJson(this.options);}if(this.pathAsQueryParam){_a99.path=path;}var _a9a={url:this.pathAsQueryParam?this.url:this.url+"/"+path,handleAs:"json-comment-optional",content:_a99,preventCache:this.urlPreventCache,failOk:this.failOk};var _a9b=dojo.xhrGet(_a9a);_a9b.addErrback(function(_a9c){if(_a97.onError){_a97.onError.call(_a98,_a9c);}});_a9b.addCallback(function(data){var item=self._processItem(data);if(_a97.onItem){_a97.onItem.call(_a98,item);}});},_processResult:function(data,_a9d){var _a9e=_a9d.scope||dojo.global;try{if(data.pathSeparator){this.pathSeparator=data.pathSeparator;}if(_a9d.onBegin){_a9d.onBegin.call(_a9e,data.total,_a9d);}var _a9f=this._processItemArray(data.items);if(_a9d.onItem){var i;for(i=0;i<_a9f.length;i++){_a9d.onItem.call(_a9e,_a9f[i],_a9d);}_a9f=null;}if(_a9d.onComplete){_a9d.onComplete.call(_a9e,_a9f,_a9d);}}catch(e){if(_a9d.onError){_a9d.onError.call(_a9e,e,_a9d);}else{console.log(e);}}},_processItemArray:function(_aa0){var i;for(i=0;i<_aa0.length;i++){this._processItem(_aa0[i]);}return _aa0;},_processItem:function(item){if(!item){return null;}item[this._storeRef]=this;if(item.children&&item.directory){if(dojo.isArray(item.children)){var _aa1=item.children;var i;for(i=0;i<_aa1.length;i++){var name=_aa1[i];if(dojo.isObject(name)){_aa1[i]=this._processItem(name);}else{_aa1[i]={name:name,_loaded:false,parentPath:item.path};_aa1[i][this._storeRef]=this;}}}else{delete item.children;}}return item;}});}if(!dojo._hasResource["plugins.data.FileStore"]){dojo._hasResource["plugins.data.FileStore"]=true;dojo.provide("plugins.data.FileStore");dojo.declare("plugins.data.FileStore",[dojox.data.FileStore],{_processItemArray:function(_aa2){if(_aa2==null){return [];}var i;for(i=0;i<_aa2.length;i++){this._processItem(_aa2[i]);}return _aa2;},_assertIsItem:function(item){if(item==null){return false;}if(!this.isItem(item)){throw new Error("dojox.data.FileStore: a function was passed an item argument that was not an item");}},});}if(!dojo._hasResource["plugins.dnd.Target"]){dojo._hasResource["plugins.dnd.Target"]=true;dojo.provide("plugins.dnd.Target");dojo.declare("plugins.dnd.Target",[dojo.dnd.Target],{contextMenu:null,parentWidget:null,droppingApp:null,dragTypes:["draggableItem"],constructor:function(node,_aa3){console.log("Target.constructor    params: "+_aa3);console.log("Target.constructor    params.contextMenu: "+_aa3.contextMenu);console.log("Target.constructor    params.this.parentWidget: "+_aa3.parentWidget);this.contextMenu=_aa3.contextMenu;this.parentWidget=_aa3.parentWidget;this.core=_aa3.core;if(_aa3&&_aa3.dragTypes){this.dragTypes=_aa3.dragTypes;}this.isSource=false;dojo.removeClass(this.node,"dojoDndSource");},resetDropping:function(){this.droppingApp=false;},onDndDrop:function(_aa4,_aa5,copy){console.log("Target.onDndDrop    XXXXXXXXXXXXXXXXXXXXXXXX this.droppingApp: "+this.droppingApp);var _aa6=this.checkAcceptance(_aa4,_aa5);console.log("Target.onDndDrop    XXXXXXXXXXXXXXXXXXXXXXXX acceptance: "+_aa6);if(!_aa6){console.log("Target.onDndDrop    acceptance is FALSE. Returning");return;}if(!this.accept||this.accept.length<1){console.log("Target.onDndDrop    this.accept is empty. Returning");return;}if(this.droppingApp){console.log("Target.onDndDrop    this.droppingApp is true. Returning");return;}else{this.droppingApp=true;}console.log("Target.onDndDrop    Set this.droppingApp: "+this.droppingApp);console.log("Target.onDndDrop    this: "+this);console.log("Target.onDndDrop    source: ");console.dir({source:_aa4});console.log("Target.onDndDrop    nodes.length: "+_aa5.length);console.log("Target.onDndDrop    nodes[0].data: "+_aa5[0].data);console.dir({nodes_0:_aa5[0]});var _aa7=this;if(_aa5[0].data==null){return;}var _aa8;do{if(this.containerState!="Over"){break;}var _aa9=this._normalizedCreator;if(this!=_aa4){this._normalizedCreator=function(node,hint){var t=_aa4.getItem(node.id);var n=node.cloneNode(true);n.parentWidget=node.parentWidget;n.id=dojo.dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}this._removeSelection();if(this!=_aa4){this._removeAnchor();}if(this!=_aa4&&!copy&&!this.creator){_aa4.selectNone();}this.insertNodes(true,_aa5,this.before,this.current);this.sync();var _aaa=false;var _aab=this.getAllNodes();console.log("Target.onDndDrop    allNodes: "+_aab);console.log("Target.onDndDrop    allNodes.length: "+_aab.length);dojo.forEach(_aab,function(node,i){if(node.application==null){node.application=dojo.clone(_aa5[0].data);console.log("Target.onDndDrop    Setting node.application: ");console.dir({node_application:node.application});node.application.appname=node.application.name;node.application.appnumber=(i+1).toString();node.application.number=(i+1).toString();node.number=(i+1).toString();if(node.application["cluster"]==null){node.application["cluster"]="";}var _aac=_aa7.core.userWorkflows.getProject();var _aad=_aa7.core.userWorkflows.getWorkflow();node.application.project=_aac;node.application.workflow=_aad;var _aae=Agua._getWorkflow({name:_aad,project:_aac});console.log("Target.onDndDrop    workflowobject: ");console.dir({workflowobject:_aae});var _aaf=_aae.number;console.log("Target.onDndDrop    workflownumber: "+_aaf);node.application.workflownumber=dojo.clone(_aaf);node.application.username=Agua.cookie("username");console.log("Target.onDndDrop    node.application: ");console.dir({application:node.application});var _ab0=new plugins.workflow.StageRow(node.application);console.log("Target.onDndDrop    stageRow: "+_ab0);console.log("Target.onDndDrop    stageRow.domNode: "+_ab0.domNode);console.log("Target.onDndDrop    stageRow.application: "+dojo.toJson(_ab0.application));_ab0.core=_aa7.core;_ab0.workflowWidget=_aa7.core.userWorkflows.parentWidget;node.innerHTML="";node.appendChild(_ab0.domNode);_aa7.contextMenu.bind(node);node.parentWidget=_ab0;console.log("Target.onDndDrop    node.id: "+node.id);console.log("Target.onDndDrop    Set node.parentWidget: "+node.parentWidget);console.log("Target.onDndDrop    BEFORE    Agua.insertStage(node.application)");var _ab1=Agua.insertStage(node.application);if(!_ab1){console.log("Target.onDndDrop    Failed to add stage to Agua data");console.log("Target.onDndDrop    Setting thisObject.droppingApp to false and returning");setTimeout(_aa7.resetDropping,1000);return;}console.log("Target.onDndDrop    AFTER    Agua.insertStage(node.application)");node.onclick=function(e){console.log("Target.onDndDrop    node.onclick fired, calling thisObject.core.userWorkflows.loadParametersPane(node, null)");console.log("Target.onDndDrop    node: "+node);_aa7.core.userWorkflows.loadParametersPane(node,null);};_aa7.contextMenu.bind(node);_aa7.core.userWorkflows.getChainedValues(node);_aaa=true;console.log("Target.onDndDrop    Setting thisObject.droppingApp = false");_aa7.droppingApp=false;_aa8=node;return;}console.log("Target.onDndDrop    belowInsertedNode: "+_aaa);if(_aaa==true){console.log("Target.onDndDrop    node "+i+" is belowInsertedNode");console.log("Target.onDndDrop    DOING thisObject.core.io.chainStage(node.application, force)");console.log("Target.onDndDrop    thisObject.core.userWorkflows: "+_aa7.core.userWorkflows);var _ab2=true;console.log("Target.onDndDrop    Doing thisObject.core.io.chainStage(node.application, force)");_aa7.core.io.chainStage(node.application,_ab2);}});console.log("Target.onDndDrop    BEFORE thisObject.droppingApp = false");console.log("Target.onDndDrop    thisObject.core.userWorkflows: "+_aa7.core.userWorkflows);_aa7.droppingApp=false;_aa7._normalizedCreator=_aa9;}while(false);setTimeout(function(){console.log("Target.onDndDrop    Doing this.core.userWorkflows.resetNumbers()");_aa7.core.userWorkflows.resetNumbers();console.log("Target.onDndDrop    Setting this.core.runStatus.polling TO FALSE");if(_aa7.core.runStatus){_aa7.core.runStatus.polling=false;}console.log("Target.onDndDrop    Doing this.core.userWorkflows.loadParametersPane(newNode)");console.dir({thisObject:_aa7});_aa7.core.userWorkflows.loadParametersPane(_aa8);},100);console.log("Target.onDndDrop    BEFORE this.onDndCancel");this.onDndCancel();console.log("Target.onDndDrop    END OF this.onDndCancel");}});}if(!dojo._hasResource["dojox.html.metrics"]){dojo._hasResource["dojox.html.metrics"]=true;dojo.provide("dojox.html.metrics");(function(){var dhm=dojox.html.metrics;dhm.getFontMeasurements=function(){var _ab3={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,"small":0,"medium":0,"large":0,"x-large":0,"xx-large":0};if(dojo.isIE){dojo.doc.documentElement.style.fontSize="100%";}var div=dojo.doc.createElement("div");var ds=div.style;ds.position="absolute";ds.left="-100px";ds.top="0";ds.width="30px";ds.height="1000em";ds.borderWidth="0";ds.margin="0";ds.padding="0";ds.outline="0";ds.lineHeight="1";ds.overflow="hidden";dojo.body().appendChild(div);for(var p in _ab3){ds.fontSize=p;_ab3[p]=Math.round(div.offsetHeight*12/16)*16/12/1000;}dojo.body().removeChild(div);div=null;return _ab3;};var _ab4=null;dhm.getCachedFontMeasurements=function(_ab5){if(_ab5||!_ab4){_ab4=dhm.getFontMeasurements();}return _ab4;};var _ab6=null,_ab7={};dhm.getTextBox=function(text,_ab8,_ab9){var m,s;if(!_ab6){m=_ab6=dojo.doc.createElement("div");var c=dojo.doc.createElement("div");c.appendChild(m);s=c.style;s.overflow="scroll";s.position="absolute";s.left="0px";s.top="-10000px";s.width="1px";s.height="1px";s.visibility="hidden";s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";dojo.body().appendChild(c);}else{m=_ab6;}m.className="";s=m.style;s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";if(arguments.length>1&&_ab8){for(var i in _ab8){if(i in _ab7){continue;}s[i]=_ab8[i];}}if(arguments.length>2&&_ab9){m.className=_ab9;}m.innerHTML=text;var box=dojo.position(m);box.w=m.parentNode.scrollWidth;return box;};var _aba={w:16,h:16};dhm.getScrollbar=function(){return {w:_aba.w,h:_aba.h};};dhm._fontResizeNode=null;dhm.initOnFontResize=function(_abb){var f=dhm._fontResizeNode=dojo.doc.createElement("iframe");var fs=f.style;fs.position="absolute";fs.width="5em";fs.height="10em";fs.top="-10000px";if(dojo.isIE){f.onreadystatechange=function(){if(f.contentWindow.document.readyState=="complete"){f.onresize=f.contentWindow.parent[dojox._scopeName].html.metrics._fontresize;}};}else{f.onload=function(){f.contentWindow.onresize=f.contentWindow.parent[dojox._scopeName].html.metrics._fontresize;};}f.setAttribute("src","javascript:'<html><head><script>if(\"loadFirebugConsole\" in window){window.loadFirebugConsole();}</script></head><body></body></html>'");dojo.body().appendChild(f);dhm.initOnFontResize=function(){};};dhm.onFontResize=function(){};dhm._fontresize=function(){dhm.onFontResize();};dojo.addOnUnload(function(){var f=dhm._fontResizeNode;if(f){if(dojo.isIE&&f.onresize){f.onresize=null;}else{if(f.contentWindow&&f.contentWindow.onresize){f.contentWindow.onresize=null;}}dhm._fontResizeNode=null;}});dojo.addOnLoad(function(){try{var n=dojo.doc.createElement("div");n.style.cssText="top:0;left:0;width:100px;height:100px;overflow:scroll;position:absolute;visibility:hidden;";dojo.body().appendChild(n);_aba.w=n.offsetWidth-n.clientWidth;_aba.h=n.offsetHeight-n.clientHeight;dojo.body().removeChild(n);delete n;}catch(e){}if("fontSizeWatch" in dojo.config&&!!dojo.config.fontSizeWatch){dhm.initOnFontResize();}});})();}if(!dojo._hasResource["dojox.widget.RollingList"]){dojo._hasResource["dojox.widget.RollingList"]=true;dojo.provide("dojox.widget.RollingList");dojo.experimental("dojox.widget.RollingList");dojo.declare("dojox.widget._RollingListPane",[dijit.layout.ContentPane,dijit._Templated,dijit._Contained],{templateString:"<div class=\"dojoxRollingListPane\"><table><tbody><tr><td dojoAttachPoint=\"containerNode\"></td></tr></tbody></div>",parentWidget:null,parentPane:null,store:null,items:null,query:null,queryOptions:null,_focusByNode:true,minWidth:0,_setContentAndScroll:function(cont,_abc){this._setContent(cont,_abc);this.parentWidget.scrollIntoView(this);},_updateNodeWidth:function(n,min){n.style.width="";var _abd=dojo.marginBox(n).w;if(_abd<min){dojo.marginBox(n,{w:min});}},_onMinWidthChange:function(v){this._updateNodeWidth(this.domNode,v);},_setMinWidthAttr:function(v){if(v!==this.minWidth){this.minWidth=v;this._onMinWidthChange(v);}},startup:function(){if(this._started){return;}if(this.store&&this.store.getFeatures()["dojo.data.api.Notification"]){window.setTimeout(dojo.hitch(this,function(){this.connect(this.store,"onSet","_onSetItem");this.connect(this.store,"onNew","_onNewItem");this.connect(this.store,"onDelete","_onDeleteItem");}),1);}this.connect(this.focusNode||this.domNode,"onkeypress","_focusKey");this.parentWidget._updateClass(this.domNode,"Pane");this.inherited(arguments);this._onMinWidthChange(this.minWidth);},_focusKey:function(e){if(e.charOrCode==dojo.keys.BACKSPACE){dojo.stopEvent(e);return;}else{if(e.charOrCode==dojo.keys.LEFT_ARROW&&this.parentPane){this.parentPane.focus();this.parentWidget.scrollIntoView(this.parentPane);}else{if(e.charOrCode==dojo.keys.ENTER){this.parentWidget._onExecute();}}}},focus:function(_abe){if(this.parentWidget._focusedPane!=this){this.parentWidget._focusedPane=this;this.parentWidget.scrollIntoView(this);if(this._focusByNode&&(!this.parentWidget._savedFocus||_abe)){try{(this.focusNode||this.domNode).focus();}catch(e){}}}},_onShow:function(){if((this.store||this.items)&&((this.refreshOnShow&&this.domNode)||(!this.isLoaded&&this.domNode))){console.log("dojox.widget.RollingListPane._onShow    Doing this.refresh()");this.refresh();}},_load:function(){console.log("dojox.widget.RollingListPane._load    caller: "+this._load.caller.nom);this.isLoaded=false;if(this.items){this._setContentAndScroll(this.onLoadStart(),true);window.setTimeout(dojo.hitch(this,"_doQuery"),1);}else{console.log("dojox.widget.RollingListPane._load    Doing this._doQuery()");this._doQuery();}},_doLoadItems:function(_abf,_ac0){var _ac1=0,_ac2=this.store;dojo.forEach(_abf,function(item){if(!_ac2.isItemLoaded(item)){_ac1++;}});if(_ac1===0){_ac0();}else{var _ac3=function(item){_ac1--;if((_ac1)===0){_ac0();}};dojo.forEach(_abf,function(item){if(!_ac2.isItemLoaded(item)){_ac2.loadItem({item:item,onItem:_ac3});}});}},_doQuery:function(){if(!this.domNode){return;}var _ac4=this.parentWidget.preloadItems;_ac4=(_ac4===true||(this.items&&this.items.length<=Number(_ac4)));if(this.items&&_ac4){this._doLoadItems(this.items,dojo.hitch(this,"onItems"));}else{if(this.items){this.onItems();}else{this._setContentAndScroll(this.onFetchStart(),true);console.log("dojox.widget.RollingList._doQuery    this.query: "+this.query);this.store.fetch({query:this.query,onComplete:function(_ac5){this.items=_ac5;this.onItems();},onError:function(e){this._onError("Fetch",e);},scope:this});}}},_hasItem:function(item){var _ac6=this.items||[];for(var i=0,_ac7;(_ac7=_ac6[i]);i++){if(this.parentWidget._itemsMatch(_ac7,item)){return true;}}return false;},_onSetItem:function(item,_ac8,_ac9,_aca){if(this._hasItem(item)){this.refresh();}},_onNewItem:function(_acb,_acc){var sel;if((!_acc&&!this.parentPane)||(_acc&&this.parentPane&&this.parentPane._hasItem(_acc.item)&&(sel=this.parentPane._getSelected())&&this.parentWidget._itemsMatch(sel.item,_acc.item))){this.items.push(_acb);this.refresh();}else{if(_acc&&this.parentPane&&this._hasItem(_acc.item)){this.refresh();}}},_onDeleteItem:function(_acd){if(this._hasItem(_acd)){this.items=dojo.filter(this.items,function(i){return (i!=_acd);});this.refresh();}},onFetchStart:function(){return this.loadingMessage;},onFetchError:function(_ace){return this.errorMessage;},onLoadStart:function(){return this.loadingMessage;},onLoadError:function(_acf){return this.errorMessage;},onItems:function(){if(!this.onLoadDeferred){this.cancel();this.onLoadDeferred=new dojo.Deferred(dojo.hitch(this,"cancel"));}console.log("RollingList.onItems    Doing this._onLoadHandler()");this._onLoadHandler();}});dojo.declare("dojox.widget._RollingListGroupPane",[dojox.widget._RollingListPane],{templateString:"<div><div dojoAttachPoint=\"containerNode\"></div>"+"<div dojoAttachPoint=\"menuContainer\">"+"<div dojoAttachPoint=\"menuNode\"></div>"+"</div></div>",_menu:null,_setContent:function(cont){if(!this._menu){this.inherited(arguments);}},_onMinWidthChange:function(v){if(!this._menu){return;}var _ad0=dojo.marginBox(this.domNode).w;var _ad1=dojo.marginBox(this._menu.domNode).w;this._updateNodeWidth(this._menu.domNode,v-(_ad0-_ad1));},onItems:function(){var _ad2,_ad3=false;if(this._menu){_ad2=this._getSelected();this._menu.destroyRecursive();}this._menu=this._getMenu();var _ad4,_ad5;if(this.items.length){dojo.forEach(this.items,function(item){_ad4=this.parentWidget._getMenuItemForItem(item,this);if(_ad4){if(_ad2&&this.parentWidget._itemsMatch(_ad4.item,_ad2.item)){_ad5=_ad4;}this._menu.addChild(_ad4);}},this);}else{_ad4=this.parentWidget._getMenuItemForItem(null,this);if(_ad4){this._menu.addChild(_ad4);}}if(_ad5){this._setSelected(_ad5);if((_ad2&&!_ad2.children&&_ad5.children)||(_ad2&&_ad2.children&&!_ad5.children)){var _ad6=this.parentWidget._getPaneForItem(_ad5.item,this,_ad5.children);if(_ad6){this.parentWidget.addChild(_ad6,this.getIndexInParent()+1);}else{this.parentWidget._removeAfter(this);this.parentWidget._onItemClick(null,this,_ad5.item,_ad5.children);}}}else{if(_ad2){this.parentWidget._removeAfter(this);}}this.containerNode.innerHTML="";this.containerNode.appendChild(this._menu.domNode);this.parentWidget.scrollIntoView(this);this._checkScrollConnection(true);this.inherited(arguments);this._onMinWidthChange(this.minWidth);},_checkScrollConnection:function(_ad7){var _ad8=this.store;if(this._scrollConn){this.disconnect(this._scrollConn);}delete this._scrollConn;if(!dojo.every(this.items,function(i){return _ad8.isItemLoaded(i);})){if(_ad7){this._loadVisibleItems();}this._scrollConn=this.connect(this.domNode,"onscroll","_onScrollPane");}},startup:function(){this.inherited(arguments);this.parentWidget._updateClass(this.domNode,"GroupPane");},focus:function(_ad9){if(this._menu){if(this._pendingFocus){this.disconnect(this._pendingFocus);}delete this._pendingFocus;var _ada=this._menu.focusedChild;if(!_ada){var _adb=dojo.query(".dojoxRollingListItemSelected",this.domNode)[0];if(_adb){_ada=dijit.byNode(_adb);}}if(!_ada){_ada=this._menu.getChildren()[0]||this._menu;}this._focusByNode=false;if(_ada.focusNode){if(!this.parentWidget._savedFocus||_ad9){try{_ada.focusNode.focus();}catch(e){}}window.setTimeout(function(){try{dojo.window.scrollIntoView(_ada.focusNode);}catch(e){}},1);}else{if(_ada.focus){if(!this.parentWidget._savedFocus||_ad9){_ada.focus();}}else{this._focusByNode=true;}}this.inherited(arguments);}else{if(!this._pendingFocus){this._pendingFocus=this.connect(this,"onItems","focus");}}},_getMenu:function(){var self=this;var menu=new dijit.Menu({parentMenu:this.parentPane?this.parentPane._menu:null,onCancel:function(_adc){if(self.parentPane){self.parentPane.focus(true);}},_moveToPopup:function(evt){if(this.focusedChild&&!this.focusedChild.disabled){this.focusedChild._onClick(evt);}}},this.menuNode);this.connect(menu,"onItemClick",function(item,evt){if(item.disabled){return;}evt.alreadySelected=dojo.hasClass(item.domNode,"dojoxRollingListItemSelected");if(evt.alreadySelected&&((evt.type=="keypress"&&evt.charOrCode!=dojo.keys.ENTER)||(evt.type=="internal"))){var p=this.parentWidget.getChildren()[this.getIndexInParent()+1];if(p){p.focus(true);this.parentWidget.scrollIntoView(p);}}else{this._setSelected(item,menu);this.parentWidget._onItemClick(evt,this,item.item,item.children);if(evt.type=="keypress"&&evt.charOrCode==dojo.keys.ENTER){this.parentWidget._onExecute();}}});if(!menu._started){menu.startup();}return menu;},_onScrollPane:function(){if(this._visibleLoadPending){window.clearTimeout(this._visibleLoadPending);}this._visibleLoadPending=window.setTimeout(dojo.hitch(this,"_loadVisibleItems"),500);},_loadVisibleItems:function(){delete this._visibleLoadPending;var menu=this._menu;if(!menu){return;}var _add=menu.getChildren();if(!_add||!_add.length){return;}var _ade=function(n,m,pb){var s=dojo.getComputedStyle(n);var r=0;if(m){r+=dojo._getMarginExtents(n,s).t;}if(pb){r+=dojo._getPadBorderExtents(n,s).t;}return r;};var _adf=_ade(this.domNode,false,true)+_ade(this.containerNode,true,true)+_ade(menu.domNode,true,true)+_ade(_add[0].domNode,true,false);var h=dojo.contentBox(this.domNode).h;var _ae0=this.domNode.scrollTop-_adf-(h/2);var _ae1=_ae0+(3*h/2);var _ae2=dojo.filter(_add,function(c){var cnt=c.domNode.offsetTop;var s=c.store;var i=c.item;return (cnt>=_ae0&&cnt<=_ae1&&!s.isItemLoaded(i));});var _ae3=dojo.map(_ae2,function(c){return c.item;});var _ae4=dojo.hitch(this,function(){var _ae5=this._getSelected();var _ae6;dojo.forEach(_ae3,function(item,idx){var _ae7=this.parentWidget._getMenuItemForItem(item,this);var _ae8=_ae2[idx];var oIdx=_ae8.getIndexInParent();menu.removeChild(_ae8);if(_ae7){if(_ae5&&this.parentWidget._itemsMatch(_ae7.item,_ae5.item)){_ae6=_ae7;}menu.addChild(_ae7,oIdx);if(menu.focusedChild==_ae8){menu.focusChild(_ae7);}}_ae8.destroy();},this);this._checkScrollConnection(false);});this._doLoadItems(_ae3,_ae4);},_getSelected:function(menu){if(!menu){menu=this._menu;}if(menu){var _ae9=this._menu.getChildren();for(var i=0,item;(item=_ae9[i]);i++){if(dojo.hasClass(item.domNode,"dojoxRollingListItemSelected")){return item;}}}return null;},_setSelected:function(item,menu){if(!menu){menu=this._menu;}if(menu){dojo.forEach(menu.getChildren(),function(i){this.parentWidget._updateClass(i.domNode,"Item",{"Selected":(item&&(i==item&&!i.disabled))});},this);}}});dojo.declare("dojox.widget.RollingList",[dijit._Widget,dijit._Templated,dijit._Container],{templateString:dojo.cache("dojox.widget","RollingList/RollingList.html","<div class=\"dojoxRollingList ${className}\"\n\t><div class=\"dojoxRollingListContainer\" dojoAttachPoint=\"containerNode\" dojoAttachEvent=\"onkeypress:_onKey\"\n\t></div\n\t><div class=\"dojoxRollingListButtons\" dojoAttachPoint=\"buttonsNode\"\n        ><button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"okButton\"\n\t\t\t\tdojoAttachEvent=\"onClick:_onExecute\">${okButtonLabel}</button\n        ><button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"cancelButton\"\n\t\t\t\tdojoAttachEvent=\"onClick:_onCancel\">${cancelButtonLabel}</button\n\t></div\n></div>\n"),widgetsInTemplate:true,className:"",store:null,query:null,queryOptions:null,childrenAttrs:["children"],parentAttr:"",value:null,executeOnDblClick:true,preloadItems:false,showButtons:false,okButtonLabel:"",cancelButtonLabel:"",minPaneWidth:0,postMixInProperties:function(){this.inherited(arguments);var loc=dojo.i18n.getLocalization("dijit","common");this.okButtonLabel=this.okButtonLabel||loc.buttonOk;this.cancelButtonLabel=this.cancelButtonLabel||loc.buttonCancel;},_setShowButtonsAttr:function(_aea){var _aeb=false;if((this.showButtons!=_aea&&this._started)||(this.showButtons==_aea&&!this.started)){_aeb=true;}dojo.toggleClass(this.domNode,"dojoxRollingListButtonsHidden",!_aea);this.showButtons=_aea;if(_aeb){if(this._started){this.layout();}else{window.setTimeout(dojo.hitch(this,"layout"),0);}}},_itemsMatch:function(_aec,_aed){if(!_aec&&!_aed){return true;}else{if(!_aec||!_aed){return false;}}return (_aec==_aed||(this._isIdentity&&this.store.getIdentity(_aec)==this.store.getIdentity(_aed)));},_removeAfter:function(idx){if(typeof idx!="number"){idx=this.getIndexOfChild(idx);}if(idx>=0){dojo.forEach(this.getChildren(),function(c,i){if(i>idx){this.removeChild(c);c.destroyRecursive();}},this);}var _aee=this.getChildren(),_aef=_aee[_aee.length-1];var _af0=null;while(_aef&&!_af0){var val=_aef._getSelected?_aef._getSelected():null;if(val){_af0=val.item;}_aef=_aef.parentPane;}if(!this._setInProgress){this._setValue(_af0);}},addChild:function(_af1,_af2){if(_af2>0){this._removeAfter(_af2-1);}this.inherited(arguments);if(!_af1._started){_af1.startup();}_af1.attr("minWidth",this.minPaneWidth);this.layout();if(!this._savedFocus){_af1.focus();}},_setMinPaneWidthAttr:function(_af3){if(_af3!==this.minPaneWidth){this.minPaneWidth=_af3;dojo.forEach(this.getChildren(),function(c){c.attr("minWidth",_af3);});}},_updateClass:function(node,type,_af4){if(!this._declaredClasses){this._declaredClasses=("dojoxRollingList "+this.className).split(" ");}dojo.forEach(this._declaredClasses,function(c){if(c){dojo.addClass(node,c+type);for(var k in _af4||{}){dojo.toggleClass(node,c+type+k,_af4[k]);}dojo.toggleClass(node,c+type+"FocusSelected",(dojo.hasClass(node,c+type+"Focus")&&dojo.hasClass(node,c+type+"Selected")));dojo.toggleClass(node,c+type+"HoverSelected",(dojo.hasClass(node,c+type+"Hover")&&dojo.hasClass(node,c+type+"Selected")));}});},scrollIntoView:function(_af5){if(this._scrollingTimeout){window.clearTimeout(this._scrollingTimeout);}delete this._scrollingTimeout;this._scrollingTimeout=window.setTimeout(dojo.hitch(this,function(){if(_af5.domNode){dojo.window.scrollIntoView(_af5.domNode);}delete this._scrollingTimeout;return;}),1);},resize:function(args){dijit.layout._LayoutWidget.prototype.resize.call(this,args);},layout:function(){var _af6=this.getChildren();if(this._contentBox){var bn=this.buttonsNode;var _af7=this._contentBox.h-dojo.marginBox(bn).h-dojox.html.metrics.getScrollbar().h;dojo.forEach(_af6,function(c){dojo.marginBox(c.domNode,{h:_af7});});}if(this._focusedPane){var foc=this._focusedPane;delete this._focusedPane;if(!this._savedFocus){foc.focus();}}else{if(_af6&&_af6.length){if(!this._savedFocus){_af6[0].focus();}}}},_onChange:function(_af8){this.onChange(_af8);},_setValue:function(_af9){delete this._setInProgress;if(!this._itemsMatch(this.value,_af9)){this.value=_af9;this._onChange(_af9);}},_setValueAttr:function(_afa){if(this._itemsMatch(this.value,_afa)&&!_afa){return;}if(this._setInProgress&&this._setInProgress===_afa){return;}this._setInProgress=_afa;if(!_afa||!this.store.isItem(_afa)){var pane=this.getChildren()[0];pane._setSelected(null);this._onItemClick(null,pane,null,null);return;}var _afb=dojo.hitch(this,function(item,_afc){var _afd=this.store,id;if(this.parentAttr&&_afd.getFeatures()["dojo.data.api.Identity"]&&((id=this.store.getValue(item,this.parentAttr))||id==="")){var cb=function(i){if(_afd.getIdentity(i)==_afd.getIdentity(item)){_afc(null);}else{_afc([i]);}};if(id===""){_afc(null);}else{if(typeof id=="string"){_afd.fetchItemByIdentity({identity:id,onItem:cb});}else{if(_afd.isItem(id)){cb(id);}}}}else{var _afe=this.childrenAttrs.length;var _aff=[];dojo.forEach(this.childrenAttrs,function(attr){var q={};q[attr]=item;_afd.fetch({query:q,scope:this,onComplete:function(_b00){if(this._setInProgress!==_afa){return;}_aff=_aff.concat(_b00);_afe--;if(_afe===0){_afc(_aff);}}});},this);}});var _b01=dojo.hitch(this,function(_b02,idx){var set=_b02[idx];var _b03=this.getChildren()[idx];var conn;if(set&&_b03){var fx=dojo.hitch(this,function(){if(conn){this.disconnect(conn);}delete conn;if(this._setInProgress!==_afa){return;}var _b04=dojo.filter(_b03._menu.getChildren(),function(i){return this._itemsMatch(i.item,set);},this)[0];if(_b04){idx++;_b03._menu.onItemClick(_b04,{type:"internal",stopPropagation:function(){},preventDefault:function(){}});if(_b02[idx]){_b01(_b02,idx);}else{this._setValue(set);this.onItemClick(set,_b03,this.getChildItems(set));}}});if(!_b03.isLoaded){conn=this.connect(_b03,"onLoad",fx);}else{fx();}}else{if(idx===0){this.set("value",null);}}});var _b05=[];var _b06=dojo.hitch(this,function(_b07){if(_b07&&_b07.length){_b05.push(_b07[0]);_afb(_b07[0],_b06);}else{if(!_b07){_b05.pop();}_b05.reverse();_b01(_b05,0);}});var ns=this.domNode.style;if(ns.display=="none"||ns.visibility=="hidden"){this._setValue(_afa);}else{if(!this._itemsMatch(_afa,this._visibleItem)){_b06([_afa]);}}},_onItemClick:function(evt,pane,item,_b08){if(evt){var _b09=this._getPaneForItem(item,pane,_b08);var _b0a=(evt.type=="click"&&evt.alreadySelected);if(_b0a&&_b09){this._removeAfter(pane.getIndexInParent()+1);var next=pane.getNextSibling();if(next&&next._setSelected){next._setSelected(null);}this.scrollIntoView(next);}else{if(_b09){this.addChild(_b09,pane.getIndexInParent()+1);if(this._savedFocus){_b09.focus(true);}}else{this._removeAfter(pane);this.scrollIntoView(pane);}}}else{if(pane){this._removeAfter(pane);this.scrollIntoView(pane);}}if(!evt||evt.type!="internal"){this._setValue(item);this.onItemClick(item,pane,_b08);}this._visibleItem=item;},_getPaneForItem:function(item,_b0b,_b0c){var ret=this.getPaneForItem(item,_b0b,_b0c);ret.store=this.store;ret.parentWidget=this;ret.parentPane=_b0b||null;if(!item){ret.query=this.query;ret.queryOptions=this.queryOptions;}else{if(_b0c){ret.items=_b0c;}else{ret.items=[item];}}return ret;},_getMenuItemForItem:function(item,_b0d){var _b0e=this.store;if(!item||!_b0e||!_b0e.isItem(item)){var i=new dijit.MenuItem({label:"---",disabled:true,iconClass:"dojoxEmpty",focus:function(){}});this._updateClass(i.domNode,"Item");return i;}else{var _b0f=_b0e.isItemLoaded(item);var _b10=_b0f?this.getChildItems(item):undefined;var _b11;if(_b10){_b11=this.getMenuItemForItem(item,_b0d,_b10);_b11.children=_b10;this._updateClass(_b11.domNode,"Item",{"Expanding":true});if(!_b11._started){var c=_b11.connect(_b11,"startup",function(){this.disconnect(c);dojo.style(this.arrowWrapper,"display","");});}else{dojo.style(_b11.arrowWrapper,"display","");}}else{_b11=this.getMenuItemForItem(item,_b0d,null);if(_b0f){this._updateClass(_b11.domNode,"Item",{"Single":true});}else{this._updateClass(_b11.domNode,"Item",{"Unloaded":true});_b11.attr("disabled",true);}}_b11.store=this.store;_b11.item=item;if(!_b11.label){_b11.attr("label",this.store.getLabel(item).replace(/</,"&lt;"));}if(_b11.focusNode){var self=this;_b11.focus=function(){if(!this.disabled){try{this.focusNode.focus();}catch(e){}}};_b11.connect(_b11.focusNode,"onmouseenter",function(){if(!this.disabled){self._updateClass(this.domNode,"Item",{"Hover":true});}});_b11.connect(_b11.focusNode,"onmouseleave",function(){if(!this.disabled){self._updateClass(this.domNode,"Item",{"Hover":false});}});_b11.connect(_b11.focusNode,"blur",function(){self._updateClass(this.domNode,"Item",{"Focus":false,"Hover":false});});_b11.connect(_b11.focusNode,"focus",function(){self._updateClass(this.domNode,"Item",{"Focus":true});self._focusedPane=_b0d;});if(this.executeOnDblClick){_b11.connect(_b11.focusNode,"ondblclick",function(){self._onExecute();});}}return _b11;}},_setStore:function(_b12){if(_b12===this.store&&this._started){return;}this.store=_b12;this._isIdentity=_b12.getFeatures()["dojo.data.api.Identity"];var _b13=this._getPaneForItem();this.addChild(_b13,0);},_onKey:function(e){if(e.charOrCode==dojo.keys.BACKSPACE){dojo.stopEvent(e);return;}else{if(e.charOrCode==dojo.keys.ESCAPE&&this._savedFocus){try{dijit.focus(this._savedFocus);}catch(e){}dojo.stopEvent(e);return;}else{if(e.charOrCode==dojo.keys.LEFT_ARROW||e.charOrCode==dojo.keys.RIGHT_ARROW){dojo.stopEvent(e);return;}}}},_resetValue:function(){this.set("value",this._lastExecutedValue);},_onCancel:function(){this._resetValue();this.onCancel();},_onExecute:function(){this._lastExecutedValue=this.get("value");this.onExecute();},focus:function(){var _b14=this._savedFocus;this._savedFocus=dijit.getFocus(this);if(!this._savedFocus.node){delete this._savedFocus;}if(!this._focusedPane){var _b15=this.getChildren()[0];if(_b15&&!_b14){_b15.focus(true);}}else{this._savedFocus=dijit.getFocus(this);var foc=this._focusedPane;delete this._focusedPane;if(!_b14){foc.focus(true);}}},handleKey:function(e){if(e.charOrCode==dojo.keys.DOWN_ARROW){delete this._savedFocus;this.focus();return false;}else{if(e.charOrCode==dojo.keys.ESCAPE){this._onCancel();return false;}}return true;},_updateChildClasses:function(){var _b16=this.getChildren();var _b17=_b16.length;dojo.forEach(_b16,function(c,idx){dojo.toggleClass(c.domNode,"dojoxRollingListPaneCurrentChild",(idx==(_b17-1)));dojo.toggleClass(c.domNode,"dojoxRollingListPaneCurrentSelected",(idx==(_b17-2)));});},startup:function(){if(this._started){return;}if(!this.getParent||!this.getParent()){this.resize();this.connect(dojo.global,"onresize","resize");}this.connect(this,"addChild","_updateChildClasses");this.connect(this,"removeChild","_updateChildClasses");this._setStore(this.store);this.set("showButtons",this.showButtons);this.inherited(arguments);this._lastExecutedValue=this.get("value");},getChildItems:function(item){var _b18,_b19=this.store;dojo.forEach(this.childrenAttrs,function(attr){var vals=_b19.getValues(item,attr);if(vals&&vals.length){_b18=(_b18||[]).concat(vals);}});return _b18;},getMenuItemForItem:function(item,_b1a,_b1b){return new dijit.MenuItem({});},getPaneForItem:function(item,_b1c,_b1d){if(!item||_b1d){return new dojox.widget._RollingListGroupPane({});}else{return null;}},onItemClick:function(item,pane,_b1e){},onExecute:function(){},onCancel:function(){},onChange:function(_b1f){}});}if(!dojo._hasResource["dojox.html._base"]){dojo._hasResource["dojox.html._base"]=true;dojo.provide("dojox.html._base");(function(){if(dojo.isIE){var _b20=/(AlphaImageLoader\([^)]*?src=(['"]))(?![a-z]+:|\/)([^\r\n;}]+?)(\2[^)]*\)\s*[;}]?)/g;}var _b21=/(?:(?:@import\s*(['"])(?![a-z]+:|\/)([^\r\n;{]+?)\1)|url\(\s*(['"]?)(?![a-z]+:|\/)([^\r\n;]+?)\3\s*\))([a-z, \s]*[;}]?)/g;var _b22=dojox.html._adjustCssPaths=function(_b23,_b24){if(!_b24||!_b23){return;}if(_b20){_b24=_b24.replace(_b20,function(_b25,pre,_b26,url,post){return pre+(new dojo._Url(_b23,"./"+url).toString())+post;});}return _b24.replace(_b21,function(_b27,_b28,_b29,_b2a,_b2b,_b2c){if(_b29){return "@import \""+(new dojo._Url(_b23,"./"+_b29).toString())+"\""+_b2c;}else{return "url("+(new dojo._Url(_b23,"./"+_b2b).toString())+")"+_b2c;}});};var _b2d=/(<[a-z][a-z0-9]*\s[^>]*)(?:(href|src)=(['"]?)([^>]*?)\3|style=(['"]?)([^>]*?)\5)([^>]*>)/gi;var _b2e=dojox.html._adjustHtmlPaths=function(_b2f,cont){var url=_b2f||"./";return cont.replace(_b2d,function(tag,_b30,name,_b31,_b32,_b33,_b34,end){return _b30+(name?(name+"="+_b31+(new dojo._Url(url,_b32).toString())+_b31):("style="+_b33+_b22(url,_b34)+_b33))+end;});};var _b35=dojox.html._snarfStyles=function(_b36,cont,_b37){_b37.attributes=[];return cont.replace(/(?:<style([^>]*)>([\s\S]*?)<\/style>|<link\s+(?=[^>]*rel=['"]?stylesheet)([^>]*?href=(['"])([^>]*?)\4[^>\/]*)\/?>)/gi,function(_b38,_b39,_b3a,_b3b,_b3c,href){var i,attr=(_b39||_b3b||"").replace(/^\s*([\s\S]*?)\s*$/i,"$1");if(_b3a){i=_b37.push(_b36?_b22(_b36,_b3a):_b3a);}else{i=_b37.push("@import \""+href+"\";");attr=attr.replace(/\s*(?:rel|href)=(['"])?[^\s]*\1\s*/gi,"");}if(attr){attr=attr.split(/\s+/);var _b3d={},tmp;for(var j=0,e=attr.length;j<e;j++){tmp=attr[j].split("=");_b3d[tmp[0]]=tmp[1].replace(/^\s*['"]?([\s\S]*?)['"]?\s*$/,"$1");}_b37.attributes[i-1]=_b3d;}return "";});};var _b3e=dojox.html._snarfScripts=function(cont,_b3f){_b3f.code="";cont=cont.replace(/<[!][-][-](.|\s)*?[-][-]>/g,function(_b40){return _b40.replace(/<(\/?)script\b/ig,"&lt;$1Script");});function _b41(src){if(_b3f.downloadRemote){src=src.replace(/&([a-z0-9#]+);/g,function(m,name){switch(name){case "amp":return "&";case "gt":return ">";case "lt":return "<";default:return name.charAt(0)=="#"?String.fromCharCode(name.substring(1)):"&"+name+";";}});dojo.xhrGet({url:src,sync:true,load:function(code){_b3f.code+=code+";";},error:_b3f.errBack});}};return cont.replace(/<script\s*(?![^>]*type=['"]?(?:dojo\/|text\/html\b))(?:[^>]*?(?:src=(['"]?)([^>]*?)\1[^>]*)?)*>([\s\S]*?)<\/script>/gi,function(_b42,_b43,src,code){if(src){_b41(src);}else{_b3f.code+=code;}return "";});};var _b44=dojox.html.evalInGlobal=function(code,_b45){_b45=_b45||dojo.doc.body;var n=_b45.ownerDocument.createElement("script");n.type="text/javascript";_b45.appendChild(n);n.text=code;};dojo.declare("dojox.html._ContentSetter",[dojo.html._ContentSetter],{adjustPaths:false,referencePath:".",renderStyles:false,executeScripts:false,scriptHasHooks:false,scriptHookReplacement:null,_renderStyles:function(_b46){this._styleNodes=[];var st,att,_b47,doc=this.node.ownerDocument;var head=doc.getElementsByTagName("head")[0];for(var i=0,e=_b46.length;i<e;i++){_b47=_b46[i];att=_b46.attributes[i];st=doc.createElement("style");st.setAttribute("type","text/css");for(var x in att){st.setAttribute(x,att[x]);}this._styleNodes.push(st);head.appendChild(st);if(st.styleSheet){st.styleSheet.cssText=_b47;}else{st.appendChild(doc.createTextNode(_b47));}}},empty:function(){this.inherited("empty",arguments);this._styles=[];},onBegin:function(){this.inherited("onBegin",arguments);var cont=this.content,node=this.node;var _b48=this._styles;if(dojo.isString(cont)){if(this.adjustPaths&&this.referencePath){cont=_b2e(this.referencePath,cont);}if(this.renderStyles||this.cleanContent){cont=_b35(this.referencePath,cont,_b48);}if(this.executeScripts){var _b49=this;var _b4a={downloadRemote:true,errBack:function(e){_b49._onError.call(_b49,"Exec","Error downloading remote script in \""+_b49.id+"\"",e);}};cont=_b3e(cont,_b4a);this._code=_b4a.code;}}this.content=cont;},onEnd:function(){var code=this._code,_b4b=this._styles;if(this._styleNodes&&this._styleNodes.length){while(this._styleNodes.length){dojo.destroy(this._styleNodes.pop());}}if(this.renderStyles&&_b4b&&_b4b.length){this._renderStyles(_b4b);}if(this.executeScripts&&code){if(this.cleanContent){code=code.replace(/(<!--|(?:\/\/)?-->|<!\[CDATA\[|\]\]>)/g,"");}if(this.scriptHasHooks){code=code.replace(/_container_(?!\s*=[^=])/g,this.scriptHookReplacement);}try{_b44(code,this.node);}catch(e){this._onError("Exec","Error eval script in "+this.id+", "+e.message,e);}}this.inherited("onEnd",arguments);},tearDown:function(){this.inherited(arguments);delete this._styles;if(this._styleNodes&&this._styleNodes.length){while(this._styleNodes.length){dojo.destroy(this._styleNodes.pop());}}delete this._styleNodes;dojo.mixin(this,dojo.getObject(this.declaredClass).prototype);}});dojox.html.set=function(node,cont,_b4c){if(!_b4c){return dojo.html._setNodeContent(node,cont,true);}else{var op=new dojox.html._ContentSetter(dojo.mixin(_b4c,{content:cont,node:node}));return op.set();}};})();}if(!dojo._hasResource["dojox.layout.ContentPane"]){dojo._hasResource["dojox.layout.ContentPane"]=true;dojo.provide("dojox.layout.ContentPane");dojo.declare("dojox.layout.ContentPane",dijit.layout.ContentPane,{adjustPaths:false,cleanContent:false,renderStyles:false,executeScripts:true,scriptHasHooks:false,constructor:function(){this.ioArgs={};this.ioMethod=dojo.xhrGet;},onExecError:function(e){},_setContent:function(cont){var _b4d=this._contentSetter;if(!(_b4d&&_b4d instanceof dojox.html._ContentSetter)){_b4d=this._contentSetter=new dojox.html._ContentSetter({node:this.containerNode,_onError:dojo.hitch(this,this._onError),onContentError:dojo.hitch(this,function(e){var _b4e=this.onContentError(e);try{this.containerNode.innerHTML=_b4e;}catch(e){console.error("Fatal "+this.id+" could not change content due to "+e.message,e);}})});}this._contentSetterParams={adjustPaths:Boolean(this.adjustPaths&&(this.href||this.referencePath)),referencePath:this.href||this.referencePath,renderStyles:this.renderStyles,executeScripts:this.executeScripts,scriptHasHooks:this.scriptHasHooks,scriptHookReplacement:"dijit.byId('"+this.id+"')"};this.inherited("_setContent",arguments);}});}if(!dojo._hasResource["dojox.layout.ResizeHandle"]){dojo._hasResource["dojox.layout.ResizeHandle"]=true;dojo.provide("dojox.layout.ResizeHandle");dojo.experimental("dojox.layout.ResizeHandle");dojo.declare("dojox.layout.ResizeHandle",[dijit._Widget,dijit._Templated],{targetId:"",targetContainer:null,resizeAxis:"xy",activeResize:false,activeResizeClass:"dojoxResizeHandleClone",animateSizing:true,animateMethod:"chain",animateDuration:225,minHeight:100,minWidth:100,constrainMax:false,maxHeight:0,maxWidth:0,fixedAspect:false,intermediateChanges:false,startTopic:"/dojo/resize/start",endTopic:"/dojo/resize/stop",templateString:"<div dojoAttachPoint=\"resizeHandle\" class=\"dojoxResizeHandle\"><div></div></div>",postCreate:function(){this.connect(this.resizeHandle,"onmousedown","_beginSizing");if(!this.activeResize){this._resizeHelper=dijit.byId("dojoxGlobalResizeHelper");if(!this._resizeHelper){this._resizeHelper=new dojox.layout._ResizeHelper({id:"dojoxGlobalResizeHelper"}).placeAt(dojo.body());dojo.addClass(this._resizeHelper.domNode,this.activeResizeClass);}}else{this.animateSizing=false;}if(!this.minSize){this.minSize={w:this.minWidth,h:this.minHeight};}if(this.constrainMax){this.maxSize={w:this.maxWidth,h:this.maxHeight};}this._resizeX=this._resizeY=false;var _b4f=dojo.partial(dojo.addClass,this.resizeHandle);switch(this.resizeAxis.toLowerCase()){case "xy":this._resizeX=this._resizeY=true;_b4f("dojoxResizeNW");break;case "x":this._resizeX=true;_b4f("dojoxResizeW");break;case "y":this._resizeY=true;_b4f("dojoxResizeN");break;}},_beginSizing:function(e){if(this._isSizing){return false;}dojo.publish(this.startTopic,[this]);this.targetWidget=dijit.byId(this.targetId);this.targetDomNode=this.targetWidget?this.targetWidget.domNode:dojo.byId(this.targetId);if(this.targetContainer){this.targetDomNode=this.targetContainer;}if(!this.targetDomNode){return false;}if(!this.activeResize){var c=dojo.position(this.targetDomNode,true);console.log(c);console.log(dojo.window.getBox());this._resizeHelper.resize({l:c.x,t:c.y,w:c.w,h:c.h});this._resizeHelper.show();}this._isSizing=true;this.startPoint={x:e.clientX,y:e.clientY};var mb=this.targetWidget?dojo.marginBox(this.targetDomNode):dojo.contentBox(this.targetDomNode);this.startSize={w:mb.w,h:mb.h};if(this.fixedAspect){var max,val;if(mb.w>mb.h){max="w";val=mb.w/mb.h;}else{max="h";val=mb.h/mb.w;}this._aspect={prop:max};this._aspect[max]=val;}this._pconnects=[];this._pconnects.push(dojo.connect(dojo.doc,"onmousemove",this,"_updateSizing"));this._pconnects.push(dojo.connect(dojo.doc,"onmouseup",this,"_endSizing"));dojo.stopEvent(e);},_updateSizing:function(e){if(this.activeResize){this._changeSizing(e);}else{var tmp=this._getNewCoords(e);if(tmp===false){return;}this._resizeHelper.resize(tmp);}e.preventDefault();},_getNewCoords:function(e){try{if(!e.clientX||!e.clientY){return false;}}catch(e){return false;}this._activeResizeLastEvent=e;var dx=(this.isLeftToRight()?this.startPoint.x-e.clientX:e.clientX-this.startPoint.x),dy=this.startPoint.y-e.clientY,newW=this.startSize.w-(this._resizeX?dx:0),newH=this.startSize.h-(this._resizeY?dy:0);return this._checkConstraints(newW,newH);},_checkConstraints:function(newW,newH){if(this.minSize){var tm=this.minSize;if(newW<tm.w){newW=tm.w;}if(newH<tm.h){newH=tm.h;}}if(this.constrainMax&&this.maxSize){var ms=this.maxSize;if(newW>ms.w){newW=ms.w;}if(newH>ms.h){newH=ms.h;}}if(this.fixedAspect){var ta=this._aspect[this._aspect.prop];if(newW<newH){newH=newW*ta;}else{if(newH<newW){newW=newH*ta;}}}return {w:newW,h:newH};},_changeSizing:function(e){var tmp=this._getNewCoords(e);if(tmp===false){return;}if(this.targetWidget&&dojo.isFunction(this.targetWidget.resize)){this.targetWidget.resize(tmp);}else{if(this.animateSizing){var anim=dojo.fx[this.animateMethod]([dojo.animateProperty({node:this.targetDomNode,properties:{width:{start:this.startSize.w,end:tmp.w}},duration:this.animateDuration}),dojo.animateProperty({node:this.targetDomNode,properties:{height:{start:this.startSize.h,end:tmp.h}},duration:this.animateDuration})]);anim.play();}else{dojo.style(this.targetDomNode,{width:tmp.w+"px",height:tmp.h+"px"});}}if(this.intermediateChanges){this.onResize(e);}},_endSizing:function(e){dojo.forEach(this._pconnects,dojo.disconnect);var pub=dojo.partial(dojo.publish,this.endTopic,[this]);if(!this.activeResize){this._resizeHelper.hide();this._changeSizing(e);setTimeout(pub,this.animateDuration+15);}else{pub();}this._isSizing=false;this.onResize(e);},onResize:function(e){}});dojo.declare("dojox.layout._ResizeHelper",dijit._Widget,{show:function(){dojo.fadeIn({node:this.domNode,duration:120,beforeBegin:function(n){dojo.style(n,"display","");}}).play();},hide:function(){dojo.fadeOut({node:this.domNode,duration:250,onEnd:function(n){dojo.style(n,"display","none");}}).play();},resize:function(dim){dojo.marginBox(this.domNode,dim);}});}if(!dojo._hasResource["dojox.layout.FloatingPane"]){dojo._hasResource["dojox.layout.FloatingPane"]=true;dojo.provide("dojox.layout.FloatingPane");dojo.experimental("dojox.layout.FloatingPane");dojo.declare("dojox.layout.FloatingPane",[dojox.layout.ContentPane,dijit._Templated],{closable:true,dockable:true,resizable:false,maxable:false,resizeAxis:"xy",title:"",dockTo:"",duration:400,contentClass:"dojoxFloatingPaneContent",_showAnim:null,_hideAnim:null,_dockNode:null,_restoreState:{},_allFPs:[],_startZ:100,templateString:dojo.cache("dojox.layout","resources/FloatingPane.html","<div class=\"dojoxFloatingPane\" id=\"${id}\">\n\t<div tabindex=\"0\" role=\"button\" class=\"dojoxFloatingPaneTitle\" dojoAttachPoint=\"focusNode\">\n\t\t<span dojoAttachPoint=\"closeNode\" dojoAttachEvent=\"onclick: close\" class=\"dojoxFloatingCloseIcon\"></span>\n\t\t<span dojoAttachPoint=\"maxNode\" dojoAttachEvent=\"onclick: maximize\" class=\"dojoxFloatingMaximizeIcon\">&thinsp;</span>\n\t\t<span dojoAttachPoint=\"restoreNode\" dojoAttachEvent=\"onclick: _restore\" class=\"dojoxFloatingRestoreIcon\">&thinsp;</span>\t\n\t\t<span dojoAttachPoint=\"dockNode\" dojoAttachEvent=\"onclick: minimize\" class=\"dojoxFloatingMinimizeIcon\">&thinsp;</span>\n\t\t<span dojoAttachPoint=\"titleNode\" class=\"dijitInline dijitTitleNode\"></span>\n\t</div>\n\t<div dojoAttachPoint=\"canvas\" class=\"dojoxFloatingPaneCanvas\">\n\t\t<div dojoAttachPoint=\"containerNode\" role=\"region\" tabindex=\"-1\" class=\"${contentClass}\">\n\t\t</div>\n\t\t<span dojoAttachPoint=\"resizeHandle\" class=\"dojoxFloatingResizeHandle\"></span>\n\t</div>\n</div>\n"),attributeMap:dojo.delegate(dijit._Widget.prototype.attributeMap,{title:{type:"innerHTML",node:"titleNode"}}),postCreate:function(){this.inherited(arguments);new dojo.dnd.Moveable(this.domNode,{handle:this.focusNode});if(!this.dockable){this.dockNode.style.display="none";}if(!this.closable){this.closeNode.style.display="none";}if(!this.maxable){this.maxNode.style.display="none";this.restoreNode.style.display="none";}if(!this.resizable){this.resizeHandle.style.display="none";}else{this.domNode.style.width=dojo.marginBox(this.domNode).w+"px";}this._allFPs.push(this);this.domNode.style.position="absolute";this.bgIframe=new dijit.BackgroundIframe(this.domNode);this._naturalState=dojo.coords(this.domNode);},startup:function(){if(this._started){return;}if(this.resizable){if(dojo.isIE){this.canvas.style.overflow="auto";}else{this.containerNode.style.overflow="auto";}this._resizeHandle=new dojox.layout.ResizeHandle({targetId:this.id,resizeAxis:this.resizeAxis},this.resizeHandle);}if(this.dockable){var _b50=this.dockTo;if(this.dockTo){this.dockTo=dijit.byId(this.dockTo);}else{this.dockTo=dijit.byId("dojoxGlobalFloatingDock");}if(!this.dockTo){var _b51,_b52;if(_b50){_b51=_b50;_b52=dojo.byId(_b50);}else{_b52=dojo.create("div",null,dojo.body());dojo.addClass(_b52,"dojoxFloatingDockDefault");_b51="dojoxGlobalFloatingDock";}this.dockTo=new dojox.layout.Dock({id:_b51,autoPosition:"south"},_b52);this.dockTo.startup();}if((this.domNode.style.display=="none")||(this.domNode.style.visibility=="hidden")){this.minimize();}}this.connect(this.focusNode,"onmousedown","bringToTop");this.connect(this.domNode,"onmousedown","bringToTop");this.resize(dojo.coords(this.domNode));this._started=true;},setTitle:function(_b53){dojo.deprecated("pane.setTitle","Use pane.set('title', someTitle)","2.0");this.set("title",_b53);},close:function(){if(!this.closable){return;}dojo.unsubscribe(this._listener);this.hide(dojo.hitch(this,function(){this.destroyRecursive();}));},hide:function(_b54){dojo.fadeOut({node:this.domNode,duration:this.duration,onEnd:dojo.hitch(this,function(){this.domNode.style.display="none";this.domNode.style.visibility="hidden";if(this.dockTo&&this.dockable){this.dockTo._positionDock(null);}if(_b54){_b54();}})}).play();},show:function(_b55){var anim=dojo.fadeIn({node:this.domNode,duration:this.duration,beforeBegin:dojo.hitch(this,function(){this.domNode.style.display="";this.domNode.style.visibility="visible";if(this.dockTo&&this.dockable){this.dockTo._positionDock(null);}if(typeof _b55=="function"){_b55();}this._isDocked=false;if(this._dockNode){this._dockNode.destroy();this._dockNode=null;}})}).play();this.resize(dojo.coords(this.domNode));this._onShow();},minimize:function(){if(!this._isDocked){this.hide(dojo.hitch(this,"_dock"));}},maximize:function(){if(this._maximized){return;}this._naturalState=dojo.position(this.domNode);if(this._isDocked){this.show();setTimeout(dojo.hitch(this,"maximize"),this.duration);}dojo.addClass(this.focusNode,"floatingPaneMaximized");this.resize(dojo.window.getBox());this._maximized=true;},_restore:function(){if(this._maximized){this.resize(this._naturalState);dojo.removeClass(this.focusNode,"floatingPaneMaximized");this._maximized=false;}},_dock:function(){if(!this._isDocked&&this.dockable){this._dockNode=this.dockTo.addNode(this);this._isDocked=true;}},resize:function(dim){dim=dim||this._naturalState;this._currentState=dim;var dns=this.domNode.style;if("t" in dim){dns.top=dim.t+"px";}if("l" in dim){dns.left=dim.l+"px";}dns.width=dim.w+"px";dns.height=dim.h+"px";var _b56={l:0,t:0,w:dim.w,h:(dim.h-this.focusNode.offsetHeight)};dojo.marginBox(this.canvas,_b56);this._checkIfSingleChild();if(this._singleChild&&this._singleChild.resize){this._singleChild.resize(_b56);}},bringToTop:function(){var _b57=dojo.filter(this._allFPs,function(i){return i!==this;},this);_b57.sort(function(a,b){return a.domNode.style.zIndex-b.domNode.style.zIndex;});_b57.push(this);dojo.forEach(_b57,function(w,x){w.domNode.style.zIndex=this._startZ+(x*2);dojo.removeClass(w.domNode,"dojoxFloatingPaneFg");},this);dojo.addClass(this.domNode,"dojoxFloatingPaneFg");},destroy:function(){this._allFPs.splice(dojo.indexOf(this._allFPs,this),1);if(this._resizeHandle){this._resizeHandle.destroy();}this.inherited(arguments);}});dojo.declare("dojox.layout.Dock",[dijit._Widget,dijit._Templated],{templateString:"<div class=\"dojoxDock\"><ul dojoAttachPoint=\"containerNode\" class=\"dojoxDockList\"></ul></div>",_docked:[],_inPositioning:false,autoPosition:false,addNode:function(_b58){var div=dojo.create("li",null,this.containerNode),node=new dojox.layout._DockNode({title:_b58.title,paneRef:_b58},div);node.startup();return node;},startup:function(){if(this.id=="dojoxGlobalFloatingDock"||this.isFixedDock){this.connect(window,"onresize","_positionDock");this.connect(window,"onscroll","_positionDock");if(dojo.isIE){this.connect(this.domNode,"onresize","_positionDock");}}this._positionDock(null);this.inherited(arguments);},_positionDock:function(e){if(!this._inPositioning){if(this.autoPosition=="south"){setTimeout(dojo.hitch(this,function(){this._inPositiononing=true;var _b59=dojo.window.getBox();var s=this.domNode.style;s.left=_b59.l+"px";s.width=(_b59.w-2)+"px";s.top=(_b59.h+_b59.t)-this.domNode.offsetHeight+"px";this._inPositioning=false;}),125);}}}});dojo.declare("dojox.layout._DockNode",[dijit._Widget,dijit._Templated],{title:"",paneRef:null,templateString:"<li dojoAttachEvent=\"onclick: restore\" class=\"dojoxDockNode\">"+"<span dojoAttachPoint=\"restoreNode\" class=\"dojoxDockRestoreButton\" dojoAttachEvent=\"onclick: restore\"></span>"+"<span class=\"dojoxDockTitleNode\" dojoAttachPoint=\"titleNode\">${title}</span>"+"</li>",restore:function(){this.paneRef.show();this.paneRef.bringToTop();this.destroy();}});}if(!dojo._hasResource["plugins.dojox.layout.Dock"]){dojo._hasResource["plugins.dojox.layout.Dock"]=true;dojo.provide("plugins.dojox.layout.Dock");dojo.declare("plugins.dojox.layout.Dock",[dijit._Widget,dijit._Templated],{templateString:"<div class=\"dojoxDock\"><ul dojoAttachPoint=\"containerNode\" class=\"dojoxDockList\"></ul></div>",_docked:[],_inPositioning:false,autoPosition:false,dockClass:"dojoxDockNode",addNode:function(_b5a){var div=dojo.create("li",null,this.containerNode);var node=new plugins.dojox.layout._DockNode({title:_b5a.title,paneRef:_b5a,dockClass:_b5a.dockClass},div);node.startup();return node;},startup:function(){if(this.id=="dojoxGlobalFloatingDock"||this.isFixedDock){this.connect(window,"onresize","_positionDock");this.connect(window,"onscroll","_positionDock");if(dojo.isIE){this.connect(this.domNode,"onresize","_positionDock");}}this._positionDock(null);this.inherited(arguments);},_positionDock:function(e){if(!this._inPositioning){if(this.autoPosition=="south"){setTimeout(dojo.hitch(this,function(){this._inPositiononing=true;var _b5b=dojo.window.getBox();var s=this.domNode.style;s.left=_b5b.l+"px";s.width=(_b5b.w-2)+"px";s.top=(_b5b.h+_b5b.t)-this.domNode.offsetHeight+"px";this._inPositioning=false;}),125);}}}});dojo.declare("plugins.dojox.layout._DockNode",[dojox.layout.Dock],{templateString:"<li dojoAttachEvent=\"onclick: restore\" class=\"dojoxDockNode\">"+"<span dojoAttachPoint=\"restoreNode\" class=\"dojoxDockRestoreButton\" dojoAttachEvent=\"onclick: restore\"></span>"+"<span class=\"dojoxDockTitleNode\" dojoAttachPoint=\"titleNode\">${title}</span>"+"</li>",dockClass:null,postCreate:function(){var _b5c=this.dockClass;if(_b5c){dojo.attr(this.domNode,"class",_b5c);}if(this.dockClass){this.templateString="<li dojoAttachEvent=\"onclick: restore\" class=\"dojoxDockNode "+this.dockClass+"\">"+"<span dojoAttachPoint=\"restoreNode\" class=\"dojoxDockRestoreButton\" dojoAttachEvent=\"onclick: restore\"></span>"+"<span class=\"dojoxDockTitleNode\" dojoAttachPoint=\"titleNode\">${title}</span>"+"</li>";}},restore:function(){this.paneRef.show();this.paneRef.bringToTop();this.destroy();}});}if(!dojo._hasResource["plugins.dojox.layout.FloatingPane"]){dojo._hasResource["plugins.dojox.layout.FloatingPane"]=true;dojo.provide("plugins.dojox.layout.FloatingPane");dojo.declare("plugins.dojox.layout.FloatingPane",[dojox.layout.FloatingPane],{dockClass:"dojoxDockNode",constructor:function(){this.inherited(arguments);},postCreate:function(){console.log("FloatingPane.postCreate    this.dockClass: "+this.dockClass);this.inherited(arguments);new dojo.dnd.Moveable(this.domNode,{handle:this.focusNode});if(!this.dockable){this.dockNode.style.display="none";}if(!this.closable){this.closeNode.style.diDocsplay="none";}if(!this.maxable){this.maxNode.style.display="none";this.restoreNode.style.display="none";}if(!this.resizable){this.resizeHandle.style.display="none";}else{this.domNode.style.width=dojo.marginBox(this.domNode).w+"px";}this._allFPs.push(this);this.domNode.style.position="absolute";this.bgIframe=new dijit.BackgroundIframe(this.domNode);this._naturalState=dojo.coords(this.domNode);},startup:function(){if(this._started){return;}if(this.resizable){if(dojo.isIE){this.canvas.style.overflow="auto";}else{this.containerNode.style.overflow="auto";}this._resizeHandle=new dojox.layout.ResizeHandle({targetId:this.id,resizeAxis:this.resizeAxis},this.resizeHandle);}if(this.dockable){var _b5d=this.dockTo;if(this.dockTo){this.dockTo=dijit.byId(this.dockTo);}else{this.dockTo=dijit.byId("dojoxGlobalFloatingDock");}if(!this.dockTo){var _b5e,_b5f;if(_b5d){_b5e=_b5d;_b5f=dojo.byId(_b5d);}else{_b5f=dojo.create("div",null,dojo.body());dojo.addClass(_b5f,"dojoxFloatingDockDefault");_b5e="dojoxGlobalFloatingDock";}console.log("FloatingPane.startup    this:");console.dir({this_ie_FloatingPane:this});console.log("FloatingPane.startup    this.dockClass: "+this.dockClass);this.dockTo=new plugins.dojox.layout.Dock({id:_b5e,autoPosition:"south",dockClass:this.dockClass,paneRef:this},_b5f);this.dockTo.startup();}if((this.domNode.style.display=="none")||(this.domNode.style.visibility=="hidden")){this.minimize();}}this.connect(this.focusNode,"onmousedown","bringToTop");this.connect(this.domNode,"onmousedown","bringToTop");this.resize(dojo.coords(this.domNode));this._started=true;},});}if(!dojo._hasResource["dijit.TitlePane"]){dojo._hasResource["dijit.TitlePane"]=true;dojo.provide("dijit.TitlePane");dojo.declare("dijit.TitlePane",[dijit.layout.ContentPane,dijit._Templated,dijit._CssStateMixin],{title:"",open:true,toggleable:true,tabIndex:"0",duration:dijit.defaultDuration,baseClass:"dijitTitlePane",templateString:dojo.cache("dijit","templates/TitlePane.html","<div>\n\t<div dojoAttachEvent=\"onclick:_onTitleClick, onkeypress:_onTitleKey\"\n\t\t\tclass=\"dijitTitlePaneTitle\" dojoAttachPoint=\"titleBarNode\">\n\t\t<div class=\"dijitTitlePaneTitleFocus\" dojoAttachPoint=\"focusNode\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" dojoAttachPoint=\"arrowNode\" class=\"dijitArrowNode\" role=\"presentation\"\n\t\t\t/><span dojoAttachPoint=\"arrowNodeInner\" class=\"dijitArrowNodeInner\"></span\n\t\t\t><span dojoAttachPoint=\"titleNode\" class=\"dijitTitlePaneTextNode\"></span>\n\t\t</div>\n\t</div>\n\t<div class=\"dijitTitlePaneContentOuter\" dojoAttachPoint=\"hideNode\" role=\"presentation\">\n\t\t<div class=\"dijitReset\" dojoAttachPoint=\"wipeNode\" role=\"presentation\">\n\t\t\t<div class=\"dijitTitlePaneContentInner\" dojoAttachPoint=\"containerNode\" role=\"region\" id=\"${id}_pane\">\n\t\t\t\t<!-- nested divs because wipeIn()/wipeOut() doesn't work right on node w/padding etc.  Put padding on inner div. -->\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n"),attributeMap:dojo.delegate(dijit.layout.ContentPane.prototype.attributeMap,{title:{node:"titleNode",type:"innerHTML"},tooltip:{node:"focusNode",type:"attribute",attribute:"title"},id:""}),buildRendering:function(){this.inherited(arguments);dojo.setSelectable(this.titleNode,false);},postCreate:function(){this.inherited(arguments);if(this.toggleable){this._trackMouseState(this.titleBarNode,"dijitTitlePaneTitle");}var _b60=this.hideNode,_b61=this.wipeNode;this._wipeIn=dojo.fx.wipeIn({node:this.wipeNode,duration:this.duration,beforeBegin:function(){_b60.style.display="";}});this._wipeOut=dojo.fx.wipeOut({node:this.wipeNode,duration:this.duration,onEnd:function(){_b60.style.display="none";}});},_setOpenAttr:function(open,_b62){dojo.forEach([this._wipeIn,this._wipeOut],function(_b63){if(_b63&&_b63.status()=="playing"){_b63.stop();}});if(_b62){var anim=this[open?"_wipeIn":"_wipeOut"];anim.play();}else{this.hideNode.style.display=this.wipeNode.style.display=open?"":"none";}if(this._started){if(open){this._onShow();}else{this.onHide();}}this.arrowNodeInner.innerHTML=open?"-":"+";dijit.setWaiState(this.containerNode,"hidden",open?"false":"true");dijit.setWaiState(this.focusNode,"pressed",open?"true":"false");this._set("open",open);this._setCss();},_setToggleableAttr:function(_b64){dijit.setWaiRole(this.focusNode,_b64?"button":"heading");if(_b64){dijit.setWaiState(this.focusNode,"controls",this.id+"_pane");dojo.attr(this.focusNode,"tabIndex",this.tabIndex);}else{dojo.removeAttr(this.focusNode,"tabIndex");}this._set("toggleable",_b64);this._setCss();},_setContentAttr:function(_b65){if(!this.open||!this._wipeOut||this._wipeOut.status()=="playing"){this.inherited(arguments);}else{if(this._wipeIn&&this._wipeIn.status()=="playing"){this._wipeIn.stop();}dojo.marginBox(this.wipeNode,{h:dojo.marginBox(this.wipeNode).h});this.inherited(arguments);if(this._wipeIn){this._wipeIn.play();}else{this.hideNode.style.display="";}}},toggle:function(){this._setOpenAttr(!this.open,true);},_setCss:function(){var node=this.titleBarNode||this.focusNode;var _b66=this._titleBarClass;this._titleBarClass="dijit"+(this.toggleable?"":"Fixed")+(this.open?"Open":"Closed");dojo.replaceClass(node,this._titleBarClass,_b66||"");this.arrowNodeInner.innerHTML=this.open?"-":"+";},_onTitleKey:function(e){if(e.charOrCode==dojo.keys.ENTER||e.charOrCode==" "){if(this.toggleable){this.toggle();}dojo.stopEvent(e);}else{if(e.charOrCode==dojo.keys.DOWN_ARROW&&this.open){this.containerNode.focus();e.preventDefault();}}},_onTitleClick:function(){if(this.toggleable){this.toggle();}},setTitle:function(_b67){dojo.deprecated("dijit.TitlePane.setTitle() is deprecated.  Use set('title', ...) instead.","","2.0");this.set("title",_b67);}});}if(!dojo._hasResource["dijit.InlineEditBox"]){dojo._hasResource["dijit.InlineEditBox"]=true;dojo.provide("dijit.InlineEditBox");dojo.declare("dijit.InlineEditBox",dijit._Widget,{editing:false,autoSave:true,buttonSave:"",buttonCancel:"",renderAsHtml:false,editor:"dijit.form.TextBox",editorWrapper:"dijit._InlineEditor",editorParams:{},disabled:false,onChange:function(_b68){},onCancel:function(){},width:"100%",value:"",noValueIndicator:dojo.isIE<=6?"<span style='font-family: wingdings; text-decoration: underline;'>&nbsp;&nbsp;&nbsp;&nbsp;&#x270d;&nbsp;&nbsp;&nbsp;&nbsp;</span>":"<span style='text-decoration: underline;'>&nbsp;&nbsp;&nbsp;&nbsp;&#x270d;&nbsp;&nbsp;&nbsp;&nbsp;</span>",constructor:function(){this.editorParams={};},postMixInProperties:function(){this.inherited(arguments);this.displayNode=this.srcNodeRef;var _b69={ondijitclick:"_onClick",onmouseover:"_onMouseOver",onmouseout:"_onMouseOut",onfocus:"_onMouseOver",onblur:"_onMouseOut"};for(var name in _b69){this.connect(this.displayNode,name,_b69[name]);}dijit.setWaiRole(this.displayNode,"button");if(!this.displayNode.getAttribute("tabIndex")){this.displayNode.setAttribute("tabIndex",0);}if(!this.value&&!("value" in this.params)){this.value=dojo.trim(this.renderAsHtml?this.displayNode.innerHTML:(this.displayNode.innerText||this.displayNode.textContent||""));}if(!this.value){this.displayNode.innerHTML=this.noValueIndicator;}dojo.addClass(this.displayNode,"dijitInlineEditBoxDisplayMode");},setDisabled:function(_b6a){dojo.deprecated("dijit.InlineEditBox.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",_b6a);},_setDisabledAttr:function(_b6b){dijit.setWaiState(this.domNode,"disabled",_b6b);if(_b6b){this.displayNode.removeAttribute("tabIndex");}else{this.displayNode.setAttribute("tabIndex",0);}dojo.toggleClass(this.displayNode,"dijitInlineEditBoxDisplayModeDisabled",_b6b);this._set("disabled",_b6b);},_onMouseOver:function(){if(!this.disabled){dojo.addClass(this.displayNode,"dijitInlineEditBoxDisplayModeHover");}},_onMouseOut:function(){dojo.removeClass(this.displayNode,"dijitInlineEditBoxDisplayModeHover");},_onClick:function(e){if(this.disabled){return;}if(e){dojo.stopEvent(e);}this._onMouseOut();setTimeout(dojo.hitch(this,"edit"),0);},edit:function(){if(this.disabled||this.editing){return;}this.editing=true;this._savedPosition=dojo.style(this.displayNode,"position")||"static";this._savedOpacity=dojo.style(this.displayNode,"opacity")||"1";this._savedTabIndex=dojo.attr(this.displayNode,"tabIndex")||"0";if(this.wrapperWidget){var ew=this.wrapperWidget.editWidget;ew.set("displayedValue" in ew?"displayedValue":"value",this.value);}else{var _b6c=dojo.create("span",null,this.domNode,"before");var ewc=typeof this.editorWrapper=="string"?dojo.getObject(this.editorWrapper):this.editorWrapper;this.wrapperWidget=new ewc({value:this.value,buttonSave:this.buttonSave,buttonCancel:this.buttonCancel,dir:this.dir,lang:this.lang,tabIndex:this._savedTabIndex,editor:this.editor,inlineEditBox:this,sourceStyle:dojo.getComputedStyle(this.displayNode),save:dojo.hitch(this,"save"),cancel:dojo.hitch(this,"cancel")},_b6c);if(!this._started){this.startup();}}var ww=this.wrapperWidget;if(dojo.isIE){dijit.focus(dijit.getFocus());}dojo.style(this.displayNode,{position:"absolute",opacity:"0",display:"none"});dojo.style(ww.domNode,{position:this._savedPosition,visibility:"visible",opacity:"1"});dojo.attr(this.displayNode,"tabIndex","-1");setTimeout(dojo.hitch(this,function(){ww.focus();ww._resetValue=ww.getValue();}),0);},_onBlur:function(){this.inherited(arguments);if(!this.editing){}},destroy:function(){if(this.wrapperWidget&&!this.wrapperWidget._destroyed){this.wrapperWidget.destroy();delete this.wrapperWidget;}this.inherited(arguments);},_showText:function(_b6d){var ww=this.wrapperWidget;dojo.style(ww.domNode,{position:"absolute",visibility:"hidden",opacity:"0"});dojo.style(this.displayNode,{position:this._savedPosition,opacity:this._savedOpacity,display:""});dojo.attr(this.displayNode,"tabIndex",this._savedTabIndex);if(_b6d){dijit.focus(this.displayNode);}},save:function(_b6e){if(this.disabled||!this.editing){return;}this.editing=false;var ww=this.wrapperWidget;var _b6f=ww.getValue();this.set("value",_b6f);this._showText(_b6e);},setValue:function(val){dojo.deprecated("dijit.InlineEditBox.setValue() is deprecated.  Use set('value', ...) instead.","","2.0");return this.set("value",val);},_setValueAttr:function(val){val=dojo.trim(val);var _b70=this.renderAsHtml?val:val.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;").replace(/\n/g,"<br>");this.displayNode.innerHTML=_b70||this.noValueIndicator;this._set("value",val);if(this._started){setTimeout(dojo.hitch(this,"onChange",val),0);}},getValue:function(){dojo.deprecated("dijit.InlineEditBox.getValue() is deprecated.  Use get('value') instead.","","2.0");return this.get("value");},cancel:function(_b71){if(this.disabled||!this.editing){return;}this.editing=false;setTimeout(dojo.hitch(this,"onCancel"),0);this._showText(_b71);}});dojo.declare("dijit._InlineEditor",[dijit._Widget,dijit._Templated],{templateString:dojo.cache("dijit","templates/InlineEditBox.html","<span data-dojo-attach-point=\"editNode\" role=\"presentation\" style=\"position: absolute; visibility:hidden\" class=\"dijitReset dijitInline\"\n\tdata-dojo-attach-event=\"onkeypress: _onKeyPress\"\n\t><span data-dojo-attach-point=\"editorPlaceholder\"></span\n\t><span data-dojo-attach-point=\"buttonContainer\"\n\t\t><button data-dojo-type=\"dijit.form.Button\" data-dojo-props=\"label: '${buttonSave}', 'class': 'saveButton'\"\n\t\t\tdata-dojo-attach-point=\"saveButton\" data-dojo-attach-event=\"onClick:save\"></button\n\t\t><button data-dojo-type=\"dijit.form.Button\"  data-dojo-props=\"label: '${buttonCancel}', 'class': 'cancelButton'\"\n\t\t\tdata-dojo-attach-point=\"cancelButton\" data-dojo-attach-event=\"onClick:cancel\"></button\n\t></span\n></span>\n"),widgetsInTemplate:true,postMixInProperties:function(){this.inherited(arguments);this.messages=dojo.i18n.getLocalization("dijit","common",this.lang);dojo.forEach(["buttonSave","buttonCancel"],function(prop){if(!this[prop]){this[prop]=this.messages[prop];}},this);},buildRendering:function(){this.inherited(arguments);var cls=typeof this.editor=="string"?dojo.getObject(this.editor):this.editor;var _b72=this.sourceStyle,_b73="line-height:"+_b72.lineHeight+";",_b74=dojo.getComputedStyle(this.domNode);dojo.forEach(["Weight","Family","Size","Style"],function(prop){var _b75=_b72["font"+prop],_b76=_b74["font"+prop];if(_b76!=_b75){_b73+="font-"+prop+":"+_b72["font"+prop]+";";}},this);dojo.forEach(["marginTop","marginBottom","marginLeft","marginRight"],function(prop){this.domNode.style[prop]=_b72[prop];},this);var _b77=this.inlineEditBox.width;if(_b77=="100%"){_b73+="width:100%;";this.domNode.style.display="block";}else{_b73+="width:"+(_b77+(Number(_b77)==_b77?"px":""))+";";}var _b78=dojo.delegate(this.inlineEditBox.editorParams,{style:_b73,dir:this.dir,lang:this.lang});_b78["displayedValue" in cls.prototype?"displayedValue":"value"]=this.value;this.editWidget=new cls(_b78,this.editorPlaceholder);if(this.inlineEditBox.autoSave){dojo.destroy(this.buttonContainer);}},postCreate:function(){this.inherited(arguments);var ew=this.editWidget;if(this.inlineEditBox.autoSave){this.connect(ew,"onChange","_onChange");this.connect(ew,"onKeyPress","_onKeyPress");}else{if("intermediateChanges" in ew){ew.set("intermediateChanges",true);this.connect(ew,"onChange","_onIntermediateChange");this.saveButton.set("disabled",true);}}},_onIntermediateChange:function(val){this.saveButton.set("disabled",(this.getValue()==this._resetValue)||!this.enableSave());},destroy:function(){this.editWidget.destroy(true);this.inherited(arguments);},getValue:function(){var ew=this.editWidget;return String(ew.get("displayedValue" in ew?"displayedValue":"value"));},_onKeyPress:function(e){if(this.inlineEditBox.autoSave&&this.inlineEditBox.editing){if(e.altKey||e.ctrlKey){return;}if(e.charOrCode==dojo.keys.ESCAPE){dojo.stopEvent(e);this.cancel(true);}else{if(e.charOrCode==dojo.keys.ENTER&&e.target.tagName=="INPUT"){dojo.stopEvent(e);this._onChange();}}}},_onBlur:function(){this.inherited(arguments);if(this.inlineEditBox.autoSave&&this.inlineEditBox.editing){if(this.getValue()==this._resetValue){this.cancel(false);}else{if(this.enableSave()){this.save(false);}}}},_onChange:function(){if(this.inlineEditBox.autoSave&&this.inlineEditBox.editing&&this.enableSave()){dojo.style(this.inlineEditBox.displayNode,{display:""});dijit.focus(this.inlineEditBox.displayNode);}},enableSave:function(){return (this.editWidget.isValid?this.editWidget.isValid():true);},focus:function(){this.editWidget.focus();setTimeout(dojo.hitch(this,function(){if(this.editWidget.focusNode&&this.editWidget.focusNode.tagName=="INPUT"){dijit.selectInputText(this.editWidget.focusNode);}}),0);}});}if(!dojo._hasResource["dojox.timing._base"]){dojo._hasResource["dojox.timing._base"]=true;dojo.provide("dojox.timing._base");dojo.experimental("dojox.timing");dojox.timing.Timer=function(_b79){this.timer=null;this.isRunning=false;this.interval=_b79;this.onStart=null;this.onStop=null;};dojo.extend(dojox.timing.Timer,{onTick:function(){},setInterval:function(_b7a){if(this.isRunning){window.clearInterval(this.timer);}this.interval=_b7a;if(this.isRunning){this.timer=window.setInterval(dojo.hitch(this,"onTick"),this.interval);}},start:function(){if(typeof this.onStart=="function"){this.onStart();}this.isRunning=true;this.timer=window.setInterval(dojo.hitch(this,"onTick"),this.interval);},stop:function(){if(typeof this.onStop=="function"){this.onStop();}this.isRunning=false;window.clearInterval(this.timer);}});}if(!dojo._hasResource["dojox.timing"]){dojo._hasResource["dojox.timing"]=true;dojo.provide("dojox.timing");}if(!dojo._hasResource["plugins.dojox.Timer"]){dojo._hasResource["plugins.dojox.Timer"]=true;dojo.provide("plugins.dojox.Timer");dojo.declare("plugins.dojox.Timer",null,{interval:3000,polling:false,completed:false,onStart:null,poll:null,onEnd:null,attenuate:false,currentInterval:false,stepInterval:2000,maxInterval:10000,tick:1,constructor:function(args){console.log("plugins.dojox.Timer.constructor     plugins.dojox.Timer.constructor");if(args==null){return;}if(args.interval!=null){this.interval=args.interval;}if(args.attenuate!=null){this.attenuate=args.attenuate;}if(args.stepInterval!=null){this.stepInterval=args.stepInterval;}if(args.maxInterval!=null){this.maxInterval=args.maxInterval;}this.poll=args.poll||function(){console.log("plugins.dojox.Timer.constructor    poll function is empty");};this.onStart=args.onStart||function(){console.log("plugins.dojox.Timer.constructor    onStart function is empty");};this.onEnd=args.onEnd||function(){console.log("plugins.dojox.Timer.constructor    onEnd function is empty");};this.currentInterval=this.interval;this.setTimer();},setTimer:function(){if(this.timer!=null){return;}if(this.checkParent&&!this.parentWidget){console.log("plugins.dojox.Timer.setTimer    no parentWidget. Doing this.destroy()");this.destroy();}this.timer=new dojox.timing.Timer;this.setInterval(this.interval);var _b7b=this;this.timer.onTick=function(){console.log("plugins.dojox.Timer.setTimer     ONTICK this.timer.interval: "+this.interval);if(_b7b.completed==true){console.log("plugins.dojox.Timer.setTimer     Stopping timer because thisObject.completed: "+_b7b.completed);_b7b.stop();return;}setTimeout(function(){try{_b7b.completed=_b7b.poll(_b7b);console.log("plugins.dojox.Timer.setTimer     Returned thisObject.completed: "+_b7b.completed);if(_b7b.completed==true){console.log("plugins.dojox.Timer.setTimer     Stopping timer because thisObject.completed: "+_b7b.completed);_b7b.stop();return;}}catch(error){console.log("plugins.dojox.Timer.setTimer     ERROR doing thisObject.poll(thisObject):"+dojo.toJson(error));}if(_b7b.attenuate==true&&_b7b.tick!=1){_b7b.currentInterval+=_b7b.stepInterval;if(_b7b.currentInterval>_b7b.maxInterval){_b7b.currentInterval=_b7b.maxInterval;}console.log("plugins.dojox.Timer.setPoll    new thisObject.currentInterval: "+_b7b.currentInterval);_b7b.timer.setInterval(_b7b.currentInterval);}else{_b7b.tick++;}},100);};},setInterval:function(_b7c){if(_b7c==null){return;}this.timer.setInterval(_b7c);},setOnEnd:function(_b7d){this.onEnd=_b7d||function(){console.log("plugins.dojox.Timer.setOnEnd    onEnd function is empty");};},setPoll:function(poll){console.log("plugins.dojox.Timer.setPoll    poll: "+poll);this.poll=poll||function(){console.log("plugins.dojox.Timer.setPoll    poll function is empty");};},start:function(){console.log("plugins.dojox.Timer.start()");this.completed=false;this.onStart(this);this.timer.start();this.polling=true;},stop:function(){console.log("plugins.dojox.Timer.stop()");this.timer.stop();this.polling=false;console.log("plugins.dojox.Timer.stop    this.polling: "+this.polling);this.onEnd(this);}});}if(!dojo._hasResource["dojox.fx._base"]){dojo._hasResource["dojox.fx._base"]=true;dojo.provide("dojox.fx._base");dojo.mixin(dojox.fx,{anim:dojo.anim,animateProperty:dojo.animateProperty,fadeTo:dojo._fade,fadeIn:dojo.fadeIn,fadeOut:dojo.fadeOut,combine:dojo.fx.combine,chain:dojo.fx.chain,slideTo:dojo.fx.slideTo,wipeIn:dojo.fx.wipeIn,wipeOut:dojo.fx.wipeOut});dojox.fx.sizeTo=function(args){var node=args.node=dojo.byId(args.node),abs="absolute";var _b7e=args.method||"chain";if(!args.duration){args.duration=500;}if(_b7e=="chain"){args.duration=Math.floor(args.duration/2);}var top,_b7f,left,_b80,_b81,_b82=null;var init=(function(n){return function(){var cs=dojo.getComputedStyle(n),pos=cs.position,w=cs.width,h=cs.height;top=(pos==abs?n.offsetTop:parseInt(cs.top)||0);left=(pos==abs?n.offsetLeft:parseInt(cs.left)||0);_b81=(w=="auto"?0:parseInt(w));_b82=(h=="auto"?0:parseInt(h));_b80=left-Math.floor((args.width-_b81)/2);_b7f=top-Math.floor((args.height-_b82)/2);if(pos!=abs&&pos!="relative"){var ret=dojo.coords(n,true);top=ret.y;left=ret.x;n.style.position=abs;n.style.top=top+"px";n.style.left=left+"px";}};})(node);var _b83=dojo.animateProperty(dojo.mixin({properties:{height:function(){init();return {end:args.height||0,start:_b82};},top:function(){return {start:top,end:_b7f};}}},args));var _b84=dojo.animateProperty(dojo.mixin({properties:{width:function(){return {start:_b81,end:args.width||0};},left:function(){return {start:left,end:_b80};}}},args));var anim=dojo.fx[(args.method=="combine"?"combine":"chain")]([_b83,_b84]);return anim;};dojox.fx.slideBy=function(args){var node=args.node=dojo.byId(args.node),top,left;var init=(function(n){return function(){var cs=dojo.getComputedStyle(n);var pos=cs.position;top=(pos=="absolute"?n.offsetTop:parseInt(cs.top)||0);left=(pos=="absolute"?n.offsetLeft:parseInt(cs.left)||0);if(pos!="absolute"&&pos!="relative"){var ret=dojo.coords(n,true);top=ret.y;left=ret.x;n.style.position="absolute";n.style.top=top+"px";n.style.left=left+"px";}};})(node);init();var _b85=dojo.animateProperty(dojo.mixin({properties:{top:top+(args.top||0),left:left+(args.left||0)}},args));dojo.connect(_b85,"beforeBegin",_b85,init);return _b85;};dojox.fx.crossFade=function(args){var _b86=args.nodes[0]=dojo.byId(args.nodes[0]),op1=dojo.style(_b86,"opacity"),_b87=args.nodes[1]=dojo.byId(args.nodes[1]),op2=dojo.style(_b87,"opacity");var _b88=dojo.fx.combine([dojo[(op1==0?"fadeIn":"fadeOut")](dojo.mixin({node:_b86},args)),dojo[(op1==0?"fadeOut":"fadeIn")](dojo.mixin({node:_b87},args))]);return _b88;};dojox.fx.highlight=function(args){var node=args.node=dojo.byId(args.node);args.duration=args.duration||400;var _b89=args.color||"#ffff99",_b8a=dojo.style(node,"backgroundColor");if(_b8a=="rgba(0, 0, 0, 0)"){_b8a="transparent";}var anim=dojo.animateProperty(dojo.mixin({properties:{backgroundColor:{start:_b89,end:_b8a}}},args));if(_b8a=="transparent"){dojo.connect(anim,"onEnd",anim,function(){node.style.backgroundColor=_b8a;});}return anim;};dojox.fx.wipeTo=function(args){args.node=dojo.byId(args.node);var node=args.node,s=node.style;var dir=(args.width?"width":"height"),_b8b=args[dir],_b8c={};_b8c[dir]={start:function(){s.overflow="hidden";if(s.visibility=="hidden"||s.display=="none"){s[dir]="1px";s.display="";s.visibility="";return 1;}else{var now=dojo.style(node,dir);return Math.max(now,1);}},end:_b8b};var anim=dojo.animateProperty(dojo.mixin({properties:_b8c},args));return anim;};}if(!dojo._hasResource["dojox.fx"]){dojo._hasResource["dojox.fx"]=true;dojo.provide("dojox.fx");}if(!dojo._hasResource["dojox.widget.DialogSimple"]){dojo._hasResource["dojox.widget.DialogSimple"]=true;dojo.provide("dojox.widget.DialogSimple");dojo.declare("dojox.widget.DialogSimple",[dojox.layout.ContentPane,dijit._DialogBase],{});}if(!dojo._hasResource["dojox.widget.Dialog"]){dojo._hasResource["dojox.widget.Dialog"]=true;dojo.provide("dojox.widget.Dialog");dojo.experimental("dojox.widget.Dialog");dojo.declare("dojox.widget.Dialog",dojox.widget.DialogSimple,{templateString:dojo.cache("dojox.widget","Dialog/Dialog.html","<div class=\"dojoxDialog\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"${id}_title\">\n\t<div dojoAttachPoint=\"titleBar\" class=\"dojoxDialogTitleBar\">\n\t\t<span dojoAttachPoint=\"titleNode\" class=\"dojoxDialogTitle\" id=\"${id}_title\">${title}</span>\n\t</div>\n\t<div dojoAttachPoint=\"dojoxDialogWrapper\">\n\t\t<div dojoAttachPoint=\"containerNode\" class=\"dojoxDialogPaneContent\"></div>\n\t</div>\n\t<div dojoAttachPoint=\"closeButtonNode\" class=\"dojoxDialogCloseIcon\" dojoAttachEvent=\"onclick: onCancel\">\n\t\t\t<span dojoAttachPoint=\"closeText\" class=\"closeText\">x</span>\n\t</div>\n</div>\n"),sizeToViewport:false,viewportPadding:35,dimensions:null,easing:null,sizeDuration:dijit._defaultDuration,sizeMethod:"chain",showTitle:false,draggable:false,modal:false,constructor:function(_b8d,node){this.easing=_b8d.easing||dojo._defaultEasing;this.dimensions=_b8d.dimensions||[300,300];},_setup:function(){this.inherited(arguments);if(!this._alreadyInitialized){this._navIn=dojo.fadeIn({node:this.closeButtonNode});this._navOut=dojo.fadeOut({node:this.closeButtonNode});if(!this.showTitle){dojo.addClass(this.domNode,"dojoxDialogNoTitle");}}},layout:function(e){this._setSize();this.inherited(arguments);},_setSize:function(){this._vp=dojo.window.getBox();var tc=this.containerNode,_b8e=this.sizeToViewport;return this._displaysize={w:_b8e?tc.scrollWidth:this.dimensions[0],h:_b8e?tc.scrollHeight:this.dimensions[1]};},show:function(){if(this.open){return;}this._setSize();dojo.style(this.closeButtonNode,"opacity",0);dojo.style(this.domNode,{overflow:"hidden",opacity:0,width:"1px",height:"1px"});dojo.style(this.containerNode,{opacity:0,overflow:"hidden"});this.inherited(arguments);if(this.modal){this._modalconnects.push(dojo.connect(dojo.body(),"onkeypress",function(e){if(e.charOrCode==dojo.keys.ESCAPE){dojo.stopEvent(e);}}));}else{this._modalconnects.push(dojo.connect(dijit._underlay.domNode,"onclick",this,"onCancel"));}this._modalconnects.push(dojo.connect(this.domNode,"onmouseenter",this,"_handleNav"));this._modalconnects.push(dojo.connect(this.domNode,"onmouseleave",this,"_handleNav"));},_handleNav:function(e){var _b8f="_navOut",_b90="_navIn",_b91=(e.type=="mouseout"?_b90:_b8f),_b92=(e.type=="mouseout"?_b8f:_b90);this[_b91].stop();this[_b92].play();},_position:function(){if(!this._started){return;}if(this._sizing){this._sizing.stop();this.disconnect(this._sizingConnect);delete this._sizing;}this.inherited(arguments);if(!this.open){dojo.style(this.containerNode,"opacity",0);}var pad=this.viewportPadding*2;var _b93={node:this.domNode,duration:this.sizeDuration||dijit._defaultDuration,easing:this.easing,method:this.sizeMethod};var ds=this._displaysize||this._setSize();_b93["width"]=ds.w=(ds.w+pad>=this._vp.w||this.sizeToViewport)?this._vp.w-pad:ds.w;_b93["height"]=ds.h=(ds.h+pad>=this._vp.h||this.sizeToViewport)?this._vp.h-pad:ds.h;this._sizing=dojox.fx.sizeTo(_b93);this._sizingConnect=this.connect(this._sizing,"onEnd","_showContent");this._sizing.play();},_showContent:function(e){var _b94=this.containerNode;dojo.style(this.domNode,{overflow:"visible",opacity:1});dojo.style(this.closeButtonNode,"opacity",1);dojo.style(_b94,{height:this._displaysize.h-this.titleNode.offsetHeight+"px",width:this._displaysize.w+"px",overflow:"auto"});dojo.anim(_b94,{opacity:1});}});}if(!dojo._hasResource["dojo.fx.easing"]){dojo._hasResource["dojo.fx.easing"]=true;dojo.provide("dojo.fx.easing");dojo.getObject("fx.easing",true,dojo);dojo.fx.easing={linear:function(n){return n;},quadIn:function(n){return Math.pow(n,2);},quadOut:function(n){return n*(n-2)*-1;},quadInOut:function(n){n=n*2;if(n<1){return Math.pow(n,2)/2;}return -1*((--n)*(n-2)-1)/2;},cubicIn:function(n){return Math.pow(n,3);},cubicOut:function(n){return Math.pow(n-1,3)+1;},cubicInOut:function(n){n=n*2;if(n<1){return Math.pow(n,3)/2;}n-=2;return (Math.pow(n,3)+2)/2;},quartIn:function(n){return Math.pow(n,4);},quartOut:function(n){return -1*(Math.pow(n-1,4)-1);},quartInOut:function(n){n=n*2;if(n<1){return Math.pow(n,4)/2;}n-=2;return -1/2*(Math.pow(n,4)-2);},quintIn:function(n){return Math.pow(n,5);},quintOut:function(n){return Math.pow(n-1,5)+1;},quintInOut:function(n){n=n*2;if(n<1){return Math.pow(n,5)/2;}n-=2;return (Math.pow(n,5)+2)/2;},sineIn:function(n){return -1*Math.cos(n*(Math.PI/2))+1;},sineOut:function(n){return Math.sin(n*(Math.PI/2));},sineInOut:function(n){return -1*(Math.cos(Math.PI*n)-1)/2;},expoIn:function(n){return (n==0)?0:Math.pow(2,10*(n-1));},expoOut:function(n){return (n==1)?1:(-1*Math.pow(2,-10*n)+1);},expoInOut:function(n){if(n==0){return 0;}if(n==1){return 1;}n=n*2;if(n<1){return Math.pow(2,10*(n-1))/2;}--n;return (-1*Math.pow(2,-10*n)+2)/2;},circIn:function(n){return -1*(Math.sqrt(1-Math.pow(n,2))-1);},circOut:function(n){n=n-1;return Math.sqrt(1-Math.pow(n,2));},circInOut:function(n){n=n*2;if(n<1){return -1/2*(Math.sqrt(1-Math.pow(n,2))-1);}n-=2;return 1/2*(Math.sqrt(1-Math.pow(n,2))+1);},backIn:function(n){var s=1.70158;return Math.pow(n,2)*((s+1)*n-s);},backOut:function(n){n=n-1;var s=1.70158;return Math.pow(n,2)*((s+1)*n+s)+1;},backInOut:function(n){var s=1.70158*1.525;n=n*2;if(n<1){return (Math.pow(n,2)*((s+1)*n-s))/2;}n-=2;return (Math.pow(n,2)*((s+1)*n+s)+2)/2;},elasticIn:function(n){if(n==0||n==1){return n;}var p=0.3;var s=p/4;n=n-1;return -1*Math.pow(2,10*n)*Math.sin((n-s)*(2*Math.PI)/p);},elasticOut:function(n){if(n==0||n==1){return n;}var p=0.3;var s=p/4;return Math.pow(2,-10*n)*Math.sin((n-s)*(2*Math.PI)/p)+1;},elasticInOut:function(n){if(n==0){return 0;}n=n*2;if(n==2){return 1;}var p=0.3*1.5;var s=p/4;if(n<1){n-=1;return -0.5*(Math.pow(2,10*n)*Math.sin((n-s)*(2*Math.PI)/p));}n-=1;return 0.5*(Math.pow(2,-10*n)*Math.sin((n-s)*(2*Math.PI)/p))+1;},bounceIn:function(n){return (1-dojo.fx.easing.bounceOut(1-n));},bounceOut:function(n){var s=7.5625;var p=2.75;var l;if(n<(1/p)){l=s*Math.pow(n,2);}else{if(n<(2/p)){n-=(1.5/p);l=s*Math.pow(n,2)+0.75;}else{if(n<(2.5/p)){n-=(2.25/p);l=s*Math.pow(n,2)+0.9375;}else{n-=(2.625/p);l=s*Math.pow(n,2)+0.984375;}}}return l;},bounceInOut:function(n){if(n<0.5){return dojo.fx.easing.bounceIn(n*2)/2;}return (dojo.fx.easing.bounceOut(n*2-1)/2)+0.5;}};}if(!dojo._hasResource["dojox.timing.Sequence"]){dojo._hasResource["dojox.timing.Sequence"]=true;dojo.provide("dojox.timing.Sequence");dojo.experimental("dojox.timing.Sequence");dojo.declare("dojox.timing.Sequence",null,{_goOnPause:0,_running:false,constructor:function(){this._defsResolved=[];},go:function(defs,_b95){this._running=true;dojo.forEach(defs,function(cur){if(cur.repeat>1){var _b96=cur.repeat;for(var j=0;j<_b96;j++){cur.repeat=1;this._defsResolved.push(cur);}}else{this._defsResolved.push(cur);}},this);var last=defs[defs.length-1];if(_b95){this._defsResolved.push({func:_b95});}this._defsResolved.push({func:[this.stop,this]});this._curId=0;this._go();},_go:function(){if(!this._running){return;}var cur=this._defsResolved[this._curId];this._curId+=1;function _b97(func){var ret=null;if(dojo.isArray(func)){if(func.length>2){ret=func[0].apply(func[1],func.slice(2));}else{ret=func[0].apply(func[1]);}}else{ret=func();}return ret;};if(this._curId>=this._defsResolved.length){_b97(cur.func);return;}if(cur.pauseAfter){if(_b97(cur.func)!==false){setTimeout(dojo.hitch(this,"_go"),cur.pauseAfter);}else{this._goOnPause=cur.pauseAfter;}}else{if(cur.pauseBefore){var x=dojo.hitch(this,function(){if(_b97(cur.func)!==false){this._go();}});setTimeout(x,cur.pauseBefore);}else{if(_b97(cur.func)!==false){this._go();}}}},goOn:function(){if(this._goOnPause){setTimeout(dojo.hitch(this,"_go"),this._goOnPause);this._goOnPause=0;}else{this._go();}},stop:function(){this._running=false;}});}if(!dojo._hasResource["plugins.files.Dialog"]){dojo._hasResource["plugins.files.Dialog"]=true;dojo.provide("plugins.files.Dialog");dojo.declare("plugins.files.Dialog",[plugins.core.Common],{loginMessageId:"loginMessage",loginLauncherId:"loginLauncher",message:"",parentFunction:null,args:null,dialogWidget:null,cssFiles:[dojo.moduleUrl("plugins","files/css/dialog.css"),dojo.moduleUrl("dojox","widget/Dialog/Dialog.css")],constructor:function(args){this.args=args;this.message=args.message;this.parentFunction=args.parentFunction;this.url=args.url;this.query=args.query;this.launchdialogWindow();},launchdialogWindow:function(){var _b98=this;var _b99=document.createElement("table");_b99.className="dialogTable";var tr1=document.createElement("tr");var td1=document.createElement("td");var _b9a=document.createTextNode(this.message);td1.setAttribute("colspan",2);td1.appendChild(_b9a);tr1.appendChild(td1);var tr2=document.createElement("tr");var _b9b=new dijit.form.Button();_b9b.setLabel("Yes");_b9b.domNode.setAttribute("class","dialogButton");_b9b.onClick=function(e){_b98.query+="&modifier=overwrite";_b98.parentFunction(_b98.url,_b98.query);_b98.fadeOut("yes");};var _b9c=document.createElement("td");_b9c.setAttribute("align","center");_b9c.setAttribute("colspan",2);_b9c.appendChild(_b9b.domNode);var _b9d=new dijit.form.Button();_b9d.setLabel("No");_b9d.domNode.setAttribute("class","dialogButton");var _b98=this;var noTd=document.createElement("td");noTd.setAttribute("align","center");noTd.setAttribute("colspan",2);noTd.appendChild(_b9d.domNode);tr2.setAttribute("class","centeredRow");tr2.appendChild(_b9c);tr2.appendChild(noTd);_b99.appendChild(tr1);_b99.appendChild(tr2);document.body.appendChild(_b99);var _b9e=new dojox.widget.Dialog({id:"loginDialog",dimensions:[250,200],draggable:true,sizeDuration:200,sizeMethod:"combine",viewportPadding:"125",showTitle:"true",title:"Confirmation"},"progDialog");_b9e.attr("class","centered");this.dialogWidget=_b9e;_b9e.setContent(_b99);_b9e.startup();_b9e.show();},fadeOut:function(){dojo.fadeOut({node:"loginDialog",duration:700}).play();setTimeout("dijit.byId('loginDialog').destroy()",700);}});}if(!dojo._hasResource["plugins.dijit.Confirm"]){dojo._hasResource["plugins.dijit.Confirm"]=true;dojo.provide("plugins.dijit.Confirm");dojo.declare("plugins.dijit.Confirm",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n    <table\n        cellspacing=\"0px\" cellpadding=\"0px\"\n        height=\"300px\" width=\"100%\" >\n        <tr>\n            <td>\n                \n                <div\n                    dojoAttachPoint=\"dialog\"\n                    dojoType=\"dijit.Dialog\"\n                    class=\"confirmDialog\"\n                    closeText=\"false\"\n                    title=\"${title}\"\n                >\n                    \n                    <table\n                        cellpadding=\"0\"\n                        cellspacing=\"0\"\n                        width=\"100%\"\n                        >\n                        <tr class=\"message\" align=\"center\">\n                            <td\n                                align=\"center\"\n                                dojoAttachPoint=\"messageNode\"\n                                colspan=\"2\">${message}</td>\n                        </tr>\n                        \n                        <tr>\n                            <td align=\"center\" class=\"yesButton\">\n                                <button\n                                    dojoType=\"dijit.form.Button\"\n                                    type=\"button\"\n                                    label=\"Yes\"\n                                    dojoAttachEvent=\"onClick:doYes\"\n                                    >\n                                </button>\n                            </td>\n\n                            <td align=\"center\" class=\"noButton\">\n                                <div\n                                    dojoType=\"dijit.form.Button\"\n                                    type=\"button\"\n                                    label=\"No\"\n                                    dojoAttachEvent=\"onClick:doNo\"\n                                    >\n                                </div>\n                            </td>\n                        </tr>\n                    </table>\n\n                </div>\n            \n            </td>\n        </tr>\n    </table>\n</div>\n",cssFiles:[dojo.moduleUrl("plugins")+"/dijit/css/confirmdialog.css"],widgetsInTemplate:true,parentWidget:null,application:null,title:null,message:null,constructor:function(args){this.title=args.title;this.message=args.message;this.parentWidget=args.parentWidget;this.yesCallback=args.yesCallback;this.noCallback=args.noCallback;this.loadCSS();},getApplication:function(){return this.application;},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.setDialogue();dojo.addClass(this.dialog.containerNode,"confirmDialog");dojo.addClass(this.dialog.titleNode,"confirmDialog");dojo.addClass(this.dialog.closeButtonNode,"confirmDialog");},show:function(){this.dialog.show();},hide:function(){this.dialog.hide();},doYes:function(type){this.yesCallback();this.dialog.hide();},doNo:function(){this.noCallback();this.dialog.hide();},load:function(args){if(args.title==null){args.title="Input dialogue";}this.dialog.titleNode.innerHTML=args.title;this.dialog.messageNode.innerHTML=args.message;this.dialog.yesCallback=args.yesCallback;this.dialog.noCallback=args.noCallback;this.show();},setDialogue:function(){document.body.appendChild(this.dialog.domNode);}});}if(!dojo._hasResource["plugins.files._GroupDragPane"]){dojo._hasResource["plugins.files._GroupDragPane"]=true;dojo.provide("plugins.files._GroupDragPane");dojo.declare("plugins.files._GroupDragPane",[dojox.widget._RollingListPane],{templateString:"<div><div dojoAttachPoint=\"containerNode\"></div>"+"<div dojoAttachPoint=\"menuContainer\">"+"<div dojoAttachPoint=\"menuNode\"></div>"+"</div></div>",_dragSource:null,_copyBox:null,debug:false,polling:false,loading:false,core:null,constructor:function(args){this.inherited(arguments);this.core=args.core;this.path=args.path;this.parentPath=args.parentPath;},startup:function(){this.inherited(arguments);if(this.loading){return;}this.loading=true;this.setSequence();this.setStandby();},_doQuery:function(){this.isLoaded=false;this._setContentAndScroll(this.onFetchStart());this.store.fetch({query:this.path,onComplete:function(_b9f){this.items=_b9f;this.onItems();},onError:function(e){this._onError("Fetch",e);},scope:this});},onLoad:function(data){this.inherited(arguments);this.loading=false;},_onLoadHandler:function(data){this.isLoaded=true;try{this.onLoad(data);}catch(e){}this.core.folders.roundRobin();},_loadCheck:function(_ba0){var _ba1=this._isShown();if((this.store||this.items)&&(_ba0||(this.refreshOnShow&&_ba1)||(!this.isLoaded&&_ba1))){this.query=this.path;this._doQuery();}},_setContent:function(cont){if(!this._dragSource){}},createMenu:function(type){if(type=="workflow"){if(this.workflowMenu){return this.workflowMenu.menu;}}else{if(type=="folder"){if(this.folderMenu){return this.folderMenu.menu;}}else{if(this.fileMenu){return this.fileMenu.menu;}}}},addItem:function(name,type,_ba2,_ba3){this.removeEmptyItem();var item=new Object;item.name=name;item.type=[type];item.directory=true;item.parentPath=this.path;item.path=name;item.children=[];this.items.push(item);var _ba4=dojo.clone(item);Agua.setFileCache(_ba2,_ba3,_ba4);var _ba5=this.parentWidget._getMenuItemForItem(item,this);this._dragSource.insertNodes(false,[_ba5]);var _ba6=this._dragSource.getAllNodes();var node=_ba6[_ba6.length-1];node.setAttribute("dndType","file");dojo.addClass(node,"directory");node.item=item;node.item._S=_ba5.store;var _ba7=this.createMenu(type);_ba7.bindDomNode(node);dojo.connect(node,"onclick",this,"onclickHandler");},renameItem:function(_ba8,_ba9){var _baa=_ba8.item.name;_ba8.innerHTML=_ba9;for(i=0;i<this.items.length;i++){var _bab=this.items[i];if(_bab.name==_baa){_bab.name=_ba9;_bab.path=_ba9;if(_bab.children.length){for(var i=0;i<_bab.children.length;i++){var _bac=_bab.children[i].parentPath;var re=new RegExp(_baa+"$");_bac=_bac.replace(re,_ba9);_bab.children[i].parentPath=_bac;}}break;}}},deleteItem:function(_bad){for(i=0;i<this.items.length;i++){var _bae=this.items[i];if(_bae.name==_bad.item.name){this.items.splice(i,1);break;}}dojo.destroy(_bad);if(!this.items.length){this.addEmptyItem();this.onItems();}var _baf=this.parentWidget;var _bb0=_baf.getChildren();var _bb1=_bb0.length;for(var i=0;i<_bb0.length;i++){if(_bb0[i]==this){_bb1=i;break;}}if(_bb1==_bb0.length){return;}_baf._removeAfter(_bb1);},removeEmptyItem:function(){var _bb2=this._dragSource.getAllNodes();var _bb3=dojo.clone(this._dragSource.getAllNodes());if(_bb2[0].item.name!="<EMPTY>"){return;}this.items.splice(0,1);dojo.destroy(_bb2[0]);},addEmptyItem:function(){if(this.items.length){return;}var item=new Object;item.name="<EMPTY>";item.parentPath=this.path;this.items.push(item);},inItems:function(_bb4){if(_bb4==null){return;}var _bb5=this._dragSource.getAllNodes();for(var i=0;i<_bb5.length;i++){if(_bb4==_bb5[i].innerHTML){return true;}}return false;},onItems:function(){var _bb6=this;for(var i=0;i<this.items.length;i++){this.items[i].path=this.items[i].name;}var _bb7,_bb8=false;this._dragSource=this._getDragSource({path:this.path,parentPath:this.parentPath});this._dragSource.store=this.store;if(!this.items.length){this.addEmptyItem();}var _bb9,_bba;if(this.items.length){dojo.forEach(this.items,function(item){_bb9=this.parentWidget._getMenuItemForItem(item,this);if(_bb9){this._dragSource.insertNodes(false,[_bb9]);var _bbb=this._dragSource.getAllNodes();var _bbc=_bbb[_bbb.length-1];if(item.children){for(var i=0;i<item.children.length;i++){item.children[i]._S=item._S;var _bbd;var _bbe="";if(item.parentPath){_bbe=item.parentPath;}if(item.path){if(_bbe){_bbe+="/"+item.path;}else{_bbe=item.path;}}if(_bbe){item.children[i].parentPath=_bbe;}}item.directory=true;}_bbc.item=item;dojo.hasClass(_bbc,"dojoxRollingListItemSelected");var _bbf=_bbc.innerHTML;var _bc0=this.getIndexInParent();var _bc1;if(_bc0==0){_bc1="workflow";}else{if(item.directory==false||item.directory=="false"){_bc1="file";}else{_bc1="folder";}}var _bc2=_bb6.createMenu(_bc1);if(_bc2!=null){_bc2.bindDomNode(_bbc);}_bbc.setAttribute("dndType",_bc1);dojo.connect(_bbc,"onclick",this,"onclickHandler");var _bc3=this._dragSource;this._dragSource.onDropExternal=function(_bc4,_bc5,copy){_bb6.onDropExternal(_bc4,_bc5,copy,_bc3,item,_bbc);};}},this);}var _bc6=this._dragSource.getAllNodes();for(var i=0;i<_bc6.length;i++){var node=_bc6[i];dojo.addClass(node,"fileDrag");if(!node.item.directory||node.item.directory=="false"){dojo.addClass(node,"file");dojo.addClass(node,"fileClosed");}else{dojo.addClass(node,"directory");dojo.addClass(node,"directoryClosed");}var _bc7=node.innerHTML;var _bc8=this.getIndexInParent();var _bc9;if(_bc8==0){_bc9="workflow";}else{_bc9="file";}node.setAttribute("dndType",_bc9);}this.containerNode.innerHTML="";this.containerNode.appendChild(this.menuNode);this.parentWidget.scrollIntoView(this);this.inherited(arguments);},onDropExternal:function(_bca,_bcb,copy,_bcc,item,_bcd){this.lastNode=_bcd;this._dragSource=_bcc;var _bce=this.store.putData.location;var file=_bcb[0].item.parentPath+"/"+_bcb[0].item.path;var _bcf=this.path;if(_bce&&!_bcf.match(/^\//)){_bcf=_bce+"/"+this.path;}this.checkFilePresent(file,_bcf);},checkFilePresent:function(file,_bd0){if(this.inItems(file)){thisObject.confirmOverwrite(file,_bd0);}else{this.prepareCopy(file,_bd0);this.copyFile();this.delayedPollCopy();}},prepareCopy:function(file,_bd1){var _bd2=this.store.putData;_bd2.mode="copyFile";_bd2.sessionid=Agua.cookie("sessionid");_bd2.username=Agua.cookie("username");_bd2.file=file;_bd2.destination=_bd1;this.putData=_bd2;},confirmOverwrite:function(file,_bd3){var _bd4=this;var _bd5=function(){_bd4.prepareCopy(file,_bd3);_bd4.copyFile();_bd4.delayedPollCopy();};var _bd6=function(){};var _bd7="Delete file: "+file+"?";var _bd8="File already exists<br>Do you want to overwrite it?<br><span style='color: #222;'>Click 'Yes' to delete or 'No' to cancel</span>";if(this.confirm!=null){this.confirm.destroy();}this.confirm=new plugins.dijit.Confirm({parentWidget:this,title:_bd7,message:_bd8,yesCallback:_bd5,noCallback:_bd6});this.confirm.show();},copyFile:function(){var _bd9=this.putData;var url=Agua.cgiUrl+"folders.cgi?";this.standby.show();var _bda=this;dojo.xhrPut({url:url,handleAs:"json-comment-optional",sync:false,putData:dojo.toJson(_bd9),handle:function(_bdb){if(!_bdb||!_bdb.error){_bda.pollCopy();}else{if(_bdb.error){_bda.standby.hide();Agua.toastMessage({message:_bdb.error,type:"error"});}}}});},delayedPollCopy:function(_bdc){if(!_bdc){_bdc=6000;}var _bdd=[{func:[this.showMessage,this,"_GroupDragPane.delayedPollCopy"],pauseAfter:_bdc},{func:this.pollCopy}];this.sequence.go(_bdd,function(){});},showMessage:function(_bde){},pollCopy:function(){if(!this.putData){if(this.standby){this.standby.hide();}return;}this.putData.modifier="status";var url=Agua.cgiUrl+"folders.cgi?";var _bdf=this;var _be0=false;dojo.xhrPut({url:url,handleAs:"json-comment-optional",sync:false,putData:dojo.toJson(this.putData),handle:function(_be1){if(_be1.status=="completed"){_bdf.polling=false;_bdf.standby.hide();Agua.setFileCache(_bdf.putData.username,_bdf.putData.destination,null);var _be2=new Object;_be2.mode="fileSystem";_be2.sessionid=Agua.cookie("sessionid");_be2.username=_bdf.putData.username;_be2.url=Agua.cgiUrl+"folders.cgi?";_be2.path=_be2.destination;_bdf.parentWidget.store.putData=_be2;_bdf.url=_be2.url;_bdf.putData=_be2;_bdf.reloadPane();}else{if(_be1.error){_bdf.polling=false;_bdf.standby.hide();}else{_bdf.delayedPollCopy();}}}});},setSequence:function(){this.sequence=new dojox.timing.Sequence({});},setStandby:function(){var id=dijit.getUniqueId("dojox_widget_Standby");this.standby=new dojox.widget.Standby({target:this.parentWidget.domNode,onClick:"reload",text:"Copying",id:id,url:"plugins/core/images/agua-biwave-24.png"});document.body.appendChild(this.standby.domNode);return this.standby;},reloadPane:function(){var item=this.lastNode.item;var _be3=item.children;if(!_be3){_be3=item.items;}item=this.itemParent(item);var _be4=this.parentWidget._getPaneForItem(item,this._dragSource,_be3);this.query=_be4.store.query;if(_be4){var _be5=this.getIndexInParent();this.parentWidget.addChild(_be4,this.getIndexInParent());}},itemParent:function(item){item.directory=true;if(item.parentPath.match(/^.+\/([^\/]+)$/)){item.path=item.parentPath.match(/^(.+?)\/([^\/]+)$/)[2];item.parentPath=item.parentPath.match(/^(.+?)\/([^\/]+)$/)[1];}else{if(item.parentPath.match(/\/*[^\/]+$/)){item.path=item.parentPath;item.parentPath="";}}item.name=item.path;return item;},onclickHandler:function(e){var item=e.target.item;var _be6=item.children||item.items;var _be7=this.parentWidget._getPaneForItem(item,this,_be6);this.query=_be7.store.query;if(_be7){this.parentWidget.addChild(_be7,this.getIndexInParent()+1);}else{this.parentWidget(this);this.parentWidget._onItemClick(null,this,selectMenuItem.item,selectMenuItem.children);}},focus:function(_be8){if(this._dragSource){if(this._pendingFocus){this.disconnect(this._pendingFocus);}delete this._pendingFocus;var _be9=this._dragSource.focusedChild;if(!_be9){var _bea=dojo.query(".dojoxRollingListItemSelected",this.domNode)[0];if(_bea){_be9=dijit.byNode(_bea);}}if(!_be9){_be9=this._dragSource.getAllNodes()[0]||this._dragSource;}this._focusByNode=false;if(_be9.focusNode){if(!this.parentWidget._savedFocus||_be8){try{_be9.focusNode.focus();}catch(e){}}window.setTimeout(function(){try{dijit.scrollIntoView(_be9.focusNode);}catch(e){}},1);}else{if(_be9.focus){if(!this.parentWidget._savedFocus||_be8){_be9.focus();}}else{this._focusByNode=true;}}this.inherited(arguments);}else{if(!this._pendingFocus){this._pendingFocus=this.connect(this,"onItems","focus");}else{}}},_getDragSource:function(){var _beb="dojo.dnd.Source";var id=dijit.getUniqueId(_beb.replace(/\./g,"_"));this.menuNode.id=id;var _bec=this.getIndexInParent();var _bed;if(_bec==0){_bed="workflow";}else{_bed="file";}var _bee=new dojo.dnd.Source(id,{accept:[_bed],copyOnly:true});this.menuNode.setAttribute("class","fileDrag");if(this.path){_bee.path=this.path;}if(this.parentPath){_bee.parentPath=this.parentPath;}if(!_bee._started){_bee.startup();}return _bee;},getPreviousPane:function(){var _bef=this.parentWidget;var _bf0=0;var _bf1=_bef.getChildren();for(var i=0;i<_bf1.length;i++){if(_bf1[i]==this){_bf0=i;break;}}if(_bf0==0){return null;}return _bf1[_bf0-1];}});}if(!dojo._hasResource["plugins.files._FileInfoPane"]){dojo._hasResource["plugins.files._FileInfoPane"]=true;dojo.provide("plugins.files._FileInfoPane");dojo.declare("plugins.files._FileInfoPane",[dojox.widget._RollingListPane],{templateString:"",templateString:"<div class=\"dojoxFileInfoPane\">\n\t<table>\n\t\t<tbody>\n\t\t\t<tr>\n\t\t\t\t<td class=\"dojoxFileInfoLabel dojoxFileInfoNameLabel\">Filename </td>\n\t\t\t\t<td colspan=\"3\" align=\"left\" class=\"dojoxFileInfoName\" dojoAttachPoint=\"nameNode\"></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td class=\"dojoxFileInfoLabel dojoxFileInfoSizeLabel\">Size (bytes) </td>\n\t\t\t\t<td align=\"left\" class=\"dojoxFileInfoSize\" dojoAttachPoint=\"sizeNode\"></td>\n\t\t\t\t<td class=\"dojoxFileInfoLabel dojoxFileInfoBytesLabel\">Sample (bytes) </td>\n\t\t\t\t<td align=\"left\" class=\"dojoxFileInfoBytes\" dojoAttachPoint=\"bytesNode\"></td>\n\t\t\t</tr>\n\t\t</tbody>\n\t</table>\n<hr>\t\n\t<table>\n\t\t<tbody>\n\t\t\t<tr>\n\t\t\t\t<td align=\"left\" class=\"dojoxFileInfoSample\" dojoAttachPoint=\"sampleNode\"></td>\n\t\t\t</tr>\n\t\t</tbody>\n\t</table>\n</div>\n\n\t\n",postMixInProperties:function(){this.inherited(arguments);},onItems:function(){var _bf2=this.store,item=this.items[0];if(!item){this._onError("Load",new Error("No item defined"));}else{this.nameNode.innerHTML=_bf2.getValue(item,"name");this.sampleNode.innerHTML=_bf2.getValue(item,"sample");this.sizeNode.innerHTML=_bf2.getValue(item,"size");this.bytesNode.innerHTML=_bf2.getValue(item,"bytes");this.parentWidget.scrollIntoView(this);this.inherited(arguments);}},_setContentAndScroll:function(cont,_bf3){return;this._setContent(cont,_bf3);this.parentWidget.scrollIntoView(this);},});}if(!dojo._hasResource["plugins.files.FileDrag"]){dojo._hasResource["plugins.files.FileDrag"]=true;dojo.provide("plugins.files.FileDrag");dojo.declare("plugins.files.FileDrag",[plugins.core.Common,dojox.widget.RollingList],{cssFiles:[dojo.moduleUrl("dojox")+"widget/Dialog/Dialog.css",dojo.moduleUrl("dojox")+"widget/RollingList/RollingList.css",dojo.moduleUrl("plugins.files")+"/FileDrag/FileDrag.css"],templateString:"<div class=\"dojoxRollingList ${className}\"\n\t><div class=\"dojoxRollingListContainer\" dojoAttachPoint=\"containerNode\" dojoAttachEvent=\"onkeypress:_onKey\"\n\t></div\n\t><div class=\"dojoxRollingListButtons\" dojoAttachPoint=\"buttonsNode\"\n        ><button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"okButton\"\n\t\t\t\tdojoAttachEvent=\"onClick:_onExecute\">${okButtonLabel}</button\n        ><button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"cancelButton\"\n\t\t\t\tdojoAttachEvent=\"onClick:_onCancel\">${cancelButtonLabel}</button\n\t></div\n></div>\n",className:"dojoxFileDrag",pathSeparator:"",topDir:"",parentAttr:"parentDir",pathAttr:"path",path:"",core:null,constructor:function(args){this.inherited(arguments);this.core=args.core;this.path=args.path;},addChild:function(_bf4,_bf5){this.inherited(arguments);},_itemsMatch:function(_bf6,_bf7){return true;},selectChild:function(_bf8){dojo.forEach(this.getChildren(),function(_bf9,_bfa){});},reload:function(){this._removeAfter(0);this._started=false;this.load();},startup:function(){this.domNode.setAttribute("style","height: auto !important; width: auto !important; overflow-y: scroll !important; overflow-x: hidden !important; border: none !important;");this.buttonsNode.setAttribute("style","display: none !important");this.loadCSS(this.cssFiles);if(this._started){return;}this.inherited(arguments);var conn,_bfb=this.getChildren()[0];var _bfc=dojo.hitch(this,function(){if(conn){this.disconnect(conn);}delete conn;var item=_bfb.items[0];if(item){var _bfd=this.store;var _bfe=_bfd.getValue(item,this.parentAttr);var path=_bfd.getValue(item,this.pathAttr);this.pathSeparator=this.pathSeparator||_bfd.pathSeparator;if(!this.pathSeparator){this.pathSeparator=path.substring(_bfe.length,_bfe.length+1);}if(!this.topDir){this.topDir=_bfe;if(!this.topDir){return;}if(this.topDir.lastIndexOf(this.pathSeparator)!=(this.topDir.length-1)){this.topDir+=this.pathSeparator;}}}});if(!this.pathSeparator||!this.topDir){if(!_bfb.items){conn=this.connect(_bfb,"onItems",_bfc);}else{_bfc();}}},_removeAfter:function(idx){if(typeof idx!="number"){idx=this.getIndexOfChild(idx);}var _bff=this.getChildren().length;dojo.forEach(this.getChildren(),function(c,i){if(i>idx){this.removeChild(c);c.destroy();}},this);var _c00=this.getChildren(),_c01=_c00[_c00.length-1];var _c02=null;while(_c01&&!_c02){var val=_c01._getSelected?_c01._getSelected():null;if(val){_c02=val.item;}_c01=_c01.parentPane;}if(!this._setInProgress){this._setValue(_c02);}},addChild:function(_c03,_c04){this._removeAfter(_c04-1);this.inherited(arguments);if(!_c03._started){_c03.startup();}this.layout();if(!this._savedFocus){_c03.focus();}},removeChild:function(_c05){},getChildItems:function(item){var ret=this.inherited(arguments);if(!ret&&this.store.getValue(item,"directory")){ret=[];}return ret;},_getMenuItemForItem:function(item,_c06){var _c07;_c07=this.getMenuItemForItem(item,_c06,null);_c07.store=this.store;_c07.item=item;return _c07;},getMenuItemForItem:function(item,_c08,_c09){if(item=="<EMPTY>"){var _c0a={data:"EMPTY",type:["file"]};return _c0a;}var _c0b=this.parentWidget.domNode.childNodes;var _c0c="workflow";if(_c0b.length>1){_c0c="file";}var _c0a={data:item.name,type:[_c0c]};return _c0a;},_getPaneForItem:function(item,_c0d,_c0e){var pane=this.getPaneForItem(item,_c0d,_c0e);var _c0f=this.getPreviousParentPath();if(!_c0f){_c0f=this.store.path;}if(item&&item.name){if(_c0f){_c0f+="/";}_c0f+=item.name;}pane.store=new plugins.dojox.data.FileStore({url:this.store.url,putData:this.store.putData,pathAsQueryParam:true,path:_c0f,parentPath:_c0f,core:this.core});pane.store.path=this.path;this.store.path=this.path;if(item){pane.store.path=item.parentPath;if(pane.store.path==""){pane.store.path=item.name;}this.store.path+="/"+item.name;pane.path=item.parentPath+"/"+item.name;pane.store.path=item.parentPath+"/"+item.name;}else{pane.path=this.path;}pane.store.parentPath=this.path;pane.parentWidget=this;pane.parentPane=_c0d||null;if(!item){pane.query=this.query;pane.queryOptions=this.queryOptions;}else{if(_c0e){pane.items=_c0e;}else{pane.items=[item];}}return pane;},getPaneForItem:function(item,_c10,_c11){var _c12=null;var path="";var _c13="";var _c14=this.getChildren();if(_c14){for(var i=0;i<_c14.length;i++){}}if(_c14&&_c14.length>0){_c13=_c14[_c14.length-1].store.path;}var path=_c13;if(item&&item.path){path+="/"+item.path;}if(item){}if(!item||(this.store.isItem(item)&&_c14)||this.store.getValue(item,"directory")){this.core.filedrag=this;_c12=new plugins.files._GroupDragPane({parentPath:_c13,path:path,fileMenu:this.fileMenu,workflowMenu:this.workflowMenu,folderMenu:this.folderMenu,core:this.core});}else{_c12=new plugins.files._FileInfoPane({});dojo.removeClass(_c12.domNode,"dijitContentPane");}return _c12;},getPreviousParentPath:function(){var _c15="";var _c16=this.getChildren();if(_c16){for(var i=0;i<_c16.length;i++){}}if(_c16&&_c16.length>0){_c15=_c16[_c16.length-1].store.path;}return _c15;},_setPathValueAttr:function(path){if(!path){this.set("value",null);return;}if(path.lastIndexOf(this.pathSeparator)==(path.length-1)){path=path.substring(0,path.length-1);}this.store.fetchItemByIdentity({identity:path,onItem:dojo.hitch(this,"attr","value"),scope:this});},_getPathValueAttr:function(val){if(!val){val=this.value;}if(val&&this.store.isItem(val)){return this.store.getValue(val,this.pathAttr);}else{return "";}},onFetchStart:function(){return this.loadingMessage;},onFetchError:function(_c17){return this.errorMessage;}});}if(!dojo._hasResource["plugins.menu.Menu"]){dojo._hasResource["plugins.menu.Menu"]=true;dojo.provide("plugins.menu.Menu");dojo.declare("plugins.menu.Menu",[dijit.Menu],{enabled:true,_openMyself:function(args){console.log("Menu._openMyself    plugins.menu.Menu._openMyself(args)");if(this.enabled==false){return;}this.currentTarget=args.target;if(this.currentTarget){console.log("plugins.menu.Menu._openMyself    Setting add class 'dojoDndItemOver' to this.currentTarget: "+this.currentTarget);console.dir({currentTarget:this.currentTarget});dojo.addClass(this.currentTarget,"dojoDndItemOver");var _c18=dojo.attr(this.currentTarget,"class");console.log("plugins.menu.Menu._openMyself    this.currentTarget classes: "+_c18);}var _c19=args.target,_c1a=args.iframe,_c1b=args.coords;if(_c1b){if(_c1a){var od=_c19.ownerDocument,ifc=dojo.position(_c1a,true),win=this._iframeContentWindow(_c1a),_c1c=dojo.withGlobal(win,"_docScroll",dojo);var cs=dojo.getComputedStyle(_c1a),tp=dojo._toPixelValue,left=(dojo.isIE&&dojo.isQuirks?0:tp(_c1a,cs.paddingLeft))+(dojo.isIE&&dojo.isQuirks?tp(_c1a,cs.borderLeftWidth):0),top=(dojo.isIE&&dojo.isQuirks?0:tp(_c1a,cs.paddingTop))+(dojo.isIE&&dojo.isQuirks?tp(_c1a,cs.borderTopWidth):0);_c1b.x+=ifc.x+left-_c1c.x;_c1b.y+=ifc.y+top-_c1c.y;}}else{_c1b=dojo.position(_c19,true);_c1b.x+=10;_c1b.y+=10;}var self=this;var _c1d=dijit.getFocus(this);function _c1e(){if(self.refocus){dijit.focus(_c1d);}dijit.popup.close(self);};dijit.popup.open({popup:this,x:_c1b.x,y:_c1b.y,onExecute:_c1e,onCancel:_c1e,orient:this.isLeftToRight()?"L":"R"});this.focus();this._onBlur=function(){console.log("plugins.menu.Menu._onBlur");this.inherited("_onBlur",arguments);dijit.popup.close(this);};}});}if(!dojo._hasResource["plugins.dijit.InputDialog"]){dojo._hasResource["plugins.dijit.InputDialog"]=true;dojo.provide("plugins.dijit.InputDialog");dojo.declare("plugins.dijit.InputDialog",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n    <table\n        cellspacing=\"0px\"\n        height=\"300px\" width=\"100%\" style=\"padding: 0; margin: 0;\"\n        class=\"inputDialog\">\n        <tr>\n            <td align=\"center\">\n                \n                <div\n                    dojoAttachPoint=\"dialog\"\n                    dojoType=\"dijit.Dialog\"\n                    closeText=\"false\"\n                    title=\"${title}\"\n                    style=\"margin-right: auto; margin-left: auto; text-align: center;\"\n                    >\n                    \n                    <table\n                        cellpadding=\"0\"\n                        cellspacing=\"0\"\n                        class=\"inputDialog\"\n                        width=\"100%\"\n                        >\n\n                        <tr class=\"message\" align=\"center\">\n                            <td\n                                align=\"center\"\n                                dojoAttachPoint=\"messageNode\"\n                                colspan=\"2\">${message}</td>\n                        </tr>\n\n                        <tr class=\"input\" align=\"center\" dojoAttachPoint=\"inputContainer\">\n                            <td align=\"center\" colspan=\"2\" >\n                                <input type=\"text\" align=\"center\"\n                                dojoAttachPoint=\"inputNode\"\n                                value=\"\"></input>\n                            </td>\n                        </tr>\n                        \n\n                        <tr\n                            dojoAttachPoint=\"checkboxContainer\"\n                            class=\"hidden\">\n\n                            <td colspan=\"2\">\n                                <table>\n                                    <tr>\n                                        <td class=\"leftColumn\"\n                                            dojoAttachPoint=\"checkboxMessageNode\"\n                                            class=\"hidden\"\n                                        >\n                                        </td>\n                                        <td class=\"rightColumn\">\n                                            <input\n                                                dojoAttachPoint=\"checkbox\"  \n                                                style=\"visibility: hidden\"\n                                                type=\"checkbox\"\n                                                class=\"hidden\"\n                                        >\n                                        </td>\n                                    </tr>\n                                </table>\n                            </td>\n\n                        </tr>\n                        \n\n                        <tr>\n                            <td align=\"center\" class=\"enterButton\">\n                                <button\n                                    dojoType=\"dijit.form.Button\"\n                                    type=\"button\"\n                                    label=\"Enter\"\n                                    dojoAttachEvent=\"onClick:doEnter\"\n                                    >\n                                </button>\n                            </td>\n\n                            <td align=\"center\" class=\"cancelButton\">\n                                <div\n                                    dojoType=\"dijit.form.Button\"\n                                    type=\"button\"\n                                    label=\"Cancel\"\n                                    dojoAttachEvent=\"onClick:doCancel\"\n                                    >\n                                </div>\n                            </td>\n                        </tr>\n                        \n                        \n                    </table>\n\n                </div>\n            \n            </td>\n        </tr>\n    </table>\n</div>\n",cssFiles:[dojo.moduleUrl("plugins","dijit/css/inputdialog.css")],widgetsInTemplate:true,parentWidget:null,application:null,message:null,constructor:function(args){this.setEnterLabel(args.enterLabel);this.setCancelLabel(args.cancelLabel);this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.setDialogue();this.showInputbox(this.inputMessage);this.showCheckbox(this.checkboxMessage);this.setNamespaceClass("inputDialog");},setNamespaceClass:function(_c1f){dojo.addClass(this.dialog.containerNode,_c1f);dojo.addClass(this.dialog.titleNode,_c1f);dojo.addClass(this.dialog.closeButtonNode,_c1f);},show:function(){this.dialog.show();this.enterButton.focus();},hide:function(){this.dialog.hide();},doEnter:function(type){var _c20=this.inputNode.value;var _c21=this.checkbox.checked;if(_c21==true){_c21=1;}else{_c21=0;}this.dialog.enterCallback(_c20,_c21);this.inputNode.value="";this.dialog.hide();},doCancel:function(){this.dialog.cancelCallback();this.dialog.hide();},setDialogue:function(){document.body.appendChild(this.dialog.domNode);this.dialog.parentWidget=this;this._fadeOutDeferred=function(){};},load:function(args){if(args.title==null){args.title="";}this.dialog.titleNode.innerHTML=args.title;this.messageNode.innerHTML=args.message;this.dialog.enterCallback=args.enterCallback;this.dialog.cancelCallback=args.cancelCallback;this.showCheckbox(args.checkboxMessage);this.setEnterLabel(args.enterLabel);this.setCancelLabel(args.cancelLabel);this.show();},showInputbox:function(_c22){if(_c22==null){dojo.destroy(this.inputContainer);}else{this.inputNode.style.visibility="visible";this.checkbox.style.visibility="visible";this.inputNode.innerHTML=_c22;var _c23=this;this.inputNode.onkeypress=function(evt){var key=evt.which;if(key==13){evt.stopPropagation();_c23.doEnter();}};}},showCheckbox:function(_c24){if(_c24==null){dojo.addClass(this.checkboxMessageNode,"hidden");dojo.addClass(this.checkbox,"hidden");}else{dojo.removeClass(this.checkboxMessageNode,"hidden");dojo.removeClass(this.checkbox,"hidden");this.inputNode.innerHTML=_c24;}},setEnterLabel:function(_c25){if(_c25!=null&&this.enterButton!=null){this.enterButton.set("label",_c25);}},setCancelLabel:function(_c26){if(_c26!=null&&this.cancelButton!=null){this.cancelButton.set("label",_c26);}}});}if(!dojo._hasResource["plugins.dijit.InteractiveDialog"]){dojo._hasResource["plugins.dijit.InteractiveDialog"]=true;dojo.provide("plugins.dijit.InteractiveDialog");dojo.declare("plugins.dijit.InteractiveDialog",[plugins.dijit.InputDialog],{show:function(){this.dialog.show();},hide:function(){this.dialog.hide();},doEnter:function(type){console.log("InteractiveDialog.doEnter    plugins.dijit.InteractiveDialog.doEnter()");console.log("InteractiveDialog.doEnter    Doing this.dialog.hide()");this.dialog.hide();var _c27="";if(this.inputNode!=null){_c27=this.inputNode.value;}var _c28=false;if(this.checkbox!=null){_c28=this.checkbox.checked;}if(_c28==true){_c28=1;}else{_c28=0;}console.log("InteractiveDialog.doEnter    input: "+_c27);console.log("InteractiveDialog.doEnter    checked: "+_c28);this.dialog.enterCallback(_c27,_c28,this);},doCancel:function(){console.log("InteractiveDialog.doCancel    plugins.dijit.InteractiveDialog.doCancel()");this.dialog.hide();this.dialog.cancelCallback();},close:function(){this.dialog.hide();this.inputNode.value="";}});}if(!dojo._hasResource["plugins.dijit.ConfirmDialog"]){dojo._hasResource["plugins.dijit.ConfirmDialog"]=true;dojo.provide("plugins.dijit.ConfirmDialog");dojo.declare("plugins.dijit.ConfirmDialog",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n    <table\n        cellspacing=\"0px\" cellpadding=\"0px\"\n        height=\"300px\" width=\"100%\" >\n        <tr>\n            <td>\n                \n                <div\n                    dojoAttachPoint=\"dialog\"\n                    dojoType=\"dijit.Dialog\"\n                    class=\"confirmDialog\"\n                    closeText=\"false\"\n                    title=\"${title}\"\n                >\n                    \n                    <table\n                        cellpadding=\"0\"\n                        cellspacing=\"0\"\n                        width=\"100%\"\n                        >\n                        <tr class=\"message\" align=\"center\">\n                            <td\n                                align=\"center\"\n                                dojoAttachPoint=\"messageNode\"\n                                colspan=\"2\">${message}</td>\n                        </tr>\n                        \n                        <tr>\n                            <td align=\"center\" class=\"yesButton\">\n                                <button\n                                    dojoType=\"dijit.form.Button\"\n                                    type=\"button\"\n                                    label=\"Yes\"\n                                    dojoAttachEvent=\"onClick:doYes\"\n                                    >\n                                </button>\n                            </td>\n\n                            <td align=\"center\" class=\"noButton\">\n                                <div\n                                    dojoType=\"dijit.form.Button\"\n                                    type=\"button\"\n                                    label=\"No\"\n                                    dojoAttachEvent=\"onClick:doNo\"\n                                    >\n                                </div>\n                            </td>\n                        </tr>\n                    </table>\n\n                </div>\n            \n            </td>\n        </tr>\n    </table>\n</div>\n",cssFiles:[dojo.moduleUrl("plugins.dijit")+"/css/confirmdialog.css"],widgetsInTemplate:true,parentWidget:null,application:null,title:null,message:null,constructor:function(args){this.title=args.title;this.message=args.message;this.parentWidget=args.parentWidget;this.yesCallback=args.yesCallback;this.noCallback=args.noCallback;this.loadCSS();},getApplication:function(){return this.application;},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.setDialogue();dojo.addClass(this.dialog.containerNode,"confirmDialog");dojo.addClass(this.dialog.titleNode,"confirmDialog");dojo.addClass(this.dialog.closeButtonNode,"confirmDialog");this.dialog.closeButtonNode.setAttribute("display","none");this.dialog.closeButtonNode.setAttribute("visibility","hidden");},show:function(){this.dialog.show();},hide:function(){this.dialog.hide();},doYes:function(type){this.dialog.yesCallback();this.dialog.hide();},doNo:function(){this.dialog.noCallback();this.dialog.hide();},load:function(args){if(args.title==null){args.title="";}this.dialog.titleNode.innerHTML=args.title;this.messageNode.innerHTML=args.message;this.dialog.yesCallback=args.yesCallback;this.dialog.noCallback=args.noCallback;this.show();},setDialogue:function(){document.body.appendChild(this.dialog.domNode);}});}if(!dojo._hasResource["dojox.form.uploader.Base"]){dojo._hasResource["dojox.form.uploader.Base"]=true;dojo.provide("dojox.form.uploader.Base");dojo.declare("dojox.form.uploader.Base",[dijit._Widget,dijit._Templated],{getForm:function(){if(!this.form){var n=this.domNode;while(n&&n.tagName&&n!==document.body){if(n.tagName.toLowerCase()=="form"){this.form=n;break;}n=n.parentNode;}}return this.form;},getUrl:function(){if(this.uploadUrl){this.url=this.uploadUrl;}if(this.url){return this.url;}if(this.getForm()){this.url=this.form.action;}return this.url;},connectForm:function(){this.url=this.getUrl();if(!this._fcon&&!!this.getForm()){this._fcon=true;this.connect(this.form,"onsubmit",function(evt){dojo.stopEvent(evt);this.submit(dojo.formToObject(this.form));});}},supports:function(what){if(!this._hascache){this._hascache={testDiv:dojo.create("div"),testInput:dojo.create("input",{type:"file"}),xhr:!!window.XMLHttpRequest?new XMLHttpRequest():{}};dojo.style(this._hascache.testDiv,"opacity",0.7);}switch(what){case "FormData":return !!window.FormData;case "sendAsBinary":return !!this._hascache.xhr.sendAsBinary;case "opacity":return dojo.style(this._hascache.testDiv,"opacity")==0.7;case "multiple":if(this.force=="flash"||this.force=="iframe"){return false;}var res=dojo.attr(this._hascache.testInput,"multiple");return res===true||res===false;}return false;},getMimeType:function(){return "application/octet-stream";},getFileType:function(name){return name.substring(name.lastIndexOf(".")+1).toUpperCase();},convertBytes:function(_c29){var kb=Math.round(_c29/1024*100000)/100000;var mb=Math.round(_c29/1048576*100000)/100000;var gb=Math.round(_c29/1073741824*100000)/100000;var _c2a=_c29;if(kb>1){_c2a=kb.toFixed(1)+" kb";}if(mb>1){_c2a=mb.toFixed(1)+" mb";}if(gb>1){_c2a=gb.toFixed(1)+" gb";}return {kb:kb,mb:mb,gb:gb,bytes:_c29,value:_c2a};}});}if(!dojo._hasResource["dojox.form.Uploader"]){dojo._hasResource["dojox.form.Uploader"]=true;dojo.provide("dojox.form.Uploader");dojo.experimental("dojox.form.Uploader");dojo.declare("dojox.form.Uploader",[dojox.form.uploader.Base],{uploadOnSelect:false,tabIndex:0,multiple:false,label:"Upload...",url:"",name:"uploadedfile",flashFieldName:"",uploadType:"form",_nameIndex:0,widgetsInTemplate:true,templateString:"<div class=\"dojoxFileInput\"><div dojoType=\"dijit.form.Button\" dojoAttachPoint=\"button\">${label}</div></div>",postMixInProperties:function(){this._inputs=[];this._getButtonStyle(this.srcNodeRef);this.inherited(arguments);},postCreate:function(){var _c2b=false;var _c2c=this.domNode.parentNode;var _c2d=this._getNodePosition(this.domNode);if(!this.btnSize.w||!this.btnSize.h){dojo.body().appendChild(this.domNode);this._getButtonStyle(this.domNode);_c2b=true;}this._setButtonStyle();if(_c2b){dojo.place(this.domNode,_c2d.node,_c2d.pos);}this.inherited(arguments);},onChange:function(_c2e){},onBegin:function(_c2f){},onProgress:function(_c30){},onComplete:function(_c31){console.log("dojox.form.Uploader.onComplete()");this.reset();},onCancel:function(){},onAbort:function(){},onError:function(_c32){},upload:function(_c33){},submit:function(form){},reset:function(){this._disconnectButton();this._inputs=[];this._nameIndex=0;this._createInput();},getFileList:function(){var _c34=[];if(this.supports("multiple")){dojo.forEach(this.inputNode.files,function(f,i){_c34.push({index:i,name:f.name,size:f.size,type:f.type});},this);}else{dojo.forEach(this._inputs,function(n,i){_c34.push({index:i,name:n.value.substring(n.value.lastIndexOf("\\")+1),size:0,type:n.value.substring(n.value.lastIndexOf(".")+1)});},this);}return _c34;},_getValueAttr:function(){return this.getFileList();},_setValueAttr:function(_c35){},_getDisabledAttr:function(){return this._disabled;},_setDisabledAttr:function(_c36){if(this._disabled==_c36){return;}this.button.set("disabled",_c36);dojo.style(this.inputNode,"display",_c36?"none":"block");},_getNodePosition:function(node){if(node.previousSibling){return {node:node.previousSibling,pos:"after"};}return {node:node.nextSibling,pos:"before"};},_getButtonStyle:function(node){if(!node){this.btnSize={w:200,h:25};}else{this.btnSize=dojo.marginBox(node);}},_setButtonStyle:function(){var _c37=true;if(!this.domNode.parentNode||!this.domNode.parentNode.tagName){document.body.appendChild(this.domNode);_c37=false;}dojo.style(this.domNode,{width:this.btnSize.w+"px",height:(this.btnSize.h+4)+"px",overflow:"hidden",position:"relative"});this.inputNodeFontSize=Math.max(2,Math.max(Math.ceil(this.btnSize.w/60),Math.ceil(this.btnSize.h/15)));this._createInput();dojo.style(this.button.domNode,{margin:"0px",display:"block",verticalAlign:"top"});dojo.style(this.button.domNode.firstChild,{margin:"0px",display:"block"});if(!_c37){document.body.removeChild(this.domNode);}},_createInput:function(){if(this._inputs.length){dojo.style(this.inputNode,{top:"500px"});this._disconnectButton();this._nameIndex++;}var name;if(this.supports("multiple")){name=this.name+"s[]";}else{name=this.name+(this.multiple?this._nameIndex:"");}this.inputNode=dojo.create("input",{type:"file",name:name,className:"dojoxInputNode"},this.domNode,"first");if(this.supports("multiple")&&this.multiple){dojo.attr(this.inputNode,"multiple",true);}this._inputs.push(this.inputNode);dojo.style(this.inputNode,{fontSize:this.inputNodeFontSize+"em"});var size=dojo.marginBox(this.inputNode);dojo.style(this.inputNode,{position:"absolute",top:"-2px",left:"-"+(size.w-this.btnSize.w-2)+"px",opacity:0});this._connectButton();},_connectButton:function(){this._cons=[];var cs=dojo.hitch(this,function(nm){this._cons.push(dojo.connect(this.inputNode,nm,this,function(evt){this.button._cssMouseEvent({type:nm});}));});cs("mouseover");cs("mouseout");cs("mousedown");this._cons.push(dojo.connect(this.inputNode,"change",this,function(evt){this.onChange(this.getFileList(evt));if(!this.supports("multiple")&&this.multiple){this._createInput();}}));this.button.set("tabIndex",-1);if(this.tabIndex>-1){this.inputNode.tabIndex=this.tabIndex;var _c38=dojo.style(this.button.domNode.firstChild,"border");this._cons.push(dojo.connect(this.inputNode,"focus",this,function(){dojo.style(this.button.domNode.firstChild,"border","1px dashed #ccc");}));this._cons.push(dojo.connect(this.inputNode,"blur",this,function(){dojo.style(this.button.domNode.firstChild,"border",_c38);}));}},_disconnectButton:function(){console.log("dojox.form.Uploaders._disconnectButton    this._cons:");console.dir({this_cons:this._cons});}});(function(){dojox.form.UploaderOrg=dojox.form.Uploader;var _c39=[dojox.form.UploaderOrg];dojox.form.addUploaderPlugin=function(plug){console.log("dojox.form.Uploader.addUploaderPlugin    XXXXXXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXXXX plug: "+plug);_c39.push(plug);dojo.declare("dojox.form.Uploader",_c39,{});};})();}if(!dojo._hasResource["dojox.form.uploader.FileList"]){dojo._hasResource["dojox.form.uploader.FileList"]=true;dojo.provide("dojox.form.uploader.FileList");dojo.declare("dojox.form.uploader.FileList",[dojox.form.uploader.Base],{uploaderId:"",uploader:null,headerIndex:"#",headerType:"Type",headerFilename:"File Name",headerFilesize:"Size",_upCheckCnt:0,rowAmt:0,templateString:"<div class=\"dojoxUploaderFileList\">"+"<div dojoAttachPoint=\"progressNode\" class=\"dojoxUploaderFileListProgress\"><div dojoAttachPoint=\"percentBarNode\" class=\"dojoxUploaderFileListProgressBar\"></div><div dojoAttachPoint=\"percentTextNode\" class=\"dojoxUploaderFileListPercentText\">0%</div></div>"+"<table class=\"dojoxUploaderFileListTable\">"+"<tr class=\"dojoxUploaderFileListHeader\"><th class=\"dojoxUploaderIndex\">${headerIndex}</th><th class=\"dojoxUploaderIcon\">${headerType}</th><th class=\"dojoxUploaderFileName\">${headerFilename}</th><th class=\"dojoxUploaderFileSize\">${headerFilesize}</th></tr>"+"<tr ><td colSpan=\"4\" class=\"dojoxUploaderFileListContainer\" dojoAttachPoint=\"containerNode\">"+"<table class=\"dojoxUploaderFileListContent\" dojoAttachPoint=\"listNode\"></table>"+"</td><tr>"+"</table>"+"<div>",postCreate:function(){this.setUploader();this.hideProgress();},reset:function(){console.log("dojox.form.uploader.FileList.reset()");for(var i=0;i<this.rowAmt;i++){this.listNode.deleteRow(0);}this.rowAmt=0;},setUploader:function(){if(!this.uploaderId&&!this.uploader){}else{if(this.uploaderId&&!this.uploader){this.uploader=dijit.byId(this.uploaderId);}else{if(this._upCheckCnt>4){return;}}}if(this.uploader){this.connect(this.uploader,"onChange","_onUploaderChange");this.connect(this.uploader,"reset","reset");this.connect(this.uploader,"onBegin",function(){this.showProgress(true);});this.connect(this.uploader,"onProgress","_progress");this.connect(this.uploader,"onComplete",function(){setTimeout(dojo.hitch(this,function(){this.hideProgress(true);}),1250);});}else{this._upCheckCnt++;setTimeout(dojo.hitch(this,"setUploader"),250);}},hideProgress:function(_c3a){var o=_c3a?{ani:true,endDisp:"none",beg:15,end:0}:{endDisp:"none",ani:false};this._hideShowProgress(o);},showProgress:function(_c3b){var o=_c3b?{ani:true,endDisp:"block",beg:0,end:15}:{endDisp:"block",ani:false};this._hideShowProgress(o);},_progress:function(_c3c){this.percentTextNode.innerHTML=_c3c.percent;dojo.style(this.percentBarNode,"width",_c3c.percent);},_hideShowProgress:function(o){var node=this.progressNode;var _c3d=function(){dojo.style(node,"display",o.endDisp);};if(o.ani){dojo.style(node,"display","block");dojo.animateProperty({node:node,properties:{height:{start:o.beg,end:o.end,units:"px"}},onEnd:_c3d}).play();}else{_c3d();}},_onUploaderChange:function(_c3e){dojo.forEach(_c3e,function(f,i){this._addRow(i+1,this.getFileType(f.name),f.name,f.size);},this);},_addRow:function(_c3f,type,name,size){var c,r=this.listNode.insertRow(-1);c=r.insertCell(-1);dojo.addClass(c,"dojoxUploaderIndex");c.innerHTML=_c3f;c=r.insertCell(-1);dojo.addClass(c,"dojoxUploaderIcon");c.innerHTML=type;c=r.insertCell(-1);dojo.addClass(c,"dojoxUploaderFileName");c.innerHTML=name;c=r.insertCell(-1);dojo.addClass(c,"dojoxUploaderSize");c.innerHTML=this.convertBytes(size).value;this.rowAmt++;}});}if(!dojo._hasResource["dojox.form.uploader.plugins.HTML5"]){dojo._hasResource["dojox.form.uploader.plugins.HTML5"]=true;dojo.provide("dojox.form.uploader.plugins.HTML5");dojo.declare("dojox.form.uploader.plugins.HTML5",[],{errMsg:"Error uploading files. Try checking permissions",uploadType:"html5",postCreate:function(){this.connectForm();this.inherited(arguments);if(this.uploadOnSelect){this.connect(this,"onChange","upload");}},upload:function(_c40){this.onBegin(this.getFileList());if(this.supports("FormData")){this.uploadWithFormData(_c40);}else{if(this.supports("sendAsBinary")){this.sendAsBinary(_c40);}}},submit:function(form){form=!!form?form.tagName?form:this.getForm():this.getForm();var data=dojo.formToObject(form);this.upload(data);},sendAsBinary:function(data){if(!this.getUrl()){}var _c41="---------------------------"+(new Date).getTime();var xhr=this.createXhr();xhr.setRequestHeader("Content-Type","multipart/form-data; boundary="+_c41);var msg=this._buildRequestBody(data,_c41);if(!msg){this.onError(this.errMsg);}else{xhr.sendAsBinary(msg);}},uploadWithFormData:function(data){if(!this.getUrl()){}var fd=new FormData();dojo.forEach(this.inputNode.files,function(f,i){fd.append(this.name+"s[]",f);},this);if(data){for(var nm in data){fd.append(nm,data[nm]);}}var xhr=this.createXhr();xhr.send(fd);},_xhrProgress:function(evt){if(evt.lengthComputable){var o={bytesLoaded:evt.loaded,bytesTotal:evt.total,type:evt.type,timeStamp:evt.timeStamp};if(evt.type=="load"){o.percent="100%",o.decimal=1;}else{o.decimal=evt.loaded/evt.total;o.percent=Math.ceil((evt.loaded/evt.total)*100)+"%";}this.onProgress(o);}},createXhr:function(){var xhr=new XMLHttpRequest();var _c42;xhr.upload.addEventListener("progress",dojo.hitch(this,"_xhrProgress"),false);xhr.addEventListener("load",dojo.hitch(this,"_xhrProgress"),false);xhr.addEventListener("error",dojo.hitch(this,function(evt){this.onError(evt);clearInterval(_c42);}),false);xhr.addEventListener("abort",dojo.hitch(this,function(evt){this.onAbort(evt);clearInterval(_c42);}),false);xhr.onreadystatechange=dojo.hitch(this,function(){if(xhr.readyState===4){console.info("dojox.form.uploader.plugins.HTML5    COMPLETE");clearInterval(_c42);this.onComplete({});}});xhr.open("POST",this.getUrl());_c42=setInterval(dojo.hitch(this,function(){try{if(typeof (xhr.statusText)){}}catch(e){clearInterval(_c42);}}),250);return xhr;},_buildRequestBody:function(data,_c43){var EOL="\r\n";var part="";_c43="--"+_c43;var _c44=[];dojo.forEach(this.inputNode.files,function(f,i){var _c45=this.name+"s[]";var _c46=this.inputNode.files[i].fileName;var _c47;try{_c47=this.inputNode.files[i].getAsBinary()+EOL;part+=_c43+EOL;part+="Content-Disposition: form-data; ";part+="name=\""+_c45+"\"; ";part+="filename=\""+_c46+"\""+EOL;part+="Content-Type: "+this.getMimeType()+EOL+EOL;part+=_c47;}catch(e){_c44.push({index:i,name:_c46});}},this);if(_c44.length){if(_c44.length>=this.inputNode.files.length){this.onError({message:this.errMsg,filesInError:_c44});part=false;}}if(!part){return false;}if(data){for(var nm in data){part+=_c43+EOL;part+="Content-Disposition: form-data; ";part+="name=\""+nm+"\""+EOL+EOL;part+=data[nm]+EOL;}}part+=_c43+"--"+EOL;return part;}});dojox.form.addUploaderPlugin(dojox.form.uploader.plugins.HTML5);}if(!dojo._hasResource["plugins.form.Uploader"]){dojo._hasResource["plugins.form.Uploader"]=true;dojo.provide("plugins.form.Uploader");dojo.declare("plugins.form.Uploader",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n<div id=\"attachPoint\" ></div>\n\n    <table\n        cellspacing=\"0px\"\n        height=\"300px\"\n        width=\"600px\"\n        style=\"padding: 0; margin: 0;\"\n\t\tclass=\"pageTable\"\n\t>\n        <tr>\n            <td align=\"center\">\n\t\t\t<td id=\"colForm\">\n                \n                <div\n                    dojoAttachPoint=\"dialog\"\n                    dojoType=\"dijit.Dialog\"\n                    closeText=\"true\"\n                    title=\"File Upload\"\n                    class=\"uploader\"\n\t\t\t\t\tdraggable=\"true\"\n                    style=\"margin-right: auto; margin-left: auto; text-align: center;\"\n\t\t\t\t>\n\n\t\t\t\t<form\n\t\t\t\t\tmethod=\"post\"\n\t\t\t\t\taction=\"../../../../../../cgi-bin/agua/upload.cgi\"\n\t\t\t\t\tenctype=\"multipart/form-data\" >\n\n\t\t\t\t\t<fieldset>\n\t\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tdojoType=\"dojox.form.Uploader\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"uploader\"\n\t\t\t\t\t\t\tclass=\"browseButton\"\n\t\t\t\t\t\t\tname=\"uploadedfile\"\n\t\t\t\t\t\t\tselectMultipleFiles=\"true\"\n\t\t\t\t\t\t\tmultiple=\"true\"\n\t\t\t\t\t\t\ttype=\"file\"\n\t\t\t\t\t\t\ttitle=\"Click to Select Files\"\n\t\t\t\t\t\t\tid=\"${uploaderId}\">\n\n<!--\t\t\t\t\t\t<div class=\"destination\">\n\t\t\t\t\t\t\tDestination\n\t\t\t\t\t\t\t<div dojoAttachPoint=\"destination\"></div>\n\t\t\t\t\t\t</div>\n\n-->\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tdojoAttachPoint=\"path\"\n\t\t\t\t\t\t\ttype=\"hidden\"\n\t\t\t\t\t\t\tname=\"path\"\n\t\t\t\t\t\t\tvalue=\"\" />\n\t\t\t\t\t\t\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"hidden\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"username\"\n\t\t\t\t\t\t\tname=\"username\"\n\t\t\t\t\t\t\tvalue=\"${username}\" />\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"hidden\"\n\t\t\t\t\t\t\tname=\"sessionid\"\n\t\t\t\t\t\t\tvalue=\"${sessionid}\" />\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tdojoType=\"dijit.form.Button\"\n\t\t\t\t\t\t\tdojoAttachEvent=\"onClick:clear\"\n\t\t\t\t\t\t\tlabel=\"Clear\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\t\tlabel=\"Submit\"\n\t\t\t\t\t\t\tdojoType=\"dijit.form.Button\" />\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoType=\"dojox.form.uploader.FileList\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"fileList\"\n\t\t\t\t\t\t\tuploaderId=\"${uploaderId}\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</fieldset>\n\t\t\t\t</form>\n\t\t\t\t\n\t\t\t</td>\n\t\t\t\n\t\t\t<td\n\t\t\t\tdojoAttachPoint=\"images\"\n\t\t\t>\n\t\t\t</td>\n\t\t</tr>\n\t</table>\n\n\n</div>\n",widgetsInTemplate:true,parentWidget:null,cssFiles:[dojo.moduleUrl("plugins","form/css/uploader.css"),dojo.moduleUrl("dojox","form/resources/UploaderFileList.css"),dojo.moduleUrl("dijit","themes/dijit.css"),],constructor:function(args){console.log("Uploader.constructor    args: ");console.dir({args:args});if(args!=null){this.url=args.url;this.parentWidget=args.parentWidget;this.username=args.username;this.sessionid=args.sessionid;this.path=args.path;}this.loadCSS(this.cssFiles);},postCreate:function(){console.log("Uploader.postCreate    plugins.form.Uploader.postCreate()");this.startup();},startup:function(){console.log("Uploader.startup    plugins.form.Uploader.startup()");this.inherited(arguments);this.setUploader();},clear:function(){console.log("Uploader.clear    this.fileList:");console.dir({fileList:this.fileList});this.fileList.reset();},setUploader:function(){console.log("Uploader.setUploader    plugins.form.Uploader.setUploader()");console.log("Uploader.setUploader    this.dialog: "+this.dialog);this.handleUpload(this.uploader,this.images);console.log("Uploader.setUploader    this.dialog: "+this.dialog);var _c48=this;dojo.connect(this.uploader,"onComplete",this,"onComplete");this.uploader.onComplete=function(_c49){console.log("Uploader.onComplete    dojox.form.plugins.Uploader.onComplete(data)");console.log("Uploader.onComplete    customEvent: ");console.dir({customEvent:_c49});_c48.onComplete(_c49);};this.uploader.createXhr=function(){console.log("Uploader.setUploader    OVERRIDE plugins.dojox.form.Uploader.HTML5.createXhr()");var xhr=new XMLHttpRequest();var _c4a;xhr.upload.addEventListener("progress",dojo.hitch(this,"_xhrProgress"),false);xhr.addEventListener("load",dojo.hitch(this,"_xhrProgress"),false);xhr.addEventListener("error",dojo.hitch(this,function(evt){this.onError(evt);clearInterval(_c4a);}),false);xhr.addEventListener("abort",dojo.hitch(this,function(evt){this.onAbort(evt);clearInterval(_c4a);}),false);xhr.onreadystatechange=dojo.hitch(this,function(){if(xhr.readyState===4){console.info("plugins.dojox.form.uploader.plugins.HTML5    COMPLETE");clearInterval(_c4a);this.onComplete({});}});xhr.open("POST",this.getUrl());_c4a=setInterval(dojo.hitch(this,function(){try{if(typeof (xhr.statusText)){}}catch(e){clearInterval(_c4a);}}),250);return xhr;};},handleUpload:function(upl,node){dojo.connect(upl,"onComplete",function(_c4b){console.log("Uploader.handleUpload    INSIDE dojo.connect");dojo.forEach(_c4b,function(file){console.log("display:",file);var div=dojo.create("div",{className:"thumb"});var span=dojo.create("span",{className:"thumbbk"},div);var img=dojo.create("img",{src:file.file},span);node.appendChild(div);});});},onComplete:function(_c4c){console.log("Uploader.onComplete    form.Uploader.onComplete(customEvent)");console.info("Uploader.onComplete    FILL ME IN");},fixInputNode:function(){var _c4d=this.uploader._inputs[0];console.log("Uploader.setInputNode     inputnode: "+_c4d);console.dir(_c4d);var _c4e=dojo.attr(_c4d,"style");console.log("Uploader.setInputNode     style: "+dojo.toJson(_c4e));_c4e+=" left: 0px !important;";dojo.attr(_c4d,"style",_c4e);},setPath:function(_c4f){console.log("Uploader.setPath     plugins.form.Uploader.setPath(value)");console.log("Uploader.setPath     value: "+_c4f);if(_c4f==null){return;}this.path.value=_c4f;this.dialog.set("title","Upload to: "+_c4f);},getPath:function(){return this.path.innerHTML;},show:function(){this.dialog.show();},hide:function(){this.dialog.hide();}});}if(!dojo._hasResource["dojo.io.iframe"]){dojo._hasResource["dojo.io.iframe"]=true;dojo.provide("dojo.io.iframe");dojo.getObject("io",true,dojo);dojo.io.iframe={create:function(_c50,_c51,uri){if(window[_c50]){return window[_c50];}if(window.frames[_c50]){return window.frames[_c50];}var _c52=null;var turi=uri;if(!turi){if(dojo.config["useXDomain"]&&!dojo.config["dojoBlankHtmlUrl"]){console.warn("dojo.io.iframe.create: When using cross-domain Dojo builds,"+" please save dojo/resources/blank.html to your domain and set djConfig.dojoBlankHtmlUrl"+" to the path on your domain to blank.html");}turi=(dojo.config["dojoBlankHtmlUrl"]||dojo.moduleUrl("dojo","resources/blank.html"));}var _c52=dojo.place("<iframe id=\""+_c50+"\" name=\""+_c50+"\" src=\""+turi+"\" onload=\""+_c51+"\" style=\"position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden\">",dojo.body());window[_c50]=_c52;return _c52;},setSrc:function(_c53,src,_c54){try{if(!_c54){if(dojo.isWebKit){_c53.location=src;}else{frames[_c53.name].location=src;}}else{var idoc;if(dojo.isIE||dojo.isWebKit){idoc=_c53.contentWindow.document;}else{idoc=_c53.contentWindow;}if(!idoc){_c53.location=src;return;}else{idoc.location.replace(src);}}}catch(e){console.log("dojo.io.iframe.setSrc: ",e);}},doc:function(_c55){var doc=_c55.contentDocument||(((_c55.name)&&(_c55.document)&&(dojo.doc.getElementsByTagName("iframe")[_c55.name].contentWindow)&&(dojo.doc.getElementsByTagName("iframe")[_c55.name].contentWindow.document)))||((_c55.name)&&(dojo.doc.frames[_c55.name])&&(dojo.doc.frames[_c55.name].document))||null;return doc;},send:function(args){if(!this["_frame"]){this._frame=this.create(this._iframeName,dojo._scopeName+".io.iframe._iframeOnload();");}var dfd=dojo._ioSetArgs(args,function(dfd){dfd.canceled=true;dfd.ioArgs._callNext();},function(dfd){var _c56=null;try{var _c57=dfd.ioArgs;var dii=dojo.io.iframe;var ifd=dii.doc(dii._frame);var _c58=_c57.handleAs;_c56=ifd;if(_c58!="html"){if(_c58=="xml"){if(dojo.isIE<9||(dojo.isIE&&dojo.isQuirks)){dojo.query("a",dii._frame.contentWindow.document.documentElement).orphan();var _c59=(dii._frame.contentWindow.document).documentElement.innerText;_c59=_c59.replace(/>\s+</g,"><");_c59=dojo.trim(_c59);var _c5a={responseText:_c59};_c56=dojo._contentHandlers["xml"](_c5a);}}else{_c56=ifd.getElementsByTagName("textarea")[0].value;if(_c58=="json"){_c56=dojo.fromJson(_c56);}else{if(_c58=="javascript"){_c56=dojo.eval(_c56);}}}}}catch(e){_c56=e;}finally{_c57._callNext();}return _c56;},function(_c5b,dfd){dfd.ioArgs._hasError=true;dfd.ioArgs._callNext();return _c5b;});dfd.ioArgs._callNext=function(){if(!this["_calledNext"]){this._calledNext=true;dojo.io.iframe._currentDfd=null;dojo.io.iframe._fireNextRequest();}};this._dfdQueue.push(dfd);this._fireNextRequest();dojo._ioWatch(dfd,function(dfd){return !dfd.ioArgs["_hasError"];},function(dfd){return (!!dfd.ioArgs["_finished"]);},function(dfd){if(dfd.ioArgs._finished){dfd.callback(dfd);}else{dfd.errback(new Error("Invalid dojo.io.iframe request state"));}});return dfd;},_currentDfd:null,_dfdQueue:[],_iframeName:dojo._scopeName+"IoIframe",_fireNextRequest:function(){try{if((this._currentDfd)||(this._dfdQueue.length==0)){return;}do{var dfd=this._currentDfd=this._dfdQueue.shift();}while(dfd&&dfd.canceled&&this._dfdQueue.length);if(!dfd||dfd.canceled){this._currentDfd=null;return;}var _c5c=dfd.ioArgs;var args=_c5c.args;_c5c._contentToClean=[];var fn=dojo.byId(args["form"]);var _c5d=args["content"]||{};if(fn){if(_c5d){var _c5e=function(name,_c5f){dojo.create("input",{type:"hidden",name:name,value:_c5f},fn);_c5c._contentToClean.push(name);};for(var x in _c5d){var val=_c5d[x];if(dojo.isArray(val)&&val.length>1){var i;for(i=0;i<val.length;i++){_c5e(x,val[i]);}}else{if(!fn[x]){_c5e(x,val);}else{fn[x].value=val;}}}}var _c60=fn.getAttributeNode("action");var _c61=fn.getAttributeNode("method");var _c62=fn.getAttributeNode("target");if(args["url"]){_c5c._originalAction=_c60?_c60.value:null;if(_c60){_c60.value=args.url;}else{fn.setAttribute("action",args.url);}}if(!_c61||!_c61.value){if(_c61){_c61.value=(args["method"])?args["method"]:"post";}else{fn.setAttribute("method",(args["method"])?args["method"]:"post");}}_c5c._originalTarget=_c62?_c62.value:null;if(_c62){_c62.value=this._iframeName;}else{fn.setAttribute("target",this._iframeName);}fn.target=this._iframeName;dojo._ioNotifyStart(dfd);fn.submit();}else{var _c63=args.url+(args.url.indexOf("?")>-1?"&":"?")+_c5c.query;dojo._ioNotifyStart(dfd);this.setSrc(this._frame,_c63,true);}}catch(e){dfd.errback(e);}},_iframeOnload:function(){var dfd=this._currentDfd;if(!dfd){this._fireNextRequest();return;}var _c64=dfd.ioArgs;var args=_c64.args;var _c65=dojo.byId(args.form);if(_c65){var _c66=_c64._contentToClean;for(var i=0;i<_c66.length;i++){var key=_c66[i];for(var j=0;j<_c65.childNodes.length;j++){var _c67=_c65.childNodes[j];if(_c67.name==key){dojo.destroy(_c67);break;}}}if(_c64["_originalAction"]){_c65.setAttribute("action",_c64._originalAction);}if(_c64["_originalTarget"]){_c65.setAttribute("target",_c64._originalTarget);_c65.target=_c64._originalTarget;}}_c64._finished=true;}};}if(!dojo._hasResource["plugins.files.FileMenu"]){dojo._hasResource["plugins.files.FileMenu"]=true;dojo.provide("plugins.files.FileMenu");dojo.declare("plugins.files.FileMenu",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n<div\n    dojoAttachPoint=\"menu\"\n    class=\"filemenu\"\n    dojoType=\"plugins.menu.Menu\"\n    title=\"List of options for file-specific actions\"\n>\n\n    <div dojoType=\"dijit.MenuItem\"\n        label=\"File Menu\"\n        dojoAttachPoint=\"titleNode\"\n        class=\"title\"\n        disabled=\"false\"\n    >\n    </div>\n\n    <div\n        dojoAttachPoint=\"selectNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:select\"\n        class=\"select\"\n        disabled=\"true\"\n    >\n        <U>S</U>elect\n    </div>\n    <div\n        dojoAttachPoint=\"addNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:add\"\n        class=\"add\"\n        disabled=\"true\"\n    >\n        <U>A</U>dd\n    </div>\n\n    <div\n        dojoAttachPoint=\"newFolderNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:newFolder\"\n        class=\"newFolder\"\n        >\n        <U>N</U>ew Folder\n    </div>\n\n    <div\n        dojoAttachPoint=\"renameNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:rename\"\n        class=\"rename\"\n        >\n        Rena<U>m</U>e\n\n    </div>\n\n<!--    <div dojoType=\"dijit.MenuSeparator\">\n    </div>\n-->\n    <div\n        dojoAttachPoint=\"deleteNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:deleteFile\"\n        class=\"delete\"\n        >\n        De<U>l</U>ete\n    </div>\n\n<!--    <div dojoType=\"dijit.MenuSeparator\">\n    </div>\n-->\n    <div\n        dojoAttachPoint=\"openWorkflowNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:openWorkflow\"\n        class=\"openWorkflow\"\n        >        \n        <U>O</U>pen Workflow\n    </div>\n\n\n<!--    <div dojoType=\"dijit.MenuSeparator\">\n    </div>\n-->\n    <div\n        dojoAttachPoint=\"uploadNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:upload\"\n        class=\"upload\"\n        style=\"height: 20px !important;\"\n        widgetsInTemplate=\"true\"\n        >\n\n        <U>U</U>pload file\n        <!--<div class=\"fileInputMask\"></div>-->\n        \n    </div>\n\n<!--    <div dojoType=\"dijit.MenuSeparator\">\n    </div>\n-->\n    <div\n        dojoAttachPoint=\"downloadNode\"\n        dojoType=\"dijit.MenuItem\"\n        class=\"download\"\n        dojoAttachEvent=\"onClick:download\"    \n        >\n        Do<U>w</U>nload file\n    </div>\n\n\n\n</div>\n",widgetsInTemplate:true,addingApp:false,cssFiles:[dojo.moduleUrl("plugins","files/css/filemenu.css"),dojo.moduleUrl("dojox","form/resources/FileInput.css")],parentWidget:null,delay:6000,constructor:function(args){this.parentWidget=args.parentWidget;this.loadCSS();},postCreate:function(){this.setInputDialog();this.setInteractiveDialog();this.setConfirmDialog();this.setTitle("File Menu");this.setMenu();this.startup();},startup:function(){console.group("FileMenu    "+this.id+"    startup");this.inherited(arguments);this.setUploader();this.disableMenuItem("select");this.disableMenuItem("add");this.menu._started=false;this.menu.startup();dojo.connect(this.menu.domNode,"oncontextmenu",function(_c68){_c68.stopPropagation();});Agua.updater.subscribe(this,"updateProjects");Agua.updater.subscribe(this,"updateWorkflows");console.groupEnd("FileMenu    "+this.id+"    startup");},updateProjects:function(args){this.parentWidget.updateProjects();},updateClusters:function(args){this.setClusterCombo();},select:function(_c69){var _c6a=this.getPath();if(!_c6a==null){return;}var _c6b=this.menu.currentTarget.innerHTML;var _c6c;if(_c6b!=null&&_c6a!=null){_c6c=_c6a+"/"+_c6b;}else{if(_c6a!=null){_c6c=_c6a;}else{if(_c6b!=null){_c6c=_c6b;}}}var _c6d=this.parameterWidget.core.parameters.application;_c6d.value=_c6c;this.parameterWidget.changeValue(this.parameterWidget.valueNode,this.parameterWidget.valueNode.innerHTML,_c6c,this.type);var _c6e=true;this.parameterWidget.core.io.chainOutputs(_c6d,true);var _c6f=this.parameterWidget.core.parameters.stageRow;var node=_c6f.domNode;node.application=_c6f.application;node.parentWidget=_c6f;this.parameterWidget.core.stages.loadParametersPane(node);this.hide();},add:function(){var _c70=this.getPath();if(_c70==null){return;}var _c71=this.menu.currentTarget.innerHTML;var _c72;if(_c71!=null&&_c70!=null){_c72=_c70+"/"+_c71;}else{if(_c70!=null){_c72=_c70;}else{if(_c71!=null){_c72=_c71;}}}this.parameterWidget.addValue(this.parameterWidget.valueNode,this.parameterWidget.valueNode.innerHTML,_c72,this.type);this.hide();},upload:function(_c73){dojo.stopEvent(_c73);var item=this.menu.currentTarget.item;var path=item.parentPath;if(!path){return;}this.uploader.setPath(path);this.uploader.show();var _c74=path.match("([^/]+)$")[1];var _c75=dijit.getEnclosingWidget(this.menu.currentTarget.offsetParent);this.callback=dojo.hitch(this,"reloadPane",_c75,_c74);},onComplete:function(){this.callback();},reloadPane:function(_c76,_c77){var _c78=_c76.parentWidget;var _c79=0;var _c7a=_c76.items;for(var i=0;i<_c7a.length;i++){if(_c7a[i].name==_c77){_c79=i;break;}}var _c7b={target:{item:_c7a[_c79]}};_c78.store.putData.query=_c76.path;_c78.store.putData.mode="fileSystem";_c76.onclickHandler(_c7b);},setUploader:function(){var _c7c=dijit.getUniqueId("plugins.form.UploadDialog");var _c7d=Agua.cookie("username");var _c7e=Agua.cookie("sessionid");this.uploader=new plugins.form.Uploader({uploaderId:_c7c,username:_c7d,sessionid:_c7e,url:Agua.cgiUrl+"upload.cgi"});dojo.connect(this.uploader,"onComplete",this,"onComplete");},setMenu:function(){this.disableRightClick();this.setShortKeys();this.menu.onCancel=function(_c7f){};},disableRightClick:function(){dojo.connect(this.menu.domNode,"contextmenu",function(_c80){_c80.preventDefault();_c80.stopPropagation();return false;});},setShortKeys:function(){dojo.connect(this.menu,"onKeyPress",dojo.hitch(this,function(_c81){var key=_c81.charOrCode;if(this.altOn==true){switch(key){case "n":this.newFolder();break;case "m":this.rename();break;case "l":this.deleteFile();break;case "o":this.openWorkflow();break;case "u":this.upload();break;case "w":this.download();break;}}_c81.stopPropagation();}));dojo.connect(this.menu,"onKeyDown",dojo.hitch(this,function(_c82){var _c83=_c82.keyCode;if(_c83==18){this.altOn=true;}}));dojo.connect(this.menu,"onKeyUp",dojo.hitch(this,function(_c84){var _c85=_c84.keyCode;if(_c85==18){this.altOn=false;}}));},openWorkflow:function(){dojo.addClass(this.menu.currentTarget,"dojoDndItemOver");var item=this.menu.currentTarget.item;if(!item.parentPath.match(/^([^\/]+)\/([^\/]+)/)){return;}var _c86=item.parentPath.match(/^([^\/]+)\/[^\/]+/)[1];var _c87=item.parentPath.match(/^[^\/]+\/([^\/]+)/)[1];var _c88=Agua.controllers["workflow"];if(_c88==null){return;}_c88.createTab({project:_c86,workflow:_c87});},rename:function(){var _c89=this.getUserName();var _c8a=this.getDragPane();var _c8b=this.menu.currentTarget;var item=this.menu.currentTarget.item;var path=item.path;var _c8c=item.path;var _c8d=item.parentPath;var _c8e=this.interactiveDialog;var _c8f="Rename file '"+_c8c+"'";var _c90="Please enter new name";var _c91=function(){};var _c92=dojo.hitch(this,function(_c93){if(_c93==null){return;}_c93=_c93.replace(/\s+/,"");if(_c93==""){return;}if(_c8a.inItems(_c93)){Agua.toastMessage({message:"FileName '"+_c93+"' already exists "});_c8e.dialog.duration=1500;_c8e.messageNode.innerHTML="Workflow already exists";return;}var _c94=_c8d+"/"+_c93;var _c95=_c8d+"/"+path;Agua.renameFileTree(_c89,_c95,_c94);_c8a.renameItem(_c8b,_c93);Agua.renameFile(_c95,_c94);});this.loadInputDialog(_c8f,_c90,_c92,_c91);},newFolder:function(){var _c96=this.getUserName();var _c97=this.getDragPane();var _c98="New Folder";var _c99="Please enter folder name";var _c9a=function(){};var _c9b=dojo.hitch(this,function(_c9c){if(_c9c==null){return;}_c9c=_c9c.replace(/\s+/,"");if(_c9c==""){return;}if(_c97.inItems(_c9c)){return;}var _c9d=_c97.path+"/"+_c9c;_c97.addItem(_c9c,"folder",_c96,_c9d);var url=Agua.cgiUrl+"folders.cgi?";var _c9e=_c97.path+"/"+_c9c;var _c9f=new Object;_c9f.mode="newFolder";_c9f.sessionid=Agua.cookie("sessionid");_c9f.username=Agua.cookie("username");_c9f.folderpath=_c9e;var _ca0=this;dojo.xhrPut({url:url,putData:dojo.toJson(_c9f),handleAs:"json",sync:false,handle:function(_ca1){if(_ca1.error){Agua.error(_ca1.error);}else{if(_ca1.status){Agua.warning(_ca1.status);var _ca2=_ca0.menu.currentTarget.parentNode;_ca2.removeChild(_ca0.menu.currentTarget);}}}});});this.loadInputDialog(_c98,_c99,_c9b,_c9a);},deleteFile:function(){console.log("FileMenu.deleteFile     plugins.files.Workflow.deleteFile(event)");if(this.menu.currentTarget==null){return;}var _ca3=this.menu.currentTarget.item.name;var _ca4=this.menu.currentTarget.item.directory;var type="file";if(_ca4==true){type="folder";}var _ca5=dijit.getEnclosingWidget(this.menu.currentTarget);_ca5.standby.show();var _ca6=function(){_ca5.standby.hide();};var _ca7=dojo.hitch(this,function(){var item=this.menu.currentTarget.item;var file=item.parentPath+"/"+item.path;var url=Agua.cgiUrl+"folders.cgi?";var _ca8=new Object;_ca8.mode="removeFile";_ca8.sessionid=Agua.cookie("sessionid");_ca8.username=Agua.cookie("username");_ca8.file=file;var _ca9=this;dojo.xhrPut({url:url,putData:dojo.toJson(_ca8),handleAs:"json",sync:false,handle:function(_caa){if(_caa.error){_ca5.standby.hide();Agua.error(_caa.error);}else{if(_caa.status){_ca9.pollDelete(_ca8,_ca5);}}}});});var _cab="Delete "+type+":<br>"+_ca3;var _cac="All its data will be destroyed";this.loadConfirmDialog(_cab,_cac,_ca7,_ca6);},delayedPollDelete:function(_cad,_cae){var _caf=this.delay;var _cb0=[{func:[this.showMessage,this,"FileMenu.delayedPollDelete"],pauseAfter:_caf},{func:[this.pollDelete,this,_cad,_cae]}];this.sequence.go(_cb0,function(){});},pollDelete:function(_cb1,_cb2){_cb1.modifier="status";var url=Agua.cgiUrl+"folders.cgi?";var _cb3=this;dojo.xhrPut({url:url,handleAs:"json-comment-optional",sync:false,putData:dojo.toJson(_cb1),handle:function(_cb4){if(_cb4.status=="completed"){_cb3.handleDelete(_cb1,_cb2,_cb4);}else{if(_cb4.error){_cb3.standby.hide();}else{_cb3.delayedPollDelete(_cb1,_cb2);}}}});},handleDelete:function(_cb5,_cb6,_cb7){_cb6.standby.hide();var _cb8=_cb5.file;var _cb9=_cb8.match(/^(.+?)\/[^\/]+$/)[1];Agua.setFileCache(_cb5.username,_cb8,null);Agua.setFileCache(_cb5.username,_cb9,null);var path=_cb6.path;var _cb9=path.match(/([^\/]+)$/)[1];var _cba=_cb6.getPreviousPane();this.reloadPane(_cba,_cb9);},download:function(){var item=this.menu.currentTarget.item;if(!item.parentPath.match(/^([^\/]+)\/([^\/]+)/)){return;}var _cbb=item.parentPath.match(/^([^\/]+)\/[^\/]+/)[1];var _cbc=item.parentPath.match(/^[^\/]+\/([^\/]+)/)[1];var _cbd=item.parentPath;if(item.path!=null&&item.path!=""){_cbd+="/"+item.path;}var url=item._S.url;var _cbe;if(url.match(/owner=([^&]+)/)){_cbe=url.match(/owner=([^&]+)/)[1];}var _cbf="?mode=downloadFile";if(_cbe!=null){_cbf+="&username="+_cbe;_cbf+="&requestor="+Agua.cookie("username");}else{_cbf+="&username="+Agua.cookie("username");}_cbf+="&sessionid="+Agua.cookie("sessionid");_cbf+="&filepath="+_cbd;var _cc0=Agua.cgiUrl+"download.cgi";var args={method:"GET",url:_cc0+_cbf,handleAs:"json",timeout:10000,load:this.handleDownload};var _cc1=dojo.io.iframe.send(args);},handleDownload:function(_cc2,_cc3){if(_cc2.message=="ifd.getElementsByTagName(\"textarea\")[0] is undefined"){Agua.toastMessage({message:"Download failed: File is not present",type:"error"});}},openFileDownload:function(_cc4){var _cc5="?username="+Agua.cookie("username");_cc5+="&sessionid="+Agua.cookie("sessionid");_cc5+="&filepath="+_cc4;var url=Agua.cgiUrl+"download.cgi";var args={method:"GET",url:url+_cc5,handleAs:"html",timeout:10000};dojo.io.iframe.send(args);},setConfirmDialog:function(){var _cc6=function(){};var _cc7=function(){};var _cc8="Dialog title";var _cc9="Dialog message";this.confirmDialog=new plugins.dijit.ConfirmDialog({title:_cc8,message:_cc9,parentWidget:this,yesCallback:_cc6,noCallback:_cc7});},loadConfirmDialog:function(_cca,_ccb,_ccc,_ccd){this.confirmDialog.load({title:_cca,message:_ccb,yesCallback:_ccc,noCallback:_ccd});},setInputDialog:function(){var _cce=function(){};var _ccf=function(){};var _cd0="";var _cd1="";this.inputDialog=new plugins.dijit.InputDialog({title:_cd0,message:_cd1,inputMessage:"",parentWidget:this,enterCallback:_cce,cancelCallback:_ccf});},loadInputDialog:function(_cd2,_cd3,_cd4,_cd5){this.inputDialog.load({title:_cd2,message:_cd3,enterCallback:_cd4,cancelCallback:_cd5});},setInteractiveDialog:function(){var _cd6=function(){};var _cd7=function(){};var _cd8="";var _cd9="";this.interactiveDialog=new plugins.dijit.InteractiveDialog({title:_cd8,message:_cd9,inputMessage:"",parentWidget:this,enterCallback:_cd6,cancelCallback:_cd7});},loadInteractiveDialog:function(_cda,_cdb,_cdc,_cdd,_cde){this.interactiveDialog.load({title:_cda,message:_cdb,checkboxMessage:_cde,enterCallback:_cdc,cancelCallback:_cdd});},bind:function(node){if(node==null){return this.menu.bindDomNode(node);}},getPath:function(){var _cdf=dijit.getEnclosingWidget(this.menu.currentTarget);if(_cdf==null||!_cdf){return;}return _cdf.path;},hide:function(){this.parentWidget.hide();},setTitle:function(_ce0){this.titleNode.containerNode.innerHTML=_ce0;},show:function(){dojo.addClass(this.menu.currentTarget,"dojoDndItemOver");dojo.style(this.containerNode,{opacity:1,overflow:"visible"});},disableMenuItem:function(name){if(this[name+"Node"]){this[name+"Node"].disabled=true;}var item=this[name+"Node"];dojo.addClass(item.domNode,"dijitMenuItemDisabled");},enableMenuItem:function(name){if(this[name+"Node"]){this[name+"Node"].disabled=false;}var item=this[name+"Node"];dojo.removeClass(item.domNode,"dijitMenuItemDisabled");},disable:function(){this.menu.enabled=false;},enable:function(){this.menu.enabled=true;},setShortKeys:function(){dojo.connect(this.menu,"onKeyPress",dojo.hitch(this,function(_ce1){var key=_ce1.charOrCode;if(this.altOn==true){switch(key){case "s":this.select();break;case "a":this.add();break;case "n":this.newFolder();break;case "m":this.rename();break;case "l":this.deleteFile();break;case "o":this.openWorkflow();break;case "u":this.upload();break;case "w":this.download();break;case "r":this.refresh();break;}}_ce1.stopPropagation();}));dojo.connect(this.menu,"onKeyDown",dojo.hitch(this,function(_ce2){var _ce3=_ce2.keyCode;if(_ce3==18){this.altOn=true;}}));dojo.connect(this.menu,"onKeyUp",dojo.hitch(this,function(_ce4){var _ce5=_ce4.keyCode;if(_ce5==18){this.altOn=false;}}));},refresh:function(_ce6){},getFilesWidget:function(){if(this.menu.currentTarget==null){return null;}var item=this.menu.currentTarget.item;var _ce7=dijit.getEnclosingWidget(this.menu.currentTarget);var _ce8=_ce7.parentWidget.parentWidget;return _ce8;},getProjectName:function(){if(this.menu.currentTarget==null){return null;}var item=this.menu.currentTarget.item;var _ce9=dijit.getEnclosingWidget(this.menu.currentTarget);var _cea=_ce9.path;return _cea;},getStandby:function(){if(this.standby){return this.standby;}var id=dijit.getUniqueId("dojox_widget_Standby");this.standby=new dojox.widget.Standby({onClick:"reload",text:"",id:id,url:"plugins/core/images/agua-biwave-24.png"});document.body.appendChild(this.standby.domNode);return this.standby;},getFileDrag:function(){var _ceb=this.getDragPane();return _ceb.parentWidget;},getDragPane:function(){return dijit.getEnclosingWidget(this.menu.currentTarget);},getUserName:function(){var _cec=this.getFileDrag();return _cec.owner;},selectTarget:function(args){var _ced=this.getDragPane();_ced._dragSource._addItemClass(this.menu.currentTarget,"Selected");},deselectTarget:function(args){var _cee=this.getDragPane();_cee._dragSource._removeItemClass(this.menu.currentTarget,"Selected");}});}if(!dojo._hasResource["plugins.files.FolderMenu"]){dojo._hasResource["plugins.files.FolderMenu"]=true;dojo.provide("plugins.files.FolderMenu");dojo.declare("plugins.files.FolderMenu",[plugins.files.FileMenu],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n<div\n    dojoAttachPoint=\"menu\"\n    class=\"filemenu\"\n    dojoType=\"plugins.menu.Menu\"\n    title=\"List of options for folder-specific actions\"\n>\n\n    <div dojoType=\"dijit.MenuItem\"\n        label=\"Folder Menu\"\n        dojoAttachPoint=\"titleNode\"\n        class=\"title\"\n        disabled=\"false\"\n    >\n    </div>\n\n\n    <div\n        dojoAttachPoint=\"refreshNode\"\n        dojoType=\"dijit.MenuItem\"\n        class=\"refresh\"\n        dojoAttachEvent=\"onClick:refresh\"    \n        >\n        <U>R</U>efresh\n    </div>\n\n    <div\n        dojoAttachPoint=\"selectNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:select\"\n        class=\"select\"\n        disabled=\"true\"\n    >\n        <U>S</U>elect\n    </div>\n    <div\n        dojoAttachPoint=\"addNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:add\"\n        class=\"add\"\n        disabled=\"true\"\n    >\n        <U>A</U>dd\n    </div>\n\n    <div\n        dojoAttachPoint=\"newFolderNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:newFolder\"\n        class=\"newFolder\"\n        >\n        <U>N</U>ew Folder\n    </div>\n\n    <div\n        dojoAttachPoint=\"renameNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:rename\"\n        class=\"rename\"\n        >\n        Rena<U>m</U>e\n\n    </div>\n\n    <div\n        dojoAttachPoint=\"deleteNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:deleteFile\"\n        class=\"delete\"\n        >\n        De<U>l</U>ete\n    </div>\n\n    <div\n        dojoAttachPoint=\"openWorkflowNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:openWorkflow\"\n        class=\"openWorkflow\"\n        >        \n        <U>O</U>pen Workflow\n    </div>\n\n    <div\n        dojoAttachPoint=\"uploadNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:upload\"\n        class=\"upload\"\n        style=\"height: 20px !important;\"\n        widgetsInTemplate=\"true\"\n        >\n        <U>U</U>pload file\n    </div>\n\n\n</div>\n",constructor:function(args){this.loadCSS();},postCreate:function(){this.setTitle("Folder Menu");this.setInputDialog();this.setConfirmDialog();this.setMenu();this.setUploader();this.startup();},refresh:function(_cef){var _cf0=this.menu.currentTarget.innerHTML;var _cf1=dijit.getEnclosingWidget(this.menu.currentTarget.offsetParent);var _cf2=_cf1.path+"/"+_cf0;var _cf3=_cf1.parentWidget;var _cf4=_cf3.owner;_cf3.store.putData.mode="fileSystem";Agua.setFileCache(_cf4,_cf2,null);this.reloadPane(_cf1,_cf0);}});}if(!dojo._hasResource["plugins.dijit.SelectiveDialog"]){dojo._hasResource["plugins.dijit.SelectiveDialog"]=true;dojo.provide("plugins.dijit.SelectiveDialog");dojo.declare("plugins.dijit.SelectiveDialog",[plugins.dijit.InteractiveDialog],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n    <table\n        cellspacing=\"0px\"\n        height=\"300px\" width=\"100%\" style=\"padding: 0; margin: 0;\"\n        class=\"selectiveDialog\">\n        <tr>\n            <td align=\"center\">\n                \n<div\n    dojoAttachPoint=\"dialog\"\n    dojoType=\"dijit.Dialog\"\n    closeText=\"false\"\n    class=\"title\"\n    title=\"${title}\"\n    style=\"margin-right: auto; margin-left: auto; text-align: center;\"\n    >\n\n    <table\n        cellpadding=\"0\"\n        cellspacing=\"0\"\n        class=\"selectiveDialog\"\n        width=\"100%\"\n        >\n\n        <tr class=\"message\" align=\"center\">\n            <td\n                align=\"center\"\n                dojoAttachPoint=\"messageNode\"\n                colspan=\"2\">${message}</td>\n        </tr>\n\n        <tr width=\"100%\">\n            <td\n                width=\"100%\"\n                align=\"right\"\n                class=\"leftColumn\"\n                dojoAttachPoint=\"comboMessageNode\">\n            </td>\n            <td align=\"center\" width=\"100%\">\n                <select\n                    dojoAttachPoint=\"combo\"\n                    class=\"combo\"\n                    autocomplete=\"false\"\n                >\n                </select>\n            </td>\n        </tr>\n        \n        <tr align=\"center\" dojoAttachPoint=\"inputContainer\">\n            <td class=\"leftColumn\"\n                dojoAttachPoint=\"inputMessageNode\">\n            </td>\n            <td class=\"input\" align=\"center\">\n                <input\n                    type=\"text\"\n                    class=\"inputNode\"\n                    dojoAttachPoint=\"inputNode\"\n                value=\"\"></input>\n            </td>\n        </tr>\n        \n\n         <tr\n            dojoAttachPoint=\"checkboxContainer\"\n            class=\"hidden\">\n\n            <td colspan=\"2\">\n                <table>\n                    <tr>\n                        <td class=\"leftColumn\"\n                            dojoAttachPoint=\"checkboxMessageNode\"\n                            style=\"visibility: visible\">\n                        </td>\n                        <td class=\"rightColumn\">\n                            <input\n                                dojoAttachPoint=\"checkbox\"  \n                                style=\"visibility: visible\"\n                                type=\"checkbox\"\n                                class=\"checkbox\"\n                        >\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n\n         <tr>\n            <td align=\"center\" class=\"enterButton\">\n                <button\n                    dojoAttachPoint=\"enterButton\"\n                    dojoType=\"dijit.form.Button\"\n                    type=\"button\"\n                    label=\"Enter\"\n                    dojoAttachEvent=\"onClick:doEnter\"\n                    >\n                </button>\n            </td>\n\n            <td align=\"center\" class=\"cancelButton\">\n                <div\n                    dojoAttachPoint=\"cancelButton\"\n                    dojoType=\"dijit.form.Button\"\n                    type=\"button\"\n                    label=\"Cancel\"\n                    dojoAttachEvent=\"onClick:doCancel\"\n                    >\n                </div>\n            </td>\n        </tr>\n    </table>\n</div>\n            \n            </td>\n        </tr>\n    </table>\n</div>\n",cssFiles:[dojo.moduleUrl("plugins.dijit")+"/css/selectivedialog.css"],constructor:function(args){this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.showComboMessage(this.comboMessage);this.setDialogue();this.setListeners();this.setNamespaceClass("selectiveDialog");},setListeners:function(){var _cf5=this;dojo.connect(this.combo,"onkeypress",function(_cf6){var key=_cf6.charOrCode;console.log("SelectiveDialog.set    this.combo onKeyPress FIRED");_cf6.stopPropagation();if(key==13){_cf5.doEnter();}if(key==dojo.keys.ESCAPE){_cf5.doCancel();}});},setCombo:function(){while(this.combo.length){this.combo.options[this.combo.length-1]=null;}for(var i=0;i<this.comboValues.length;i++){var _cf7=document.createElement("OPTION");_cf7.text=this.comboValues[i];_cf7.value=this.comboValues[i];this.combo.options.add(_cf7);}},showComboMessage:function(_cf8){if(_cf8==null){dojo.attr(this.combo.parentNode,"colspan",2);dojo.destroy(this.comboMessageNode);}},load:function(args){this.title=args.title||"";this.message=args.message;this.comboValues=args.comboValues;this.parentWidget=args.parentWidget;this.enterCallback=args.enterCallback;this.cancelCallback=args.cancelCallback;this.dialog.titleNode.innerHTML=args.title;this.messageNode.innerHTML=args.message;this.inputMessageNode.innerHTML=args.inputMessage||"";this.comboMessageNode.innerHTML=args.comboMessage||"";this.checkboxMessageNode.innerHTML=args.checkboxMessage||"";this.dialog.enterCallback=args.enterCallback;this.dialog.cancelCallback=args.cancelCallback;this.showCheckbox(args.checkboxMessage);this.setEnterLabel(args.enterLabel);this.setCancelLabel(args.cancelLabel);this.setCombo();this.show();},doEnter:function(type){var _cf9="";if(this.inputNode!=null){_cf9=this.inputNode.value;}var _cfa;if(this.checkbox.checked==true){_cfa=1;}else{_cfa=0;}var _cfb=this.combo.value;this.dialog.enterCallback(_cf9,_cfb,_cfa,this);}});}if(!dojo._hasResource["plugins.files.WorkflowMenu"]){dojo._hasResource["plugins.files.WorkflowMenu"]=true;dojo.provide("plugins.files.WorkflowMenu");dojo.declare("plugins.files.WorkflowMenu",[plugins.files.FileMenu],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n<div\n    dojoAttachPoint=\"menu\"\n    class=\"workflowmenu\"\n    dojoType=\"plugins.menu.Menu\">\n\n    <div dojoType=\"dijit.MenuItem\"\n        label=\"Workflow Menu\"\n        dojoAttachPoint=\"titleNode\"\n        class=\"title\"\n        disabled=\"false\">\n    </div>\n\n    <div\n        dojoAttachPoint=\"refreshNode\"\n        dojoType=\"dijit.MenuItem\"\n        class=\"refresh\"\n        dojoAttachEvent=\"onClick:refresh\"    \n        >\n        <U>R</U>efresh\n    </div>\n\n\n    <div\n        dojoAttachPoint=\"selectNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:select\"\n        class=\"select\"\n        >\n        <U>S</U>elect\n    </div>\n    <div\n        dojoAttachPoint=\"addNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:add\"\n        class=\"add\"\n        >\n        <U>A</U>dd\n    </div>\n\n    <div\n        dojoAttachPoint=\"newProjectNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:newProject\"\n        class=\"newProject\"\n        >\n        New <U>P</U>roject\n    </div>\n\n    <div\n        dojoAttachPoint=\"newWorkflowNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:newWorkflow\"\n        class=\"newWorkflow\"\n        >\n        New <U>W</U>orkflow\n    </div>\n\n    <div\n        dojoAttachPoint=\"copyWorkflowNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:copyWorkflow\"\n        class=\"copyWorkflow\"\n        disabled=\"false\"\n        >\n        <U>C</U>opy Workflow\n    </div>\n\n    <div\n        dojoAttachPoint=\"renameWorkflowNode\"\n        dojoType=\"dijit.MenuItem\"\n        class=\"renameWorkflow\"\n        dojoAttachEvent=\"onClick:renameWorkflow\"    \n        >\n        <U>R</U>ename Workflow\n    </div>\n\n    <div\n        dojoAttachPoint=\"openWorkflowNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:openWorkflow\"\n        class=\"openWorkflow\"\n        >\n        <U>O</U>pen Workflow\n    </div>\n\n    <div\n        dojoAttachPoint=\"deleteProjectNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:deleteProject\"\n        class=\"deleteProject\"\n        >\n        <U>D</U>elete Project\n    </div>\n\n    <div\n        dojoAttachPoint=\"deleteWorkflowNode\"\n        dojoType=\"dijit.MenuItem\"\n        dojoAttachEvent=\"onClick:deleteWorkflow\"\n        class=\"deleteWorkflow\"\n        >\n        De<U>l</U>ete Workflow\n    </div>\n\n\n</div>\n",cssFiles:[dojo.moduleUrl("plugins","files/css/workflowmenu.css")],constructor:function(){this.loadCSS();},postCreate:function(){this.setInputDialog();this.setInteractiveDialog();this.setConfirmDialog();this.setTitle("Workflow Menu");this.setMenu();this.startup();},startup:function(){this.inherited(arguments);this.setMenu();this.disableMenuItem("select");this.disableMenuItem("add");dojo.connect(this.menu,"_openMyself",this,"selectTarget");dojo.connect(this.menu,"_markInactive",this,"deselectTarget");this.setSelectiveDialog();Agua.updater.subscribe(this,"updateProjects");},updateProjects:function(args){},setTitle:function(_cfc){},setShortKeys:function(){dojo.connect(this.menu,"onKeyPress",dojo.hitch(this,function(_cfd){var key=_cfd.charOrCode;if(this.altOn==true){switch(key){case "s":this.select();break;case "a":this.add();break;case "p":this.newProject();break;case "w":this.newWorkflow();break;case "r":this.renameWorkflow();break;case "d":this.deleteProject();break;case "l":this.deleteWorkflow();break;case "o":this.openWorkflow();break;case "c":this.copyWorkflow();break;}}_cfd.stopPropagation();}));dojo.connect(this.menu,"onKeyDown",dojo.hitch(this,function(_cfe){var _cff=_cfe.keyCode;if(_cff==18){this.altOn=true;}}));dojo.connect(this.menu,"onKeyUp",dojo.hitch(this,function(_d00){var _d01=_d00.keyCode;if(_d01==18){this.altOn=false;}}));},newProject:function(){var _d02=this.getUserName();var _d03=this.interactiveDialog;var _d04=this.getFilesWidget();var _d05=function(){};var _d06=dojo.hitch(this,function(_d07){if(_d07==null){return;}if(_d07==""){return;}_d07=_d07.replace(/\s+/g,"");var _d08=new Object;_d08.name=_d07;if(Agua.isProject(_d07)==true){_d03.messageNode.innerHTML="Project already exists";return;}var _d09={username:_d02,owner:_d02,name:_d07,title:_d07};_d04.addChild(_d09);Agua.addProject(_d08);});var _d0a="New Project";var _d0b="Please enter project name";this.loadInputDialog(_d0a,_d0b,_d06,_d05);},newWorkflow:function(){var _d0c=this.getProjectName();var _d0d=this.interactiveDialog;var _d0e=this.getUserName();var _d0f=this.getDragPane();var _d10="New Workflow";var _d11="Please enter workflow name";var _d12=function(){};var _d13=dojo.hitch(this,function(_d14,_d15){_d14=_d14.replace(/\s+/,"");if(!_d14){return;}if(Agua.isWorkflow({project:_d0c,name:_d14})==true){_d0d.messageNode.innerHTML="Workflow already exists";return;}else{_d0d.messageNode.innerHTML="Creating workflow";_d0d.close();}var _d16=_d0f.path+"/"+_d14;Agua.addWorkflow({project:_d0c,name:_d14});_d0f.addItem(_d14,"workflow",_d0e,_d16);});this.loadInteractiveDialog(_d10,_d11,_d13,_d12);},copyWorkflow:function(){var item=this.menu.currentTarget.item;var _d17=item.parentPath;var _d18=item.path;var _d19=function(){};var _d1a=this;var _d1b=dojo.hitch(this,function(_d1c,_d1d,_d1e,_d1f){var _d20="Copy";var _d21="Cancel";if(_d1d==null||_d1d==""){return;}_d1d=_d1d.replace(/\s+/,"");if(_d1d==null||_d1d==""){_d1f.messageNode.innerHTML="Please input name of new Workflow";return;}if(Agua.isWorkflow({project:_d1c,name:_d1d})==true){_d1f.messageNode.innerHTML="/"+_d1d+"' already exists in '"+_d1c+"'";return;}else{_d1f.messageNode.innerHTML="Creating workflow";_d1f.close();}_d1a._copyWorkflow(_d17,_d18,_d1d,_d1c,_d1e);});this.selectiveDialog.load({title:"Copy Workflow",message:"Source: '"+_d17+":"+_d18+"'",comboValues:Agua.getProjectNames(),inputMessage:"Workflow name",comboMessage:"Project",checkboxMessage:"Copy files",parentWidget:this,enterCallback:_d1b,cancelCallback:_d19,enterLabel:"Copy",cancelLabel:"Cancel"});},_copyWorkflow:function(_d22,_d23,_d24,_d25,_d26){var _d27=Agua.cookie("username");Agua.copyWorkflow(_d27,_d22,_d23,_d27,_d24,_d25,_d26);},renameWorkflow:function(){var _d28=this.getFilesWidget();if(_d28==null){return;}var _d29=this.getDragPane();var _d2a=this.getUserName();var _d2b=this.menu.currentTarget;var _d2c=this.getProjectName();var _d2d=this.getWorkflowName();var _d2e=this.getWorkflowNumber();var _d2f=new Object;_d2f.project=_d2c;_d2f.name=_d2d;_d2f.number=_d2e;var _d30="Rename workflow '"+_d2d+"'";var _d31="Please enter new name";var _d32=function(){};var _d33=dojo.hitch(this,function(_d34){if(_d34==null){return;}_d34=_d34.replace(/\s+/,"");if(_d34==""){return;}if(Agua.isWorkflow({project:_d2c,name:_d34})){return;}var _d35=_d2c+"/"+_d2d;var _d36=_d2c+"/"+_d34;Agua.renameFileTree(_d2a,_d35,_d36);_d29.renameItem(_d2b,_d34);Agua.renameWorkflow(_d2f,_d34);Agua.updater.update("updateProjects",{originator:this.parentWidget,reload:false});});this.loadInputDialog(_d30,_d31,_d33,_d32);},openWorkflow:function(){dojo.addClass(this.menu.currentTarget,"dojoDndItemOver");var _d37=this.getFilesWidget();if(_d37==null){return;}var _d38=this.getProjectName();var _d39=this.getWorkflowName();var _d3a=Agua.controllers["workflow"];if(Agua.controllers["workflow"]){Agua.controllers["workflow"].createTab({project:_d38,workflow:_d39});}},deleteWorkflow:function(){var _d3b=this.getProjectName();var _d3c=this.getWorkflowName();var _d3d=this.getWorkflowNumber();var _d3e=new Object;_d3e.project=_d3b;_d3e.name=_d3c;_d3e.number=_d3d;var _d3f=function(){};var _d40=dojo.hitch(this,function(){if(Agua.isWorkflow({project:_d3b,name:_d3c})==false){return;}var _d41=this.menu.currentTarget;this.removeItemFileCache(_d41);var _d42=dijit.getEnclosingWidget(this.menu.currentTarget);_d42.deleteItem(_d41);Agua.removeWorkflow(_d3e);});var _d43="Delete workflow '"+_d3c+"'?";var _d44="All files and data will be destroyed";this.loadConfirmDialog(_d43,_d44,_d40,_d3f);},removeItemFileCache:function(_d45){var _d46=_d45.item.parentPath+"/"+_d45.item.path;var _d47=this.getUserName();Agua.removeFileTree(_d47,_d46);},deleteProject:function(){var _d48=this.getFilesWidget();var _d49=this.getFileDrag();if(_d48==null){return;}var _d4a=this.getProjectName();var _d4b=function(){};var _d4c=dojo.hitch(this,function(){if(!Agua.isProject(_d4a)){return;}Agua.removeProject({name:_d4a});setTimeout(function(_d4d){_d48.removeChild(_d49);},1000,this);});var _d4e="Delete project '"+_d4a+"'?";var _d4f="All workflows and data will be destroyed";this.loadConfirmDialog(_d4e,_d4f,_d4c,_d4b);},refresh:function(_d50){var _d51=this.menu.currentTarget.innerHTML;var _d52=dijit.getEnclosingWidget(this.menu.currentTarget.offsetParent);var _d53=_d52.path+"/"+_d51;var _d54=_d52.parentWidget;var _d55=_d54.owner;_d54.store.putData.mode="fileSystem";Agua.setFileCache(_d55,_d53,null);this.reloadPane(_d52,_d51);},getWorkflowName:function(){var item=this.menu.currentTarget.item;var _d56=item.path;_d56=_d56.replace(/\s+/g,"");return _d56;},getWorkflowNumber:function(){var _d57=this.menu.currentTarget.item.path;var _d58=this.getDragPane();for(var i=0;i<_d58.items.length;i++){if(_d58.items[i].name==_d57){return (i+1);}}return null;},setSelectiveDialog:function(){var _d59=function(){};var _d5a=function(){};var _d5b="";var _d5c="";this.selectiveDialog=new plugins.dijit.SelectiveDialog({title:_d5b,message:_d5c,inputMessage:"",checkboxMessage:"",parentWidget:this,enterCallback:_d59,cancelCallback:_d5a});},loadSelectiveDialog:function(_d5d,_d5e,_d5f,_d60,_d61,_d62,_d63,_d64){this.selectiveDialog.load({title:_d5d,message:_d5e,comboValues:_d5f,inputMessage:_d60,comboMessage:_d61,checkboxMessage:_d62,parentWidget:this,enterCallback:_d63,cancelCallback:_d64});},getStandby:function(){if(this.standby){return this.standby;}var id=dijit.getUniqueId("dojox_widget_Standby");this.standby=new dojox.widget.Standby({onClick:"reload",text:"",id:id,url:"plugins/core/images/agua-biwave-24.png"});document.body.appendChild(this.standby.domNode);return this.standby;},getFileDrag:function(){var _d65=this.getDragPane();return _d65.parentWidget;},getDragPane:function(){return dijit.getEnclosingWidget(this.menu.currentTarget);},getUserName:function(){var _d66=this.getFileDrag();return _d66.owner;},selectTarget:function(args){var _d67=this.getDragPane();_d67._dragSource._addItemClass(this.menu.currentTarget,"Selected");},deselectTarget:function(args){var _d68=this.getDragPane();_d68._dragSource._removeItemClass(this.menu.currentTarget,"Selected");}});}if(!dojo._hasResource["plugins.dojox.data.FileStore"]){dojo._hasResource["plugins.dojox.data.FileStore"]=true;dojo.provide("plugins.dojox.data.FileStore");dojo.declare("plugins.dojox.data.FileStore",[dojox.data.FileStore],{path:"",putData:null,constructor:function(args){this.inherited(arguments);if(!args){return;}this.core=args.core;this.path=args.path;this.putData=args.putData;this.parentPath=args.parentPath;this.processResultCallback=dojo.hitch(this,"_processResult");},_assertIsItem:function(item){if(!this.isItem(item)){}},_assertIsAttribute:function(_d69){if(typeof _d69!=="string"){throw new Error("dojox.data.FileStore: a function was passed an attribute argument that was not an attribute name string");}},loadItem:function(_d6a){var item=_d6a.item;var self=this;var _d6b=_d6a.scope||dojo.global;var _d6c={};if(this.options.length>0){_d6c.options=dojo.toJson(this.options);}if(this.pathAsQueryParam){_d6c.path=item.parentPath+this.pathSeparator+item.name;}var _d6d={url:this.pathAsQueryParam?this.url:this.url+"/"+item.parentPath+"/"+item.name,handleAs:"json-comment-optional",content:_d6c,preventCache:this.urlPreventCache,failOk:this.failOk};var _d6e=dojo.xhrGet(_d6d);_d6e.addErrback(function(_d6f){if(_d6a.onError){_d6a.onError.call(_d6b,_d6f);}});_d6e.addCallback(function(data){delete item.parentPath;delete item._loaded;dojo.mixin(item,data);self._processItem(item);if(_d6a.onItem){_d6a.onItem.call(_d6b,item);}});},isItem:function(item){if(item&&item[this._storeRef]===this){return true;}return false;},close:function(_d70){},fetch:function(_d71){_d71=_d71||{};if(!_d71.store){_d71.store=this;}var self=this;var _d72=_d71.scope||dojo.global;var _d73={};if(_d71.query){_d73.query=_d71.query;}var _d74=this.putData;if(_d71.query){_d74.query=_d71.query;}var _d75=this.processResultCallback;Agua.getFileSystem(_d74,_d75,_d71);},fetchItemByIdentity:function(_d76){var path=_d76.identity;var self=this;var _d77=_d76.scope||dojo.global;var _d78={};if(this.options.length>0){_d78.options=dojo.toJson(this.options);}if(this.pathAsQueryParam){_d78.path=path;}var _d79={url:this.pathAsQueryParam?this.url:this.url+"/"+path,handleAs:"json-comment-optional",content:_d78,preventCache:this.urlPreventCache,failOk:this.failOk};var _d7a=dojo.xhrGet(_d79);_d7a.addErrback(function(_d7b){if(_d76.onError){_d76.onError.call(_d77,_d7b);}});_d7a.addCallback(function(data){var item=self._processItem(data);if(_d76.onItem){_d76.onItem.call(_d77,item);}});},_processResult:function(data,_d7c){if(!_d7c){return;}var _d7d=_d7c.scope||dojo.global;try{if(data.pathSeparator){this.pathSeparator=data.pathSeparator;}if(_d7c.onBegin){_d7c.onBegin.call(_d7d,data.total,_d7c);}var _d7e=this._processItemArray(data.items);if(_d7c.onItem){var i;for(i=0;i<_d7e.length;i++){_d7c.onItem.call(_d7d,_d7e[i],_d7c);}_d7e=null;}if(_d7c.onComplete){_d7c.onComplete.call(_d7d,_d7e,_d7c);}}catch(e){if(_d7c.onError){_d7c.onError.call(_d7d,e,_d7c);}else{}}},_processItemArray:function(_d7f){if(!_d7f){return [];}var i;for(i=0;i<_d7f.length;i++){this._processItem(_d7f[i]);}return _d7f;},_processItem:function(item){if(!item){return null;}item[this._storeRef]=this;if(item.children&&item.directory){if(dojo.isArray(item.children)){var _d80=item.children;var i;for(i=0;i<_d80.length;i++){var name=_d80[i];if(dojo.isObject(name)){_d80[i]=this._processItem(name);}else{_d80[i]={name:name,_loaded:false,parentPath:item.path};_d80[i][this._storeRef]=this;}}}else{delete item.children;}}return item;}});}if(!dojo._hasResource["plugins.dijit.layout.BorderContainer"]){dojo._hasResource["plugins.dijit.layout.BorderContainer"]=true;dojo.provide("plugins.dijit.layout.BorderContainer");dojo.declare("plugins.dijit.layout.BorderContainer",[dijit.layout.BorderContainer],{layout:function(_d81,_d82,type){for(var _d83 in this._splitters){this._computeSplitterThickness(_d83);}this._layoutChildren(_d81,_d82,type);},_layoutChildren:function(_d84,_d85,type){if(_d85!=null){if(type=="hide"){if(/left|right|center/.test(_d84)&&_d85.minWidth){dojo.style(_d85,"width",_d85.minWidth+"px");dojo.marginBox(_d85).w=_d85.minWidth;_d85.style.width=_d85.minWidth+"px";}else{if(/top|bottom/.test(_d84)&&_d85.minHeight){_d85.style.height=_d85.minHeight+"px";}}}else{if(type=="show"){if(/left|right|center/.test(_d84)&&_d85.width){_d85.style.width=_d85.width+"px";}else{if(/top|bottom/.test(_d84)&&_d85.height){dojo.style(_d85,"width",_d85.width+"px");dojo.marginBox(_d85).w=_d85.width;}}}}}var _d86=(this.design=="sidebar");var _d87=0,_d88=0,_d89=0,_d8a=0,_d8b=0;var _d8c={},_d8d={},_d8e={},_d8f={},_d90=(this._center&&this._center.style)||{};var _d91=/left|right|center/.test(_d84);var _d92=!_d84||(!_d91&&!_d86);var _d93=!_d84||(_d91&&_d86);_d92=!_d84;if(this._top){_d8c=_d93&&this._top.style;_d87=dojo.marginBox(this._top).h;}if(this._left){_d8d=_d92&&this._left.style;_d89=dojo.marginBox(this._left).w;}if(this._center){_d8a=dojo.marginBox(this._center).w;}if(this._right){_d8e=_d92&&this._right.style;_d8b=dojo.marginBox(this._right).w;}if(this._bottom){_d8f=_d93&&this._bottom.style;_d88=dojo.marginBox(this._bottom).h;}if(_d90){}var _d94=this._splitters;var _d95=_d94.top,_d96=_d94.bottom,_d97=_d94.left,_d98=_d94.right,_d99=_d94.center;var _d9a=this._splitterThickness;var _d9b=_d9a.top||0,_d9c=_d9a.left||0,_d9d=_d9a.right||0,_d9e=_d9a.bottom||0,_d9f=_d9a.center||0;if(_d9c>50||_d9d>50){setTimeout(dojo.hitch(this,function(){this._splitterThickness={};for(var _da0 in this._splitters){this._computeSplitterThickness(_da0);}this._layoutChildren();}),50);return false;}var pe=this.pe;var _da1=this._borderBox.w-pe.l-pe.r;var _da2;if(_d85!=null){if(this._center==_d85.domNode){_da2=_d8a;_d8b=_da1-(_d89+_d9c+_d8a+_d9f);if(type=="hide"){dojo.removeClass(this._right,"dojoxExpandoClosed");dojo.style(dijit.byNode(this._right).cwrapper,"visibility","visible");dojo.style(dijit.byNode(this._right).cwrapper,"opacity","1");dijit.byNode(this._right)._showing=true;}if(dojo.hasClass(this._left,"dojoxExpandoClosed")){_d89=_d89-2;}}else{if(this._right==_d85.domNode){_da2=_da1-(_d89+_d9c+_d8b+_d9d);if(type=="hide"){dojo.removeClass(this._center,"dojoxExpandoClosed");dojo.style(dijit.byNode(this._center).cwrapper,"visibility","visible");dojo.style(dijit.byNode(this._center).cwrapper,"opacity","1");dijit.byNode(this._center)._showing=true;}if(dojo.hasClass(this._left,"dojoxExpandoClosed")){_d89=_d89-2;}}else{if(dojo.hasClass(this._right,"dojoxExpandoClosed")){_da2=_da1-(_d89+_d9c+_d8b+_d9d);_d8b=_d8b-2;}else{_da2=_d8a;_d8b=_da1-(_d89+_d9c+_d8a+_d9f);}}}}else{_da2=_da1-(_d89+_d9c+_d8b+_d9d);}if(_d90){}var _da3=_d86?_da2:_da1;var dim={top:{w:_da3,h:_d87},bottom:{w:_da3,h:_d88},left:{w:_d89,h:_da4},right:{w:_d8b,h:_da4},center:{h:_da5,w:_da2}};var _da6={left:(_d86?_d89+_d9c:0)+pe.l+"px",center:(_d86?_d8a+_d9f:0)+pe.l+"px",right:(_d86?_d8b+_d9d:0)+pe.r+"px"};if(_d95){dojo.mixin(_d95.style,_da6);_d95.style.top=_d87+pe.t+"px";}if(_d96){dojo.mixin(_d96.style,_da6);_d96.style.bottom=_d88+pe.b+"px";}_da6={top:(_d86?0:_d87+_d9b)+pe.t+"px",bottom:(_d86?0:_d88+_d9e)+pe.b+"px"};if(_d97){dojo.mixin(_d97.style,_da6);_d97.style.left=_d89+pe.l+"px";}if(_d99){dojo.mixin(_d99.style,_da6);_d99.style.center=_d8a+pe.r+"px";}if(_d98){dojo.mixin(_d98.style,_da6);_d98.style.right=_d8b+pe.r+"px";}dojo.mixin(_d90,{top:pe.t+_d87+_d9b+"px",left:pe.l+_d89+_d9c+"px",center:pe.l+_d8a+_d9f+"px",right:pe.r+_d8b+_d9d+"px",bottom:pe.b+_d88+_d9e+"px"});var _da7={top:_d86?pe.t+"px":_d90.top,bottom:_d86?pe.b+"px":_d90.bottom};dojo.mixin(_d8d,_da7);dojo.mixin(_d8e,_da7);_d8d.left=pe.l+"px";_d8e.right=pe.r+"px";_d8c.top=pe.t+"px";_d8f.bottom=pe.b+"px";if(_d86){_d8c.left=_d8f.left=_d89+_d9c+pe.l+"px";_d8c.right=_d8f.right=_d8b+_d9d+pe.r+"px";}else{_d8c.left=_d8f.left=pe.l+"px";_d8c.right=_d8f.right=pe.r+"px";}var _da8=this._borderBox.h-pe.t-pe.b;var _da5=_da8-(_d87+_d9b+_d88+_d9e);var _da4=_d86?_da8:_da5;var _da9=dojo.isIE||dojo.some(this.getChildren(),function(_daa){return _daa.domNode.tagName=="TEXTAREA"||_daa.domNode.tagName=="INPUT";});if(_da9){var _dab=function(_dac,_dad,_dae){if(_dac){(_dac.resize?_dac.resize(_dad,_dae):dojo.marginBox(_dac.domNode,_dad));}};if(_d97){_d97.style.height=_da4;}if(_d98){_d98.style.height=_da4;}_dab(this._leftWidget,{h:_da4},dim.left);_dab(this._rightWidget,{h:_da4},dim.right);if(_d95){_d95.style.width=_da3;}if(_d96){_d96.style.width=_da3;}_dab(this._topWidget,{w:_da3},dim.top);_dab(this._bottomWidget,{w:_da3},dim.bottom);_dab(this._centerWidget,{h:_da4},dim.center);}else{var _daf={};if(_d84){_daf[_d84]=_daf.center=true;if(/left|right|center/.test(_d84)){_daf.left=_daf.right=true;}else{if(/top|bottom|center/.test(_d84)){_daf.top=_daf.bottom=true;}}}dojo.forEach(this.getChildren(),function(_db0){if(_db0.resize&&(!_d84||_db0.region in _daf)){_db0.resize(null,dim[_db0.region]);}},this);}}});}if(!dojo._hasResource["dojox.layout.ExpandoPane"]){dojo._hasResource["dojox.layout.ExpandoPane"]=true;dojo.provide("dojox.layout.ExpandoPane");dojo.experimental("dojox.layout.ExpandoPane");dojo.declare("dojox.layout.ExpandoPane",[dijit.layout.ContentPane,dijit._Templated,dijit._Contained,dijit._Container],{attributeMap:dojo.delegate(dijit.layout.ContentPane.prototype.attributeMap,{title:{node:"titleNode",type:"innerHTML"}}),templateString:dojo.cache("dojox.layout","resources/ExpandoPane.html","<div class=\"dojoxExpandoPane\">\n\t<div dojoAttachPoint=\"titleWrapper\" class=\"dojoxExpandoTitle\">\n\t\t<div class=\"dojoxExpandoIcon\" dojoAttachPoint=\"iconNode\" dojoAttachEvent=\"onclick:toggle\"><span class=\"a11yNode\">X</span></div>\t\t\t\n\t\t<span class=\"dojoxExpandoTitleNode\" dojoAttachPoint=\"titleNode\">${title}</span>\n\t</div>\n\t<div class=\"dojoxExpandoWrapper\" dojoAttachPoint=\"cwrapper\" dojoAttachEvent=\"ondblclick:_trap\">\n\t\t<div class=\"dojoxExpandoContent\" dojoAttachPoint=\"containerNode\"></div>\n\t</div>\n</div>\n"),easeOut:"dojo._DefaultEasing",easeIn:"dojo._DefaultEasing",duration:420,startExpanded:true,previewOpacity:0.75,previewOnDblClick:false,baseClass:"dijitExpandoPane",postCreate:function(){this.inherited(arguments);this._animConnects=[];this._isHorizontal=true;if(dojo.isString(this.easeOut)){this.easeOut=dojo.getObject(this.easeOut);}if(dojo.isString(this.easeIn)){this.easeIn=dojo.getObject(this.easeIn);}var _db1="",rtl=!this.isLeftToRight();if(this.region){switch(this.region){case "trailing":case "right":_db1=rtl?"Left":"Right";break;case "leading":case "left":_db1=rtl?"Right":"Left";break;case "top":_db1="Top";break;case "bottom":_db1="Bottom";break;}dojo.addClass(this.domNode,"dojoxExpando"+_db1);dojo.addClass(this.iconNode,"dojoxExpandoIcon"+_db1);this._isHorizontal=/top|bottom/.test(this.region);}dojo.style(this.domNode,{overflow:"hidden",padding:0});this.connect(this.domNode,"ondblclick",this.previewOnDblClick?"preview":"toggle");if(this.previewOnDblClick){this.connect(this.getParent(),"_layoutChildren",dojo.hitch(this,function(){this._isonlypreview=false;}));}},_startupSizes:function(){this._container=this.getParent();this._closedSize=this._titleHeight=dojo.marginBox(this.titleWrapper).h;if(this.splitter){var myid=this.id;dijit.registry.filter(function(w){return w&&w.child&&w.child.id==myid;}).forEach(dojo.hitch(this,function(w){this.connect(w,"_stopDrag","_afterResize");}));}this._currentSize=dojo.contentBox(this.domNode);this._showSize=this._currentSize[(this._isHorizontal?"h":"w")];this._setupAnims();if(this.startExpanded){this._showing=true;}else{this._showing=false;this._hideWrapper();this._hideAnim.gotoPercent(99,true);}this._hasSizes=true;},_afterResize:function(e){var tmp=this._currentSize;this._currentSize=dojo.marginBox(this.domNode);var n=this._currentSize[(this._isHorizontal?"h":"w")];if(n>this._titleHeight){if(!this._showing){this._showing=!this._showing;this._showEnd();}this._showSize=n;this._setupAnims();}else{this._showSize=tmp[(this._isHorizontal?"h":"w")];this._showing=false;this._hideWrapper();this._hideAnim.gotoPercent(89,true);}},_setupAnims:function(){dojo.forEach(this._animConnects,dojo.disconnect);var _db2={node:this.domNode,duration:this.duration},_db3=this._isHorizontal,_db4={},_db5={},_db6=_db3?"height":"width";_db4[_db6]={end:this._showSize};_db5[_db6]={end:this._closedSize};this._showAnim=dojo.animateProperty(dojo.mixin(_db2,{easing:this.easeIn,properties:_db4}));this._hideAnim=dojo.animateProperty(dojo.mixin(_db2,{easing:this.easeOut,properties:_db5}));this._animConnects=[dojo.connect(this._showAnim,"onEnd",this,"_showEnd"),dojo.connect(this._hideAnim,"onEnd",this,"_hideEnd")];},preview:function(){if(!this._showing){this._isonlypreview=!this._isonlypreview;}this.toggle();},toggle:function(){if(this._showing){this._hideWrapper();this._showAnim&&this._showAnim.stop();this._hideAnim.play();}else{this._hideAnim&&this._hideAnim.stop();this._showAnim.play();}this._showing=!this._showing;},_hideWrapper:function(){dojo.addClass(this.domNode,"dojoxExpandoClosed");dojo.style(this.cwrapper,{visibility:"hidden",opacity:"0",overflow:"hidden"});},_showEnd:function(){dojo.style(this.cwrapper,{opacity:0,visibility:"visible"});dojo.anim(this.cwrapper,{opacity:this._isonlypreview?this.previewOpacity:1},227);dojo.removeClass(this.domNode,"dojoxExpandoClosed");if(!this._isonlypreview){setTimeout(dojo.hitch(this._container,"layout"),15);}else{this._previewShowing=true;this.resize();}},_hideEnd:function(){if(!this._isonlypreview){setTimeout(dojo.hitch(this._container,"layout"),25);}else{this._previewShowing=false;}this._isonlypreview=false;},resize:function(_db7){if(!this._hasSizes){this._startupSizes(_db7);}var _db8=dojo.marginBox(this.domNode);this._contentBox={w:_db7&&"w" in _db7?_db7.w:_db8.w,h:(_db7&&"h" in _db7?_db7.h:_db8.h)-this._titleHeight};dojo.style(this.containerNode,"height",this._contentBox.h+"px");if(_db7){dojo.marginBox(this.domNode,_db7);}this._layoutChildren();},_trap:function(e){dojo.stopEvent(e);}});}if(!dojo._hasResource["plugins.dojox.layout.ExpandoPane"]){dojo._hasResource["plugins.dojox.layout.ExpandoPane"]=true;dojo.provide("plugins.dojox.layout.ExpandoPane");dojo.declare("plugins.dojox.layout.ExpandoPane",[dojox.layout.ExpandoPane],{width:null,minWidth:15,height:null,minHeight:15,expand:false,resize:function(node,_db9){if(_db9){}var size=dojo.marginBox(this.domNode);var h=size.h-this._titleHeight;dojo.style(this.containerNode,"height",h+"px");if(_db9&&_db9.w){dojo.style(this.domNode,"width",_db9.w+"px");}},_showEnd:function(){dojo.style(this.cwrapper,{opacity:0,visibility:"visible"});dojo.fadeIn({node:this.cwrapper,duration:227}).play(1);dojo.removeClass(this.domNode,"dojoxExpandoClosed");if(this.region){switch(this.region){case "left":case "center":case "right":this.domNode.style.width=this.width+"px";break;case "top":case "bottom":this.domNode.style.height=this.height+"px";break;}}setTimeout(dojo.hitch(this._container,"layout",this.region,this,"show"),15);},_hideEnd:function(){if(this.region){switch(this.region){case "left":case "center":case "right":dojo.style(this.domNode,"width",this.minWidth+"px");break;case "top":case "bottom":dojo.style(this.domNode,"width",this.minHeight+"px");break;}}setTimeout(dojo.hitch(this._container,"layout",this.region,this,"hide"),15);}});}if(!dojo._hasResource["plugins.files.TitlePane"]){dojo._hasResource["plugins.files.TitlePane"]=true;dojo.provide("plugins.files.TitlePane");dojo.declare("plugins.files.TitlePane",[dijit.TitlePane,plugins.core.Common],{className:"filesTitlePane",title:"",open:true,duration:dijit.defaultDuration,baseClass:"filesTitlePane",templateString:null,templateString:"<div dojoAttachPoint=\"containerNode\">\r\n\r\n\t\t<div dojoAttachEvent=\"onclick:toggle,onkeypress: _onTitleKey,onfocus:_handleFocus,onblur:_handleFocus\" tabindex=\"0\"\r\n\t\t\twaiRole=\"button\"\r\n\t\t\tclass=\"dijitTitlePaneTitle\" dojoAttachPoint=\"titleBarNode,focusNode\">\r\n\t\r\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" dojoAttachPoint=\"arrowNode\" class=\"filesArrowNode\" waiRole=\"presentation\">\r\n\t\t\t\t<span dojoAttachPoint=\"arrowNodeInner\" class=\"dijitArrowNodeInner\"></span>\r\n\t\t\t\t<img src=\"${_blankGif}\" dojoAttachPoint=\"refresh\" class=\"refreshTitlePane\" dojoAttachEvent=\"onclick:reload\">\r\n\t\r\n\t\t\t<span dojoAttachPoint=\"titleNode\" class=\"dijitTitlePaneTextNode\">\r\n\t\t\t\t\r\n\t\t\t\t<table cellspacing=\"0\" cellpadding=\"0\" dojoAttachPoint='header' class='header'>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td dojoAttachPoint=\"ownerNode\" class='owner' title='Owner'></td>\r\n\t\t\t\t\t\t<td dojoAttachPoint=\"nameNode\" class='name'></td>\r\n\t\t\t\t\t\t<td dojoAttachPoint=\"locationNode\" class='location'></td>\r\n\t\t\t\t\t\t<td dojoAttachPoint=\"descriptionNode\" class='description' title='Description'></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t\t\r\n\t\t\t</span>\r\n\t\t\t\r\n\t\t</div>\r\n\t\t<div class=\"dijitTitlePaneContentOuter\" dojoAttachPoint=\"hideNode\">\r\n\t\t\t<div class=\"dijitReset\" dojoAttachPoint=\"wipeNode\">\r\n\t\t\t\t<div class=\"dijitTitlePaneContentInner\" dojoAttachPoint=\"containerNode\" waiRole=\"region\" tabindex=\"-1\">\r\n\t\t\t\t\t<!-- nested divs because wipeIn()/wipeOut() doesn't work right on node w/padding etc.  Put padding on inner div. -->\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n</div>\r\n",cssFiles:[dojo.moduleUrl("plugins")+"/files/css/titlepane.css"],reloadCallback:null,core:null,directory:"",name:"",owner:"",location:"",description:"",size:"normal",type:"",attributeMap:dojo.delegate(dijit.layout.ContentPane.prototype.attributeMap,{title:{node:"titleNode",type:"innerHTML"},number:{node:"numberNode",type:"innerHTML"},tooltip:{node:"focusNode",type:"attribute",attribute:"title"},id:""}),constructor:function(args){this.title=args.title||"";this.size=args.size||"";this.name=args.name||"";this.owner=args.owner||"";this.location=args.location||"";this.description=args.description||"";this.core=args.core;},postCreate:function(){this.loadCSS(this.cssFiles);if(this.owner){this.ownerNode.innerHTML=this.owner;}if(this.name){this.nameNode.innerHTML=this.name;}if(this.location){this.locationNode.innerHTML=this.location;}if(this.description){this.descriptionNode.innerHTML=this.description;}var _dba="Type of filesystem";if(!this.name){this.nameNode.setAttribute("title",_dba);}if(this.size=="large"){this.arrowNode.setAttribute("class","largeFilesArrowNode");}if(this.size=="larger"){this.arrowNode.setAttribute("class","largerFilesArrowNode");}console.log("TitlePane.postCreate    BEFORE this.inherited(arguments)");this.inherited(arguments);console.log("TitlePane.postCreate    AFTER this.inherited(arguments)");},reload:function(_dbb){_dbb.stopPropagation();if(this.reloadCallback!=null){this.reloadCallback();return;}this.clear();var _dbc=this.master;var _dbd=this.core[_dbc].createFileDrag(this.directory);this.containerNode.appendChild(_dbd.domNode);},clear:function(){while(this.containerNode.firstChild){var _dbe=dijit.getEnclosingWidget(this.containerNode.firstChild);_dbe.destroy();}},_handleFocus:function(e){dojo[(e.type=="focus"?"addClass":"removeClass")](this.focusNode,this.baseClass+"Focused");},destroyRecursive:function(){this.inherited(arguments);}});}if(!dojo._hasResource["dijit.layout.LayoutContainer"]){dojo._hasResource["dijit.layout.LayoutContainer"]=true;dojo.provide("dijit.layout.LayoutContainer");dojo.declare("dijit.layout.LayoutContainer",dijit.layout._LayoutWidget,{baseClass:"dijitLayoutContainer",constructor:function(){dojo.deprecated("dijit.layout.LayoutContainer is deprecated","use BorderContainer instead",2);},layout:function(){dijit.layout.layoutChildren(this.domNode,this._contentBox,this.getChildren());},addChild:function(_dbf,_dc0){this.inherited(arguments);if(this._started){dijit.layout.layoutChildren(this.domNode,this._contentBox,this.getChildren());}},removeChild:function(_dc1){this.inherited(arguments);if(this._started){dijit.layout.layoutChildren(this.domNode,this._contentBox,this.getChildren());}}});dojo.extend(dijit._Widget,{layoutAlign:"none"});}if(!dojo._hasResource["plugins.folders.Files"]){dojo._hasResource["plugins.folders.Files"]=true;dojo.provide("plugins.folders.Files");if(1){}dojo.declare("plugins.folders.Files",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<div\n\t\tdojoAttachPoint=\"mainNode\">\n\t\n\t\t<div\n\t\t\tdojoAttachPoint=\"titlePane\"\n\t\t\tdojoType=\"plugins.files.TitlePane\"\n\t\t\tparentWidget=\"this\"\n\t\t\tsize=\"large\"\n\t\t\ttitle=\"${title}\"\n\t\t\topen=\"${open}\"\n\t\t\twidth=\"200\">\n\t\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"rowsNode\"\n\t\t\t\tclass=\"directories\"\n\t\t\t\t>\n\t\t\t</div>\n\t\n\t\t</div>\n\n\t</div>\n\n</div>\n",widgetsInTemplate:true,project:null,sleep:300,loadingPanes:null,fileDrags:null,cssFiles:[dojo.moduleUrl("plugins","folders/css/dialog.css"),dojo.moduleUrl("plugins","files/FileDrag/FileDrag.css"),dojo.moduleUrl("dojox","widget/Dialog/Dialog.css")],title:"Workflow",core:null,open:true,self:null,url:null,constructor:function(args){if(args.open){this.open=args.open;}if(this.open==null){this.open=false;}this.core=args.core;this.attachNode=args.attachNode;if(args.cssFiles!=null){this.cssFiles=args.cssFiles;}this.loadCSS(this.cssFiles);},postCreate:function(){this.titlePane.reloadCallback=dojo.hitch(this,"reload");this.startup();},startup:function(){console.group("Files    "+this.id+"    startup");console.log("Files.startup    BEFORE this.inherited(arguments)");this.inherited(arguments);console.log("Files.startup    AFTER this.inherited(arguments)");console.log("Files.startup    this.mainNode: "+this.mainNode);console.log("Files.startup    this.attachNode: "+this.attachNode);console.log("Files.startup    this.attachNode.addChild: "+this.attachNode.addChild);console.log("Files.startup    this.attachNode.appendChild: "+this.attachNode.appendChild);if(this.attachNode.addChild!=null){var _dc2=new dijit.layout.LayoutContainer({title:"Files"},this.mainNode);console.log("Files.startup    projectFilesContainer: "+_dc2);_dc2.id="projectFilesContainer";this.attachNode.addChild(_dc2);}else{this.attachNode.appendChild(this.mainNode);}console.log("Files.startup    AFTER this.attachNode.appendChild(this.mainNode)");this.fileDrags=[];this.load();console.groupEnd("Files    "+this.id+"    startup");},reload:function(){this.clear();this.load();},getDirectories:function(){var _dc3=Agua.getProjects();return _dc3;},clear:function(){while(this.rowsNode.firstChild){this.rowsNode.removeChild(this.rowsNode.firstChild);}},load:function(){console.group("Files    "+this.id+"    load");var _dc4=this.getDirectories();if(_dc4==null){return;}console.log("Files.load\t   directories.length: "+_dc4.length);console.log("Files.load\t   directories: ");console.dir({directories:_dc4});this.titlePanes=new Array;for(var i=0;i<_dc4.length;i++){var _dc5=dojo.clone(_dc4[i]);var _dc6=this.setTitlePane(_dc5);this.titlePanes.push(_dc6);}console.groupEnd("Files    "+this.id+"    load");},setTitlePane:function(_dc7){if(!_dc7.owner){_dc7.owner=_dc7.username;}_dc7.description=_dc7.description||"";_dc7.open=this.open;_dc7.title=this.title;var _dc8=document.createElement("div");this.rowsNode.appendChild(_dc8);this.core[this.self]=this;var _dc9=new plugins.files.TitlePane({owner:_dc7.owner,type:_dc7.type,name:_dc7.name,location:_dc7.location,description:_dc7.description,open:_dc7.open,directory:_dc7,core:this.core,master:this.self},_dc8);return _dc9;},createFileDrag:function(_dca){var _dcb=this.createStore(_dca);this.core[this.self]=this;var _dcc=new plugins.files.FileDrag({style:"height: auto; width: 100%; minHeight: 50px;",store:_dcb,fileMenu:this.fileMenu,folderMenu:this.folderMenu,workflowMenu:this.workflowMenu,core:this.core,parentWidget:this,owner:_dca.owner,path:_dca.name,description:_dca.description||""});this.fileDrags.push(_dcc);_dcc.startup();return _dcc;},addChild:function(_dcd){var _dce=this.setTitlePane(_dcd);this.titlePanes.push(_dce);var name=_dcd.name;var _dcf=_dcd.owner;var _dd0={"name":name,"path":name,"total":"0","items":[]};Agua.setFileCache(_dcf,name,_dd0);var _dd1={stopPropagation:function(){}};_dce.reload(_dd1);},removeChild:function(_dd2){if(!this.fileDrags){return false;}for(var i=0;i<this.fileDrags.length;i++){if(this.fileDrags[i]==_dd2){this.fileDrags.splice(i,1);_dd2.destroyRecursive();var _dd3=this.titlePanes.splice(i,1);var _dd4=_dd3[0];_dd4.destroyRecursive();return true;}}return false;},getPutData:function(_dd5){var _dd6=new Object;_dd6.mode="fileSystem";_dd6.username=Agua.cookie("username");_dd6.sessionid=Agua.cookie("sessionid");_dd6.url=this.url;_dd6.path=_dd5.name;return _dd6;},createStore:function(_dd7){var url=this.url;var _dd8=this.getPutData(_dd7);var _dd9=new plugins.dojox.data.FileStore({url:url,putData:_dd8,pathAsQueryParam:true,parentPath:this.parentPath,path:_dd7.name});_dd9.preamble=function(){this.store.path=this.arguments[0].path;};return _dd9;},openLocation:function(_dda,_ddb){console.log("Files.openLocation    location: "+_dda);console.log("Files.openLocation    username: "+_ddb);var _ddc=_dda.split(/\//);var _ddd=_ddc[0];var _dde=this.getFileDragByProject(_ddd);console.log("Files.openLocation    fileDrag: ");console.dir({fileDrag:_dde});if(!_dde){return;}var _ddf=_dde.getChildren();console.dir({dragPanes:_ddf});if(!_ddf){_dde.startup();}_ddf=_dde.getChildren();console.log("Files.openLocation    dragPanes.length: "+_ddf.length);if(_ddc.length<2){return;}console.log("Files.openLocation    Doing this.folderRoundRobin("+_dda+", 1)");this.folderRoundRobin(_dda,1);},folderRoundRobin:function(_de0,_de1){console.log("Files.folderRoundRobin    location: "+_de0);console.log("Files.folderRoundRobin    index: "+_de1);console.log("Files.folderRoundRobin    caller: "+this.folderRoundRobin.caller.nom);var _de2=_de0.split(/\//);console.log("Files.folderRoundRobin    folders.length: "+_de2.length);var _de3=_de2[0];var _de4=this.getFileDragByProject(_de3);console.dir({fileDrag:_de4});var _de5=_de4.getChildren();console.log("Files.folderRoundRobin    dragPanes.length: "+_de5.length);if(_de1>1){console.log("Files.folderRoundRobin    Removing connection for previous dragPane");var _de6=_de5[_de1-1];if(_de6._connection){dojo.disconnect(_de6._connection);}}var _de7=dojo.hitch(this,"connectRoundRobin",_de4,_de0,_de1+1);var _de8;if(_de5.length<_de1+1){if((_de1+1)<=_de2.length){this.openFolder(_de5[_de1-1],_de2[_de1],_de7);}}else{var _de9=_de5[_de1];console.log("Files.folderRoundRobin    dragPane "+_de1+": "+_de9);var path=_de9.path;console.log("Files.folderRoundRobin    Doing folder "+_de1+" path: "+path);var _dea=this.folderPathByIndex(_de2,_de1);console.log("Files.folderRoundRobin    Doing folder "+_de1+" folderPath: "+_dea);if(_dea!=path){this.openFolder(_de5[_de1-1],_de2[_de1],_de7);}}},openFolder:function(_deb,name,_dec){_deb._dragSource._removeSelection();var _ded=this.getItemIndexByName(_deb,name);if(_ded<0){return;}var _dee=_deb._dragSource.getAllNodes();dojo.addClass(_dee[_ded],"dojoDndItemAnchor");var item=_dee[_ded].item;var _def={target:{item:item}};if(this._connection){dojo.disconnect(this._connection);}delete this._connection;this._connection=dojo.connect(_deb.parentWidget,"addChild",dojo.hitch(this,_dec));_deb.onclickHandler(_def);},testCallback:function(_df0,_df1,_df2){},connectRoundRobin:function(_df3,_df4,_df5){var _df6=_df3.getChildren();var _df7=_df6[_df6.length-1];_df7._connection=dojo.connect(_df7,"onLoad",dojo.hitch(this,"folderRoundRobin",_df4,_df5));},getFileDragByProject:function(_df8){for(var i=0;i<this.fileDrags.length;i++){var _df9=this.fileDrags[i];if(_df9.path==_df8){return _df9;}}return null;},refreshFileDrags:function(){var _dfa=Agua.getProjects();var _dfb=dojo.query(".dojoxFileDrag");this.fileDrags=[];for(var i=0;i<_dfb.length;i++){this.fileDrags.push(dijit.byNode(_dfb[i]));}},getItemIndexByName:function(_dfc,name){var _dfd=_dfc._dragSource.getAllNodes();for(var i=0;i<_dfd.length;i++){if(_dfd[i].item.name==name){return i;}}return -1;},folderPathByIndex:function(_dfe,_dff){if(_dff>_dfe.length-1){return;}var path="";for(var i=0;i<_dff+1;i++){if(i>0){path+="/";}path+=_dfe[i];}return path;}});}if(!dojo._hasResource["plugins.folders.ProjectFiles"]){dojo._hasResource["plugins.folders.ProjectFiles"]=true;dojo.provide("plugins.folders.ProjectFiles");if(1){}dojo.declare("plugins.folders.ProjectFiles",[plugins.folders.Files],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<div\n\t\tdojoAttachPoint=\"mainNode\">\n\t\n\t\t<div\n\t\t\tdojoAttachPoint=\"titlePane\"\n\t\t\tdojoType=\"plugins.files.TitlePane\"\n\t\t\tparentWidget=\"this\"\n\t\t\tsize=\"large\"\n\t\t\ttitle=\"${title}\"\n\t\t\topen=\"${open}\"\n\t\t\twidth=\"200\">\n\t\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"rowsNode\"\n\t\t\t\tclass=\"directories\"\n\t\t\t\t>\n\t\t\t</div>\n\t\n\t\t</div>\n\n\t</div>\n\n</div>\n",widgetsInTemplate:true,project:null,sleep:300,loadingPanes:null,fileDrags:null,cssFiles:[dojo.moduleUrl("plugins","folders/css/dialog.css"),dojo.moduleUrl("dojox","widget/Dialog/Dialog.css")],title:"Workflow",open:true,self:"projectfiles"});}if(!dojo._hasResource["plugins.folders.SourceFiles"]){dojo._hasResource["plugins.folders.SourceFiles"]=true;dojo.provide("plugins.folders.SourceFiles");dojo.declare("plugins.folders.SourceFiles",[plugins.folders.Files],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<div\n\t\tdojoAttachPoint=\"mainNode\">\n\t\n\t\t<div\n\t\t\tdojoAttachPoint=\"titlePane\"\n\t\t\tdojoType=\"plugins.files.TitlePane\"\n\t\t\tparentWidget=\"this\"\n\t\t\tsize=\"large\"\n\t\t\ttitle=\"${title}\"\n\t\t\topen=\"${open}\"\n\t\t\twidth=\"200\">\n\t\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"rowsNode\"\n\t\t\t\tclass=\"directories\"\n\t\t\t\t>\n\t\t\t</div>\n\t\n\t\t</div>\n\n\t</div>\n\n</div>\n",widgetsInTemplate:true,core:null,project:null,sleep:250,open:false,self:"sourcefiles",constructor:function(args){this.paneId=args.paneId;this.project=args.project;this.core=args.core;this.attachNode=args.attachNode;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);},load:function(){this.inherited(arguments);},getDirectories:function(){return Agua.getSources();},createFileDrag:function(_e00){var _e01=this.createSourceStore(_e00);this.core[this.self]=this;var _e02=new plugins.files.FileDrag({style:"height: auto; width: 100%; minHeight: 50px;",store:_e01,fileMenu:this.fileMenu,folderMenu:this.folderMenu,workflowMenu:this.workflowMenu,core:this.core,parentWidget:this,owner:_e00.owner,path:"",description:_e00.description||""});this.fileDrags.push(_e02);_e02.startup();return _e02;},createSourceStore:function(_e03){var url=this.url;var _e04=this.getSourcePutData(_e03);var _e05=new plugins.dojox.data.FileStore({url:url,putData:_e04,pathAsQueryParam:true,parentPath:this.parentPath,path:_e03.name});return _e05;},getSourcePutData:function(_e06){var _e07=new Object;_e07.mode="fileSystem";_e07.username=Agua.cookie("username");_e07.sessionid=Agua.cookie("sessionid");_e07.location=_e06.location;_e07.url=Agua.cgiUrl+"folders.cgi?";return _e07;}});}if(!dojo._hasResource["plugins.folders.SharedProjectFiles"]){dojo._hasResource["plugins.folders.SharedProjectFiles"]=true;dojo.provide("plugins.folders.SharedProjectFiles");dojo.declare("plugins.folders.SharedProjectFiles",[plugins.folders.Files],{open:true,self:"sharedprojectfiles",load:function(){console.group("sharedProjectFiles    "+this.id+"    load");this.titlePanes=new Array;var _e08=Agua.getSharedUsernames();for(var j=0;j<_e08.length;j++){if(_e08[j]=="agua"){continue;}var _e09=Agua.getSharedProjectsByUsername(_e08[j]);for(var i=0;i<_e09.length;i++){var _e0a=dojo.clone(_e09[i]);_e0a.open=this.open;this.titlePanes.push(this.setTitlePane(_e0a));}}console.groupEnd("sharedProjectFiles    "+this.id+"    load");},createFileDrag:function(_e0b){console.log("SharedProjectFiles.createFileDrag    directory: ");console.dir({directory:_e0b});var _e0c=this.createStore(_e0b);var _e0d=new plugins.files.FileDrag({style:"height: auto; width: 100%; minHeight: 50px;",store:_e0c,fileMenu:this.fileMenu,folderMenu:this.folderMenu,workflowMenu:this.workflowMenu,owner:_e0b.owner,parentWidget:this,core:this.core});_e0d.path=_e0b.name;_e0d.startup();return _e0d;},getPutData:function(_e0e){console.log("folders.SharedProjectFiles    directory:");console.dir({directory:_e0e});var _e0f=new Object;_e0f.mode="fileSystem";_e0f.sessionid=Agua.cookie("sessionid");_e0f.url=Agua.cgiUrl+"folders.cgi?";_e0f.requestor=Agua.cookie("username");_e0f.username=_e0e.owner;_e0f.groupname=_e0e.groupname;return _e0f;}});}if(!dojo._hasResource["plugins.folders.SharedSourceFiles"]){dojo._hasResource["plugins.folders.SharedSourceFiles"]=true;dojo.provide("plugins.folders.SharedSourceFiles");dojo.declare("plugins.folders.SharedSourceFiles",[plugins.folders.Files],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<div\n\t\tdojoAttachPoint=\"mainNode\">\n\t\n\t\t<div\n\t\t\tdojoAttachPoint=\"titlePane\"\n\t\t\tdojoType=\"plugins.files.TitlePane\"\n\t\t\tparentWidget=\"this\"\n\t\t\tsize=\"large\"\n\t\t\ttitle=\"${title}\"\n\t\t\topen=\"${open}\"\n\t\t\twidth=\"200\">\n\t\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"rowsNode\"\n\t\t\t\tclass=\"directories\"\n\t\t\t\t>\n\t\t\t</div>\n\t\n\t\t</div>\n\n\t</div>\n\n</div>\n",widgetsInTemplate:true,parentWidget:null,project:null,sleep:250,title:"Shared Sources",open:true,titlePanes:null,self:"sourcefiles",constructor:function(args){this.paneId=args.paneId;this.project=args.project;this.core=args.core;this.attachNode=args.attachNode;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);},load:function(){var _e10=Agua.getSharedUsernames();if(!_e10){return;}this.titlePanes=new Array;for(var j=0;j<_e10.length;j++){if(_e10[j]=="agua"){continue;}var _e11=Agua.getSharedSourcesByUsername(_e10[j]);if(!_e11){continue;}for(var i=0;i<_e11.length;i++){var _e12=dojo.clone(_e11[i]);_e12.open=this.open;this.titlePanes.push(this.setTitlePane(_e12));}}},getDirectories:function(){return Agua.getSharedSources();},createFileDrag:function(_e13){var _e14=this.createStore(_e13);var _e15=new plugins.files.FileDrag({style:"height: auto; width: 100%; minHeight: 50px;",store:_e14,fileMenu:this.fileMenu,folderMenu:this.folderMenu,workflowMenu:this.workflowMenu,owner:_e13.owner,parentWidget:this,core:this.core});_e15.path=_e13.location;this.fileDrags.push(_e15);_e15.startup();return _e15;},getPutData:function(_e16){var _e17=new Object;_e17.mode="fileSystem";_e17.requestor=Agua.cookie("username");_e17.sessionid=Agua.cookie("sessionid");_e17.location=_e16.location;_e17.url=Agua.cgiUrl+"folders.cgi?";_e17.username=_e16.owner;_e17.owner=_e16.owner;_e17.location=_e16.location;_e17.groupname=_e16.groupname;return _e17;}});}if(!dojo._hasResource["plugins.files.FileManager"]){dojo._hasResource["plugins.files.FileManager"]=true;dojo.provide("plugins.files.FileManager");if(1){}dojo.declare("plugins.files.FileManager",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n\t<div\n\t\tdojoAttachPoint=\"mainTab\"\n\t\tclass=\"folders\"\n\t\ticonClass=\"dijitEditorIcon dijitEditorIconProject\"\n\t\tminWidth=\"1000\"\n\t\tstyle=\"position: relative; min-width: auto !important; width: 100% !important; height: auto !important; padding: 0px; background: #FFF; overflow-y: scroll\"\n\t\tclosable=\"true\"\n\t\tscrollbar=\"true\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t>\n\t\t\n\t\t<div\n\t\t\tdojoAttachPoint=\"projectsNode\"\n\t\t\t>\n\t\t</div>\n\n\t\t<div\n\t\t\tdojoAttachPoint=\"sourcesNode\"\n\t\t\t>\n\t\t</div>\n\n\t\t<div\n\t\t\tdojoAttachPoint=\"sharedProjectsNode\"\n\t\t\t>\n\t\t</div>\n\n\t\t<div\n\t\t\tdojoAttachPoint=\"sharedSourcesNode\"\n\t\t\t>\n\t\t</div>\n\n    </div>\n\n</div>\n",widgetsInTemplate:true,sourceId:"",workflowObject:null,dialogId:null,cssFiles:[dojo.moduleUrl("plugins","files/css/filemanager.css"),dojo.moduleUrl("dojox","layout/resources/FloatingPane.css")],callback:null,core:null,dialog:null,atomic:{},preamble:function(){this.callback=arguments[0].callback;},constructor:function(args){console.log("XXXXXX FileManager.constructor\targs:");console.dir({args:args});this.loadCSS();this.setMenus();this.core=new Object;this.core.folders=this;},postCreate:function(){this.startup();},startup:function(){console.log("FileManager.startup\tplugins.files.FileManager.startup()");console.log("FileManager.startup\tBEFORE this.inherited(arguments)");this.inherited(arguments);console.log("FileManager.startup\tAFTER this.inherited(arguments)");console.log("startup, this.core: ");console.log(this.core);this.createDialog();console.log("FileManager.startup\tAFTER this.createDialog()");this.setAtomic();this.setNodes();this.loadPanes();this.atomic.dialog.startup();Agua.updater.subscribe(this,"updateProjects");Agua.updater.subscribe(this,"updateSources");},updateProjects:function(args){console.log("FileManager.updateProjects    Cluster.updateProjects()");console.log("FileManager.updateProjects    this: "+this);console.log("FileManager.updateProjects    Calling this.loadPanes()");this.loadProjects();},updateWorkflows:function(args){if(args!=null&&args.originator==this){if(args.reload==false){return;}}this.loadWorkflows;},updateSources:function(args){console.log("FileManager.updateSources    Cluster.updateSources()");console.log("FileManager.updateSources    this: "+this);console.log("FileManager.updateSources    Calling this.loadSourceTab()");this.loadSources();},setMenus:function(){this.fileMenu=new plugins.files.FileMenu({parentWidget:this});this.folderMenu=new plugins.files.FolderMenu({parentWidget:this});this.workflowMenu=new plugins.files.WorkflowMenu({parentWidget:this});},createDialog:function(){console.log("FileManager.createDialog    plugins.files.FileManager.createDialog()");var _e18=dojo.dnd.getUniqueId();this.dialogId=_e18;var node=dojo.create("div");document.body.appendChild(node);this.atomic.dialog=new plugins.dojox.layout.FloatingPane({id:_e18,draggable:true,showTitle:true,title:"File Manager",region:"bottom",dockable:"true",duration:"10",height:"500px",width:"900px",resizable:"true",maxable:"false",closable:"false",dockClass:"filesDockNode"},node);dojo.style(this.atomic.dialog.domNode,"display","none");dojo.style(this.atomic.dialog.domNode,"visibility","hidden");this.atomic.dialog.startup();dojo.connect(this.atomic.dialog,"_onShow",this.atomic.dialog,"maximize");console.log("FileManager.createDialog    AFTER create dialog");console.log("FileManager.createDialog    Doing set class 'folders dijitDialog'");dojo.attr(dojo.byId(_e18),"class","folders dijitDialog");console.log("FileManager.createDialog    Doing set style.top");this.atomic.dialog.domNode.style.top="100px";console.log("FileManager.createDialog    Doing add class 'folders'");dojo.addClass(this.atomic.dialog.domNode,"folders");console.log("FileManager.createDialog     Doing this.atomic.dialog.content = this.mainTab.containerNode");console.log("FileManager.createDialog     this.mainTab.containerNode: "+this.mainTab.containerNode);dojo.connect(this.atomic.dialog,"minimize",this,"disableMenuSelect");dojo.connect(this.atomic.dialog,"minimize",this,"disableMenuAdd");this.atomic.dialog.containerNode.appendChild(this.mainTab.containerNode);},setAtomic:function(){this.atomic.nodes=new Object;this.atomic.widgets=new Object;},setRefreshButtons:function(){console.log("FileManager.setRefreshButtons    FileManager.setRefreshButtons()");var _e19=[{titleNode:this.projectsTitle.focusNode,title:"Refresh Projects",onclick:"loadProjects"},{titleNode:this.sharedProjectsTitle.focusNode,title:"Refresh Shared Projects",onclick:"loadSharedProjects"},{titleNode:this.sourcesTitle.focusNode,title:"Refresh Sources",onclick:"loadSources"},{titleNode:this.sharedSourcesTitle.focusNode,title:"Refresh Shared Sources",onclick:"loadSharedSources"}];var _e1a=this;dojo.forEach(_e19,dojo.hitch(_e1a,function(_e1b){console.log("FileManager.setRefreshButtons    FileManager.setRefreshButtons(command)");console.log("FileManager.setRefreshButtons    command: ");console.dir(_e1b);var node=document.createElement("div");_e1b.titleNode.appendChild(node);dojo.attr(node,"title",_e1b.title);dojo.addClass(node,"refreshButton");dojo.connect(node,"onclick",this,_e1b.onclick);}));},setNodes:function(){console.log("FileManager.setNodes    workflow.FileManager.setNodes()");var _e1c=document.createElement("div");dojo.addClass(_e1c,"folders");this.paneNode=_e1c;var _e1d=["projects","sharedProjects","sources","sharedSources"];var _e1e=this;dojo.forEach(_e1d,function(_e1f){console.log("FileManager.setNodes    thisObject["+_e1f+"Node]: "+_e1e[_e1f+"Node"]);_e1e.atomic.nodes[_e1f]=_e1e[_e1f+"Node"];_e1e.atomic.widgets[_e1f]=new Array;});},loadPanes:function(){console.log("FileManager.loadPanes\t   plugins.files.FileManager.loadPanes()");this.titlePanes=[];this.titlePanes=this.concatArrays(this.titlePanes,this.loadProjects());this.titlePanes=this.concatArrays(this.titlePanes,this.loadSources());this.titlePanes=this.concatArrays(this.titlePanes,this.loadSharedProjects());this.titlePanes=this.concatArrays(this.titlePanes,this.loadSharedSources());console.log("Folders.loadPanes    this.titlePanes.length: "+this.titlePanes.length);this.roundRobin();},loadProjects:function(){this.remove("projectsNode",this.projectFiles);this.projectFiles=new plugins.folders.ProjectFiles({open:false,title:"Projects",type:"Project",attachNode:this.projectsNode,fileMenu:this.fileMenu,folderMenu:this.folderMenu,workflowMenu:this.workflowMenu,core:this.core});return this.projectFiles.titlePanes;},loadSources:function(){while(this.sourcesNode.firstChild){this.sourcesNode.removeChild(this.sourcesNode.firstChild);}this.sourceFiles=new plugins.folders.SourceFiles({open:false,title:"Sources",type:"Source",attachNode:this.sourcesNode,project:this.project,fileMenu:this.fileMenu,folderMenu:this.folderMenu,workflowMenu:this.workflowMenu,core:this.core});return this.sourceFiles.titlePanes;},loadSharedProjects:function(){this.sharedProjectFiles=new plugins.folders.SharedProjectFiles({open:false,title:"Shared Projects",type:"Shared Project",attachNode:this.sharedProjectsNode,fileMenu:this.fileMenu,folderMenu:this.folderMenu,workflowMenu:this.workflowMenu,core:this.core});return this.sharedProjectFiles.titlePanes;},loadSharedSources:function(){this.sharedSourceFiles=new plugins.folders.SharedSourceFiles({open:false,title:"SharedSources",type:"Shared Source",attachNode:this.sharedSourcesNode,project:this.project,fileMenu:this.fileMenu,folderMenu:this.folderMenu,workflowMenu:this.workflowMenu,core:this.core});return this.sharedSourceFiles.titlePanes;},roundRobin:function(){console.group("FileManager-"+this.id+"    roundRobin");console.log("FileManager.roundRobin    caller: "+this.roundRobin.caller.nom);console.log("FileManager.roundRobin    this.titlePanes.length: "+this.titlePanes.length);if(!this.titlePanes||this.titlePanes.length<1){return;}var _e20=this.titlePanes.splice(0,1);var _e21=_e20[0];console.log("FileManager.roundRobin    titlePane.name:"+_e21.name);console.dir({titlePane:_e21});var _e22={stopPropagation:function(){console.log("FileManager.roundRobin    fakeEvent.stopPropagation()");}};_e21.reload(_e22);},remove:function(_e23,_e24){console.log("FileManager.remove     nodeName: "+_e23);console.log("FileManager.remove     widget: "+_e24);while(this[_e23].firstChild){this[_e23].removeChild(this[_e23].firstChild);}if(_e24){_e24.destroy();}},hide:function(){console.log("FileManager.hide    Doing this.atomic.dialog.minimize()");this.atomic.dialog.minimize();},show:function(_e25){console.log("FileManager.show    parameterWidget:");console.dir({parameterWidget:_e25});this.parameterWidget=_e25;this.fileMenu.parameterWidget=_e25;this.folderMenu.parameterWidget=_e25;this.workflowMenu.parameterWidget=_e25;this.atomic.dialog.show();var _e26=this.parameterWidget.project;var _e27=this.parameterWidget.workflow;console.log("FileManager.show    project: "+_e26);console.log("FileManager.show    workflow: "+_e27);this.openProjectLocation(_e26,_e27);},openProjectLocation:function(_e28,_e29){var _e2a=_e28;if(_e29){_e2a+="/"+_e29;}var _e2b=Agua.cookie("username");var _e2c=this.projectFiles;console.log("projectFiles: ");console.dir({projectFiles:_e2c});_e2c.openLocation(_e2a,_e2b);},openProject:function(_e2d,_e2e){console.log("FileManager.show\tproject: "+_e2d);console.log("FileManager.show\tworkflow: "+_e2e);var _e2f=this.atomic.nodes.projects;for(var i=0;i<_e2f.length;i++){var _e30=this.projectTitlePanes[i];if(_e30.title==_e2d){console.log("FileManager.show\ttitlePane fo project '"+_e2d+"': "+_e30);_e30.open=false;_e30.toggle();console.log("FileManager.show    AFTER titlePane.toggle()");console.log("FileManager.show    titlePane.fileSelector: "+_e30.fileSelector);if(_e2e!=null&&_e2e){_e30.fileSelector.selectChild(_e2e);}console.log("FileManager.show    AFTER titlePane.fileSelector.selectChild("+_e2e+")");}}},openWorkflow:function(_e31,_e32){},enableMenus:function(){console.log("FileManager.enableMenus     plugins.files.FileManager.enableMenus()");this.fileMenu.enable();this.folderMenu.enable();this.workflowMenu.enable();},enableMenuSelect:function(){console.log("FileManager.enableMenuSelect     plugins.files.FileManager.enableMenuSelect()");this.fileMenu.enableMenuItem("select");this.folderMenu.enableMenuItem("select");this.workflowMenu.enableMenuItem("select");},enableMenuAdd:function(){console.log("FileManager.enableMenuAdd     plugins.files.FileManager.enableMenuAdd()");this.fileMenu.enableMenuItem("add");this.folderMenu.enableMenuItem("add");this.workflowMenu.enableMenuItem("add");},disableMenus:function(){console.log("FileManager.disableMenus     plugins.files.FileManager.disableMenus()");this.fileMenu.disable();this.folderMenu.disable();this.workflowMenu.disable();},disableMenuSelect:function(){this.fileMenu.disableMenuItem("select");this.folderMenu.disableMenuItem("select");this.workflowMenu.disableMenuItem("select");},disableMenuAdd:function(){this.fileMenu.disableMenuItem("add");this.folderMenu.disableMenuItem("add");this.workflowMenu.disableMenuItem("add");},concatArrays:function(_e33,_e34){for(var i=0;i<_e34.length;i++){_e33.push(_e34[i]);}return _e33;}});}if(!dojo._hasResource["plugins.files.Controller"]){dojo._hasResource["plugins.files.Controller"]=true;dojo.provide("plugins.files.Controller");dojo.declare("plugins.files.Controller",[plugins.core.Common],{name:"plugins.files.Controller",version:"0.01",url:"",description:"Load the floating pane File Manager",dependencies:[{name:"plugins.core.Agua",version:0.01}],templateString:"<div dojoAttachPoint=\"containerNode\" class=\"workflow\">\n    <button\n        dojoType=\"dijit.form.Button\"\n        dojoAttachPoint=\"menuButton\"\n        class=\"menuButton\"\n        iconClass=\"workflowIcon\"\n        type=\"button\"\n        label=\"Workflow\"\n        ></button>\n</div>\n",widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins")+"workflow/css/controller.css",dojo.moduleUrl("plugins")+"workflow/css/workflow.css"],tabPanes:[],constructor:function(args){this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);},createFileManager:function(){},postLoad:function(){console.log("plugins.files.Controller.postLoad    DOING new plugins.files.FileManager");Agua.fileManager=new plugins.files.FileManager({paneId:"fileManager"+this.paneId,tabsNodeId:"tabs"});}});dojo.addOnLoad(function(){});}if(!dojo._hasResource["plugins.folders.Folders"]){dojo._hasResource["plugins.folders.Folders"]=true;dojo.provide("plugins.folders.Folders");if(1){}dojo.declare("plugins.folders.Folders",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n\t<!-- PROJECT TAB -->\n\t<div\n\t\tdojoAttachPoint=\"mainTab\"\n\t\tclass=\"folders\"\n\t\ticonClass=\"foldersIcon\"\n\t\tminWidth=\"1000\"\n\t\tstyle=\"position: relative; min-width: 1140px !important; width: 100% !important; min-height: 770px !important; height: 100% !important; padding: 0px; background: #FFF; overflow-y: scroll\"\n\t\tclosable=\"true\"\n\t\tscrollbar=\"true\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Folders\" >\n\t\t\n\t\t<div\n\t\t\tdojoAttachPoint=\"projectsNode\"\n\t\t\t>\n\t\t</div>\n\n\t\t<div\n\t\t\tdojoAttachPoint=\"sourcesNode\"\n\t\t\t>\n\t\t</div>\n\n\t\t<div\n\t\t\tdojoAttachPoint=\"sharedProjectsNode\"\n\t\t\t>\n\t\t</div>\n\n\t\t<div\n\t\t\tdojoAttachPoint=\"sharedSourcesNode\"\n\t\t\t>\n\t\t</div>\n\n\t</div>\n\t<!-- END OF PROJECT TAB -->\n\n<!--</div>-->\n",widgetsInTemplate:true,parentWidget:null,core:null,project:null,polling:false,textBreakWidth:22,cssFiles:[dojo.moduleUrl("plugins")+"folders/css/folders.css"],projectFiles:null,sourceFiles:null,sharedProjectFiles:null,sharedSourceFiles:null,callback:null,url:null,constructor:function(args){console.log("Folders.constructor    args:");console.dir({args:args});if(!args){return;}this.callback=args.callback;this.project=args.project;this.attachWidget=Agua.tabs;this.core=new Object;this.core.folders=this;if(Agua.cgiUrl){this.url=Agua.cgiUrl+"/folders.cgi";}this.loadCSS();},postCreate:function(){this.startup();},startup:function(){if(!this.attachWidget){return;}this.inherited(arguments);if(this.attachWidget.addChild){this.attachWidget.addChild(this.mainTab);this.attachWidget.selectChild(this.mainTab);}if(this.attachWidget.appendChild){this.attachWidget.appendChild(this.mainTab.domNode);}this.setMenus();Agua.updater.subscribe(this,"updateProjects");Agua.updater.subscribe(this,"updateWorkflows");Agua.updater.subscribe(this,"updateSources");this.loadPanes();},updateProjects:function(args){if(args!=null&&args.originator==this){if(args.reload==false){return;}}this.loadProjects;},updateWorkflows:function(args){if(args!=null&&args.originator==this){if(args.reload==false){return;}}this.loadWorkflows;},updateSources:function(args){if(args!=null&&args.originator==this){if(args.reload==false){return;}}this.loadSources;},setMenus:function(){this.fileMenu=new plugins.files.FileMenu({parentWidget:this});this.folderMenu=new plugins.files.FolderMenu({parentWidget:this});this.workflowMenu=new plugins.files.WorkflowMenu({parentWidget:this});dojo.connect(this.folderMenu.menu.domNode,"oncontextmenu",function(_e35){_e35.stopPropagation();});dojo.connect(this.workflowMenu.menu,"oncontextmenu",function(_e36){_e36.stopPropagation();});},loadPanes:function(){this.titlePanes=[];this.titlePanes=this.concatArrays(this.titlePanes,this.loadProjects());this.titlePanes=this.concatArrays(this.titlePanes,this.loadSources());this.titlePanes=this.concatArrays(this.titlePanes,this.loadSharedProjects());this.titlePanes=this.concatArrays(this.titlePanes,this.loadSharedSources());this.roundRobin();},concatArrays:function(_e37,_e38){for(var i=0;i<_e38.length;i++){_e37.push(_e38[i]);}return _e37;},roundRobin:function(){if(!this.titlePanes||this.titlePanes.length<1){console.log("Folders.roundRobin    Doing this.callback if defined: "+this.callback);if(this.callback){this.callback();}return;}var _e39=this.titlePanes.splice(0,1);var _e3a=_e39[0];var _e3b={stopPropagation:function(){}};_e3a.reload(_e3b);},loadProjects:function(){this.remove("projectsNode",this.projectFiles);this.projectFiles=new plugins.folders.ProjectFiles({open:true,title:"Projects",type:"Project",attachNode:this.projectsNode,fileMenu:this.fileMenu,folderMenu:this.folderMenu,workflowMenu:this.workflowMenu,core:this.core,url:this.url});return this.projectFiles.titlePanes;},loadSources:function(){while(this.sourcesNode.firstChild){this.sourcesNode.removeChild(this.sourcesNode.firstChild);}this.sourceFiles=new plugins.folders.SourceFiles({open:true,title:"Sources",type:"Source",attachNode:this.sourcesNode,project:this.project,fileMenu:this.fileMenu,folderMenu:this.folderMenu,workflowMenu:this.workflowMenu,core:this.core,url:this.url});return this.sourceFiles.titlePanes;},loadSharedProjects:function(){this.sharedProjectFiles=new plugins.folders.SharedProjectFiles({open:false,title:"Shared Projects",type:"Shared Project",attachNode:this.sharedProjectsNode,fileMenu:this.fileMenu,folderMenu:this.folderMenu,workflowMenu:this.workflowMenu,core:this.core,url:this.url});return this.sharedProjectFiles.titlePanes;},loadSharedSources:function(){this.sharedSourceFiles=new plugins.folders.SharedSourceFiles({open:false,title:"SharedSources",type:"Shared Source",attachNode:this.sharedSourcesNode,project:this.project,fileMenu:this.fileMenu,folderMenu:this.folderMenu,workflowMenu:this.workflowMenu,core:this.core,url:this.url});return this.sharedSourceFiles.titlePanes;},remove:function(_e3c,_e3d){while(this[_e3c].firstChild){this[_e3c].removeChild(this[_e3c].firstChild);}if(_e3d!=null){_e3d.destroy();}},destroyRecursive:function(){console.log("Folders.destroyRecursive    this.mainTab: ");console.dir({this_mainTab:this.mainTab});if(Agua&&Agua.tabs){Agua.tabs.removeChild(this.mainTab);}this.inherited(arguments);}});}if(!dojo._hasResource["plugins.folders.Controller"]){dojo._hasResource["plugins.folders.Controller"]=true;dojo.provide("plugins.folders.Controller");dojo.declare("plugins.folders.Controller",[plugins.core.PluginController],{paneId:null,templateString:"<div dojoAttachPoint=\"containerNode\" class=\"folders\">\n    <button\n        dojoType=\"dijit.form.Button\"\n        dojoAttachPoint=\"menuButton\"\n        class=\"foldersButton\"\n        iconClass=\"foldersIcon\"\n        type=\"button\"\n        label=\"Folders\"\n        ></button>\n</div>\n        \n",cssFiles:[dojo.moduleUrl("plugins")+"/folders/css/controller.css"],tabClass:"plugins.folders.Folders",});dojo.addOnLoad(function(){});}if(!dojo._hasResource["dojox.io.windowName"]){dojo._hasResource["dojox.io.windowName"]=true;dojo.provide("dojox.io.windowName");dojox.io.windowName={send:function(_e3e,args){args.url+=(args.url.match(/\?/)?"&":"?")+"windowname="+(args.authElement?"auth":true);var _e3f=args.authElement;var _e40=function(_e41){try{var _e42=dfd.ioArgs.frame.contentWindow.document;_e42.write(" ");_e42.close();}catch(e){}(_e3f||dojo.body()).removeChild(dfd.ioArgs.outerFrame);return _e41;};var dfd=dojo._ioSetArgs(args,_e40,_e40,_e40);if(args.timeout){setTimeout(function(){if(dfd.fired==-1){dfd.callback(new Error("Timeout"));}},args.timeout);}var self=dojox.io.windowName;if(dojo.body()){self._send(dfd,_e3e,_e3f,args.onAuthLoad);}else{dojo.addOnLoad(function(){self._send(dfd,_e3e,_e3f,args.onAuthLoad);});}return dfd;},_send:function(dfd,_e43,_e44,_e45){var _e46=dfd.ioArgs;var _e47=dojox.io.windowName._frameNum++;var _e48=(dojo.config.dojoBlankHtmlUrl||dojo.config.dojoCallbackUrl||dojo.moduleUrl("dojo","resources/blank.html"))+"#"+_e47;var _e49=new dojo._Url(window.location,_e48);var doc=dojo.doc;var _e4a=_e44||dojo.body();function _e4b(_e4c){_e4c.style.width="100%";_e4c.style.height="100%";_e4c.style.border="0px";};if(dojo.isMoz&&![].reduce){var _e4d=doc.createElement("iframe");_e4b(_e4d);if(!_e44){_e4d.style.display="none";}_e4a.appendChild(_e4d);var _e4e=_e4d.contentWindow;doc=_e4e.document;doc.write("<html><body margin='0px'><iframe style='width:100%;height:100%;border:0px' name='protectedFrame'></iframe></body></html>");doc.close();var _e4f=_e4e[0];_e4e.__defineGetter__(0,function(){});_e4e.__defineGetter__("protectedFrame",function(){});doc=_e4f.document;doc.write("<html><body margin='0px'></body></html>");doc.close();_e4a=doc.body;}var _e50;if(dojo.isIE){var div=doc.createElement("div");div.innerHTML="<iframe name=\""+_e49+"\" onload=\"dojox.io.windowName["+_e47+"]()\">";_e50=div.firstChild;}else{_e50=doc.createElement("iframe");}_e46.frame=_e50;_e4b(_e50);_e46.outerFrame=_e4d=_e4d||_e50;if(!_e44){_e4d.style.display="none";}var _e51=0;function _e52(){var data=_e50.contentWindow.name;if(typeof data=="string"){if(data!=_e49){_e51=2;dfd.ioArgs.hash=_e50.contentWindow.location.hash;dfd.callback(data);}}};dojox.io.windowName[_e47]=_e50.onload=function(){try{if(!dojo.isMoz&&_e50.contentWindow.location=="about:blank"){return;}}catch(e){}if(!_e51){_e51=1;if(_e44){if(_e45){_e45();}}else{_e50.contentWindow.location=_e48;}}try{if(_e51<2){_e52();}}catch(e){}};_e50.name=_e49;if(_e43.match(/GET/i)){dojo._ioAddQueryToUrl(_e46);_e50.src=_e46.url;_e4a.appendChild(_e50);if(_e50.contentWindow){_e50.contentWindow.location.replace(_e46.url);}}else{if(_e43.match(/POST/i)){_e4a.appendChild(_e50);var form=dojo.doc.createElement("form");dojo.body().appendChild(form);var _e53=dojo.queryToObject(_e46.query);for(var i in _e53){var _e54=_e53[i];_e54=_e54 instanceof Array?_e54:[_e54];for(var j=0;j<_e54.length;j++){var _e55=doc.createElement("input");_e55.type="hidden";_e55.name=i;_e55.value=_e54[j];form.appendChild(_e55);}}form.method="POST";form.action=_e46.url;form.target=_e49;form.submit();form.parentNode.removeChild(form);}else{throw new Error("Method "+_e43+" not supported with the windowName transport");}}if(_e50.contentWindow){_e50.contentWindow.name=_e49;}},_frameNum:0};}if(!dojo._hasResource["dojox.fx.easing"]){dojo._hasResource["dojox.fx.easing"]=true;dojo.provide("dojox.fx.easing");dojo.deprecated("dojox.fx.easing","Upgraded to Core, use dojo.fx.easing instead","2.0");dojox.fx.easing=dojo.fx.easing;}if(!dojo._hasResource["plugins.home.Home"]){dojo._hasResource["plugins.home.Home"]=true;dojo.provide("plugins.home.Home");if(1){}dojo.declare("plugins.home.Home",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n\t<div\n\t\tdojoAttachPoint=\"mainTab\"\n\t\tclass=\"home\"\n\t\ticonClass=\"homeIcon\"\n\t\tstyle=\"min-width: 1000px !important; width: 100% !important; height:inherit !important; padding: 0px; background: #FFF;\"\n\t\ttitle=\"Home\"\n\t\tclosable=\"true\"\n\t\tdojoType=\"dijit.layout.BorderContainer\"\n\t\t>\n\n\t\t<div\n\t\t\tclass=\"homeContainer\"\n\t\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\t\tregion=\"top\">\n\t\t\t\n\t\t\t<table width=\"100%\">\n\t\t\t\t<tr>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<table class=\"navigationTable\">\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\tUse\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td class=\"leftArrow\">\n\t\t\t\t\t\t\t\t\tALT +\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\tand\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td class=\"rightArrow\">\n\t\t\t\t\t\t\t\t\tALT +\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td class=\"navigationInfo\">\n\t\t\t\t\t\t\t\t\tto Navigate\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\n\t\t\t\t\t\n\t\t\t\t\t<td align=\"right\">\n\t\t\t\t\t\t<table class=\"packageTable\">\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td class=packageTitle>Package</td>\n\t\t\t\t\t\t\t\t<td class=packageTitle title=\"Current installed version\">Version</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"packageCombo\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachEvent='onChange:showCurrentVersion'\n\t\t\t\t\t\t\t\t\t\tclass=\"packageCombo\"\n\t\t\t\t\t\t\t\t\t\tautocomplete=\"false\"\n\t\t\t\t\t\t\t\t\t\tdisabled=\"false\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclass=\"currentVersion\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"currentVersion\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"checkVersion\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"checkVersion\"\n\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:showUpgrades\"\n\t\t\t\t\t\t>Check For Upgrades</button>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td width=\"400\">\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\n\t\t\t<div\n\t\t\t\tid=\"authTarget\"\n\t\t\t\tdojoAttachPoint=\"bottomPane\"\n\t\t\t\tclass=\"bottomPane\"\n\t\t\t\talt=\"Agua Home Page\"\n\t\t\t>\n\t\t\t</div>\n\t\t\n\t\t</div>\n\t\t\n\t\t<div\n\t\t\tclass=\"progressPane\"\n\t\t\tdojoAttachPoint=\"progressPane\"\n\t\t\tdojoType=\"plugins.dojox.layout.FloatingPane\"\n\t\t\tregion=\"top\"\n\t\t\tresizable=\"false\"\n\t\t\tmoveable=\"false\"\n\t\t\tdockable=\"true\"\n\t\t\tmaxable=\"false\"\n\t\t\tclosable=\"false\"\n\t\t\tduration=\"1500\"\n\t\t\theight=\"500px\"\n\t\t\twidth=\"900px\"\n\t\t\ttitle=\"Upgrade Log\"\n\t\t\tdockClass=\"homeDockNode\"\n\t\t\t> \n\t\t</div>\n\t</div>\n\t\t\t\n</div>\n",cssFiles:[dojo.moduleUrl("plugins","home/css/home.css"),dojo.moduleUrl("dojox","layout/resources/ResizeHandle.css"),dojo.moduleUrl("dojox","layout/resources/FloatingPane.css"),dojo.moduleUrl("dojox","widget/Dialog/Dialog.css")],widgetsInTemplate:true,paneWidgets:null,url:"http://www.aguadev.org/confluence/display/home/Home",progressPane:null,timerInterval:30000,constructor:function(args){this.loadCSS();},postCreate:function(){console.log("Home.postCreate    plugins.home.Home.postCreate()");this.startup();},startup:function(){console.log("Home.startup    plugins.home.Home.startup()");this.inherited(arguments);Agua.tabs.addChild(this.mainTab);Agua.tabs.selectChild(this.mainTab);this.loadPane();this.disableUpgrade();this.setPackageCombo();this.setSelectiveDialog();this.setSimpleDialog();this.setTimer();this.setProgressPane();Agua.updater.subscribe(this,"updatePackages");dojo.connect(window,"onresize",dojo.hitch(this,"resizeProgress"));},updatePackages:function(args){console.log("Home.updatePackages    Home.updatePackages(args)");console.dir({args:args});if(args&&!args.reload){return;}if(args.originator&&args.originator==this){return;}console.log("Home.updatePackages    Calling setPackageCombo()");this.setPackageCombo();},disableUpgrade:function(){var _e56=Agua.getPackages();console.log("plugins.home.Home.disableUpgrade    packages: ");console.dir({packages:_e56});if(_e56==null||_e56.length==0){console.log("plugins.home.Home.disableUpgrade    version is empty. Returning");dojo.removeClass(this.checkVersion,"checkVersion");dojo.addClass(this.checkVersion,"hidden");dojo.addClass(this.packageCombo,"hidden");}},loadPane:function(){var url=this.url;console.log("Home.loadPane    url: "+url);var auth=true;var _e57=this.bottomPane;if(this.bottomPane.id==null){this.bottomPane.id=this.id+"_windowName";}this.windowDeferred=dojox.io.windowName.send("GET",{url:url,handleAs:"text",authElement:_e57,onAuthLoad:auth&&function(){_e57.style.display="block";console.log("Changed authTarget style.display to 'block'");}});this.windowDeferred.addBoth(function(_e58){console.dir({result:_e58});auth&&(_e57.style.display="none");alert(_e58);});},setPackageCombo:function(_e59){console.log("Home.setPackageCombo    packageName: "+_e59);var _e5a=Agua.getPackages();console.log("Home.setPackageCombo    BEFORE FILTER packages: ");console.dir({packages:_e5a});var _e5b=Agua.cookie("username");_e5a=this.filterByKeyValues(_e5a,["username"],[_e5b]);console.log("Home.setPackageCombo    AFTER FILTER packages by username: "+_e5b);console.dir({packages:_e5a});var _e5c=this.hashArrayKeyToArray(_e5a,"package");console.log("Home.setPackageCombo    packageNames: "+dojo.toJson(_e5c));if(!_e5c){console.log("Home.setPackageCombo    packageNames not defined. Returning.");return;}_e5c=_e5c.sort();var data={identifier:"name",items:[]};for(var i in _e5c){data.items[i]={name:_e5c[i]};}var _e5d=new dojo.data.ItemFileReadStore({data:data});this.packageCombo.store=_e5d;if(!_e59){_e59=_e5c[_e5c.length-1];}console.log("Home.setPackageCombo    SETTING value packageName: "+_e59);this.packageCombo.set("value",_e59);},setSelectiveDialog:function(){var _e5e=function(){};var _e5f=function(){};console.log("Stages.setSelectiveDialog    plugins.files.Stages.setSelectiveDialog()");this.selectiveDialog=new plugins.dijit.SelectiveDialog({title:"",message:"",enterLabel:"Upgrade",cancelLabel:"Cancel",parentWidget:this,enterCallback:_e5e,cancelCallback:_e5f});dojo.addClass(this.selectiveDialog.dialog.domNode,"home");dojo.addClass(this.selectiveDialog.dialog.domNode,"progressPane");dojo.addClass(this.selectiveDialog.dialog.domNode,"home progressPane dojoxDialog dijitDialog");},setSimpleDialog:function(){this.simpleDialog=new dijit.Dialog({});dojo.addClass(this.simpleDialog.domNode,"simpleDialog dijitDialog");dojo.addClass(this.simpleDialog.containerNode,"simpleDialog dijitDialogPaneContent");},setTimer:function(){console.log("Home.setTimer    this.timerInterval: "+this.timerInterval);this.timer=new dojox.timing.Timer;console.log("Home.setTimer    Created this.timer: "+this.timer);this.timer.setInterval(this.timerInterval);},setProgressPane:function(){console.log("plugins.home.Home.setProgressPane");console.dir({progressPane:this.progressPane});dojo.attr(this.progressPane.domNode,"class","home progressPane dojoxDialog dijitDialog");var _e60=this;this.progressPane.close=dojo.hitch(this,function(){console.log("plugins.home.Home.setProgressPane    this.progressPane.close");this.progressPane.minimize();this.timer.stop();dojo.attr(this.timer,"isRunning",false);});this.progressPane.onDownloadError=dojo.hitch(this,function(){console.log("Home.setProgressPane    this.progressPane.onLoadError");});dojo.connect(this.progressPane,"_onShow",this,"_onShow");},showCurrentVersion:function(){console.log("Home.showCurrentVersion    plugins.home.Home.showCurrentVersion()");var _e61=this.packageCombo.get("value");console.log("Home.showCurrentVersion    packageName: "+_e61);var _e62=this.getPackageObject(_e61);console.log("Home.showCurrentVersion    AFTER packageObject: "+dojo.toJson(_e62));this.currentVersion.innerHTML=_e62.version;},showUpgrades:function(){console.log("Home.showUpgrades    plugins.home.Home.showUpgrades()");var _e63=this.packageCombo.get("value");console.log("Home.showUpgrades    packageName: "+_e63);var _e64=this.getPackageObject(_e63);console.log("Home.showUpgrades    AFTER packageObject: "+dojo.toJson(_e64));if(!_e64.current){console.log("Home.showUpgrades    packageObject.current not defined. Returning");return;}if(_e64.current.length==0){this.showLatestInstalled(_e63,_e64.version);}else{this.loadSelectiveDialog(_e64);}},loadSelectiveDialog:function(_e65){console.log("Home.loadSelectiveDialog    plugins.files.Home.loadSelectiveDialog(packageObject)");console.log("Home.loadSelectiveDialog    packageObject: "+dojo.toJson(_e65));var _e66=this;var _e67=function(){console.log("Home.loadSelectiveDialog    cancelCallback()");};var _e68=dojo.hitch(this,function(_e69,_e6a,_e6b,_e6c){console.log("Home.loadSelectiveDialog    Doing enterCallback(input, selected, checked, dialogWidget)");console.log("Home.loadSelectiveDialog    input: "+_e69);console.log("Home.loadSelectiveDialog    selected: "+_e6a);console.log("Home.loadSelectiveDialog    checked: "+_e6b);console.log("Home.loadSelectiveDialog    dialogWidget: "+_e6c);setTimeout(function(){_e6c.close();},100);_e66.runUpgrade(_e6a,_e65);});this.selectiveDialog.load({title:"Current "+_e65["package"]+" version: "+_e65.version,message:"Select upgrade version",comboValues:_e65.current,comboMessage:"Agua version",parentWidget:this,enterCallback:_e68,cancelCallback:_e67,enterLabel:"Upgrade",cancelLabel:"Cancel"});},runUpgrade:function(_e6d,_e6e){console.log("Home.runUpgrade    selectedVersion: "+_e6d);console.log("Home.runUpgrade    packageObject: "+dojo.toJson(_e6e));console.log("plugins.home.Home.runUpgrade    Doing this.getStandby()");var _e6f=this.getStandby();console.log("plugins.home.Home.runUpgrade    standby: "+_e6f);_e6f.show();var _e70=this;setTimeout(function(){_e70.upgrade(_e6d,_e6e);},500);},upgrade:function(_e71,_e72){_e72.random=Math.floor(Math.random()*1000000000000);console.log("Home.upgrade    packageObject: "+dojo.toJson(_e72));var url=Agua.cgiUrl+"workflow.cgi";var _e73=new Object;_e73.username=Agua.cookie("username");_e73.sessionid=Agua.cookie("sessionid");_e73["package"]=_e72["package"];_e73.repository=_e72["package"];_e73.version=_e71;_e73.privacy=_e72.privacy;_e73.owner=_e72.owner;_e73.installdir=_e72.installdir;_e73.mode="upgrade";_e73.random=_e72.random;console.log("packageObject"+dojo.toJson(_e72));var _e74=this;var _e75=dojo.xhrPut({url:url,contentType:"text",sync:false,handleAs:"json",putData:dojo.toJson(_e73),load:function(_e76,_e77){if(_e76.error!=null){Agua.error("Home.runUpgrade    Error: "+_e76.error);_e74.progressPane.hide();_e74.progressPane.set("innerHTML","");_e74.stopProgress();}else{console.log("Home.runUpgrade    OK");var _e78=this.setLogFile(_e72);var _e79=_e72["package"];console.log("Home.upgrade    logfile: "+_e78);console.log("Home.upgrade    packageName: "+_e79);console.log("Home.upgrade    thisObject: "+_e74);console.log("Home.upgrade    thisObject.progressPane: "+_e74.progressPane);var _e7a=_e74(_e72,version);console.log("Home.upgrade    title: "+_e7a);_e74.progressPane.set("title",_e7a);_e74.progressPane.set("href",_e78);_e74.progressPane.show();_e74.updatePackage(_e72);}},error:function(_e7b,_e7c){console.log("plugins.home.Home.runUpgrade    Error with JSON Post, response: "+dojo.toJson(_e7b));}});this.showProgress(_e72,_e71);this.standby.hide();},updatePackage:function(_e7d){Agua.removePackage(_e7d);Agua.addPackage(_e7d);this.showCurrentVersion();if(!this.timer){return;}this.timer.stop();dojo.attr(this.timer,"isRunning",false);},onClose:function(){console.log("Home.onClose    Home.onClose()");console.log("Home.onClose    ");},showProgress:function(_e7e,_e7f){console.log("Home.showProgress    packageObject: ");console.dir({packageObject:_e7e});console.log("Home.showProgress    version: "+_e7f);var _e80=this.setLogFile(_e7e);console.log("Home.showProgress    logfile: "+_e80);var _e81=this.setTitle(_e7e,_e7f);console.log("Home.showProgress    title: "+_e81);this.progressPane.set("title",_e81);this.progressPane.set("href",_e80);this.progressPane.show();this.resizeProgress();this.pollProgress(_e80,_e7f,_e7e);dojo.connect(this.progressPane,"close",dojo.hitch(this,"stopProgress"));dojo.connect(this.progressPane,"minimize",dojo.hitch(this,"stopProgress"));dojo.connect(this.progressPane,"resize",dojo.hitch(this,"startProgress"));},setLogFile:function(_e82){return "log/"+_e82["package"]+"-upgradelog."+_e82.random+".html";},setTitle:function(_e83,_e84){var _e85=_e83["package"];var _e86=_e85+" "+_e84+" upgrade log";return _e86;},stopProgress:function(){console.log("Home.stopProgress    Home.stopProgress()");console.dir({timer:this.timer});if(this.timer==null){return;}if(dojo.attr(this.timer,"isRunning")==false){return;}console.log("Home.stopProgress    Doing this.timer.stop()");dojo.attr(this.timer,"isRunning",false);this.timer.stop();this.timer.interval=999999999999;this.timer.onTick=function(){console.log("Home.stopProgress    timer.onTick()");};console.log("Home.stopProgress    Doing window.clearInterval(this.timer.timer)");window.clearInterval(this.timer.timer);},startProgress:function(){this.timer.interval=this.timerInterval;console.log("Home.startProgress    timer:");console.dir({timer:this.timer});if(dojo.attr(this.timer,"isRunning")==true){return;}console.log("Home.startProgress    Doing this.timer.start()");dojo.attr(this.timer,"isRunning",true);this.timer.start();this.resizeProgress();},resizeProgress:function(){if(!this.progressPane){return;}var node=this.progressPane.domNode;var _e87=dojo.window.getBox();var _e88=dojo._getBorderBox(node);l=Math.floor(_e87.l+(_e87.w-_e88.w)/2);t=Math.floor(_e87.t+(_e87.h-_e88.h)/2);var _e89={left:l+"px",top:t+"px"};dojo.style(node,_e89);},pollProgress:function(url,_e8a,_e8b){console.log("Home.pollProgress    Home.pollProgress(url, version)");console.log("Home.pollProgress    url: "+url);console.log("Home.pollProgress    version: "+_e8a);this.packageObject=_e8b;var _e8c=this;this.timer.onTick=function(){console.log("Home.pollProgress    timer onTick: "+new Date().toTimeString());_e8c.progressPane.set("href","");_e8c.progressPane.set("href",url);_e8c.progressPane.show();};this.timer.start();dojo.attr(this.timer,"isRunning",true);},reportedVersion:function(){console.log("Home.reportedVersion    plugins.home.Home.reportedVersion");var _e8d=this.progressPane.containerNode.innerHTML;var _e8e;var _e8f=_e8d.match(/Completed installation, version:\s*(\S+)/);if(_e8f){_e8e=_e8f[1];}console.log("Home.reportedVersion    version: "+_e8e);return _e8e;},_onShow:function(){console.log("Home.setProgressPane    this.progressPane._onShow");var _e90=this;setTimeout(function(){var _e91=_e90.progressPane.containerNode.innerHTML;console.dir({report:_e91});var _e92=_e90.reportedVersion();if(_e92){console.log("Home._onShow    reportedVersion is defined: "+_e92+". Stopping timer");_e90.stopProgress();_e90.packageObject.version=_e92;_e90.setVersion(_e90.packageObject);Agua.updater.update("updatePackages",{originator:_e90});}},2000);},setVersion:function(_e93){console.log("Home.setVersion    packagObject: "+dojo.toJson(_e93,true));Agua.removePackage(_e93);Agua.addPackage(_e93);this.setPackageCombo(_e93["package"]);this.showCurrentVersion();},getStandby:function(){console.log("Stages.getStandby    Stages.getStandby()");if(this.standby==null){var id=dijit.getUniqueId("dojox_widget_Standby");this.standby=new dojox.widget.Standby({target:this.bottomPane,onClick:"reload",text:"Running upgrade",id:id,url:"plugins/core/images/agua-biwave-24.png"});document.body.appendChild(this.standby.domNode);}console.log("Stages.getStandby    this.standby: "+this.standby);return this.standby;},newWindow:function(){console.log("plugins.home.Home.newWindow    Home.newWindow()");var url=window.location;window.open(location,"_blank","toolbar=1,location=0,directories=0,status=0,menubar=1,scrollbars=1,resizable=1,navigation=0");},parseVersion:function(_e94){var _e95={};if(!_e94.match(/^(\d+)\.(\d+)\.(\d+)(-)?(\S+)?$/)){return;}else{_e95.major=parseInt(_e94.match(/^(\d+)\.(\d+)\.(\d+)(-\S+)?(\+\S+)?$/)[1]);_e95.minor=parseInt(_e94.match(/^(\d+)\.(\d+)\.(\d+)(-\S+)?(\+\S+)?$/)[2]);_e95.patch=parseInt(_e94.match(/^(\d+)\.(\d+)\.(\d+)(-\S+)?(\+\S+)?$/)[3]);_e95.release=_e94.match(/^(\d+)\.(\d+)\.(\d+)(-\S+)?(\+\S+)?$/)[4];_e95.build=_e94.match(/^(\d+)\.(\d+)\.(\d+)(-\S+)?(\+\S+)?$/)[5];if(_e95.release){_e95.release=_e95.release.replace(/^-/,"");}if(_e95.build){_e95.build=_e95.build.replace(/^\+/,"");}}return _e95;},returnValue:function(_e96){return _e96;},compareStringNumber:function(a,b){if(!a.match(/^(\D+)(\d+)$/)&&!b.match(/^(\D+)(\d+)$/)){var _e97=a.toLowerCase().localeCompare(b.toLowerCase());return _e97;}else{var _e98=this.splitStringNumber(a);var _e99=this.splitStringNumber(b);if(_e98.string!=_e99.string){var _e97=a.toLowerCase().localeCompare(b.toLowerCase());this.returnValue(_e97);}else{if(!_e98.number&&!_e99.number){this.returnValue(0);}else{if(_e98.number&&!_e99.number){this.returnValue(1);}else{if(_e99.number&&!_e98.number){this.returnValue(-1);}else{if(parseInt(_e98.number)>parseInt(_e99.number)){return 1;}else{if(parseInt(_e99.number)>parseInt(_e98.number)){return -1;}else{this.returnValue(0);}}}}}}}return null;},splitStringNumber:function(_e9a){var _e9b=new Object;_e9b.string=_e9a.match(/^(\D+)/)[1];if(_e9a.match(/^(\D+)(\d+)$/)){_e9b.number=_e9a.match(/^(\D+)(\d+)$/)[2];}return _e9b;},destroyRecursive:function(){console.log("Home.destroyRecursive    this.mainTab: ");console.dir({this_mainTab:this.mainTab});if(Agua&&Agua.tabs){Agua.tabs.removeChild(this.mainTab);}},showLatestInstalled:function(_e9c,_e9d){console.dir({simpleDialog:this.simpleDialog});this.simpleDialog.titleNode.innerHTML="Latest version of "+_e9c+" is installed (version "+_e9d+")";this.simpleDialog.show();},getPackageObject:function(_e9e){var _e9f=Agua.getPackages();console.dir({packages:_e9f});for(var i=0;i<_e9f.length;i++){if(_e9f[i]["package"]==_e9e){return _e9f[i];break;}}return;},laterVersions:function(_ea0){for(var i=0;i<_ea0.length;i++){var _ea1=_ea0[i].version;var _ea2=_ea0[i].current;for(var k=0;k<_ea2.length;k++){console.log("laterVersions    versionarray["+k+"]: "+_ea2[k]);if(_ea2[k]==_ea1){_ea2.splice(k,1);break;}else{_ea2.splice(k,1);k--;}}}return _ea0;},sortVersions:function(_ea3){console.log("Home.sortVersions    versions: "+dojo.toJson(_ea3));var _ea4=this;var _ea5=function(a,b){var _ea6=_ea4.parseVersion(a);var _ea7=_ea4.parseVersion(b);if(_ea6.major>_ea7.major){return _ea4.returnValue(1);}else{if(_ea7.major>_ea6.major){return _ea4.returnValue(-1);}}if(_ea6.minor>_ea7.minor){return _ea4.returnValue(1);}else{if(_ea7.minor>_ea6.minor){return _ea4.returnValue(-1);}}if(_ea6.patch>_ea7.patch){return _ea4.returnValue(1);}else{if(_ea7.patch>_ea6.patch){return _ea4.returnValue(-1);}}if(!_ea6.release&&!_ea7.release&&!_ea6.build&&!_ea7.build){return _ea4.returnValue(0);}if(_ea6.release&&!_ea7.release){return _ea4.returnValue(1);}if(_ea7.release&&!_ea6.release){return _ea4.returnValue(-1);}if(_ea6.release&&_ea7.release){return _ea4.compareStringNumber(_ea6.release,_ea7.release);}if(_ea6.build&&!_ea7.build){return _ea4.returnValue(1);}if(_ea7.build&&!_ea6.build){return _ea4.returnValue(-1);}if(_ea6.build&&_ea7.build){return _ea4.compareStringNumber(_ea6.build,_ea7.build);}return _ea4.returnValue(0);};_ea3=_ea3.sort(_ea5);return _ea3;}});}if(!dojo._hasResource["plugins.home.Controller"]){dojo._hasResource["plugins.home.Controller"]=true;dojo.provide("plugins.home.Controller");dojo.declare("plugins.home.Controller",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <button\n        dojoType=\"dijit.form.Button\"\n        dojoAttachPoint=\"menuButton\"\n        class=\"menuButton\"\n        iconClass=\"homeIcon\"\n        type=\"button\"\n        label=\"Home\"\n    >\n    </button>\n\n</div>\n        \n",widgetsInTemplate:true,cssFiles:["plugins/home/css/controller.css"],tabPanes:[],constructor:function(args){console.log("Controller.constructor     plugins.home.Controller.constructor");this.loadCSS();},postCreate:function(){console.log("Controller.postCreate    plugins.home.Controller.postCreate()");this.startup();},startup:function(){console.log("Controller.startup    plugins.home.Controller.startup()");this.inherited(arguments);Agua.toolbar.addChild(this.menuButton);this.menuButton.parentWidget=this;var _ea8=dojo.connect(this.menuButton,"onClick",this,"createTab");},createTab:function(args){console.log("Controller.createTab    plugins.home.Controller.createTab");if(args==null){args=new Object;}args.attachWidget=Agua.tabs;var _ea9=new plugins.home.Home(args);this.tabPanes.push(_ea9);this._supportingWidgets.push(_ea9);return _ea9;}});dojo.addOnLoad(function(){});}if(!dojo._hasResource["dijit.dijit"]){dojo._hasResource["dijit.dijit"]=true;dojo.provide("dijit.dijit");}if(!dojo._hasResource["dijit.form.HorizontalSlider"]){dojo._hasResource["dijit.form.HorizontalSlider"]=true;dojo.provide("dijit.form.HorizontalSlider");dojo.declare("dijit.form.HorizontalSlider",[dijit.form._FormValueWidget,dijit._Container],{templateString:dojo.cache("dijit.form","templates/HorizontalSlider.html","<table class=\"dijit dijitReset dijitSlider dijitSliderH\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" rules=\"none\" dojoAttachEvent=\"onkeypress:_onKeyPress,onkeyup:_onKeyUp\"\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t\t><td dojoAttachPoint=\"topDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationT dijitSliderDecorationH\"></td\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH\"\n\t\t\t><div class=\"dijitSliderDecrementIconH\" style=\"display:none\" dojoAttachPoint=\"decrementButton\"><span class=\"dijitSliderButtonInner\">-</span></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper\" dojoAttachEvent=\"onmousedown:_onClkDecBumper\"></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><input dojoAttachPoint=\"valueNode\" type=\"hidden\" ${!nameAttrSetting}\n\t\t\t/><div class=\"dijitReset dijitSliderBarContainerH\" role=\"presentation\" dojoAttachPoint=\"sliderBarContainer\"\n\t\t\t\t><div role=\"presentation\" dojoAttachPoint=\"progressBar\" class=\"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH\" dojoAttachEvent=\"onmousedown:_onBarClick\"\n\t\t\t\t\t><div class=\"dijitSliderMoveable dijitSliderMoveableH\"\n\t\t\t\t\t\t><div dojoAttachPoint=\"sliderHandle,focusNode\" class=\"dijitSliderImageHandle dijitSliderImageHandleH\" dojoAttachEvent=\"onmousedown:_onHandleClick\" role=\"slider\" valuemin=\"${minimum}\" valuemax=\"${maximum}\"></div\n\t\t\t\t\t></div\n\t\t\t\t></div\n\t\t\t\t><div role=\"presentation\" dojoAttachPoint=\"remainingBar\" class=\"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH\" dojoAttachEvent=\"onmousedown:_onBarClick\"></div\n\t\t\t></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper\" dojoAttachEvent=\"onmousedown:_onClkIncBumper\"></div\n\t\t></td\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH\"\n\t\t\t><div class=\"dijitSliderIncrementIconH\" style=\"display:none\" dojoAttachPoint=\"incrementButton\"><span class=\"dijitSliderButtonInner\">+</span></div\n\t\t></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t\t><td dojoAttachPoint=\"containerNode,bottomDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationB dijitSliderDecorationH\"></td\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t></tr\n></table>\n"),value:0,showButtons:true,minimum:0,maximum:100,discreteValues:Infinity,pageIncrement:2,clickSelect:true,slideDuration:dijit.defaultDuration,widgetsInTemplate:true,attributeMap:dojo.delegate(dijit.form._FormWidget.prototype.attributeMap,{id:""}),baseClass:"dijitSlider",cssStateNodes:{incrementButton:"dijitSliderIncrementButton",decrementButton:"dijitSliderDecrementButton",focusNode:"dijitSliderThumb"},_mousePixelCoord:"pageX",_pixelCount:"w",_startingPixelCoord:"x",_startingPixelCount:"l",_handleOffsetCoord:"left",_progressPixelSize:"width",_onKeyUp:function(e){if(this.disabled||this.readOnly||e.altKey||e.ctrlKey||e.metaKey){return;}this._setValueAttr(this.value,true);},_onKeyPress:function(e){if(this.disabled||this.readOnly||e.altKey||e.ctrlKey||e.metaKey){return;}switch(e.charOrCode){case dojo.keys.HOME:this._setValueAttr(this.minimum,false);break;case dojo.keys.END:this._setValueAttr(this.maximum,false);break;case ((this._descending||this.isLeftToRight())?dojo.keys.RIGHT_ARROW:dojo.keys.LEFT_ARROW):case (this._descending===false?dojo.keys.DOWN_ARROW:dojo.keys.UP_ARROW):case (this._descending===false?dojo.keys.PAGE_DOWN:dojo.keys.PAGE_UP):this.increment(e);break;case ((this._descending||this.isLeftToRight())?dojo.keys.LEFT_ARROW:dojo.keys.RIGHT_ARROW):case (this._descending===false?dojo.keys.UP_ARROW:dojo.keys.DOWN_ARROW):case (this._descending===false?dojo.keys.PAGE_UP:dojo.keys.PAGE_DOWN):this.decrement(e);break;default:return;}dojo.stopEvent(e);},_onHandleClick:function(e){if(this.disabled||this.readOnly){return;}if(!dojo.isIE){dijit.focus(this.sliderHandle);}dojo.stopEvent(e);},_isReversed:function(){return !this.isLeftToRight();},_onBarClick:function(e){if(this.disabled||this.readOnly||!this.clickSelect){return;}dijit.focus(this.sliderHandle);dojo.stopEvent(e);var _eaa=dojo.position(this.sliderBarContainer,true);var _eab=e[this._mousePixelCoord]-_eaa[this._startingPixelCoord];this._setPixelValue(this._isReversed()?(_eaa[this._pixelCount]-_eab):_eab,_eaa[this._pixelCount],true);this._movable.onMouseDown(e);},_setPixelValue:function(_eac,_ead,_eae){if(this.disabled||this.readOnly){return;}_eac=_eac<0?0:_ead<_eac?_ead:_eac;var _eaf=this.discreteValues;if(_eaf<=1||_eaf==Infinity){_eaf=_ead;}_eaf--;var _eb0=_ead/_eaf;var _eb1=Math.round(_eac/_eb0);this._setValueAttr((this.maximum-this.minimum)*_eb1/_eaf+this.minimum,_eae);},_setValueAttr:function(_eb2,_eb3){this._set("value",_eb2);this.valueNode.value=_eb2;dijit.setWaiState(this.focusNode,"valuenow",_eb2);this.inherited(arguments);var _eb4=(_eb2-this.minimum)/(this.maximum-this.minimum);var _eb5=(this._descending===false)?this.remainingBar:this.progressBar;var _eb6=(this._descending===false)?this.progressBar:this.remainingBar;if(this._inProgressAnim&&this._inProgressAnim.status!="stopped"){this._inProgressAnim.stop(true);}if(_eb3&&this.slideDuration>0&&_eb5.style[this._progressPixelSize]){var _eb7=this;var _eb8={};var _eb9=parseFloat(_eb5.style[this._progressPixelSize]);var _eba=this.slideDuration*(_eb4-_eb9/100);if(_eba==0){return;}if(_eba<0){_eba=0-_eba;}_eb8[this._progressPixelSize]={start:_eb9,end:_eb4*100,units:"%"};this._inProgressAnim=dojo.animateProperty({node:_eb5,duration:_eba,onAnimate:function(v){_eb6.style[_eb7._progressPixelSize]=(100-parseFloat(v[_eb7._progressPixelSize]))+"%";},onEnd:function(){delete _eb7._inProgressAnim;},properties:_eb8});this._inProgressAnim.play();}else{_eb5.style[this._progressPixelSize]=(_eb4*100)+"%";_eb6.style[this._progressPixelSize]=((1-_eb4)*100)+"%";}},_bumpValue:function(_ebb,_ebc){if(this.disabled||this.readOnly){return;}var s=dojo.getComputedStyle(this.sliderBarContainer);var c=dojo._getContentBox(this.sliderBarContainer,s);var _ebd=this.discreteValues;if(_ebd<=1||_ebd==Infinity){_ebd=c[this._pixelCount];}_ebd--;var _ebe=(this.value-this.minimum)*_ebd/(this.maximum-this.minimum)+_ebb;if(_ebe<0){_ebe=0;}if(_ebe>_ebd){_ebe=_ebd;}_ebe=_ebe*(this.maximum-this.minimum)/_ebd+this.minimum;this._setValueAttr(_ebe,_ebc);},_onClkBumper:function(val){if(this.disabled||this.readOnly||!this.clickSelect){return;}this._setValueAttr(val,true);},_onClkIncBumper:function(){this._onClkBumper(this._descending===false?this.minimum:this.maximum);},_onClkDecBumper:function(){this._onClkBumper(this._descending===false?this.maximum:this.minimum);},decrement:function(e){this._bumpValue(e.charOrCode==dojo.keys.PAGE_DOWN?-this.pageIncrement:-1);},increment:function(e){this._bumpValue(e.charOrCode==dojo.keys.PAGE_UP?this.pageIncrement:1);},_mouseWheeled:function(evt){dojo.stopEvent(evt);var _ebf=!dojo.isMozilla;var _ec0=evt[(_ebf?"wheelDelta":"detail")]*(_ebf?1:-1);this._bumpValue(_ec0<0?-1:1,true);},startup:function(){if(this._started){return;}dojo.forEach(this.getChildren(),function(_ec1){if(this[_ec1.container]!=this.containerNode){this[_ec1.container].appendChild(_ec1.domNode);}},this);this.inherited(arguments);},_typematicCallback:function(_ec2,_ec3,e){if(_ec2==-1){this._setValueAttr(this.value,true);}else{this[(_ec3==(this._descending?this.incrementButton:this.decrementButton))?"decrement":"increment"](e);}},buildRendering:function(){this.inherited(arguments);if(this.showButtons){this.incrementButton.style.display="";this.decrementButton.style.display="";}var _ec4=dojo.query("label[for=\""+this.id+"\"]");if(_ec4.length){_ec4[0].id=(this.id+"_label");dijit.setWaiState(this.focusNode,"labelledby",_ec4[0].id);}dijit.setWaiState(this.focusNode,"valuemin",this.minimum);dijit.setWaiState(this.focusNode,"valuemax",this.maximum);},postCreate:function(){this.inherited(arguments);if(this.showButtons){this._connects.push(dijit.typematic.addMouseListener(this.decrementButton,this,"_typematicCallback",25,500));this._connects.push(dijit.typematic.addMouseListener(this.incrementButton,this,"_typematicCallback",25,500));}this.connect(this.domNode,!dojo.isMozilla?"onmousewheel":"DOMMouseScroll","_mouseWheeled");var _ec5=dojo.declare(dijit.form._SliderMover,{widget:this});this._movable=new dojo.dnd.Moveable(this.sliderHandle,{mover:_ec5});this._layoutHackIE7();},destroy:function(){this._movable.destroy();if(this._inProgressAnim&&this._inProgressAnim.status!="stopped"){this._inProgressAnim.stop(true);}this._supportingWidgets=dijit.findWidgets(this.domNode);this.inherited(arguments);}});dojo.declare("dijit.form._SliderMover",dojo.dnd.Mover,{onMouseMove:function(e){var _ec6=this.widget;var _ec7=_ec6._abspos;if(!_ec7){_ec7=_ec6._abspos=dojo.position(_ec6.sliderBarContainer,true);_ec6._setPixelValue_=dojo.hitch(_ec6,"_setPixelValue");_ec6._isReversed_=_ec6._isReversed();}var _ec8=e.touches?e.touches[0]:e,_ec9=_ec8[_ec6._mousePixelCoord]-_ec7[_ec6._startingPixelCoord];_ec6._setPixelValue_(_ec6._isReversed_?(_ec7[_ec6._pixelCount]-_ec9):_ec9,_ec7[_ec6._pixelCount],false);},destroy:function(e){dojo.dnd.Mover.prototype.destroy.apply(this,arguments);var _eca=this.widget;_eca._abspos=null;_eca._setValueAttr(_eca.value,true);}});}if(!dojo._hasResource["plugins.init.Init"]){dojo._hasResource["plugins.init.Init"]=true;dojo.provide("plugins.init.Init");dojo.declare("plugins.init.Init",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- init TAB -->\n\t<div\n\t\tdojoAttachPoint=\"initTab\"\n\t\tclass=\"init\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Settings\"\n\t\tstyle=\"text-align: center; max-height: auto !important; min-width: 100% !important; padding: 0 !important;\"\n\t\t>\n\n\t\t<table class=\"mainTable\">\n\t\t\t<tr class=\"aguaIconBackground\">\n\t\t\t\t<td align=\"center\" class=\"aguaIcon\"></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td class=\"title\"> Input user information and 'Save' to load data and user volumes </div>\n\t\t\t</tr>\n\t\t\t\n\t\t\t<tr align=\"center\" width=\"100%\">\n\t\t\t\t<td width=\"100%\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoAttachPoint=\"initTable\"\n\t\t\t\t\t\tclass=\"initTable\"\n\t\t\t\t\t\tstyle=\"height: 800px; \"\n\t\t\t\t\t>\n\t\t\t\t\t\t<table width=\"840px\" align=\"center\">\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"progressButton\"\n\t\t\t\t\t\t\t\t\tclass=\"progressButton\"\n\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:openProgressLog\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tProgress Log\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"saveButton\"\n\t\t\t\t\t\t\t\t\tclass=\"saveButton\"\n\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:save\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tSave\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td colspan=\"3\" align=\"center\">\n\t\t\t\t\t\t\t\t\t<table>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"sublabel\">Admin User</td>\n\t\t\t\t\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"adminUser\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"adminuser\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tmaxlength=\"20\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"admin\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tregExpGen=\"return '[a-z]{5,20}'\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tinvalidMessage=\"Lowercase letters (5-20)\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tpromptMessage=\"Lowercase letters (5-20)\"\n\t\t\t\t\t\t\t\t\t\t\t\t\trequired=\"false\"\n\t\t\t\t\t\t\t\t\t\t\t\t/> \n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"sublabel\">Admin Password</td>\n\t\t\t\t\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"password\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tdojoType=\"plugins.dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tinvalidMessage=\"Passwords don't match\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"password\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"sublabel\">Confirm Password</td>\n\t\t\t\t\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"confirmPassword\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tdojoType=\"plugins.dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tinvalidMessage=\"Passwords don't match\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"confirmPassword\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t</td>\t\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td align=\"center\"\n\t\t\t\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\t\t\t\tclass=\"sublabel\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tData Volume\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td colspan=\"1\"\n\t\t\t\t\t\t\t\t\tclass=\"dataVolumeContainer\"\n\t\t\t\t\t\t\t\t\talign=\"right\"\n\t\t\t\t\t\t\t\t\ttitle=\"REQUIRED: Input snapshot ID (to copy) or volume ID (to mount).\nDEFAULT    : Data snapshot for the current version of Agua\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\tclass=\"dataVolume\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"datavolume\"\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\t\tmaxlength=\"13\" \n\t\t\t\t\t\t\t\t\t\tvalue=\"snap-6341b301\"\n\t\t\t\t\t\t\t\t\t\tregExpGen=\"return '^(snap|vol)\\-[A-F0-9a-f]{8}'\"\n\t\t\t\t\t\t\t\t\t\tinvalidMessage=\"Required format: 'snap-abcdef09' or 'vol-abcdef09'\"\n\t\t\t\t\t\t\t\t\t\tpromptMessage=\"Enter snapshot or volume ID\"\n\t\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\t/> \n\t\t\t\t\t\t\t\t</td>\n\n\t\t\t\t\t\t\t\t<td colspan=\"1\"\n\t\t\t\t\t\t\t\t\talign=\"left\"\n\t\t\t\t\t\t\t\t\tclass=\"dataVolumeSizeContainer\"\n\t\t\t\t\t\t\t\t\ttitle=\"Size of data volume (10-1000 GB)\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\tclass=\"dataVolumeSize\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"datavolumesize\"\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.NumberTextBox\"\n\t\t\t\t\t\t\t\t\t\tname=\"elevation\"\n\t\t\t\t\t\t\t\t\t\tvalue=\"200\"\n\t\t\t\t\t\t\t\t\t\tconstraints=\"{min:200,max:1000,places:0}\"\n\t\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\t\tinvalidMessage=\"Valid range: 200-1000 GB\"\n\t\t\t\t\t\t\t\t\t\tpromptMessage=\"Valid range: 200-1000 GB\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</td>\n\n\t\t\t\t\t\t\t\t<td align=\"left\"\n\t\t\t\t\t\t\t\t\tclass=\"dataVolumeSliderContainer\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"datavolumeslider\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.HorizontalSlider\" \n\t\t\t\t\t\t\t\t\t\tvalue=\"200\"\n\t\t\t\t\t\t\t\t\t\tmaximum=\"1000\"\n\t\t\t\t\t\t\t\t\t\tminimum=\"200\"\n\t\t\t\t\t\t\t\t\t\tpageIncrement=\"10\"\n\t\t\t\t\t\t\t\t\t\tshowButtons=\"true\"\n\t\t\t\t\t\t\t\t\t\tintermediateChanges=\"true\"\n\t\t\t\t\t\t\t\t\t\tslideDuration=\"200\"\n\t\t\t\t\t\t\t\t\t\tdisabled=\"false\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 150px;\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td align=\"center\"\n\t\t\t\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\t\t\t\tclass=\"sublabel\">\n\t\t\t\t\t\t\t\t\tUser Volume\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td colspan=\"1\"\n\t\t\t\t\t\t\t\t\tclass=\"userVolumeContainer\"\n\t\t\t\t\t\t\t\t\talign=\"right\"\n\t\t\t\t\t\t\t\t\ttitle=\"OPTIONAL: Input snapshot ID (to copy) or volume ID (to mount).\nDEFAULT    : Create a new, empty volume\"\n\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:toggleUserVolume\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\tclass=\"userVolume\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"uservolume\"\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\t\tmaxlength=\"13\"\n\t\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t\t\tregExpGen=\"return '(snap|vol)\\-[A-F0-9a-f]{8}'\"\n\t\t\t\t\t\t\t\t\t\tinvalidMessage=\"Required format: 'snap-abcdef09' or 'vol-abcdef09'\"\n\t\t\t\t\t\t\t\t\t\tpromptMessage=\"Required format: 'snap-abcdef09' or 'vol-abcdef09'\"\n\t\t\t\t\t\t\t\t\t\trequired=\"false\"\n\t\t\t\t\t\t\t\t\t/> \n\t\t\t\t\t\t\t\t</td>\n\n\t\t\t\t\t\t\t\t<td colspan=\"1\"\n\t\t\t\t\t\t\t\t\talign=\"left\"\n\t\t\t\t\t\t\t\t\tclass=\"userVolumeSizeContainer\">\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\tclass=\"userVolumeSize\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"uservolumesize\"\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.NumberTextBox\"\n\t\t\t\t\t\t\t\t\t\tname=\"elevation\"\n\t\t\t\t\t\t\t\t\t\tvalue=\"100\"\n\t\t\t\t\t\t\t\t\t\tconstraints=\"{min:10,max:1000,places:0}\"\n\t\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\t\tinvalidMessage=\"Valid range: 10-1000 GB\"\n\t\t\t\t\t\t\t\t\t\tpromptMessage=\"Valid range: 10-1000 GB\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</td>\n\n\t\t\t\t\t\t\t\t<td align=\"left\">\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"uservolumeslider\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.HorizontalSlider\" \n\t\t\t\t\t\t\t\t\t\tvalue=\"10\"\n\t\t\t\t\t\t\t\t\t\tmaximum=\"1000\"\n\t\t\t\t\t\t\t\t\t\tminimum=\"10\"\n\t\t\t\t\t\t\t\t\t\tpageIncrement=\"10\"\n\t\t\t\t\t\t\t\t\t\tshowButtons=\"true\"\n\t\t\t\t\t\t\t\t\t\tintermediateChanges=\"true\"\n\t\t\t\t\t\t\t\t\t\tslideDuration=\"200\"\n\t\t\t\t\t\t\t\t\t\tdisabled=\"false\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 150px;\"\n\t\t\t\t\t\t\t\t\t\tclass=\"userVolumeSlider\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td align=\"center\"\n\t\t\t\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\t\t\t\tclass=\"sublabel\">\n\t\t\t\t\t\t\t\t\tAmazon User ID\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\tclass=\"amazonUserId\"\n\t\t\t\t\t\t\t\t\t\tsize=\"200\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"amazonuserid\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\t\tregExp=\"^\\d{12}$\"\n\t\t\t\t\t\t\t\t\t\tmaxlength=\"12\" \n\t\t\t\t\t\t\t\t\t\tpromptMessage=\"Enter your 12-digit Amazon User ID (numbers only)\" \n\t\t\t\t\t\t\t\t\t\tinvalidMessage=\"Invalid User ID (Must be 12-digits, numbers only).\"\n\t\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\t\twrap=\"off\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td align=\"center\"\n\t\t\t\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\t\t\t\tclass=\"sublabel\"\n\t\t\t\t\t\t\t\t\t>AWS Access Key ID\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\tclass=\"awsAccessKeyId\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"awsaccesskeyid\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\tmaxlength=\"20\"\n\t\t\t\t\t\t\t\t\t\tuppercase=\"true\"\n\t\t\t\t\t\t\t\t\t\tregExpGen=\"return '[A-Z0-9]{16,24}'\"\n\t\t\t\t\t\t\t\t\t\tinvalidMessage=\"20 characters: capital letters or numbers\"\n\t\t\t\t\t\t\t\t\t\tpromptMessage=\"20 characters: capital letters or numbers\"\n\t\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td align=\"center\"\n\t\t\t\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\t\t\t\tclass=\"sublabel\">Secret Access Key\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"awssecretaccesskey\"\n\t\t\t\t\t\t\t\t\t\tclass=\"secretAccessKey\"\n\t\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ValidationTextBox\"\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\tmaxlength=\"40\"\n\t\t\t\t\t\t\t\t\t\tregExpGen=\"return '.{35,45}'\"\n\t\t\t\t\t\t\t\t\t\tinvalidMessage=\"40 characters\"\n\t\t\t\t\t\t\t\t\t\tpromptMessage=\"40 characters\"\n\t\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td align=\"center\"\n\t\t\t\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\t\t\t\tclass=\"sublabel\">EC2 Private Key</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\t\tpromptMessage=\"-----BEGIN PRIVATE KEY---- ... -----END PRIVATE KEY-----\" \n\t\t\t\t\t\t\t\t\t\tdojoType=\"plugins.form.ValidationTextarea\"\n\t\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"ec2privatekey\"\n\t\t\t\t\t\t\t\t\t\tclass=\"ec2privatekey\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width:100%; font-size: 10px; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\t\trows=\"14\"\n\t\t\t\t\t\t\t\t\t></textarea>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td align=\"center\"\n\t\t\t\t\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\t\t\t\t\tclass=\"sublabel\">EC2 Public Certificate</td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\t\tdojoType=\"plugins.form.ValidationTextarea\"\n\t\t\t\t\t\t\t\t\t\tpromptMessage=\"-----BEGIN CERTIFICATE----- ... -----END CERTIFICATE-----\"\n\t\t\t\t\t\t\t\t\t\trequired=\"true\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"ec2publiccert\"\n\t\t\t\t\t\t\t\t\t\tclass=\"ec2publiccert\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width:100%; font-size: 10px; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\t\trows=\"14\"\n\t\t\t\t\t\t\t\t\t></textarea>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</table>\n\t\t\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\n\t\t</table>\n\n\t</div>\n\t<!-- END init TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,addingUser:false,cssFiles:["plugins/init/css/init.css"],parentWidget:null,defaultDataVolume:null,constructor:function(args){this.loadCSS();this.defaultDataVolume=args.dataVolume;console.log("Init.constructor    this.defaultDataVolume: "+this.defaultDataVolume);},postCreate:function(){console.log("Controller.postCreate    plugins.init.Controller.postCreate()");this.startup();},startup:function(){console.log("Init.startup    plugins.init.GroupInit.startup()");this.inherited(arguments);console.log("Init.startup    this.defaultDataVolume: "+this.defaultDataVolume);this.datavolume.set("value",this.defaultDataVolume);dijit.Tooltip.defaultPosition=["above","below"];console.log("Init.startup    BEFORE appendChild(this.initTab.domNode)");dojo.byId("attachPoint").appendChild(this.initTab.domNode);console.log("Init.startup    AFTER appendChild(this.initTab.domNode)");this.disableProgressButton();dojo.connect(this.saveButton,"onClick",dojo.hitch(this,"save"));this.setDataVolumeSlider();this.setUserVolumeSlider();this.setPasswordMatcher();this.setToaster();},save:function(_ecb){console.log("Init.save    event: "+_ecb);if(this.saving==true){console.log("Init.save    this.saving: "+this.saving+". Returning.");return;}this.saving=true;var _ecc=["confirmPassword","amazonuserid","datavolume","uservolume","datavolumesize","uservolumesize","awsaccesskeyid","awssecretaccesskey","ec2publiccert","ec2privatekey"];var _ecd=true;for(var i=0;i<_ecc.length;i++){var _ece=_ecc[i];console.log("Init.save    parameter: "+_ece);console.log("Init.save    this["+_ece+"]: ");console.dir({this_parameter:this[_ece]});var _ecf=this[_ece].isValid(this[_ece].textbox.value);console.log("Init.save    this["+_ece+"] valid: "+_ecf);if(_ecf){console.log("Init.save    VALID!!");this[_ece].state="Incomplete";this[_ece]._setStateClass();}else{console.log("Init.save    NOT VALID. Setting 'Error' state");this[_ece].state="Error";this[_ece]._setStateClass();_ecd=false;}if(_ece=="confirmPassword"){if(_ecf){console.log("Init.save    DOING _setStateClass 'Incomplete' for 'password'");this["password"].state="Incomplete";this["password"]._setStateClass();}else{console.log("Init.save    DOING _setStateClass 'Error' for 'password'");this["password"].state="Error";this["password"]._setStateClass();}}}if(!_ecf){console.log("Init.save    One or more inputs not valid. Returning");this.saving=false;return;}var _ed0=this.uservolume.value;if(_ed0.match(/New volume/)){_ed0="";}var aws=new Object;aws.username=this.adminuser.value;aws.password=this.password.value;aws.amazonuserid=this.cleanEdges(this.amazonuserid.value);aws.datavolume=this.datavolume.value;aws.uservolume=_ed0;aws.datavolumesize=this.datavolumesize.value;aws.uservolumesize=this.uservolumesize.value;aws.ec2publiccert=this.cleanEdges(this.ec2publiccert.value);aws.ec2privatekey=this.cleanEdges(this.ec2privatekey.value);aws.awsaccesskeyid=this.cleanEdges(this.awsaccesskeyid.value);aws.awssecretaccesskey=this.cleanEdges(this.awssecretaccesskey.value);var url=this.cgiUrl+"/init.cgi?";console.log("Init.saveStore     url: "+url);var _ed1=new Object;_ed1.username="agua";_ed1.mode="init";_ed1.data=aws;console.log("Init.save    query: "+dojo.toJson(_ed1));console.dir({query:_ed1});this.enableProgressButton();var _ed2=this;dojo.xhrPut({url:url,contentType:"text",putData:dojo.toJson(_ed1),load:function(_ed3,_ed4){console.log("Init.save    response:");console.dir({response:_ed3});_ed2.handleSave(_ed3);},error:function(_ed5,_ed6){console.log("Init.save    Error with JSON Post, response: ");console.dir({response:_ed5});}});this.saving=false;},handleSave:function(_ed7){console.log("Init.handleSave    response: ");console.dir({response:_ed7});if(!_ed7){this.toast({error:"No response from server. If problem persists, restart instance"});return;}this.toast(_ed7);},openProgressLog:function(){if(dojo.hasClass(this.progressButton,"disabled")){console.log("Init.openProgressLog    DISABLED. returning");return;}window.open("log/initlog.html","_blank","toolbar=1,location=0,directories=0,status=0,menubar=1,scrollbars=1,resizable=1,navigation=0");},disableProgressButton:function(){dojo.addClass(this.progressButton,"disabled");},enableProgressButton:function(){dojo.removeClass(this.progressButton,"disabled");},setTable:function(){console.log("Init.setTable     plugins.init.GroupInit.setTable()");while(this.initTable.firstChild){this.initTable.removeChild(this.initTable.firstChild);}},setDataVolumeSlider:function(){console.log("Init.setDataVolumeSlider     plugins.init.Init.setDataVolumeSlider()");var _ed8=this;dojo.connect(this.datavolumeslider,"onMouseUp",dojo.hitch(this,function(e){console.log("Init.setDataVolumeSlider    onMouseUp fired");var size=parseInt(this.datavolumeslider.getValue());console.log("Init.setDataVolumeSlider    size: "+size);_ed8.datavolumesize.set("value",size);}));},setUserVolumeSlider:function(){console.log("Init.setUserVolumeSlider     plugins.init.Init.setUserVolumeSlider()");var _ed9=this;dojo.connect(this.uservolumeslider,"onMouseUp",dojo.hitch(this,function(e){console.log("Init.setUserVolumeSlider    onMouseUp fired");var size=parseInt(this.uservolumeslider.getValue());console.log("Init.setUserVolumeSlider    size: "+size);_ed9.uservolumesize.set("value",size);}));},setPasswordMatcher:function(){console.log("Init.setPasswordMatcher    this.confirmPassword: "+this.confirmPassword);this.confirmPassword.parentWidget=this;this.password.parentWidget=this;this.password.target=this.confirmPassword;this.confirmPassword.source=this.password;},passwordsMatch:function(){var _eda=this.password.textbox.value;console.log("Settings.confirmPassword    password: "+_eda);var _edb=this.confirmPassword.textbox.value;console.log("Settings.confirmPassword    confirmPassword: "+_edb);if(!_eda){return false;}return _eda==_edb;},setAdminPassword:function(){var _edc=9;var _edd=this.createRandomHexString(_edc);console.log("Init.setAdminPassword    password: "+_edd);},createRandomHexString:function(_ede){var _edf="";for(var i=0;i<_ede;i++){var _ee0=parseInt(Math.random()*16);var hex=this.decimalToHex(_ee0);if(hex==10){hex=0;}_edf+=hex;}return _edf;},decimalToHex:function(_ee1){return Number(_ee1).toString(16);},cleanEdges:function(_ee2){if(_ee2==null){return null;}_ee2=_ee2.replace(/^\s+/,"");_ee2=_ee2.replace(/\s+$/,"");return _ee2;},toggleUserVolume:function(_ee3){console.log("Init.toggleUserVolume    this.userVolumeToggled: "+this.userVolumeToggled);if(this.userVolumeToggled){return;}this.userVolumeToggled=true;this.uservolume.set("disabled",false);dojo.addClass(this.uservolume.textbox,"enabled");this.uservolume.textbox.value="";},toggleDataVolume:function(_ee4){console.log("Init.toggleUserVolume    this.dataVolumeToggled: "+this.dataVolumeToggled);if(this.dataVolumeToggled){return;}this.dataVolumeToggled=true;this.datavolume.set("disabled",false);dojo.addClass(this.datavolume.textbox,"enabled");}});}if(!dojo._hasResource["dijit.ProgressBar"]){dojo._hasResource["dijit.ProgressBar"]=true;dojo.provide("dijit.ProgressBar");dojo.declare("dijit.ProgressBar",[dijit._Widget,dijit._Templated],{progress:"0",value:"",maximum:100,places:0,indeterminate:false,label:"",name:"",templateString:dojo.cache("dijit","templates/ProgressBar.html","<div class=\"dijitProgressBar dijitProgressBarEmpty\" role=\"progressbar\"\n\t><div  dojoAttachPoint=\"internalProgress\" class=\"dijitProgressBarFull\"\n\t\t><div class=\"dijitProgressBarTile\" role=\"presentation\"></div\n\t\t><span style=\"visibility:hidden\">&nbsp;</span\n\t></div\n\t><div dojoAttachPoint=\"labelNode\" class=\"dijitProgressBarLabel\" id=\"${id}_label\"></div\n\t><img dojoAttachPoint=\"indeterminateHighContrastImage\" class=\"dijitProgressBarIndeterminateHighContrastImage\" alt=\"\"\n/></div>\n"),_indeterminateHighContrastImagePath:dojo.moduleUrl("dijit","themes/a11y/indeterminate_progress.gif"),postMixInProperties:function(){this.inherited(arguments);if(!("value" in this.params)){this.value=this.indeterminate?Infinity:this.progress;}},buildRendering:function(){this.inherited(arguments);this.indeterminateHighContrastImage.setAttribute("src",this._indeterminateHighContrastImagePath.toString());this.update();},update:function(_ee5){dojo.mixin(this,_ee5||{});var tip=this.internalProgress,ap=this.domNode;var _ee6=1;if(this.indeterminate){dijit.removeWaiState(ap,"valuenow");dijit.removeWaiState(ap,"valuemin");dijit.removeWaiState(ap,"valuemax");}else{if(String(this.progress).indexOf("%")!=-1){_ee6=Math.min(parseFloat(this.progress)/100,1);this.progress=_ee6*this.maximum;}else{this.progress=Math.min(this.progress,this.maximum);_ee6=this.progress/this.maximum;}dijit.setWaiState(ap,"describedby",this.labelNode.id);dijit.setWaiState(ap,"valuenow",this.progress);dijit.setWaiState(ap,"valuemin",0);dijit.setWaiState(ap,"valuemax",this.maximum);}this.labelNode.innerHTML=this.report(_ee6);dojo.toggleClass(this.domNode,"dijitProgressBarIndeterminate",this.indeterminate);tip.style.width=(_ee6*100)+"%";this.onChange();},_setValueAttr:function(v){this._set("value",v);if(v==Infinity){this.update({indeterminate:true});}else{this.update({indeterminate:false,progress:v});}},_setLabelAttr:function(_ee7){this._set("label",_ee7);this.update();},_setIndeterminateAttr:function(_ee8){this.indeterminate=_ee8;this.update();},report:function(_ee9){return this.label?this.label:(this.indeterminate?"&nbsp;":dojo.number.format(_ee9,{type:"percent",places:this.places,locale:this.lang}));},onChange:function(){}});}if(!dojo._hasResource["plugins.login.LoginStatus"]){dojo._hasResource["plugins.login.LoginStatus"]=true;dojo.provide("plugins.login.LoginStatus");dojo.declare("plugins.login.LoginStatus",[dijit._Widget,dijit._Templated],{templateString:"<span dojoAttachPoint=\"containerNode\" >\n\n    <table class=\"loginStatus\">\n\n        <tr>\n            <td>\n                <div\n                    dojoAttachPoint=\"launcher\"\n                    class=\"launcher\"\n                    >\n                    \n                </div>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <div\n                    dojoAttachPoint=\"username\"\n                    class=\"username\"\n                    >\n                </div>\n            </td>\n        </tr>\n    </table>\n    \n\n</span>\n",widgetsInTemplate:true,constructor:function(){console.log("LoginStatus.constructor    plugins.login.LoginStatus.constructor()");this.loadCSS();},postMixInProperties:function(){console.log("LoginStatus.postMixInProperties    plugins.login.LoginStatus.postMixInProperties()");},postCreate:function(){console.log("LoginStatus.postCreate    plugins.login.LoginStatus.postCreate()");this.startup();},startup:function(){console.log("LoginStatus.startup    plugins.login.LoginStatus.startup()");this.inherited(arguments);},loadCSS:function(){console.log("LoginStatus.loadCSS    plugins.login.LoginStatus.loadCSS()");var _eea=[dojo.moduleUrl("plugins")+"login/css/loginstatus.css",dojo.moduleUrl("plugins")+"login/css/login.css"];for(var i in _eea){var _eeb=_eea[i];console.log("LoginStatus.loadCSS    cssFile: "+_eeb);var _eec=document.createElement("link");_eec.type="text/css";_eec.rel="stylesheet";_eec.href=_eeb;_eec.media="screen";document.getElementsByTagName("head")[0].appendChild(_eec);}}});}if(!dojo._hasResource["plugins.login.Login"]){dojo._hasResource["plugins.login.Login"]=true;dojo.provide("plugins.login.Login");dojo.declare("plugins.login.Login",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\" class=\"login\">\n\n    <div\n        dojoAttachPoint=\"loginDialogue\"\n        class=\"loginDialogue\"\n        label=\"Login\"\n        class=\"login\"\n        modal=\"true\"\n        dojoType=\"dojox.widget.Dialog\"\n        style=\"overflow: visible; position: absolute; top: 240px; left: 248px; opacity: 1; width: 300px; height: 300px; align: center;\"\n        title=\"Agua Login\"\n        >\n        \n        <table align=\"center\" width=\"100%\">\n\n            <tr align=\"center\" width=\"100%\">\n                <td colspan=\"2\" class=\"loginIcon\"></td>\n            </tr>\n\n            <tr\n                dojoAttachPoint=\"nameRow\"\n                align=\"center\">\n                <td align=\"right\">Username</td>\n                <td align=\"left\">\n                    <div\n                        dojoAttachPoint=\"username\"\n                        class=\"username\"\n                        value=\"\"\n                        dojoType=\"dijit.form.TextBox\"\n                        style=\"width: 100px\"\n                        value=\"testuser\"\n                        >testuser\n                    </div>\n                </td>\n            </tr>\n            <tr\n                dojoAttachPoint=\"passwordRow\"\n                align=\"center\">\n                <td align=\"right\">Password</td>\n                <td align=\"left\">\n                    <div\n                        dojoAttachPoint=\"password\"\n                        class=\"password\"\n                        value=\"\"\n                        type=\"password\"\n                        dojoType=\"dijit.form.TextBox\"\n                        style=\"width: 100px\"\n                        value=\"testuser\"\n                        >testuser\n                    </div>\n                </td>\n            </tr>\n            <tr\n                dojoAttachPoint=\"buttonRow\"\n                class=\"loginCenteredRow\">\n                <td align=\"center\" colspan=\"2\">\n                    <div\n                        dojoAttachPoint=\"loginButton\"\n                        dojoAttachEvent=\"onclick:login\"\n                        class=\"loginButton\"\n                        >Login</div>\n                </td>\n            </tr>\n            <tr class=\"loginCenteredRow\">\n                <td align=\"center\" colspan=\"2\">\n                    <div\n                        dojoAttachPoint=\"message\"\n                        colspan=\"2\">\n                    </div>\n                </td>\n            </tr>\n            <tr class=\"loginCenteredRow\">\n                <td align=\"center\" colspan=\"2\">\n                    <div\n                        dojoAttachPoint=\"progressBar\"\n                        class=\"progressBar\"\n                        dojoType=\"dijit.ProgressBar\"\n                        colspan=\"2\">\n                    </div>\n                </td>\n            </tr>\n        </table>\n    \n    </div>\n</div>\n",widgetsInTemplate:true,loginMessage:"",cssFiles:[dojo.moduleUrl("plugins")+"login/css/login.css",dojo.moduleUrl("dojox")+"widget/Dialog/Dialog.css",dojo.moduleUrl("dijit")+"themes/claro/claro.css"],logging:false,constructor:function(){console.log("Login.constructor    plugins.login.Login.constructor()");this.loadCSS();this.statusBar=new plugins.login.LoginStatus();this.statusBar.launcher.innerHTML="Log In";var _eed=dojo.connect(this.statusBar.launcher,"onclick",this,"show");this.statusBar.launcher.listener=_eed;document.getElementById("loginHolder").appendChild(this.statusBar.containerNode);},postCreate:function(){console.log("Login.postCreate    plugins.workflow.Login.postCreate()");this.startup();},startup:function(){console.log("Login.startup    plugins.workflow.Login.startup()");this.inherited(arguments);dojo.addClass(this.domNode,"login");this.setDialogListeners();this.setProgressBar();var data=this.debug();if(data){this.handleLogin(data,data.username);return;}this.show();},debug:function(){var url=window.location.href;console.log("Login.debug    url: "+url);if(!url.match(/(.+?)\?([^\?]+),([^,]+)/)){console.log("Login.debug    Not debugging. Setting this.debugFlag to FALSE and returning");return false;}console.log("Login.debug    Debugging");var _eee=url.match(/(.+?)\?([^\?]+?),([^,]+)/)[2];var _eef=url.match(/(.+?)\?([^\?]+?),([^,]+)/)[3];var _ef0;if(url.match(/(.+?)\?([^\?]+),([^,]+?),([^,]+)$/)){_ef0=url.match(/(.+?)\?([^\?]+),([^,]+),([^,]+)$/)[4];}console.log("Login.debug    plugins: "+dojo.toJson(_ef0));if(_ef0!=null){var _ef1=_ef0.split(/\./);console.log("Login.debug    array: "+dojo.toJson(_ef1));var _ef2=new Array;var _ef3=new Array;for(var i=0;i<_ef1.length;i++){if(!_ef1[i].match(/^[^\(]+/)){continue;}var _ef4=_ef1[i].match(/^([^\(]+)/)[1];_ef2[i]="plugins.";_ef2[i]+=_ef4;_ef2[i]+=".Controller";if(_ef1[i].match(/^[^\(]+\(([^\)]+)\)/)){var args=_ef1[i].match(/^[^\(]+\(([^\)]+)\)/)[1];console.log("Login.debug    args: ");console.dir({args:args});_ef3[i]=args;}}Agua.pluginsList=_ef2;Agua.pluginsArgs=_ef3;}console.log("Login.debug    this.pluginsList: "+dojo.toJson(Agua.pluginsList));var data={};data.username=_eee;data.sessionid=_eef;return data;},setDialogListeners:function(){var _ef5=this;dojo.connect(this.username,"onKeyPress",function(_ef6){var key=_ef6.charOrCode;_ef6.stopPropagation();if(key==13){_ef5.password.focus();}});var _ef5=this;dojo.connect(this.password,"onKeyPress",function(_ef7){var key=_ef7.charOrCode;_ef7.stopPropagation();if(key==13){_ef5.login();}if(key==dojo.keys.ESCAPE){dojo.fadeOut({node:"loginDialogue",duration:500}).play();_ef5.loginDialogue.hide();}});},setProgressBar:function(){this.hideProgressBar();},show:function(){console.log("Login.show    plugins.login.Login.show()");this.logging=false;dojo.removeClass(this.message,"error");dojo.removeClass(this.message,"accepted");dojo.addClass(this.loginDialogue.domNode,"login");dojo.removeClass(this.message,"error");dojo.removeClass(this.message,"accepted");if(this.loginDialogue==null){console.log("Login.show    this.loginDialogue == null. Returning.");return;}this.showInputs();this.message.innerHTML=this.loginMessage;console.log("Login.show    DOING this.loginDialogue.show()");this.loginDialogue.show();},hide:function(){console.log("Login.hide     plugins.login.Login.hide()");console.log("Login.hide    Doing dojo.style(this.domNode, opacity, 0)");dojo.style(this.domNode,"opacity",0);console.log("Login.hide    HIDE DIALOGUE");this.loginDialogue.hide();console.log("Login.hide    RESETTING CSS to default");dojo.removeClass(this.message,"error");dojo.removeClass(this.message,"accepted");dojo.removeClass(this.message,"loading");console.log("Login.hide    RESETTING this.message to default");this.message.innerHTML="Loaded";},login:function(){console.log("Login.login     this.logging: "+this.logging);if(this.logging){console.log("Login.login     Returning.");return;}console.log("Login.login    Setting this.logging to TRUE");this.logging=true;var _ef8=this.username.get("value");var _ef9=this.password.get("value");if(_ef9==null||_ef9==""){return;}this.setLoginStyle();Agua.cookie("sessionid",null);Agua.cookie("username",null);var _efa=new Object;_efa.username=_ef8;_efa.password=_ef9;_efa.mode="submitLogin";console.log("Login.login     query: "+dojo.toJson(_efa));var url=Agua.cgiUrl+"workflow.cgi";console.log("Login.login     url: "+url);console.log("Login.login    BEFORE xhrPut");console.log("Login.login    Agua.cookie('username'): "+Agua.cookie("username"));console.log("Login.login    Agua.cookie('sessionid'): "+Agua.cookie("sessionid"));var _efb=this;var _efc=dojo.xhrPut({url:url,contentType:"json",handleAs:"json",sync:true,putData:dojo.toJson(_efa),preventCache:true,handle:function(_efd){if(_efd.error){console.log("Login.login    Error. Setting this.logging to FALSE");_efb.logging=false;dojo.addClass(_efb.message,"error");_efb.message.innerHTML="Invalid username and password";_efb.showInputs();}else{_efb.handleLogin(_efd,_ef8);}},error:function(_efe,_eff){console.log("Login.login    Response is NULL. Setting this.logging to FALSE");_efb.logging=false;}});console.log("Login.login    After xhrPut");},setLoginStyle:function(){this.hideInputs();dojo.removeClass(this.message,"error");dojo.removeClass(this.message,"accepted");this.message.innerHTML="Authenticating...";console.log("Login.setLoginStyle    Doing progress bar removeClass 'inactive'");console.dir({login:this});console.dir({progressBar:this.progressBar});},showProgressBar:function(){console.log("Login.showProgess    Doing progress bar removeClass 'inactive'");dojo.removeClass(this.progressBar.domNode,"inactive");this.message.innerHTML="Loading Agua...";},hideProgressBar:function(){console.log("Login.hideProgess    Doing progress bar addClass 'inactive'");dojo.addClass(this.progressBar.domNode,"inactive");},showInputs:function(){console.log("Login.showInputs    DOING dojo.addClass(this.xxxRow, 'hidden')");dojo.removeClass(this.nameRow,"hidden");dojo.removeClass(this.passwordRow,"hidden");dojo.removeClass(this.buttonRow,"hidden");dojo.removeClass(this.message,"loading");},hideInputs:function(){console.log("Login.hideInputs    DOING dojo.removeClass(this.xxxRow, 'hidden')");dojo.addClass(this.nameRow,"hidden");dojo.addClass(this.passwordRow,"hidden");dojo.addClass(this.buttonRow,"hidden");},setLogoutStyle:function(){console.log("Logout.setLogoutStyle    Getting ");this.message.innerHTML=this.loginMessage;dojo.removeClass(this.message,"error");dojo.removeClass(this.message,"accepted");this.statusBar.username.innerHTML="Logged out";this.statusBar.launcher.innerHTML="Log In";},setLoading:function(){dojo.addClass(this.message,"loading");this.message.innerHTML="Loading Agua";},handleLogin:function(data,_f00){console.log("Login.handleLogin     xhrPut data Json: "+dojo.toJson(data));this.showProgressBar();this.password.set("value","");if(data.error!=null){console.log("Login.handleLogin    Login error: "+data.error);console.log("Login.handleLogin    DOING this.showInputs()");this.showInputs();dojo.addClass(this.message,"error");this.message.innerHTML=data.error;}else{console.log("Login.handleLogin    Successful login");console.log("Login.handleLogin    data: "+dojo.toJson(data));Agua.cookie("sessionid",data.sessionid);Agua.cookie("username",_f00);console.log("Login.handleLogin    username: "+_f00);console.log("Login.handleLogin    sessionid: "+data.sessionid);dojo.removeClass(this.message,"error");dojo.addClass(this.message,"accepted");this.message.innerHTML="Accepted";var _f01;setTimeout(function(_f02){console.log("Login.handleLogin    setTimeout    Setting message to 'Loading Agua'");_f02.setLoading();},1000,this);this.statusBar.username.innerHTML="<span class='label'></span> "+_f00;this.statusBar.launcher.innerHTML="Log Out";dojo.disconnect(this.statusBar.launcher.listener);var _f03=dojo.connect(this.statusBar.launcher,"onclick",this,"logout");this.statusBar.launcher.listener=_f03;console.log("Login.handleLogin    DOING setTimeout( Agua.startPlugins(), 100)");setTimeout(function(_f04){Agua.startPlugins();_f04.hideProgressBar();},100,this);console.log("Login.login    Setting this.logging to FALSE");this.logging=false;setTimeout(function(_f05){dojo.fadeOut({node:_f05.loginDialogue.domNode,duration:10}).play();_f05.hide();_f05.logging=false;},100,this);}},logout:function(e){Agua.cookie("sessionid",null);Agua.cookie("username",null);this.setLogoutStyle();dojo.disconnect(this.statusBar.launcher.listener);var _f06=dojo.connect(this.statusBar.launcher,"onclick",this,"show");this.statusBar.launcher.listener=_f06;Agua.logout();}});}if(!dojo._hasResource["plugins.login.Controller"]){dojo._hasResource["plugins.login.Controller"]=true;dojo.provide("plugins.login.Controller");dojo.declare("plugins.login.Controller",[],{login:null,constructor:function(args){console.log("Controller.constructor     plugins.login.Controller.constructor");this.loadCSS();},loadCSS:function(){console.log("Controller.loadCSS    Loading CSS FILES");var _f07=[dojo.moduleUrl("plugins")+"login/css/login.css"];for(var i in _f07){var _f08=_f07[i];var _f09=document.createElement("link");_f09.type="text/css";_f09.rel="stylesheet";_f09.href=_f08;_f09.media="screen";document.getElementsByTagName("head")[0].appendChild(_f09);}}});dojo.addOnLoad(function(){});}if(!dojo._hasResource["plugins.sharing.AccessRow"]){dojo._hasResource["plugins.sharing.AccessRow"]=true;dojo.provide("plugins.sharing.AccessRow");dojo.declare("plugins.sharing.AccessRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n<table>\n    \n    <tr dojoAttachPoint=\"row\">\n        <td \n            colspan=\"1\"\n            dojoAttachPoint=\"groupname\"\n            class=\"narrowColumn\"\n            title=\"Special file groupnames, e.g., FASTA, FASTQ\"\n        >${groupname}</td>\n        <td \n            colspan=\"1\"\n            dojoAttachPoint=\"groupwrite\"\n            dojoAttachEvent=\"onclick:toggle\"\n            class=\"narrowColumn\"\n            title=\"Special file groupwrites, e.g., FASTA, FASTQ\"\n            value=\"groupwrite\"\n        ></td>\n        <td\n            colspan=\"1\"\n            dojoAttachPoint=\"groupcopy\"\n            dojoAttachEvent=\"onclick:toggle\"\n            class=\"narrowColumn\"\n            title=\"User can groupcopy data and workflows in this group\"\n            value=\"groupcopy\"\n        ></td>\n        <td\n            colspan=\"1\"\n            dojoAttachPoint=\"groupview\"\n            dojoAttachEvent=\"onclick:toggle\"\n            class=\"narrowColumn\"\n            title=\"User can groupview data and workflows in this group\"\n            value=\"groupview\"\n        ></td>\n        <td \n            colspan=\"1\"\n            dojoAttachPoint=\"worldwrite\"\n            dojoAttachEvent=\"onclick:toggle\"\n            class=\"narrowColumn\"\n            title=\"Special file worldwrites, e.g., FASTA, FASTQ\"\n            value=\"worldwrite\"\n        ></td>\n        <td\n            colspan=\"1\"\n            dojoAttachPoint=\"worldcopy\"\n            dojoAttachEvent=\"onclick:toggle\"\n            class=\"narrowColumn\"\n            title=\"User can worldcopy data and workflows in this group\"\n            value=\"worldcopy\"\n        ></td>\n        <td\n            colspan=\"1\"\n            dojoAttachPoint=\"worldview\"\n            dojoAttachEvent=\"onclick:toggle\"\n            class=\"narrowColumn\"\n            title=\"User can worldview data and workflows in this group\"\n            value=\"worldview\"\n        ></td>\n    </tr>\n\n</table>\n\n</div>\n",widgetsInTemplate:true,parentWidget:null,args:null,constructor:function(args){this.args=args;},postCreate:function(){this.rights=this.parentWidget.rights;this.startup();},startup:function(){this.inherited(arguments);for(var _f0a in this.rights){var _f0b=this.rights[_f0a];if(this.args[_f0b]==1){dojo.addClass(this[_f0b],"allowed");}else{dojo.addClass(this[_f0b],"denied");}}},toggle:function(_f0c){var _f0d=dojo.attr(_f0c.target,"value");_f0c.stopPropagation();var _f0e="group";if(_f0d.match(/^world/)){_f0e="world";}var _f0f;if(_f0d.match(/^group/)){_f0f=_f0d.replace(/^group/,"");}if(_f0d.match(/^world/)){_f0f=_f0d.replace(/^world/,"");}var _f10="allowed";var _f11="denied";if(dojo.hasClass(this[_f0d],"allowed")){_f10="denied";_f11="allowed";}this.descendingOwnership(_f0e,_f0f,_f10,_f11);if(_f0e=="world"&&_f10=="allowed"){var _f12=false;this.descendingOwnership("group",_f0f,_f10,_f11,_f12);}},descendingOwnership:function(_f13,_f14,_f15,_f16,_f17){if(_f17==null){_f17=true;}if(_f14=="write"){this.setClasses(_f13,"write",_f15,_f16);this.setClasses(_f13,"copy",_f15,_f16);this.setClasses(_f13,"view",_f15,_f16);}if(_f14=="copy"){this.setClasses(_f13,"view",_f15,_f16);this.setClasses(_f13,"copy",_f15,_f16);if(_f15=="denied"){this.setClasses(_f13,"write",_f15,_f16);}else{if(_f17==true){this.setClasses(_f13,"write",_f16,_f15);}}}if(_f14=="view"){this.setClasses(_f13,"view",_f15,_f16);if(_f15=="denied"&&_f17==true){this.setClasses(_f13,"write",_f15,_f16);this.setClasses(_f13,"copy",_f15,_f16);}else{if(_f17==true){this.setClasses(_f13,"write",_f16,_f15);this.setClasses(_f13,"copy",_f16,_f15);}}}},setClasses:function(_f18,_f19,_f1a,_f1b){dojo.addClass(this[_f18+_f19],_f1a);dojo.removeClass(this[_f18+_f19],_f1b);}});}if(!dojo._hasResource["plugins.sharing.Access"]){dojo._hasResource["plugins.sharing.Access"]=true;dojo.provide("plugins.sharing.Access");dojo.declare("plugins.sharing.Access",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- access TAB -->\n\t<div\n\t\tdojoAttachPoint=\"accessTab\"\n\t\tclass=\"access\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Access\"\n\t\tstyle=\"height: 700px; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t\t>\n\t\t\n\t\t<table width=\"100%\">\n\t\t\t<tr valign=\"top\" width=\"100%\">\n\t\t\t\t<td colspan=\"7\" class=\"tabTitle\" align=\"center\"> Access </td>\n\t\t\t</tr>\n\t\t</table>\n\t\t<table class=\"saveButtonTable\">\n\t\t\t<tr>\n\t\t\t\t<td \n\t\t\t\t\tcolspan=\"11\"\n\t\t\t\t\talign=\"center\"\n\t\t\t\t\tclass=\"saveButton\"\n\t\t\t\t\tdojoAttachPoint=\"saveButton\"\n\t\t\t\t\tdojoAttachEvent=\"onclick:saveAccess\"\n\t\t\t\t>\n\t\t\t\t\tSave\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\n\t\t<div\n\t\t\tclass=\"dragSource\"\n\t\t\tstyle=\"height: 600px; width: 96%;\"\n\t\t>\n\t\t\t<table class=\"permissionsTable\"\n\t\t\t\t   dojoAttachPoint='table'>\n\t\t\t\t<tr class=\"header\">\n\t\t\t\t\t<td >Group</td>\n\t\t\t\t\t<td colspan=\"3\" class=\"headerBold\">Group</td>\n\t\t\t\t\t<td colspan=\"3\" class=\"headerBold\">World</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr class=\"subheader\">\n\t\t\t\t\t<td class=\"narrowColumn\" colspan=\"1\"> </td>\n\t\t\t\t\t<td class=\"narrowColumn\">Write</td>\n\t\t\t\t\t<td class=\"narrowColumn\">Copy</td>\n\t\t\t\t\t<td class=\"narrowColumn\">View</td>\n\t\t\t\t\t<td class=\"narrowColumn\">Write</td>\n\t\t\t\t\t<td class=\"narrowColumn\">Copy</td>\n\t\t\t\t\t<td class=\"narrowColumn\">View</td>\n\t\t\t\t</tr>\n\t\t\t\t\n\t\t\t</table>\n\t\t</div>\t\t\n\n\t</div>\n\t<!-- END access TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins")+"sharing/css/access.css"],parentWidget:null,accessRows:new Array,rights:["groupwrite","groupcopy","groupview","worldwrite","worldcopy","worldview"],constructor:function(args){this.parentWidget=args.parentWidget;this.tabContainer=args.tabContainer;this.loadCSS();},postMixInProperties:function(){},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.tabContainer.addChild(this.accessTab);this.tabContainer.selectChild(this.accessTab);this.buildTable();Agua.updater.subscribe(this,"updateGroups");},updateGroups:function(args){this.buildTable();},buildTable:function(){var _f1c=Agua.getAccess();if(this.table.childNodes){while(this.table.childNodes.length>2){this.table.removeChild(this.table.childNodes[2]);}}this.tableRows=[];for(var _f1d=0;_f1d<_f1c.length;_f1d++){_f1c[_f1d].parentWidget=this;var _f1e=new plugins.sharing.AccessRow(_f1c[_f1d]);this.table.appendChild(_f1e.row);this.tableRows.push(_f1e);}},togglePermission:function(_f1f){var _f20=_f1f.target.parentNode;var _f21=_f1f.target.getAttribute("class");if(_f21.match("allowed")){dojo.removeClass(_f1f.target,"allowed");dojo.addClass(_f1f.target,"denied");}else{dojo.removeClass(_f1f.target,"denied");dojo.addClass(_f1f.target,"allowed");}},saveAccess:function(){var _f22=new Array;for(var i=0;i<this.tableRows.length;i++){var data=new Object;data.owner=Agua.cookie("username");data.groupname=this.tableRows[i].args.groupname;for(var j=1;j<this.rights.length;j++){data[this.rights[j]]=0;if(dojo.hasClass(this.tableRows[i][this.rights[j]],"allowed")){data[this.rights[j]]=1;}}_f22.push(data);}var url=Agua.cgiUrl+"sharing.cgi";var _f23=new Object;_f23.username=Agua.cookie("username");_f23.sessionid=Agua.cookie("sessionid");_f23.mode="saveAccess";_f23.data=_f22;dojo.xhrPut({url:url,contentType:"text",putData:dojo.toJson(_f23),handle:function(_f24,_f25){Agua.toast(_f24);}});}});}if(!dojo._hasResource["plugins.sharing.Sharing"]){dojo._hasResource["plugins.sharing.Sharing"]=true;dojo.provide("plugins.sharing.Sharing");dojo.declare("plugins.sharing.Sharing",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n\t<!-- ADMIN TAB -->\n\t<div\n        dojoAttachPoint=\"mainTab\"\n        class=\"sharing\"\n\t\ticonClass=\"sharingIcon\"\n        style=\"min-width: 1140px !important; width: 100% !important; height:100% !important; max-height: auto !important; padding: 0px; background: #FFF;\"\n        dojoType=\"dijit.layout.BorderContainer\"\n\t\tclosable=\"true\"\t\t\n        title=\"Sharing\"\n        >\n        \n        <!-- LEFT PANE -->\n        <div\n            dojoAttachPoint=\"leftPane\"\n            class=\"leftPane\"\n\t\t\tlayoutAlign=\"left\" \n            dojoType=\"dijit.layout.ContentPane\" \n            style=\"position: absolute !important; width: 390px; height: 100% !important; max-height: auto !important; min-width: 25px; background: #FFF; padding: 0; border: none !important;\"\n            >\n\n            <!-- LEFT TAB CONTAINER-->\n            <div dojoAttachPoint=\"leftTabContainer\"\n                dojoType=\"dijit.layout.TabContainer\"\n                style=\"height: 100%; overflow: visible;\"\n                class=\"infoPane\">\n\n            </div>\n            <!-- END OF LEFT TAB CONTAINER-->\n\t\t\t\n        </div>\n        <!-- END OF LEFT PANE -->\n\n        <!-- MIDDLE PANE -->\n        <div\n            dojoAttachPoint=\"middlePane\"\n\t\t\tlayoutAlign=\"middle\" \n\t\t\tclass=\"middlePane\"\n            dojoType=\"dijit.layout.ContentPane\" \n            style=\"position: absolute !important; left: 390px !important; height: 100% !important; max-height: auto !important; width: 390px; min-width: 25px; background: #FFF; padding: 0; border: none !important;\"\n            >\n\n            <!-- MIDDLE TAB CONTAINER-->\n            <div\n                dojoAttachPoint=\"middleTabContainer\"\n                dojoType=\"dijit.layout.TabContainer\"\n                style=\"height: 100%; overflow: visible;\"\n                class=\"infoPane\">\n\n            </div>\n\n        </div>\n        <!-- END OF MIDDLE PANE -->\n\n\n        <!-- RIGHT PANE -->\n        <div\n            dojoAttachPoint=\"rightPane\" \n            class=\"rightPane\"\n\t\t\tlayoutAlign=\"right\"\n            dojoType=\"dijit.layout.ContentPane\" \n            style=\"position: absolute !important; left: 780px !important; height: 100% !important; max-height: auto !important; width: 370px !important; min-width: 25px; background: #FFF; padding: 0; border: none !important;\"\n            >\n\n            <!-- RIGHT TAB CONTAINER-->\n            <div dojoAttachPoint=\"rightTabContainer\"\n                dojoType=\"dijit.layout.TabContainer\"\n                style=\"height: 100%; overflow: visible; width: 370px !important; \"\n                class=\"infoPane\">\n\n            </div>\n            <!-- END OF RIGHT TAB CONTAINER-->\n\n        </div>\n        <!-- END OF RIGHT PANE -->\n\n\t</div>\n\t<!-- END OF ADMIN TAB -->\n\n</div>\n",widgetsInTemplate:true,paneWidgets:null,core:new Object,cssFiles:[dojo.moduleUrl("plugins","sharing/css/sharing.css")],modules:{"Apps":"plugins.sharing.Apps","GroupProjects":"plugins.sharing.GroupProjects","Settings":"plugins.sharing.Settings","Clusters":"plugins.sharing.Clusters","Amis":"plugins.sharing.Amis","Parameters":"plugins.sharing.Parameters","Packages":"plugins.sharing.Packages","Groups":"plugins.sharing.Groups","Projects":"plugins.sharing.Projects","Access":"plugins.sharing.Access","GroupSources":"plugins.sharing.GroupSources","GroupUsers":"plugins.sharing.GroupUsers","Sources":"plugins.sharing.Sources","Users":"plugins.sharing.Users"},constructor:function(args){this.loadCSS();},postCreate:function(){this.startup();},startup:function(){Agua.addWidget("sharing",this);Agua.tabs.addChild(this.mainTab);Agua.tabs.selectChild(this.mainTab);this.paneWidgets=new Object;this.headings=Agua.getSharingHeadings();this.loadPanes();},reload:function(_f26){if(_f26=="all"){for(var _f27 in this.headings){for(var i in this.headings[_f27]){this.reloadWidget(this.headings[_f27][i]);}}}else{if(_f26=="leftPane"||_f26=="middlePane"||_f26=="rightPane"){for(var i in this.headings[_f26]){this.reloadWidget(this.headings[_f26][i]);}}else{try{this.reloadWidget(_f26);}catch(e){}}}},reloadWidget:function(_f28){delete this.paneWidgets[_f28];var _f29=this;this.paneWidgets[_f28]=new plugins.sharing[_f28]({parentWidget:_f29,tabContainer:_f29.leftTabContainer});},loadPanes:function(){var _f2a=["left","middle","right"];for(var i=0;i<_f2a.length;i++){this.loadPane(_f2a[i]);}},loadPane:function(side){var pane=side+"Pane";var _f2b=side+"TabContainer";if(this.headings==null||this.headings[pane]==null){return;}for(var i=0;i<this.headings[pane].length;i++){var _f2c=this.headings[pane][i];console.log("Sharing.loadPane    dojo.require tabPaneName: "+_f2c);var _f2d=this.modules[_f2c];console.log("Sharing.loadPane    BEFORE dojo.require moduleName: "+_f2d);dojo["require"](_f2d);console.log("Sharing.loadPane    AFTER dojo.require moduleName: "+_f2d);var _f2e=this;var _f2f=new plugins["sharing"][_f2c]({parentWidget:_f2e,tabContainer:_f2e[_f2b]});if(this.paneWidgets[_f2d]==null){this.paneWidgets[_f2d]=new Array;}this.paneWidgets[_f2d].push(_f2f);}},destroyRecursive:function(){console.log("Sharing.destroyRecursive    this.mainTab: ");console.dir({this_mainTab:this.mainTab});if(Agua&&Agua.tabs){Agua.tabs.removeChild(this.mainTab);}this.inherited(arguments);}});}if(!dojo._hasResource["plugins.sharing.Controller"]){dojo._hasResource["plugins.sharing.Controller"]=true;dojo.provide("plugins.sharing.Controller");var sharingController;dojo.declare("plugins.sharing.Controller",[dijit._Widget,dijit._Templated],{paneId:null,templateString:"<div dojoAttachPoint=\"containerNode\" class=\"sharing\">\n    <button\n        dojoType=\"dijit.form.Button\"\n        dojoAttachPoint=\"menuButton\"\n        class=\"menuButton\"\n        iconClass=\"sharingIcon\"\n        type=\"button\"\n        label=\"Sharing\"\n        ></button>\n</div>\n        \n",widgetsInTemplate:true,tabPanes:[],constructor:function(args){this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);Agua.toolbar.addChild(this.menuButton);this.menuButton.parentWidget=this;var _f30=dojo.connect(this.menuButton,"onClick",this,"createTab");},createTab:function(){var _f31=new plugins.sharing.Sharing({});this.tabPanes.push(_f31);this._supportingWidgets.push(_f31);},createMenu:function(){var _f32=new dijit.Menu({id:"sharing"+this.paneId+"dynamicMenuPopup"});_f32.addChild(new dijit.MenuItem({label:"Application Menu",disabled:false}));_f32.addChild(new dijit.MenuSeparator());var _f33=new dijit.MenuItem({id:"sharing"+this.paneId+"remove",label:"Remove",disabled:false});_f32.addChild(_f33);dojo.connect(_f33,"onClick",function(){var _f34=_f32.currentTarget.parentNode;_f34.removeChild(_f32.currentTarget);});_f32.addChild(new dijit.MenuSeparator());var _f35=new dijit.MenuItem({id:"sharing"+this.paneId+"run",label:"Run",disabled:false});_f32.addChild(_f35);dojo.connect(_f35,"onClick",function(){var _f36=_f32.currentTarget;var _f37=_f36.parentNode;});return _f32;},loadCSS:function(){var _f38=["plugins/sharing/css/controller.css"];for(var i in _f38){var _f39=_f38[i];var _f3a=document.createElement("link");_f3a.type="text/css";_f3a.rel="stylesheet";_f3a.href=_f39;_f3a.media="screen";document.getElementsByTagName("head")[0].appendChild(_f3a);}}});dojo.addOnLoad(function(){});}if(!dojo._hasResource["plugins.sharing.GroupProjectRow"]){dojo._hasResource["plugins.sharing.GroupProjectRow"]=true;dojo.provide("plugins.sharing.GroupProjectRow");dojo.declare("plugins.sharing.GroupProjectRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table width=\"100%\" cellspacing=\"0px\">\n        <tr width=\"100%\">\n            <td\n                colspan=\"2\"\n                dojoAttachPoint=\"name\"\n                class=\"name\"\n                >\n                ${name}</td>\n        </tr>\n        <tr>\n            <td colspan=\"2\"\n                dojoAttachPoint=\"description\"\n                class=\"description\"\n                style=\"display: none;\"\n                >${description}</td>\n        </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);var _f3b=this;dojo.connect(this.name,"onclick",function(_f3c){_f3b.toggle();_f3c.stopPropagation();});},toggle:function(){if(this.description.style.display=="block"){this.description.style.display="none";}else{this.description.style.display="block";}}});}if(!dojo._hasResource["dijit.form.VerticalSlider"]){dojo._hasResource["dijit.form.VerticalSlider"]=true;dojo.provide("dijit.form.VerticalSlider");dojo.declare("dijit.form.VerticalSlider",dijit.form.HorizontalSlider,{templateString:dojo.cache("dijit.form","templates/VerticalSlider.html","<table class=\"dijit dijitReset dijitSlider dijitSliderV\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" rules=\"none\" dojoAttachEvent=\"onkeypress:_onKeyPress,onkeyup:_onKeyUp\"\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\"></td\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerV\"\n\t\t\t><div class=\"dijitSliderIncrementIconV\" style=\"display:none\" dojoAttachPoint=\"decrementButton\"><span class=\"dijitSliderButtonInner\">+</span></div\n\t\t></td\n\t\t><td class=\"dijitReset\"></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\"></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><center><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperV dijitSliderTopBumper\" dojoAttachEvent=\"onmousedown:_onClkIncBumper\"></div></center\n\t\t></td\n\t\t><td class=\"dijitReset\"></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td dojoAttachPoint=\"leftDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationL dijitSliderDecorationV\"></td\n\t\t><td class=\"dijitReset dijitSliderDecorationC\" style=\"height:100%;\"\n\t\t\t><input dojoAttachPoint=\"valueNode\" type=\"hidden\" ${!nameAttrSetting}\n\t\t\t/><center class=\"dijitReset dijitSliderBarContainerV\" role=\"presentation\" dojoAttachPoint=\"sliderBarContainer\"\n\t\t\t\t><div role=\"presentation\" dojoAttachPoint=\"remainingBar\" class=\"dijitSliderBar dijitSliderBarV dijitSliderRemainingBar dijitSliderRemainingBarV\" dojoAttachEvent=\"onmousedown:_onBarClick\"><!--#5629--></div\n\t\t\t\t><div role=\"presentation\" dojoAttachPoint=\"progressBar\" class=\"dijitSliderBar dijitSliderBarV dijitSliderProgressBar dijitSliderProgressBarV\" dojoAttachEvent=\"onmousedown:_onBarClick\"\n\t\t\t\t\t><div class=\"dijitSliderMoveable dijitSliderMoveableV\" style=\"vertical-align:top;\"\n\t\t\t\t\t\t><div dojoAttachPoint=\"sliderHandle,focusNode\" class=\"dijitSliderImageHandle dijitSliderImageHandleV\" dojoAttachEvent=\"onmousedown:_onHandleClick\" role=\"slider\" valuemin=\"${minimum}\" valuemax=\"${maximum}\"></div\n\t\t\t\t\t></div\n\t\t\t\t></div\n\t\t\t></center\n\t\t></td\n\t\t><td dojoAttachPoint=\"containerNode,rightDecoration\" class=\"dijitReset dijitSliderDecoration dijitSliderDecorationR dijitSliderDecorationV\"></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\"></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><center><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperV dijitSliderBottomBumper\" dojoAttachEvent=\"onmousedown:_onClkDecBumper\"></div></center\n\t\t></td\n\t\t><td class=\"dijitReset\"></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\"></td\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerV\"\n\t\t\t><div class=\"dijitSliderDecrementIconV\" style=\"display:none\" dojoAttachPoint=\"incrementButton\"><span class=\"dijitSliderButtonInner\">-</span></div\n\t\t></td\n\t\t><td class=\"dijitReset\"></td\n\t></tr\n></table>\n"),_mousePixelCoord:"pageY",_pixelCount:"h",_startingPixelCoord:"y",_startingPixelCount:"t",_handleOffsetCoord:"top",_progressPixelSize:"height",_descending:true,_isReversed:function(){return this._descending;}});}if(!dojo._hasResource["dijit.form.HorizontalRule"]){dojo._hasResource["dijit.form.HorizontalRule"]=true;dojo.provide("dijit.form.HorizontalRule");dojo.declare("dijit.form.HorizontalRule",[dijit._Widget,dijit._Templated],{templateString:"<div class=\"dijitRuleContainer dijitRuleContainerH\"></div>",count:3,container:"containerNode",ruleStyle:"",_positionPrefix:"<div class=\"dijitRuleMark dijitRuleMarkH\" style=\"left:",_positionSuffix:"%;",_suffix:"\"></div>",_genHTML:function(pos,ndx){return this._positionPrefix+pos+this._positionSuffix+this.ruleStyle+this._suffix;},_isHorizontal:true,buildRendering:function(){this.inherited(arguments);var _f3d;if(this.count==1){_f3d=this._genHTML(50,0);}else{var i;var _f3e=100/(this.count-1);if(!this._isHorizontal||this.isLeftToRight()){_f3d=this._genHTML(0,0);for(i=1;i<this.count-1;i++){_f3d+=this._genHTML(_f3e*i,i);}_f3d+=this._genHTML(100,this.count-1);}else{_f3d=this._genHTML(100,0);for(i=1;i<this.count-1;i++){_f3d+=this._genHTML(100-_f3e*i,i);}_f3d+=this._genHTML(0,this.count-1);}}this.domNode.innerHTML=_f3d;}});}if(!dojo._hasResource["dijit.form.VerticalRule"]){dojo._hasResource["dijit.form.VerticalRule"]=true;dojo.provide("dijit.form.VerticalRule");dojo.declare("dijit.form.VerticalRule",dijit.form.HorizontalRule,{templateString:"<div class=\"dijitRuleContainer dijitRuleContainerV\"></div>",_positionPrefix:"<div class=\"dijitRuleMark dijitRuleMarkV\" style=\"top:",_isHorizontal:false});}if(!dojo._hasResource["dijit.form.HorizontalRuleLabels"]){dojo._hasResource["dijit.form.HorizontalRuleLabels"]=true;dojo.provide("dijit.form.HorizontalRuleLabels");dojo.declare("dijit.form.HorizontalRuleLabels",dijit.form.HorizontalRule,{templateString:"<div class=\"dijitRuleContainer dijitRuleContainerH dijitRuleLabelsContainer dijitRuleLabelsContainerH\"></div>",labelStyle:"",labels:[],numericMargin:0,minimum:0,maximum:1,constraints:{pattern:"#%"},_positionPrefix:"<div class=\"dijitRuleLabelContainer dijitRuleLabelContainerH\" style=\"left:",_labelPrefix:"\"><div class=\"dijitRuleLabel dijitRuleLabelH\">",_suffix:"</div></div>",_calcPosition:function(pos){return pos;},_genHTML:function(pos,ndx){return this._positionPrefix+this._calcPosition(pos)+this._positionSuffix+this.labelStyle+this._labelPrefix+this.labels[ndx]+this._suffix;},getLabels:function(){var _f3f=this.labels;if(!_f3f.length){_f3f=dojo.query("> li",this.srcNodeRef).map(function(node){return String(node.innerHTML);});}this.srcNodeRef.innerHTML="";if(!_f3f.length&&this.count>1){var _f40=this.minimum;var inc=(this.maximum-_f40)/(this.count-1);for(var i=0;i<this.count;i++){_f3f.push((i<this.numericMargin||i>=(this.count-this.numericMargin))?"":dojo.number.format(_f40,this.constraints));_f40+=inc;}}return _f3f;},postMixInProperties:function(){this.inherited(arguments);this.labels=this.getLabels();this.count=this.labels.length;}});}if(!dojo._hasResource["dijit.form.VerticalRuleLabels"]){dojo._hasResource["dijit.form.VerticalRuleLabels"]=true;dojo.provide("dijit.form.VerticalRuleLabels");dojo.declare("dijit.form.VerticalRuleLabels",dijit.form.HorizontalRuleLabels,{templateString:"<div class=\"dijitRuleContainer dijitRuleContainerV dijitRuleLabelsContainer dijitRuleLabelsContainerV\"></div>",_positionPrefix:"<div class=\"dijitRuleLabelContainer dijitRuleLabelContainerV\" style=\"top:",_labelPrefix:"\"><span class=\"dijitRuleLabel dijitRuleLabelV\">",_calcPosition:function(pos){return 100-pos;},_isHorizontal:false});}if(!dojo._hasResource["dijit.form.Slider"]){dojo._hasResource["dijit.form.Slider"]=true;dojo.provide("dijit.form.Slider");dojo.deprecated("Call require() for HorizontalSlider / VerticalRule, explicitly rather than 'dijit.form.Slider' itself","","2.0");}if(!dojo._hasResource["plugins.sharing.GroupProjects"]){dojo._hasResource["plugins.sharing.GroupProjects"]=true;dojo.provide("plugins.sharing.GroupProjects");dojo.declare("plugins.sharing.GroupProjects",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- groupprojects TAB -->\n\t<div\n\t\tdojoAttachPoint=\"groupprojectsTab\"\n\t\tclass=\"groupprojects\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Group Projects\"\n\t\tstyle=\"height: 100% !important; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t\t>\n\n\t\t<table width=\"100%\">\n\t\t\t<tr>\n\t\t\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\"> Group Projects </td>\n\t\t\t</tr>\n\t\t\t<tr valign=\"top\">\n\t\t\t\t<td width=\"50%\">\n\t\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t\t\t\t<!-- GROUP COMBO -->\n\t\t\t\t\t\t\t\t<div class=\"comboLabel\"> Groups </div>\n\t\t\t\t\t\t\t\t<div dojoAttachPoint=\"groupCombo\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\t\t\tclass=\"groupCombo\"\n\t\t\t\t\t\t\t\t\t\tpopupClass=\"groupprojects groupCombo dijitReset dijitMenu\"\n\t\t\t\t\t\t\t\t\t\tautocomplete=\"true\"\n\t\t\t\t\t\t\t\t\t\thasDownArrow=\"true\"\n\t\t\t\t\t\t\t\t\t\tdisabled=\"false\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 150px;\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t\t\t\t<!-- DROP TARGET CONTAINER -->\n\t\t\t\t\t\t\t\t<div class=\"comboLabel\"> Group Projects </div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"dropTargetContainer\"\n\t\t\t\t\t\t\t\t\tclass=\"dropTarget\"\n\t\t\t\t\t\t\t\t\tstyle=\"height: 615px; width: 180px;\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t\t<td width=\"50%\">\n\t\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\">\n\t\t\t\t\t\t\t\t<div class=\"comboLabel\"> Projects </div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"dragSourceSlider\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.HorizontalSlider\" \n\t\t\t\t\t\t\t\t\tvalue=\"0\"\n\t\t\t\t\t\t\t\t\tmaximum=\"100\"\n\t\t\t\t\t\t\t\t\tminimum=\"0\"\n\t\t\t\t\t\t\t\t\tpageIncrement=\"100\"\n\t\t\t\t\t\t\t\t\tshowButtons=\"true\"\n\t\t\t\t\t\t\t\t\tintermediateChanges=\"true\"\n\t\t\t\t\t\t\t\t\tslideDuration=\"200\"\n\t\t\t\t\t\t\t\t\tstyle=\"width: 150px;\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t\t\t\t<!-- DRAG SOURCE CONTAINER -->\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"dragSourceContainer\"\n\t\t\t\t\t\t\t\t\tclass=\"dragSource\"\n\t\t\t\t\t\t\t\t\tstyle=\"height: 553px; width: 150px;\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr align=\"center\">\n\t\t\t\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t\t\t\t<!-- TRASH CONTAINER -->\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"trashContainer\"\n\t\t\t\t\t\t\t\t\tclass=\"trash\"\n\t\t\t\t\t\t\t\t\tstyle=\"height: 60px; width: 150px; align: center;\" \n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"trashIcon\"\n\t\t\t\t\t\t\t\t\t\tclass=\"trashIcon\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"height: 60px; width: 60px;\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\n\t</div>\n\t<!-- END groupprojects TAB -->\n\t\n</div> \n",widgetsInTemplate:true,addingSource:false,cssFiles:["plugins/sharing/css/groupprojects.css"],parentWidget:null,constructor:function(args){this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.tabContainer.addChild(this.groupprojectsTab);this.tabContainer.selectChild(this.groupprojectsTab);this.setGroupCombo();this.setDragSource();this.setDragSourceSlider();this.setDropTarget();this.setTrash();Agua.updater.subscribe(this,"updateGroups");Agua.updater.subscribe(this,"updateProjects");},updateGroups:function(args){this.reload();},updateProjects:function(args){this.reload();},reload:function(){this.setGroupCombo();this.setDragSource();this.setDropTarget();},setGroupCombo:function(){var _f41=Agua.getGroupNames();var data={identifier:"name",items:[]};for(var i=0;i<_f41.length;i++){data.items[i]={name:_f41[i]};}var _f42=new dojo.data.ItemFileWriteStore({data:data});this.groupCombo.popupClass="groupprojects groupCombo dijitReset dijitMenu";this.groupCombo.wrapperClass="groupprojects dijitPopup";this.groupCombo.itemHeight=30;this.groupCombo.store=_f42;this.groupCombo.startup();var _f43=_f41[0];this.groupCombo.setValue(_f43);var _f44=this;dojo.connect(this.groupCombo,"onChange",function(_f45){_f44.setDropTarget();});},setDragSource:function(_f46){while(this.dragSourceContainer.firstChild){if(dijit.byNode(this.dragSourceContainer)&&dijit.byNode(this.dragSourceContainer).destroy){dijit.byNode(this.dragSourceContainer).destroy();}this.dragSourceContainer.removeChild(this.dragSourceContainer.firstChild);}if(_f46==null){_f46=0;}if(Agua.getProjects()==null||Agua.getProjects().length==0){return;}var _f47=Agua.getProjects();var _f48=this.maxDisplayedProjects;var _f49=(_f47.length-_f48)/100;_f49=_f49?_f49:1;var _f4a=parseInt(_f46*_f49);var end=parseInt((_f46*_f49)+_f48);if(!end||end>_f47.length){end=_f47.length;}var _f4b=new Array;for(var j=_f4a;j<end;j++){var data=_f47[j];data.toString=function(){return this.name;};_f4b.push({data:data,type:["draggableItem"]});}var _f4c=new dojo.dnd.Source(this.dragSourceContainer,{copyOnly:true,selfAccept:false,accept:["none"]});_f4c.insertNodes(false,_f4b);var _f4d=_f4c.getAllNodes();for(var k=0;k<_f4d.length;k++){var node=_f4d[k];node.name=_f4b[k].data.name;node.description=_f4b[k].data.description;if(node.description==null){node.description="";}if(node.description==null){node.description="";}if(node.name!=null&&node.name!=""){var _f4e={name:node.name,description:node.description};_f4e.parentWidget=this;var _f4f=new plugins.sharing.GroupProjectRow(_f4e);node.innerHTML="";node.appendChild(_f4f.domNode);}}var _f50=this;_f4c.creator=function(item,hint){var node=dojo.doc.createElement("div");node.name=item.name;node.description=item.description;node.id=dojo.dnd.getUniqueId();node.className="dojoDndItem";node.innerHTML="<table> <tr><td> <img src='http://localhost/agua/plugins/sharing/images/users-18.png' <strong style='color: darkred'>"+node.name+"</strong></td></tr><tr><td> "+node.description+"</td></tr></table>";return {node:node,data:item,type:["text"]};};},setDragSourceSlider:function(){var _f51=this;dojo.connect(this.dragSourceSlider,"onMouseUp",dojo.hitch(this,function(e){var _f52=parseInt(this.dragSourceSlider.getValue());this.setDragSource(_f52);}));},setDropTarget:function(){while(this.dropTargetContainer.firstChild){this.dropTargetContainer.removeChild(this.dropTargetContainer.firstChild);}var _f53=this.groupCombo.getValue();var _f54=Agua.getProjectsByGroup(_f53);if(_f54==null){return;}var _f55=new Array;for(var j=0;j<_f54.length;j++){var data=_f54[j];data.toString=function(){return this.name;};var _f56=_f54[j].description;_f55.push({data:data,type:["draggableItem"],description:_f56});}var _f57=new dojo.dnd.Source(this.dropTargetContainer,{accept:["draggableItem"]});_f57.insertNodes(false,_f55);var _f58=_f57.getAllNodes();for(var k=0;k<_f58.length;k++){var node=_f58[k];var _f59=_f55[k].type;dojo.addClass(node,_f59);node.name=_f55[k].data.name;node.description=_f55[k].data.description;var _f5a={name:node.name,description:node.description};_f5a.parentWidget=this;var _f5b=new plugins.sharing.GroupProjectRow(_f5a);node.innerHTML="";node.appendChild(_f5b.domNode);}var _f5c=this;_f57.creator=function(item,hint){var name=item.projectname?item.projectname:item.name;var _f5d=item.projectdesc?item.projectdesc:item.description;if(name==null||name==""){return;}if(_f5d==null){_f5d="";}var node=dojo.doc.createElement("div");node.name=name;node.description=_f5d;node.id=dojo.dnd.getUniqueId();node.className="dojoDndItem";var _f5e={name:name,description:_f5d};_f5e.parentWidget=this;var _f5f=new plugins.sharing.GroupProjectRow(_f5e);node.innerHTML="";node.appendChild(_f5f.domNode);if(hint!="avatar"){_f5c.addToGroup(node.name,node.description,node.name);}return {node:node,data:item,type:["draggableItem"]};};dojo.connect(_f57,"onDndDrop",function(_f60,_f61,copy,_f62){if(_f60==this&&_f62!=this){for(var i=0;i<_f61.length;i++){var node=_f61[i];_f5c.removeFromGroup(node.name,node.description,node.location);}}else{}var _f63=_f57.getAllNodes();if(_f63==null||!_f63){console.log("GroupProjects.setDropTarget dojo.connect onDndDrop    currentNodes is null or empty. Returning");return;}var _f64=new Object;console.log("GroupProjects.setDropTarget dojo.connect onDndDrop    Checking for duplicate nodes");for(var i=0;i<_f63.length;i++){var node=_f63[i];if(!_f64[node.name]){_f64[node.name]=1;}else{try{console.log("GroupProjects.setDropTarget dojo.connect onDndDrop    Removing duplicate node: "+node.name);node.parentNode.removeChild(node);}catch(e){}}}});},addToGroup:function(name,_f65,_f66){var _f67=new Object;_f67.username=Agua.cookie("username");_f67.name=name;_f67.description=_f65;_f67.location=_f66;_f67.username=Agua.cookie("username");var _f68=this.groupCombo.getValue();var _f69=Agua.addProjectToGroup(_f68,_f67);if(_f69==false){return;}var data=new Object;data.name=name;data.description=_f65;data.location=_f66;data.groupname=_f68;data.type="project";var url=Agua.cgiUrl+"sharing.cgi";var _f6a=new Object;_f6a.username=Agua.cookie("username");_f6a.sessionid=Agua.cookie("sessionid");_f6a.data=data;_f6a.mode="addToGroup";var _f6b=dojo.toJson(_f6a).replace(/undefined/g,"\"\"");dojo.xhrPut({url:url,contentType:"text",sync:false,handleAs:"json",putData:_f6b,timeout:15000,load:function(data){},error:function(_f6c,_f6d){return _f6c;}});},removeFromGroup:function(name,_f6e,_f6f){var _f70=this.groupCombo.getValue();var _f71=new Object;_f71.name=name;_f71.description=_f6e;_f71.location=_f6f;_f71.username=Agua.cookie("username");if(Agua.removeProjectFromGroup(_f70,_f71)==false){return;}var data=new Object;data.name=String(name);data.description=_f6e;data.location=_f6f;data.groupname=_f70;data.type="project";var url=Agua.cgiUrl+"sharing.cgi";var _f72=new Object;_f72.username=Agua.cookie("username");_f72.sessionid=Agua.cookie("sessionid");_f72.data=data;_f72.mode="removeFromGroup";var _f73=dojo.toJson(_f72).replace(/undefined/g,"\"\"");dojo.xhrPut({url:url,contentType:"text",sync:false,handleAs:"json",putData:_f73,timeout:15000,load:function(data){},error:function(_f74,_f75){return _f74;}});},setTrash:function(){var _f76=new dojo.dnd.Source(this.trashContainer,{accept:["draggableItem"]});dojo.connect(_f76,"onDndDrop",function(_f77,_f78,copy,_f79){if(_f79==this){var _f7a=_f76.getAllNodes();for(var i=0;i<_f7a.length;i++){var node=_f7a[i];try{node.parentNode.removeChild(node);}catch(e){}}}});}});}if(!dojo._hasResource["plugins.sharing.GroupRow"]){dojo._hasResource["plugins.sharing.GroupRow"]=true;dojo.provide("plugins.sharing.GroupRow");dojo.declare("plugins.sharing.GroupRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table width=\"100%\">\n        <tr>\n            <td\n                dojoAttachPoint=\"groupname\"\n                class=\"groupname\"\n                >\n                ${groupname}</td>\n        </tr>\n        <tr>\n            <td\n                dojoAttachPoint=\"description\"\n                class='description'\n                style=\"display: none;\" >${description}</td>\n        </tr>\n        <tr>\n            <td\n                dojoAttachPoint=\"notes\"\n                class='notes'\n                style=\"display: none;\">${notes}</td>\n        </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;},postCreate:function(){this.formInputs=this.parentWidget.formInputs;this.startup();},startup:function(){this.inherited(arguments);var _f7b=this;dojo.connect(this.groupname,"onclick",function(_f7c){_f7b.toggle();_f7c.stopPropagation();});dojo.connect(this.description,"onclick",function(_f7d){_f7b.parentWidget.editRow(_f7b,_f7d.target);});dojo.connect(this.notes,"onclick",function(_f7e){_f7b.parentWidget.editRow(_f7b,_f7e.target);});},toggle:function(){if(this.description.style.display=="block"){this.description.style.display="none";}else{this.description.style.display="block";}if(this.notes.style.display=="block"){this.notes.style.display="none";}else{this.notes.style.display="block";}}});}if(!dojo._hasResource["plugins.sharing.GroupSourceRow"]){dojo._hasResource["plugins.sharing.GroupSourceRow"]=true;dojo.provide("plugins.sharing.GroupSourceRow");dojo.declare("plugins.sharing.GroupSourceRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table width=\"100%\" cellspacing=\"0px\">\n        <tr>\n            <td colspan=\"2\"\n                dojoAttachPoint=\"name\"\n                class=\"name\"\n                >\n                ${name}</td>\n        </tr>\n        <tr>\n            <td colspan=\"2\"\n                dojoAttachPoint=\"description\"\n                class=\"description\"\n                style=\"display: none;\"\n                >${description}</td>\n        </tr>\n        <!--<tr>-->\n        <!--    <td-->\n        <!--        dojoAttachPoint=\"location\"-->\n        <!--        class='location'-->\n        <!--        style=\"display: block;\"-->\n        <!--        >${location}</td>-->\n        <!--</tr>-->\n\n    </table>\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){console.log("GroupSourceRow.constructor    args:");console.dir({args:args});this.parentWidget=args.parentWidget;},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);var _f7f=this;dojo.connect(this.name,"onclick",function(_f80){_f7f.toggle();_f80.stopPropagation();});},toggle:function(){if(this.description.style.display=="block"){this.description.style.display="none";}else{this.description.style.display="block";}}});}if(!dojo._hasResource["plugins.sharing.GroupSources"]){dojo._hasResource["plugins.sharing.GroupSources"]=true;dojo.provide("plugins.sharing.GroupSources");dojo.declare("plugins.sharing.GroupSources",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- SOURCES TAB -->\n\t<div\n\t\tdojoAttachPoint=\"sourcesTab\"\n\t\tclass=\"groupsources\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Group Sources\"\n\t\tstyle=\"height: 100% !important; max-height: auto !important; width: 370px !important; padding: 0 !important;\"\n\t\t>\n\n\t\t<table width=\"100%\">\n\t\t\t<tr valign=\"top\" width=\"370\">\n\t\t\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\"> Group Sources </td>\n\t\t\t</tr>\n\t\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t\t<td width=\"50%\">\n\t\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t\t\t\t<!-- GROUP COMBO -->\n\t\t\t\t\t\t\t\t<div class=\"comboLabel\"> Groups </div>\n\t\t\t\t\t\t\t\t<div dojoAttachPoint=\"groupCombo\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\t\t\tclass=\"groupCombo\"\n\t\t\t\t\t\t\t\t\t\tpopupClass=\"sources groupCombo dijitReset dijitMenu\"\n\t\t\t\t\t\t\t\t\t\tautocomplete=\"true\"\n\t\t\t\t\t\t\t\t\t\thasDownArrow=\"true\"\n\t\t\t\t\t\t\t\t\t\tdisabled=\"false\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 150px;\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t\t\t\t<!-- DROP TARGET CONTAINER -->\n\t\t\t\t\t\t\t\t<div class=\"comboLabel\"> Group Sources </div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"dropTargetContainer\"\n\t\t\t\t\t\t\t\t\tclass=\"dropTarget\"\n\t\t\t\t\t\t\t\t\tstyle=\"height: 622px; width: 160px;\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t\t<td width=\"50%\">\n\t\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t\t\t\t<!-- DRAG SOURCE CONTAINER -->\n\t\t\t\t\t\t\t\t<div class=\"comboLabel\"> Sources </div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"dragSourceContainer\"\n\t\t\t\t\t\t\t\t\tclass=\"dragSource\"\n\t\t\t\t\t\t\t\t\tstyle=\"height: 580px; width: 160px;\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr align=\"center\">\n\t\t\t\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t\t\t\t<!-- TRASH CONTAINER -->\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"trashContainer\"\n\t\t\t\t\t\t\t\t\tclass=\"trash\"\n\t\t\t\t\t\t\t\t\tstyle=\"height: 60px; width: 150px; align: center;\" \n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"trashIcon\"\n\t\t\t\t\t\t\t\t\t\tclass=\"trashIcon\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"height: 60px; width: 60px;\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\n\t</div>\n\t<!-- END SOURCES TAB -->\n\t\n</div> \n",widgetsInTemplate:true,addingSource:false,cssFiles:["plugins/sharing/css/groupsources.css"],parentWidget:null,constructor:function(args){this.loadCSS();},postCreate:function(){this.startup();},startup:function(){console.log("GroupSources.startup    plugins.sharing.GroupSources.start()");this.inherited(arguments);this.tabContainer.addChild(this.sourcesTab);this.setGroupCombo();this.setDragSource();this.createDropTarget();this.setDropTarget();this.setTrash();Agua.updater.subscribe(this,"updateGroups");Agua.updater.subscribe(this,"updateSources");},updateGroups:function(args){console.log("sharing.GroupSources.updateGroups    sharing.GroupSources.updateGroups(args)");console.log("sharing.GroupSources.updateGroups    args:");console.dir(args);this.reload();},updateSources:function(args){console.log("sharing.GroupSources.updateSources    sharing.GroupSources.updateSources(args)");console.log("sharing.GroupSources.updateSources    args:");console.dir(args);this.reload();},reload:function(){console.log("sharing.GroupSources.reload    sharing.GroupSources.reload()");this.setGroupCombo();this.setDragSource();this.setDropTarget();},setGroupCombo:function(){console.log("GroupSources.setGroupCombo     plugins.sharing.GroupSources.setGroupCombo()");var _f81=Agua.getGroupNames();console.log("GroupSources.setGroupCombo     groupNames: "+dojo.toJson(_f81));var data={identifier:"name",items:[]};for(var i=0;i<_f81.length;i++){data.items[i]={name:_f81[i]};}console.log("GroupSources.setGroupCombo     data: "+dojo.toJson(data));var _f82=new dojo.data.ItemFileWriteStore({data:data});this.groupCombo.popupClass="groupsources groupCombo dijitReset dijitMenu";this.groupCombo.wrapperClass="groupsources dijitPopup";this.groupCombo.itemHeight=30;this.groupCombo.store=_f82;this.groupCombo.startup();console.log("GroupSources.setGroupCombo::setCombo     AFTER this.groupCombo.startup()");var _f83=_f81[0];this.groupCombo.setValue(_f83);console.log("GroupSources.setGroupCombo::setCombo     AFTER this.groupCombo.setValue(firstValue)");var _f84=this;dojo.connect(this.groupCombo,"onChange",function(_f85){_f84.setDropTarget();});},setDragSource:function(){console.log("GroupSources.setDragSource     plugins.sharing.GroupSources.setDragSource()");while(this.dragSourceContainer.firstChild){if(dijit.byNode(this.dragSourceContainer)&&dijit.byNode(this.dragSourceContainer).destroy){dijit.byNode(this.dragSourceContainer).destroy();}this.dragSourceContainer.removeChild(this.dragSourceContainer.firstChild);}var _f86=new Array;var _f87=Agua.getSources();console.log("GroupSources.setDragSource     sourceArray: ");console.dir({sourceArray:_f87});if(_f87==null||!_f87){console.log("GroupSources.setDragSource     sourceArray is null or empty. Returning.");return;}for(var j=0;j<_f87.length;j++){var data=_f87[j];data.toString=function(){return this.name;};_f86.push({data:data,type:["draggableItem"]});}var _f88=new dojo.dnd.Source(this.dragSourceContainer,{copyOnly:true,selfAccept:false,accept:["none"]});_f88.insertNodes(false,_f86);var _f89=_f88.getAllNodes();for(var k=0;k<_f89.length;k++){var node=_f89[k];node.name=_f86[k].data.name;node.description=_f86[k].data.description;node.location=_f86[k].data.location;var _f8a={name:node.name,location:node.location,description:node.description};_f8a.parentWidget=this;var _f8b=new plugins.sharing.GroupSourceRow(_f8a);node.innerHTML="";node.appendChild(_f8b.domNode);}var _f8c=this;_f88.creator=function(item,hint){console.log("GroupSources.setDragSource dragSource.creator         item: "+dojo.toJson(item));var node=dojo.doc.createElement("div");node.name=item.name;node.description=item.description;node.location=item.location;node.id=dojo.dnd.getUniqueId();node.className="dojoDndItem";node.innerHTML="<table> <tr><td><strong style='color: darkred'>"+item.name+"</strong></td></tr><tr><td> "+item.description+"</td></tr></table>";return {node:node,data:item,type:["text"]};};},createDropTarget:function(){this.dropTarget=new dojo.dnd.Source(this.dropTargetContainer,{accept:["draggableItem"]});var _f8d=this;this.dropTarget.creator=function(item,hint){console.log("GroupSources.createDropTarget this.dropTarget.creator         item: ");console.dir({item:item});console.log("GroupSources.createDropTarget this.dropTarget.creator         hint: "+hint);var data=item;if(item.data){data=item.data;}var name=data.name;var _f8e=data.description;var _f8f=data.location;var node=dojo.doc.createElement("div");node.name=name;node.description=_f8e;node.location=_f8f;node.id=dojo.dnd.getUniqueId();node.className="dojoDndItem";var _f90={name:name,description:_f8e,location:_f8f};console.log("GroupUsers.createDropTarget    this.dropTarget.creator    source: ");console.dir({source:_f90});_f90.parentWidget=this;var _f91=new plugins.sharing.GroupSourceRow(_f90);node.innerHTML="";node.appendChild(_f91.domNode);if(hint!="avatar"){_f8d.addToGroup(node.name,node.description,node.location);}return {node:node,data:item,type:["draggableItem"]};};dojo.connect(this.dropTarget,"onDndDrop",function(_f92,_f93,copy,_f94){console.log("GroupSources.createDropTarget dojo.connect onDndDrop    AFTER this.dropTarget.onDndDrop");if(_f92==this){console.log("GroupSources.createDropTarget dojo.connect(onDndDrop)    Node has been moved to trash.");for(var i=0;i<_f93.length;i++){var node=_f93[i];_f8d.removeFromGroup(node.name,node.description,node.location);}}var _f95=_f8d.dropTarget.getAllNodes();if(_f95==null||!_f95){console.log("GroupSources.createDropTarget dojo.connect onDndDrop    currentNodes is null or empty. Returning");return;}var _f96=new Object;for(var i=0;i<_f95.length;i++){var node=_f95[i];if(!_f96[node.name]){_f96[node.name]=1;}else{try{node.parentNode.removeChild(node);}catch(e){}}}});},setDropTarget:function(){console.log("GroupSources.setDropTarget     plugins.sharing.GroupSources.setDropTarget()");while(this.dropTargetContainer.firstChild){console.log("GroupSources.setDropTarget     REMOVING firstChild");this.dropTargetContainer.removeChild(this.dropTargetContainer.firstChild);}var _f97=this.groupCombo.getValue();var _f98=Agua.getSourcesByGroup(_f97);if(_f98==null){console.log("GroupSources.setDropTarget     sourceArray is null or empty. Returning.");return;}console.log("GroupSources.setDropTarget     sourceArray: "+dojo.toJson(_f98,true));if(_f98==null||_f98.length==0){return;}var _f99=new Array;for(var j=0;j<_f98.length;j++){var data=_f98[j];data.toString=function(){return this.name;};var _f9a=_f98[j].description;_f99.push({data:data,type:["draggableItem"],description:_f9a});}console.log("GroupSources.setDropTarget     dataArray: ");console.dir({dataArray:_f99});this.dropTarget.insertNodes(false,_f99);var _f9b=this.dropTarget.getAllNodes();console.log("GroupSources.setDropTarget     allNodes.length: "+_f9b.length);for(var k=0;k<_f9b.length;k++){var node=_f9b[k];var _f9c=_f99[k].type;dojo.addClass(node,_f9c);node.description=_f99[k].description;node.location=_f99[k].location;var name=_f99[k].data;node.name=name;node.name=_f99[k].data.name;node.description=_f99[k].data.description;node.location=_f99[k].data.location;var _f9d={name:node.name,location:node.location,description:node.description};_f9d.parentWidget=this;var _f9e=new plugins.sharing.GroupSourceRow(_f9d);node.innerHTML="";node.appendChild(_f9e.domNode);}},addToGroup:function(name,_f9f,_fa0){console.log("GroupSources.addToGroup    plugins.sharing.GroupSources.addToGroup(name, description, location)");console.log("GroupSources.addToGroup    name: "+name);var _fa1=new Object;_fa1.username=Agua.cookie("username");_fa1.name=name;_fa1.description=_f9f;_fa1.location=_fa0;var _fa2=this.groupCombo.getValue();console.log("GroupSources.addToGroup     groupName: "+_fa2);if(Agua.addSourceToGroup(_fa2,_fa1)==false){console.log("GroupSources.addToGroup     Failed to add source to group: "+_fa1.name+". Returning.");return;}var data=new Object;data.name=name;data.description=_f9f;data.location=_fa0;data.groupname=_fa2;data.type="source";var url=Agua.cgiUrl+"sharing.cgi";var _fa3=new Object;_fa3.username=Agua.cookie("username");_fa3.sessionid=Agua.cookie("sessionid");_fa3.data=data;_fa3.mode="addToGroup";var _fa4=dojo.toJson(_fa3).replace(/undefined/g,"\"\"");dojo.xhrPut({url:url,contentType:"text",sync:false,handleAs:"json",putData:_fa4,timeout:15000,load:function(data){console.log("SourceManager.addToGroup    JSON loaded okay");console.log("SourceManager.addToGroup    data: "+dojo.toJson(data));},error:function(_fa5,_fa6){console.log("SourceManager.addToGroup    Error with JSON Post, response: "+_fa5+", ioArgs: "+_fa6);return _fa5;}});},removeFromGroup:function(name,_fa7,_fa8){console.log("GroupSources.removeFromGroup    plugins.sharing.GroupSources.removeFromGroup(name, description, location)");console.log("GroupSources.removeFromGroup    name: "+name);var _fa9=this.groupCombo.getValue();console.log("GroupSources.removeFromGroup     groupName: "+_fa9);var _faa=new Object;_faa.name=name;_faa.description=_fa7;_faa.location=_fa8;if(Agua.removeSourceFromGroup(_fa9,_faa)==false){console.log("GroupSources.removeFromGroup     Failed to remove source from group: "+_faa.name+". Returning.");return;}var data=new Object;data.name=String(name);data.description=_fa7;data.location=_fa8;data.groupname=_fa9;data.type="source";var url=Agua.cgiUrl+"sharing.cgi";var _fab=new Object;_fab.username=Agua.cookie("username");_fab.sessionid=Agua.cookie("sessionid");_fab.data=data;_fab.mode="removeFromGroup";var _fac=dojo.toJson(_fab).replace(/undefined/g,"\"\"");dojo.xhrPut({url:url,contentType:"text",sync:false,handleAs:"json",putData:_fac,timeout:15000,load:function(data){console.log("SourceManager.removeFromGroup    JSON loaded okay");console.log("SourceManager.removeFromGroup    data: "+dojo.toJson(data));},error:function(_fad,_fae){console.log("SourceManager.removeFromGroup    Error with JSON Post, response: "+_fad+", ioArgs: "+_fae);return _fad;}});},setTrash:function(){console.log("GroupSources.setTrash     plugins.sharing.GroupSources.setTrash()");var _faf=new dojo.dnd.Source(this.trashContainer,{accept:["draggableItem"]});dojo.connect(_faf,"onDndDrop",function(_fb0,_fb1,copy,_fb2){console.log("GroupSources.setTrash    dojo.connect(onDndDrop)    Checking if target == this");console.log("GroupSources.setTrash    target:");console.dir({target:_fb2});console.log("GroupSources.setTrash    this:");if(_fb2==this){console.log("GroupSources.setTrash    dojo.connect(onDndDrop)    target == this. Removing dropped nodes");var _fb3=_faf.getAllNodes();for(var i=0;i<_fb3.length;i++){var node=_fb3[i];console.log("GroupSources.setTrash    dojo.connect(onDndDrop)    target == this. Removing dropped nodes");try{node.parentNode.removeChild(node);}catch(e){}}}});}});}if(!dojo._hasResource["plugins.sharing.GroupUserRow"]){dojo._hasResource["plugins.sharing.GroupUserRow"]=true;dojo.provide("plugins.sharing.GroupUserRow");dojo.declare("plugins.sharing.GroupUserRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table width=\"100%\" cellspacing=\"0px\">\n        <tr>\n            <td colspan=\"2\"\n                dojoAttachPoint=\"username\"\n                class=\"username\"\n                width=\"100%\"\n                >\n                ${username}</td>\n        </tr>\n        <tr class=\"email\">\n            <td colspan=\"2\"\n                dojoAttachPoint=\"email\"\n                style=\"display: none;\"\n                width=\"100%\"\n                >\n                ${email}</td>\n        </tr>\n        <tr dojoAttachPoint=\"fullname\"\n            style=\"display: none\"\n            class=\"fullname\"\n            >\n            <td dojoAttachPoint=\"firstname\"\n                class=\"firstname\"\n                style=\"display: inline\"\n                width=\"100%\"\n                >${firstname}</td>\n            <td dojoAttachPoint=\"lastname\"\n                class=\"lastname\"\n                style=\"display: inline\"\n                width=\"100%\"\n                >${lastname}</td>\n        </tr>\n        <tr>\n            <td colspan=\"2\"\n                dojoAttachPoint=\"description\"\n                class=\"description\"\n                style=\"display: none;\"\n                width=\"100%\"\n                >${description}</td>\n        </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);var _fb4=this;dojo.connect(this.username,"onclick",function(_fb5){_fb4.toggle();_fb5.stopPropagation();});},toggle:function(){if(this.email.style.display=="block"){this.email.style.display="none";}else{this.email.style.display="block";}if(this.fullname.style.display=="block"){this.fullname.style.display="none";}else{this.fullname.style.display="block";}if(this.description.style.display=="block"){this.description.style.display="none";}else{this.description.style.display="block";}}});}if(!dojo._hasResource["plugins.sharing.GroupUsers"]){dojo._hasResource["plugins.sharing.GroupUsers"]=true;dojo.provide("plugins.sharing.GroupUsers");dojo.declare("plugins.sharing.GroupUsers",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- groupusers TAB -->\n\t<div\n\t\tdojoAttachPoint=\"groupusersTab\"\n\t\tclass=\"groupusers\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Group Users\"\n\t\tstyle=\"height: 100% !important; max-height: auto !important; width: 370px !important; padding: 0 !important;\"\n\t>\n\n\t\t<table width=\"100%\">\n\t\t\t<tr valign=\"top\" width=\"370\">\n\t\t\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\"> Group Users </td>\n\t\t\t</tr>\n\t\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t\t<td width=\"50%\">\n\t\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t\t\t\t<!-- GROUP COMBO -->\n\t\t\t\t\t\t\t\t<div class=\"comboLabel\"> Groups </div>\n\t\t\t\t\t\t\t\t<div dojoAttachPoint=\"groupCombo\"\n\t\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\t\t\tclass=\"groupCombo\"\n\t\t\t\t\t\t\t\t\t\tpopupClass=\"groupusers groupCombo dijitReset dijitMenu\"\n\t\t\t\t\t\t\t\t\t\tautocomplete=\"true\"\n\t\t\t\t\t\t\t\t\t\thasDownArrow=\"true\"\n\t\t\t\t\t\t\t\t\t\tdisabled=\"false\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"width: 150px;\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t\t\t\t<!-- DROP TARGET CONTAINER -->\n\t\t\t\t\t\t\t\t<div class=\"comboLabel\"> Group Users </div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"dropTargetContainer\"\n\t\t\t\t\t\t\t\t\tclass=\"dropTarget\"\n\t\t\t\t\t\t\t\t\tstyle=\"height: 622px; width: 170px;\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t\t<td width=\"50%\">\n\t\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\">\n\t\t\t\t\t\t\t\t<div class=\"comboLabel\"> Users </div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"dragSourceSlider\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.HorizontalSlider\" \n\t\t\t\t\t\t\t\t\tvalue=\"0\"\n\t\t\t\t\t\t\t\t\tmaximum=\"100\"\n\t\t\t\t\t\t\t\t\tminimum=\"0\"\n\t\t\t\t\t\t\t\t\tpageIncrement=\"100\"\n\t\t\t\t\t\t\t\t\tshowButtons=\"true\"\n\t\t\t\t\t\t\t\t\tintermediateChanges=\"true\"\n\t\t\t\t\t\t\t\t\tslideDuration=\"200\"\n\t\t\t\t\t\t\t\t\tstyle=\"width: 150px;\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t\t\t\t<!-- DRAG SOURCE CONTAINER -->\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"dragSourceContainer\"\n\t\t\t\t\t\t\t\t\tclass=\"dragSource\"\n\t\t\t\t\t\t\t\t\tstyle=\"height: 560px; width: 150px;\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr align=\"center\">\n\t\t\t\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t\t\t\t<!-- TRASH CONTAINER -->\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"trashContainer\"\n\t\t\t\t\t\t\t\t\tclass=\"trash\"\n\t\t\t\t\t\t\t\t\tstyle=\"height: 60px; width: 150px; align: center;\" \n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"trashIcon\"\n\t\t\t\t\t\t\t\t\t\tclass=\"trashIcon\"\n\t\t\t\t\t\t\t\t\t\tstyle=\"height: 60px; width: 60px;\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\n\t</div>\n\t<!-- END groupusers TAB -->\n\t\n</div> \n",widgetsInTemplate:true,addingSource:false,cssFiles:["plugins/sharing/css/groupusers.css"],parentWidget:null,maxDisplayedUsers:24,constructor:function(args){this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.tabContainer.addChild(this.groupusersTab);this.tabContainer.selectChild(this.groupusersTab);this.setGroupCombo();this.setDragSource();this.setDragSourceSlider();this.setDropTarget();this.setTrash();Agua.updater.subscribe(this,"updateGroups");Agua.updater.subscribe(this,"updateUsers");},updateGroups:function(args){this.reload();},updateUsers:function(args){this.reload();},reload:function(){this.setGroupCombo();this.setDragSource();this.setDropTarget();},setGroupCombo:function(){var _fb6=Agua.getGroupNames();var data={identifier:"name",items:[]};for(var i=0;i<_fb6.length;i++){data.items[i]={name:_fb6[i]};}var _fb7=new dojo.data.ItemFileWriteStore({data:data});this.groupCombo.store=_fb7;this.groupCombo.startup();var _fb8=_fb6[0];this.groupCombo.setValue(_fb8);var _fb9=this;dojo.connect(this.groupCombo,"onChange",function(_fba){_fb9.setDropTarget();});},setDragSource:function(_fbb){while(this.dragSourceContainer.firstChild){if(dijit.byNode(this.dragSourceContainer)&&dijit.byNode(this.dragSourceContainer).destroy){dijit.byNode(this.dragSourceContainer).destroy();}this.dragSourceContainer.removeChild(this.dragSourceContainer.firstChild);}if(_fbb==null){_fbb=0;}var _fbc=new Array;var _fbd=Agua.getUsers();if(_fbd==null||_fbd.length==0){return;}var _fbe=this.maxDisplayedUsers;var _fbf=(_fbd.length-_fbe)/100;_fbf=_fbf?_fbf:1;var _fc0=parseInt(_fbb*_fbf);var end=parseInt((_fbb*_fbf)+_fbe);if(!end||end>_fbd.length){end=_fbd.length;}if(!_fc0||_fc0<0){_fc0=0;}for(var j=_fc0;j<end;j++){var data=_fbd[j];_fbc.push({data:data,type:["draggableUser"]});}var _fc1=new dojo.dnd.Source(this.dragSourceContainer,{copyOnly:true,selfAccept:false,accept:["none"]});_fc1.insertNodes(false,_fbc);var _fc2=_fc1.getAllNodes();for(var k=0;k<_fc2.length;k++){var node=_fc2[k];node.username=_fbc[k].data["username"]?_fbc[k].data["username"]:"";node.firstname=_fbc[k].data["firstname"]?_fbc[k].data["firstname"]:"";node.lastname=_fbc[k].data["lastname"]?_fbc[k].data["lastname"]:"";node.email=_fbc[k].data["email"]?_fbc[k].data["email"]:"";node.description=_fbc[k].data["description"]?_fbc[k].data["description"]:"";node.firstname=this.firstLetterUpperCase(node.firstname);node.lastname=this.firstLetterUpperCase(node.lastname);if(node.description==null){node.description="";}if(node.username!=null&&node.username!=""){var user={username:node.username,email:node.email,firstname:node.firstname,lastname:node.lastname,description:node.description};user.parentWidget=this;var _fc3=new plugins.sharing.GroupUserRow(user);node.innerHTML="";node.appendChild(_fc3.domNode);}}var _fc4=this;_fc1.creator=function(item,hint){var node=dojo.doc.createElement("div");node.username=item["username"];node.firstname=item["firstname"];node.lastname=item["lastname"];node.email=item["email"];node.description=item["description"];node.id=dojo.dnd.getUniqueId();node.className="dojoDndItem";node.innerHTML="<table> <tr><td><strong style='color: darkred'>"+item["username"]+"</strong></td></tr><tr><td> "+item["email"]+"</td></tr></table>";return {node:node,data:item,type:["text"]};};},setDragSourceSlider:function(){dojo.connect(this.dragSourceSlider,"onMouseUp",dojo.hitch(this,function(e){var _fc5=parseInt(this.dragSourceSlider.getValue());this.setDragSource(_fc5);}));},setDropTarget:function(){while(this.dropTargetContainer.firstChild){this.dropTargetContainer.removeChild(this.dropTargetContainer.firstChild);}var _fc6=this.groupCombo.get("value");var _fc7=Agua.getGroupUsers();_fc7=this.filterByKeyValues(_fc7,["groupname"],[_fc6]);_fc7=this.filterByKeyValues(_fc7,["groupname"],[_fc6]);if(_fc7==null){return;}var _fc8=new Array;for(var j=0;j<_fc7.length;j++){var data=_fc7[j];var _fc9=_fc7[j].description;_fc8.push({data:data,type:["draggableUser"],description:_fc9});}var _fca=new dojo.dnd.Source(this.dropTargetContainer,{accept:["draggableUser"]});_fca.insertNodes(false,_fc8);var _fcb=_fca.getAllNodes();for(var k=0;k<_fcb.length;k++){var node=_fcb[k];var _fcc=_fc8[k].type;dojo.addClass(node,_fcc);node.username=_fc8[k].data.name;node.description=_fc8[k].data.description;node.email=_fc8[k].data.location;var user={username:node.username,email:node.email,firstname:"",lastname:"",description:node.description};user.parentWidget=this;var _fcd=new plugins.sharing.GroupUserRow(user);node.innerHTML="";node.appendChild(_fcd.domNode);}var _fce=this;_fca.creator=function(item,hint){var node=dojo.doc.createElement("div");node.name=item.username||item.name;node.username=item.username||item.name;node.description=item.description||"";node.email=item.email||item.location;node.id=dojo.dnd.getUniqueId();node.className="dojoDndItem";var user={username:item.username||item.name,email:item.email||item.location,firstname:"",lastname:"",description:""};user.parentWidget=this;var _fcf=new plugins.sharing.GroupUserRow(user);node.innerHTML="";node.appendChild(_fcf.domNode);if(hint!="avatar"){_fce.addToGroup(node.username,node.description,node.email);}return {node:node,data:item,type:["draggableUser"]};};dojo.connect(_fca,"onDndDrop",function(_fd0,_fd1,copy,_fd2){if(_fd0==this&&_fd2!=this){for(var i=0;i<_fd1.length;i++){var node=_fd1[i];_fce.removeFromGroup(node.username,node.description,node.email);}}else{}var _fd3=_fca.getAllNodes();if(_fd3==null||!_fd3){return;}var _fd4=new Object;for(var i=0;i<_fd3.length;i++){var node=_fd3[i];if(!_fd4[node.username]){_fd4[node.username]=1;}else{try{node.parentNode.removeChild(node);}catch(e){}}}});},addToGroup:function(name,_fd5,_fd6){var _fd7=new Object;_fd7.username=Agua.cookie("username");_fd7.name=name;_fd7.description=_fd5;_fd7.location=_fd6;var _fd8=this.groupCombo.get("value");if(Agua.addUserToGroup(_fd8,_fd7)==false){return;}var data=new Object;data.name=name;data.description=_fd5||"";data.location=_fd6||"";data.groupname=_fd8||"";data.type="user";var url=Agua.cgiUrl+"sharing.cgi";var _fd9=new Object;_fd9.username=Agua.cookie("username");_fd9.sessionid=Agua.cookie("sessionid");_fd9.data=data;_fd9.mode="addToGroup";this.doPut({url:url,query:_fd9,sync:false,timeout:15000});},removeFromGroup:function(name,_fda,_fdb){var _fdc=this.groupCombo.get("value");var _fdd=new Object;_fdd.name=name;_fdd.description=_fda;_fdd.email=_fdb;if(Agua.removeUserFromGroup(_fdc,_fdd)==false){return;}var data=new Object;data.name=String(name)||"";data.description=_fda||"";data.email=_fdb||"";data.groupname=_fdc||"";data.type="user";var url=Agua.cgiUrl+"sharing.cgi";var _fde=new Object;_fde.username=Agua.cookie("username");_fde.sessionid=Agua.cookie("sessionid");_fde.data=data;_fde.mode="removeFromGroup";this.doPut({url:url,query:_fde,sync:false,timeout:15000});},setTrash:function(){var _fdf=new dojo.dnd.Source(this.trashContainer,{accept:["draggableUser"]});dojo.connect(_fdf,"onDndDrop",function(_fe0,_fe1,copy,_fe2){if(_fe2==this){var _fe3=_fdf.getAllNodes();for(var i=0;i<_fe3.length;i++){var node=_fe3[i];try{node.parentNode.removeChild(node);}catch(e){}}}});}});}if(!dojo._hasResource["plugins.sharing.Groups"]){dojo._hasResource["plugins.sharing.Groups"]=true;dojo.provide("plugins.sharing.Groups");dojo.declare("plugins.sharing.Groups",[dijit._Widget,dijit._Templated,plugins.core.Common,plugins.form.EditForm],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- SOURCES TAB -->\n\t<div\n\t\tdojoAttachPoint=\"groupsTab\"\n\t\tclass=\"groups\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Groups\"\n\t\tstyle=\"height: 100% !important; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t\t>\n\n<table width=\"100%\">\n\t<tr valign=\"top\" width=\"100%\">\n\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\"> Groups </td>\n\t</tr>\n\n\t<tr valign=\"top\" width=\"95%\">\n\t\t<td>\n\t\t\t<div class=\"label\"> New Group </div>\n\t\t\t<table>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"groupname\"\n\t\t\t\t\t\t\tclass=\"groupname\"\n\t\t\t\t\t\t\tstyle=\"width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"30\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t>Groupname</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoAttachPoint=\"addGroupButton\"\n\t\t\t\t\t\t\tclass=\"addGroupButton\"\n\t\t\t\t\t\t\tdojoType=\"dijit.form.Button\"\n\t\t\t\t\t\t\tlabel=\"Save\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"description\"\n\t\t\t\t\t\t\tclass=\"description\"\n\t\t\t\t\t\t\tstyle=\"width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t>Description</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"notes\"\n\t\t\t\t\t\t\tclass=\"notes\"\n\t\t\t\t\t\t\tvalue=\"Notes\"\n\t\t\t\t\t\t\tstyle=\"width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t>Notes</textarea>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t</td>\n\t</tr>\n\t\n\t<tr valign=\"top\" width=\"95%\">\n\t\t<td width=\"95%\">\n\t\t\t<div class=\"label\">Groups</div>\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"dragSourceNode\"\n\t\t\t\tclass=\"dragSource\"\n\t\t\t\tstyle=\"height: 467px; width: 95%;\"\n\t\t\t>\n\t\t\t</div>\n\t\t</td>\n\t</tr>\n\n\t<tr align=\"center\">\n\t\t<td align=\"center\">\n\n\t\t\t<!-- TRASH CONTAINER -->\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"trashContainer\"\n\t\t\t\tclass=\"trash\"\n\t\t\t\tstyle=\"height: 60px; width: 150px; align: center;\" \n\t\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"trashIcon\"\n\t\t\t\t\tclass=\"trashIcon\"\n\t\t\t\t\tstyle=\"height: 60px; width: 60px;\"\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</td>\n\t</tr>\n</table>\n\n\n\n\t</div>\n\t<!-- END SOURCES TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,addingGroup:false,cssFiles:["plugins/sharing/css/groups.css"],parentWidget:null,formInputs:{groupname:"word",description:"phrase",notes:"phrase"},defaultInputs:{groupname:"Groupname",description:"Description",notes:"Notes"},requiredInputs:{groupname:1},invalidInputs:{groupname:"Groupname",description:"Description",notes:"Notes"},dataFields:["groupname"],avatarItems:["groupname","description"],rowClass:"plugins.sharing.GroupRow",constructor:function(args){this.parentWidget=args.parentWidget;this.groups=args.parentWidget.groups;-this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.tabContainer.addChild(this.groupsTab);this.tabContainer.selectChild(this.groupsTab);this.setDragSource();this.setForm();Agua.updater.subscribe(this,"updateGroups");this.setTrash(this.dataFields);},updateGroups:function(args){if(args==null||args.reload!=false){this.setDragSource();}},setForm:function(){dojo.connect(this.addGroupButton,"onClick",dojo.hitch(this,"saveInputs",null,null));this.setClearValues();this.chainInputs(["groupname","description","notes","addGroupButton"]);},getItemArray:function(){var _fe4=Agua.getGroups();return this.sortHasharray(_fe4,"groupname");},deleteItem:function(_fe5){Agua.removeGroup(_fe5);Agua.updater.update("updateGroups");},addItem:function(_fe6,_fe7){if(this.savingGroup==true){return;}this.savingGroup=true;Agua.addGroup(_fe6);this.savingGroup=false;Agua.updater.update("updateGroups");}});}if(!dojo._hasResource["plugins.sharing.ProjectRow"]){dojo._hasResource["plugins.sharing.ProjectRow"]=true;dojo.provide("plugins.sharing.ProjectRow");dojo.declare("plugins.sharing.ProjectRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table width=\"100%\">\n        <tr>\n            <td\n                dojoAttachPoint=\"name\"\n                class=\"name\"\n                >${name}</td>\n        </tr>\n        <tr>\n            <td\n                dojoAttachPoint=\"description\"\n                class='description'\n                style=\"display: none;\" >${description}</td>\n        </tr>\n        <tr>\n            <td\n                dojoAttachPoint=\"notes\"\n                class='notes'\n                style=\"display: none;\">${notes}</td>\n        </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;},postCreate:function(){this.formInputs=this.parentWidget.formInputs;this.startup();},startup:function(){this.inherited(arguments);var _fe8=this;dojo.connect(this.name,"onclick",function(_fe9){_fe8.toggle();_fe9.stopPropagation();});dojo.connect(this.description,"onclick",function(_fea){_fe8.parentWidget.editRow(_fe8,_fea.target);});dojo.connect(this.notes,"onclick",function(_feb){_fe8.parentWidget.editRow(_fe8,_feb.target);});},toggle:function(){if(this.description.style.display=="block"){this.description.style.display="none";}else{this.description.style.display="block";}if(this.notes.style.display=="block"){this.notes.style.display="none";}else{this.notes.style.display="block";}}});}if(!dojo._hasResource["plugins.sharing.Projects"]){dojo._hasResource["plugins.sharing.Projects"]=true;dojo.provide("plugins.sharing.Projects");dojo.declare("plugins.sharing.Projects",[dijit._Widget,dijit._Templated,plugins.core.Common,plugins.form.EditForm],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- SOURCES TAB -->\n\t<div\n\t\tdojoAttachPoint=\"projectsTab\"\n\t\tclass=\"projects\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Projects\"\n\t\tstyle=\"height: 100% !important; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t\t>\n\n\t\t<table width=\"100%\">\n\t\t\t<tr valign=\"top\" width=\"100%\">\n\t\t\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\"> Projects </td>\n\t\t\t</tr>\n\n\t\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t\t<td>\n\t\t\t\t\t<div class=\"label\"> New Project </div>\n\t\t\t\t\t<table>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"name\"\n\t\t\t\t\t\t\t\t\tclass=\"name\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\tcols=\"30\"\n\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t>Name</textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"addProjectButton\"\n\t\t\t\t\t\t\t\t\tclass=\"addProjectButton\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.Button\"\n\t\t\t\t\t\t\t\t\tlabel=\"Save\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"description\"\n\t\t\t\t\t\t\t\t\tclass=\"description\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t>Description</textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"notes\"\n\t\t\t\t\t\t\t\t\tclass=\"notes\"\n\t\t\t\t\t\t\t\t\tvalue=\"Notes\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t>Notes</textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t\n\t\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t\t<td width=\"95%\">\n\t\t\t\t\t<div class=\"label\"> Projects </div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoAttachPoint=\"dragSourceNode\"\n\t\t\t\t\t\tclass=\"dragSource\"\n\t\t\t\t\t\tstyle=\"height: 468px; width: 95%;\"\n\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\n\t\t\t<tr align=\"center\">\n\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t<!-- TRASH CONTAINER -->\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoAttachPoint=\"trashContainer\"\n\t\t\t\t\t\tclass=\"trash\"\n\t\t\t\t\t\tstyle=\"height: 60px; width: 150px; align: center;\" \n\t\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoAttachPoint=\"trashIcon\"\n\t\t\t\t\t\t\tclass=\"trashIcon\"\n\t\t\t\t\t\t\tstyle=\"height: 60px; width: 60px;\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\n\t</div>\n\t<!-- END SOURCES TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,adding:false,cssFiles:["plugins/sharing/css/projects.css"],parentWidget:null,formInputs:{name:"word",description:"phrase",notes:"word"},defaultInputs:{name:"Name",description:"Description",notes:"Notes"},requiredInputs:{name:1},invalidInputs:{name:"Name",description:"Description",notes:"Notes"},dataFields:["name"],avatarItems:["name","description"],rowClass:"plugins.sharing.ProjectRow",constructor:function(args){this.parentWidget=args.parentWidget;this.projects=args.parentWidget.projects;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.tabContainer.addChild(this.projectsTab);this.tabContainer.selectChild(this.projectsTab);this.setDragSource();this.setForm();Agua.updater.subscribe(this,"updateProjects");Agua.updater.subscribe(this,"updateWorkflows");this.setTrash(this.dataFields);},updateProjects:function(args){if(args==null||args.reload!=false){this.setDragSource();}},setForm:function(){dojo.connect(this.addProjectButton,"onClick",dojo.hitch(this,"saveInputs",null,null));this.setClearValues();this.chainInputs(["name","description","notes","addProjectButton"]);},getItemArray:function(){var _fec=new Array;var _fed=Agua.getProjects();return this.sortHasharray(_fed,"name");},deleteItem:function(_fee){if(!Agua.isProject(_fee.name)){return;}Agua.removeProject(_fee);Agua.updater.update("updateProjects");},addItem:function(_fef,_ff0){if(this.adding==true){return;}this.adding=true;if(_ff0&&Agua.isProject(_fef.name)){this.adding=false;return;}Agua.addProject(_fef);this.adding=false;Agua.updater.update("updateProjects");}});}if(!dojo._hasResource["plugins.sharing.SourceRow"]){dojo._hasResource["plugins.sharing.SourceRow"]=true;dojo.provide("plugins.sharing.SourceRow");dojo.declare("plugins.sharing.SourceRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table width=\"100%\">\n        <tr>\n            <td\n                dojoAttachPoint=\"name\"\n                class=\"name\"\n                >\n                ${name}</td>\n        </tr>\n        <tr>\n            <td dojoAttachPoint=\"description\" class='description' style=\"display: block;\" >${description}</td>\n        </tr>\n        <tr>\n            <td dojoAttachPoint=\"location\" class='location' style=\"display: block;\">${location}</td>\n        </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;},postCreate:function(){this.formInputs=this.parentWidget.formInputs;this.startup();},startup:function(){this.inherited(arguments);var _ff1=this;dojo.connect(this.name,"onclick",function(_ff2){_ff1.toggle();_ff2.stopPropagation();});dojo.connect(this.description,"onclick",function(_ff3){_ff1.parentWidget.editRow(_ff1,_ff3.target);_ff3.stopPropagation();});dojo.connect(this.location,"onclick",function(_ff4){_ff1.parentWidget.editRow(_ff1,_ff4.target);_ff4.stopPropagation();});},toggle:function(){if(this.description.style.display=="block"){this.description.style.display="none";}else{this.description.style.display="block";}if(this.location.style.display=="block"){this.location.style.display="none";}else{this.location.style.display="block";}}});}if(!dojo._hasResource["plugins.sharing.Sources"]){dojo._hasResource["plugins.sharing.Sources"]=true;dojo.provide("plugins.sharing.Sources");dojo.declare("plugins.sharing.Sources",[dijit._Widget,dijit._Templated,plugins.core.Common,plugins.form.EditForm],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- SOURCES TAB -->\n\t<div\n\t\tdojoAttachPoint=\"sourcesTab\"\n\t\tclass=\"sources\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Sources\"\n\t\tstyle=\"height: 100% !important; max-height: auto !important; width: 390px !important; padding: 0 !important;\"\n\t\t>\n\n\t\t<table width=\"100%\">\n\t\t\t<tr valign=\"top\" width=\"370\">\n\t\t\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\"> Sources </td>\n\t\t\t</tr>\n\n\t\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t\t<td>\n\t\t\t\t\t<div class=\"label\"> New Source </div>\n\t\t\t\t\t<table>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"name\"\n\t\t\t\t\t\t\t\t\tclass=\"name\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\tcols=\"30\"\n\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t>Name</textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"addSourceButton\"\n\t\t\t\t\t\t\t\t\tclass=\"addSourceButton\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.Button\"\n\t\t\t\t\t\t\t\t\tlabel=\"Save\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"description\"\n\t\t\t\t\t\t\t\t\tclass=\"description\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t>Description</textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"location\"\n\t\t\t\t\t\t\t\t\tclass=\"location\"\n\t\t\t\t\t\t\t\t\tvalue=\"Location\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t>Location</textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t\n\t\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t\t<td width=\"95%\">\n\t\t\t\t\t<div class=\"label\"> Sources </div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoAttachPoint=\"dragSourceNode\"\n\t\t\t\t\t\tclass=\"dragSource\"\n\t\t\t\t\t\tstyle=\"height: 468px; width: 95%;\"\n\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\n\t\t\t<tr align=\"center\">\n\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t<!-- TRASH CONTAINER -->\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoAttachPoint=\"trashContainer\"\n\t\t\t\t\t\tclass=\"trash\"\n\t\t\t\t\t\tstyle=\"height: 60px; width: 150px; align: center;\" \n\t\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoAttachPoint=\"trashIcon\"\n\t\t\t\t\t\t\tclass=\"trashIcon\"\n\t\t\t\t\t\t\tstyle=\"height: 60px; width: 60px;\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\n\t</div>\n\t<!-- END SOURCES TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,addingSource:false,cssFiles:["plugins/sharing/css/sources.css"],parentWidget:null,formInputs:{name:"phrase",description:"phrase",location:"word"},defaultInputs:{name:"Name",description:"Description",location:"Location"},requiredInputs:{name:1,location:1},invalidInputs:{name:"Name",description:"Description",location:"Location"},dataFields:["name","description","location"],avatarItems:["name","description","location"],rowClass:"plugins.sharing.SourceRow",constructor:function(args){this.parentWidget=args.parentWidget;this.sources=args.parentWidget.sources;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.tabContainer.addChild(this.sourcesTab);this.tabContainer.selectChild(this.sourcesTab);this.setDragSource();this.setForm();Agua.updater.subscribe(this,"updateSources");this.setTrash(this.dataFields);},updateSources:function(args){if(args!=null&&args.originator==this){if(args.reload==false){return;}}this.setDragSource();},setForm:function(){dojo.connect(this.addSourceButton,"onClick",dojo.hitch(this,"saveInputs",null,null));this.setClearValues();this.chainInputs(["name","description","location","addSourceButton"]);},getItemArray:function(){var _ff5=Agua.getSources();_ff5=this.sortHasharray(_ff5,"name");console.log("Sources.getItemArray    Returning itemArray: ");console.dir({itemArray:_ff5});return _ff5;},deleteItem:function(_ff6){_ff6.name=_ff6.name.replace(/\s+$/,"");_ff6.name=_ff6.name.replace(/^\s+/,"");var _ff7=Agua.removeSource(_ff6);Agua.updater.update("updateSources");},addItem:function(_ff8,_ff9){if(this.savingSource==true){return;}this.savingSource=true;Agua.addSource(_ff8);this.savingSource=false;Agua.updater.update("updateSources",_ff9);}});}if(!dojo._hasResource["plugins.sharing.UserRow"]){dojo._hasResource["plugins.sharing.UserRow"]=true;dojo.provide("plugins.sharing.UserRow");dojo.declare("plugins.sharing.UserRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table width=\"100%\">\n        <tr class=\"username\" width=\"100%\">\n            <td\n                width=\"100%\"\n                colspan=\"2\"\n                dojoAttachPoint=\"username\"\n                class=\"username\"\n            >${username}</td>\n        </tr>\n        <tr class='firstname' width=\"100%\">\n            <td \n                dojoAttachPoint=\"firstname\"\n                class='firstname'\n                style=\"display: none;\"\n                width=\"100%\" colspan=\"2\"\n            >${firstname}</td>\n        </tr>\n        <tr class='lastname' width=\"100%\">\n            <td \n                dojoAttachPoint=\"lastname\"\n                class='lastname'\n                style=\"display: none;\"\n                width=\"100%\" colspan=\"2\"\n            >${lastname}</td>\n        </tr>\n        <tr class=\"email\" width=\"100%\">\n            <td \n                dojoAttachPoint=\"email\"\n                class='email'\n                style=\"display: none;\"\n                width=\"100%\" colspan=\"2\"\n            >${email}</td>\n        </tr>\n        <tr class=\"password\" width=\"100%\">\n            <td \n                dojoAttachPoint=\"password\"\n                class='password'\n                style=\"display: none;\"\n                type=\"password\"\n                value=\"its-a-secret\"\n                width=\"100%\" colspan=\"2\"\n            >reset-password</td>\n        </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;},postCreate:function(){this.formInputs=this.parentWidget.formInputs;this.startup();},startup:function(){this.inherited(arguments);var _ffa=this;dojo.connect(this.username,"onclick",function(_ffb){_ffa.toggle();_ffb.stopPropagation();});var _ffa=this;dojo.connect(this.firstname,"onclick",function(_ffc){_ffa.parentWidget.editRow(_ffa,_ffc.target);_ffc.stopPropagation();});dojo.connect(this.lastname,"onclick",function(_ffd){_ffa.parentWidget.editRow(_ffa,_ffd.target);_ffd.stopPropagation();});dojo.connect(this.email,"onclick",function(_ffe){_ffa.parentWidget.editRow(_ffa,_ffe.target);_ffe.stopPropagation();});dojo.connect(this.password,"onclick",function(_fff){_ffa.clearValue(_fff.target);_ffa.parentWidget.editRow(_ffa,_fff.target);_fff.stopPropagation();});},toggle:function(){if(this.firstname.style.display=="block"){this.firstname.style.display="none";}else{this.firstname.style.display="block";}if(this.lastname.style.display=="block"){this.lastname.style.display="none";}else{this.lastname.style.display="block";}if(this.email.style.display=="block"){this.email.style.display="none";}else{this.email.style.display="block";}if(this.password.style.display=="block"){this.password.style.display="none";}else{this.password.style.display="block";}},clearValue:function(_1000){if(_1000.clicked==true){return;}_1000.clicked=true;_1000.innerHTML="";_1000.focus();}});}if(!dojo._hasResource["plugins.sharing.Users"]){dojo._hasResource["plugins.sharing.Users"]=true;dojo.provide("plugins.sharing.Users");dojo.declare("plugins.sharing.Users",[dijit._Widget,dijit._Templated,plugins.core.Common,plugins.form.EditForm],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n\t<!-- users TAB -->\n\t<div\n\t\tdojoAttachPoint=\"mainTab\"\n\t\tclass=\"users\"\n\t\tdojoType=\"dijit.layout.ContentPane\"\n\t\ttitle=\"Users\"\n\t\tstyle=\"height: 100% !important; max-height: auto !important; width: 370px !important; padding: 0 !important;\"\n\t\t>\n\n\t\t<table width=\"100%\">\n\t\t\t<tr valign=\"top\" width=\"370\">\n\t\t\t\t<td colspan=\"2\" class=\"tabTitle\" align=\"center\"> Users </td>\n\t\t\t</tr>\n\n\t\t\t<tr valign=\"top\" width=\"95%\">\n\n\t\t\t\t<td>\n\t\t\t\t\n\t\t\t\t\t<table>\n\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t\t\t<div class=\"label\"> Create New User </div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\tUsername\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"username\"\n\t\t\t\t\t\t\t\t\tclass=\"username\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%; height: 20px; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\tcols=\"30\"\n\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\ttitle=\"Username\"\n\t\t\t\t\t\t\t\t\t>Username</textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"addUserButton\"\n\t\t\t\t\t\t\t\t\tclass=\"addUserButton\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.Button\"\n\t\t\t\t\t\t\t\t\tlabel=\"Add\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\tFirst name\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"firstname\"\n\t\t\t\t\t\t\t\t\tclass=\"firstname\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%; height: 20px; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\ttitle=\"Firstname\"\n\t\t\t\t\t\t\t\t\t>Firstname</textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\tLast name\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"lastname\"\n\t\t\t\t\t\t\t\t\tclass=\"lastname\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%; height: 20px; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\ttitle=\"Lastname\"\n\t\t\t\t\t\t\t\t\t>Lastname</textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\tEmail\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tspellcheck=\"false\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"email\"\n\t\t\t\t\t\t\t\t\tclass=\"email\"\n\t\t\t\t\t\t\t\t\tvalue=\"Email\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%; height: 20px; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\tcols=\"40\"\n\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\ttitle=\"Email\"\n\t\t\t\t\t\t\t\t\t>Email</textarea>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\tPassword\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"password\"\n\t\t\t\t\t\t\t\t\tclass=\"password\"\n\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\t\t\tstyle=\"width:100%; height: 20px; font-weight: bolder; font-family: Verdana;\";\n\t\t\t\t\t\t\t\t\tvalue=\"\"\n\t\t\t\t\t\t\t\t\ttitle=\"Password\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t\n\t\t\t<tr valign=\"top\" width=\"95%\">\n\t\t\t\t<td width=\"95%\">\n\t\t\t\t\t<div class=\"label\"> Users </div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoAttachPoint=\"dragSourceNode\"\n\t\t\t\t\t\tclass=\"dragSource\"\n\t\t\t\t\t\tstyle=\"height: 416px; width: 95%;\"\n\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\n\t\t\t<tr align=\"center\">\n\t\t\t\t<td align=\"center\">\n\n\t\t\t\t\t<!-- TRASH CONTAINER -->\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoAttachPoint=\"trashContainer\"\n\t\t\t\t\t\tclass=\"trash\"\n\t\t\t\t\t\tstyle=\"height: 60px; width: 150px; align: center;\" \n\t\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoAttachPoint=\"trashIcon\"\n\t\t\t\t\t\t\tclass=\"trashIcon\"\n\t\t\t\t\t\t\tstyle=\"height: 60px; width: 60px;\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\n\t</div>\n\t<!-- END users TAB -->\n\t\n</div> \n\n\n",widgetsInTemplate:true,addingUser:false,cssFiles:["plugins/sharing/css/users.css"],parentWidget:null,formInputs:{username:"word",firstname:"phrase",lastname:"phrase",email:"phrase",password:"phrase"},defaultInputs:{username:"Username",firstname:"Firstname",lastname:"Lastname",email:"Email"},requiredInputs:{username:1,firstname:1,lastname:1,email:1},invalidInputs:{username:"Username",firstname:"Firstname",lastname:"Lastname",email:"Email"},dataFields:["username"],avatarItems:["username","email"],rowClass:"plugins.sharing.UserRow",constructor:function(args){this.parentWidget=args.parentWidget;this.users=args.parentWidget.users;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){console.log("Users.startup    plugins.sharing.Users.startup()");this.inherited(arguments);this.tabContainer.addChild(this.mainTab);this.tabContainer.selectChild(this.mainTab);this.setDragSource();this.setForm();Agua.updater.subscribe(this,"updateUsers");this.setTrash(this.dataFields);},updateUsers:function(args){if(args==null||args.reload!=false){console.log("Users.updateUsers    Doing this.setDragSource()");this.setDragSource();}},setForm:function(){dojo.connect(this.addUserButton,"onClick",dojo.hitch(this,"saveInputs",null,null));this.setClearValues();this.chainInputs(["username","firstname","lastname","email","password","addUserButton"]);},getItemArray:function(){var _1001=new Array;var _1002=Agua.getUsers();return this.sortHasharray(_1002,"username");},deleteItem:function(_1003){Agua.removeUser(_1003);Agua.updater.update("updateUsers");},addItem:function(_1004,_1005){console.log("Users.addItem    itemObject: ");console.dir({itemObject:_1004});_1004.originalName=this.jsonSafe(_1004.originalName,"toJson");_1004.username=this.jsonSafe(_1004.username,"toJson");_1004.firstname=this.jsonSafe(_1004.firstname,"toJson");_1004.email=this.jsonSafe(_1004.email,"toJson");_1004.password=this.jsonSafe(_1004.password,"toJson");if(this.saving==true){return;}this.saving=true;if(_1005==true&&Agua.isUser(_1004)){return;}Agua.addUser(_1004);this.saving=false;Agua.updater.update("updateUsers");}});}if(!dojo._hasResource["plugins.dojox.timing.Sequence"]){dojo._hasResource["plugins.dojox.timing.Sequence"]=true;dojo.provide("plugins.dojox.timing.Sequence");dojo.declare("plugins.dojox.timing.Sequence",[dojox.timing.Sequence],{clear:function(){this._defsResolved=[];}});}if(!dojo._hasResource["dijit.layout.SplitContainer"]){dojo._hasResource["dijit.layout.SplitContainer"]=true;dojo.provide("dijit.layout.SplitContainer");dojo.declare("dijit.layout.SplitContainer",dijit.layout._LayoutWidget,{constructor:function(){dojo.deprecated("dijit.layout.SplitContainer is deprecated","use BorderContainer with splitter instead",2);},activeSizing:false,sizerWidth:7,orientation:"horizontal",persist:true,baseClass:"dijitSplitContainer",postMixInProperties:function(){this.inherited("postMixInProperties",arguments);this.isHorizontal=(this.orientation=="horizontal");},postCreate:function(){this.inherited(arguments);this.sizers=[];if(dojo.isMozilla){this.domNode.style.overflow="-moz-scrollbars-none";}if(typeof this.sizerWidth=="object"){try{this.sizerWidth=parseInt(this.sizerWidth.toString());}catch(e){this.sizerWidth=7;}}var sizer=dojo.doc.createElement("div");this.virtualSizer=sizer;sizer.style.position="relative";sizer.style.zIndex=10;sizer.className=this.isHorizontal?"dijitSplitContainerVirtualSizerH":"dijitSplitContainerVirtualSizerV";this.domNode.appendChild(sizer);dojo.setSelectable(sizer,false);},destroy:function(){delete this.virtualSizer;dojo.forEach(this._ownconnects,dojo.disconnect);this.inherited(arguments);},startup:function(){if(this._started){return;}dojo.forEach(this.getChildren(),function(child,i,_1006){this._setupChild(child);if(i<_1006.length-1){this._addSizer();}},this);if(this.persist){this._restoreState();}this.inherited(arguments);},_setupChild:function(child){this.inherited(arguments);child.domNode.style.position="absolute";dojo.addClass(child.domNode,"dijitSplitPane");},_onSizerMouseDown:function(e){if(e.target.id){for(var i=0;i<this.sizers.length;i++){if(this.sizers[i].id==e.target.id){break;}}if(i<this.sizers.length){this.beginSizing(e,i);}}},_addSizer:function(index){index=index===undefined?this.sizers.length:index;var sizer=dojo.doc.createElement("div");sizer.id=dijit.getUniqueId("dijit_layout_SplitterContainer_Splitter");this.sizers.splice(index,0,sizer);this.domNode.appendChild(sizer);sizer.className=this.isHorizontal?"dijitSplitContainerSizerH":"dijitSplitContainerSizerV";var thumb=dojo.doc.createElement("div");thumb.className="thumb";sizer.appendChild(thumb);this.connect(sizer,"onmousedown","_onSizerMouseDown");dojo.setSelectable(sizer,false);},removeChild:function(_1007){if(this.sizers.length){var i=dojo.indexOf(this.getChildren(),_1007);if(i!=-1){if(i==this.sizers.length){i--;}dojo.destroy(this.sizers[i]);this.sizers.splice(i,1);}}this.inherited(arguments);if(this._started){this.layout();}},addChild:function(child,_1008){this.inherited(arguments);if(this._started){var _1009=this.getChildren();if(_1009.length>1){this._addSizer(_1008);}this.layout();}},layout:function(){this.paneWidth=this._contentBox.w;this.paneHeight=this._contentBox.h;var _100a=this.getChildren();if(!_100a.length){return;}var space=this.isHorizontal?this.paneWidth:this.paneHeight;if(_100a.length>1){space-=this.sizerWidth*(_100a.length-1);}var outOf=0;dojo.forEach(_100a,function(child){outOf+=child.sizeShare;});var _100b=space/outOf;var _100c=0;dojo.forEach(_100a.slice(0,_100a.length-1),function(child){var size=Math.round(_100b*child.sizeShare);child.sizeActual=size;_100c+=size;});_100a[_100a.length-1].sizeActual=space-_100c;this._checkSizes();var pos=0;var size=_100a[0].sizeActual;this._movePanel(_100a[0],pos,size);_100a[0].position=pos;pos+=size;if(!this.sizers){return;}dojo.some(_100a.slice(1),function(child,i){if(!this.sizers[i]){return true;}this._moveSlider(this.sizers[i],pos,this.sizerWidth);this.sizers[i].position=pos;pos+=this.sizerWidth;size=child.sizeActual;this._movePanel(child,pos,size);child.position=pos;pos+=size;},this);},_movePanel:function(panel,pos,size){if(this.isHorizontal){panel.domNode.style.left=pos+"px";panel.domNode.style.top=0;var box={w:size,h:this.paneHeight};if(panel.resize){panel.resize(box);}else{dojo.marginBox(panel.domNode,box);}}else{panel.domNode.style.left=0;panel.domNode.style.top=pos+"px";var box={w:this.paneWidth,h:size};if(panel.resize){panel.resize(box);}else{dojo.marginBox(panel.domNode,box);}}},_moveSlider:function(_100d,pos,size){if(this.isHorizontal){_100d.style.left=pos+"px";_100d.style.top=0;dojo.marginBox(_100d,{w:size,h:this.paneHeight});}else{_100d.style.left=0;_100d.style.top=pos+"px";dojo.marginBox(_100d,{w:this.paneWidth,h:size});}},_growPane:function(_100e,pane){if(_100e>0){if(pane.sizeActual>pane.sizeMin){if((pane.sizeActual-pane.sizeMin)>_100e){pane.sizeActual=pane.sizeActual-_100e;_100e=0;}else{_100e-=pane.sizeActual-pane.sizeMin;pane.sizeActual=pane.sizeMin;}}}return _100e;},_checkSizes:function(){var _100f=0;var _1010=0;var _1011=this.getChildren();dojo.forEach(_1011,function(child){_1010+=child.sizeActual;_100f+=child.sizeMin;});if(_100f<=_1010){var _1012=0;dojo.forEach(_1011,function(child){if(child.sizeActual<child.sizeMin){_1012+=child.sizeMin-child.sizeActual;child.sizeActual=child.sizeMin;}});if(_1012>0){var list=this.isDraggingLeft?_1011.reverse():_1011;dojo.forEach(list,function(child){_1012=this._growPane(_1012,child);},this);}}else{dojo.forEach(_1011,function(child){child.sizeActual=Math.round(_1010*(child.sizeMin/_100f));});}},beginSizing:function(e,i){var _1013=this.getChildren();this.paneBefore=_1013[i];this.paneAfter=_1013[i+1];this.isSizing=true;this.sizingSplitter=this.sizers[i];if(!this.cover){this.cover=dojo.create("div",{style:{position:"absolute",zIndex:5,top:0,left:0,width:"100%",height:"100%"}},this.domNode);}else{this.cover.style.zIndex=5;}this.sizingSplitter.style.zIndex=6;this.originPos=dojo.position(_1013[0].domNode,true);if(this.isHorizontal){var _1014=e.layerX||e.offsetX||0;var _1015=e.pageX;this.originPos=this.originPos.x;}else{var _1014=e.layerY||e.offsetY||0;var _1015=e.pageY;this.originPos=this.originPos.y;}this.startPoint=this.lastPoint=_1015;this.screenToClientOffset=_1015-_1014;this.dragOffset=this.lastPoint-this.paneBefore.sizeActual-this.originPos-this.paneBefore.position;if(!this.activeSizing){this._showSizingLine();}this._ownconnects=[];this._ownconnects.push(dojo.connect(dojo.doc.documentElement,"onmousemove",this,"changeSizing"));this._ownconnects.push(dojo.connect(dojo.doc.documentElement,"onmouseup",this,"endSizing"));dojo.stopEvent(e);},changeSizing:function(e){if(!this.isSizing){return;}this.lastPoint=this.isHorizontal?e.pageX:e.pageY;this.movePoint();if(this.activeSizing){this._updateSize();}else{this._moveSizingLine();}dojo.stopEvent(e);},endSizing:function(e){if(!this.isSizing){return;}if(this.cover){this.cover.style.zIndex=-1;}if(!this.activeSizing){this._hideSizingLine();}this._updateSize();this.isSizing=false;if(this.persist){this._saveState(this);}dojo.forEach(this._ownconnects,dojo.disconnect);},movePoint:function(){var p=this.lastPoint-this.screenToClientOffset;var a=p-this.dragOffset;a=this.legaliseSplitPoint(a);p=a+this.dragOffset;this.lastPoint=p+this.screenToClientOffset;},legaliseSplitPoint:function(a){a+=this.sizingSplitter.position;this.isDraggingLeft=!!(a>0);if(!this.activeSizing){var min=this.paneBefore.position+this.paneBefore.sizeMin;if(a<min){a=min;}var max=this.paneAfter.position+(this.paneAfter.sizeActual-(this.sizerWidth+this.paneAfter.sizeMin));if(a>max){a=max;}}a-=this.sizingSplitter.position;this._checkSizes();return a;},_updateSize:function(){var pos=this.lastPoint-this.dragOffset-this.originPos;var _1016=this.paneBefore.position;var _1017=this.paneAfter.position+this.paneAfter.sizeActual;this.paneBefore.sizeActual=pos-_1016;this.paneAfter.position=pos+this.sizerWidth;this.paneAfter.sizeActual=_1017-this.paneAfter.position;dojo.forEach(this.getChildren(),function(child){child.sizeShare=child.sizeActual;});if(this._started){this.layout();}},_showSizingLine:function(){this._moveSizingLine();dojo.marginBox(this.virtualSizer,this.isHorizontal?{w:this.sizerWidth,h:this.paneHeight}:{w:this.paneWidth,h:this.sizerWidth});this.virtualSizer.style.display="block";},_hideSizingLine:function(){this.virtualSizer.style.display="none";},_moveSizingLine:function(){var pos=(this.lastPoint-this.startPoint)+this.sizingSplitter.position;dojo.style(this.virtualSizer,(this.isHorizontal?"left":"top"),pos+"px");},_getCookieName:function(i){return this.id+"_"+i;},_restoreState:function(){dojo.forEach(this.getChildren(),function(child,i){var _1018=this._getCookieName(i);var _1019=dojo.cookie(_1018);if(_1019){var pos=parseInt(_1019);if(typeof pos=="number"){child.sizeShare=pos;}}},this);},_saveState:function(){if(!this.persist){return;}dojo.forEach(this.getChildren(),function(child,i){dojo.cookie(this._getCookieName(i),child.sizeShare,{expires:365});},this);}});dojo.extend(dijit._Widget,{sizeMin:10,sizeShare:10});}if(!dojo._hasResource["plugins.view.jbrowse.js.Browser"]){dojo._hasResource["plugins.view.jbrowse.js.Browser"]=true;dojo.provide("plugins.view.jbrowse.js.Browser");dojo.declare("plugins.view.jbrowse.js.Browser",[dijit._Widget,dijit._Templated,plugins.core.Common],{templatePath:dojo.moduleUrl("","../plugins/view/templates/browser.html"),widgetsInTemplate:true,cssFiles:["dojo-1.6.1rc2/dojox/layout/resources/ExpandoPane.css"],constructor:function(args){this.loadCSS();this.viewObject=args.viewObject;this.parentWidget=args.parentWidget;this.projectName=args.projectName;this.viewName=args.viewName;this.speciesName=args.speciesName;this.buildName=args.buildName;this.location=args.location;this.locationObject=args.locationObject;this.params=args;this.refSeqs=args.refSeqs;this.trackData=args.trackData;this.deferredFunctions=[];this.tracks=args.tracks;this.trackList=args.trackList;this.dataRoot=args.dataRoot;this.dataRoot;if("dataRoot" in args){dataRoot=args.dataRoot;}else{dataRoot="";}this.attachWidget=args.attachWidget;},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.attachWidget.addChild(this.mainTab);this.attachWidget.selectChild(this.mainTab);this.mainTab.set("title",this.viewObject.project+"."+this.viewObject.view);this.topPane.titleNode.innerHTML=this.firstLetterUpperCase(this.viewObject.species)+" ("+this.viewObject.build+")";this.deferredFunctions=[];var _101a=this.refSeqs;var _101b=this.trackData;var _101c=this.dataRoot||"";this.names=new LazyTrie(_101c+"data/names/lazy-",_101c+"data/names/root.json");this.tracks=[];var brwsr=this;brwsr.isInitialized=false;brwsr.container=this.mainTab;brwsr.container.genomeBrowser=brwsr;var _101d=_101a.reduce(function(a,b){return a.end>b.end?a:b;}).end;var _101e=this.createNavBox(this.topPane,(2*(String(_101d).length+(((String(_101d).length/3)|0)/2)))+2,this.params);var _101f=this.topPane;var _1020=this.centerPane;brwsr.locationTrap=document.createElement("div");brwsr.locationTrap.className="locationTrap";this.topPane.domNode.appendChild(brwsr.locationTrap);brwsr.allRefs={};for(var i=0;i<_101a.length;i++){brwsr.allRefs[_101a[i].name]=_101a[i];}brwsr.refSeq=_101a[0];for(var i=0;i<_101a.length;i++){brwsr.chromList.options[i]=new Option(_101a[i].name,_101a[i].name);if(_101a[i].name.toUpperCase()==this.locationObject.name.toUpperCase()){brwsr.refSeq=brwsr.allRefs[_101a[i].name];brwsr.chromList.selectedIndex=i;}}dojo.connect(brwsr.chromList,"onchange",function(event){var _1021=brwsr.allRefs[brwsr.chromList.options[brwsr.chromList.selectedIndex].value];brwsr.navigateTo(_1021.name+":"+(((_1021.start+_1021.end)*0.4)|0)+" .. "+(((_1021.start+_1021.end)*0.6)|0));});var gv=new GenomeView(this.viewElem.containerNode,250,brwsr.refSeq,1/200,this);brwsr.view=gv;brwsr.viewElem=this.viewElem;this.viewElem.view=gv;dojo.connect(_1020,"resize",function(){gv.sizeInit();brwsr.view.locationTrapHeight=dojo.marginBox(_101e).h;gv.showVisibleBlocks();gv.showFine();gv.showCoarse();});brwsr.view.locationTrapHeight=dojo.marginBox(_101e).h;dojo.connect(gv,"onFineMove",brwsr,"onFineMove");dojo.connect(gv,"onCoarseMove",brwsr,"onCoarseMove");var _1022=brwsr.createTrackList(brwsr.container,this.params);brwsr.isInitialized=true;var _1023=dojo.fromJson(dojo.cookie(brwsr.container.id+"-location"))||{};if(this.params.location){brwsr.navigateTo(this.params.location);}else{if(_1023[brwsr.refSeq.name]){brwsr.navigateTo(brwsr.refSeq.name+":"+_1023[brwsr.refSeq.name]);}else{if(this.params.defaultLocation){brwsr.navigateTo(this.params.defaultLocation);}else{brwsr.navigateTo(brwsr.refSeq.name+":"+((((brwsr.refSeq.start+brwsr.refSeq.end)*0.4)|0)+" .. "+(((brwsr.refSeq.start+brwsr.refSeq.end)*0.6)|0)));}}}for(var i=0;i<brwsr.deferredFunctions.length;i++){brwsr.deferredFunctions[i]();}brwsr.deferredFunctions=[];},onFineMove:function(_1024,endbp){var _1025=this.view.ref.end-this.view.ref.start;var _1026=Math.round((((_1024-this.view.ref.start)/_1025)*this.view.overviewBox.w)+this.view.overviewBox.l);var _1027=Math.round((((endbp-this.view.ref.start)/_1025)*this.view.overviewBox.w)+this.view.overviewBox.l);var _1028;if(dojo.isIE){_1028="top: "+this.view.overviewBox.t+"px;"+"height: "+this.view.overviewBox.h+"px;"+"left: "+_1026+"px;"+"width: "+(_1027-_1026)+"px;"+"border-width: 0px";}else{_1028="top: "+this.view.overviewBox.t+"px;"+"height: "+this.view.overviewBox.h+"px;"+"left: "+this.view.overviewBox.l+"px;"+"width: "+(_1027-_1026)+"px;"+"border-width: "+"0px "+(this.view.overviewBox.w-_1027)+"px "+this.view.locationTrapHeight+"px "+_1026+"px;";}this.locationTrap.style.cssText=_1028;},createTrackList:function(_1029,_102a){var _102b=this.leftPane.containerNode;var _102c=this.leftPane;var _102d=document.createElement("div");_102d.className="container handles";_102d.style.cssText="width: 100%; height: 100%; overflow-x: hidden; overflow-y: auto; text-align: center";_102d.innerHTML="";_102b.appendChild(_102d);var brwsr=this;var _102e=function(){brwsr.view.showVisibleBlocks(true);};var _102f=function(node,url){console.log("js.Browser.trackListCreate    setNodeDblClick     url: "+url);node.ondblclick=function(event){console.log("js.Browser.trackListCreate    DOING node.DOUBLECLICK url: "+url);window.open(url,"_blank");event.stopPropagation();};};var _1030=function(track,hint){var node=document.createElement("div");node.className="tracklist-label";node.innerHTML=track.key;for(var i=0;i<_102a.trackData.length;i++){if(_102a.trackData[i].label==track.label){if(_102a.trackData[i].urlInfo){_102f(node,_102a.trackData[i].urlInfo);}break;}}for(var i=0;i<_102a.trackData.length;i++){if(_102a.trackData[i].label==track.label){dojo.addClass(node,_102a.trackData[i].label+"-label");if(_102a.trackData[i].sourceType!=null){dojo.addClass(node,_102a.trackData[i].sourceType+"-label");}continue;}}if("avatar"!=hint){var _1031=document.createElement("div");_1031.className="tracklist-container";_1031.appendChild(node);node=_1031;}node.id=dojo.dnd.getUniqueId();return {node:node,data:track,type:["track"]};};this.listTracks=function(){var _1032=brwsr.viewDndWidget.getAllNodes();var array=[];for(var i=0;i<_1032.length;i++){array.push(_1032[i].track.name);}var _1033=array.join(",");return _1033;};this.trackListWidget=new dojo.dnd.Source(_102d,{creator:_1030,accept:["track"],withHandles:false});var _1034=function(track,hint){var node;if("avatar"==hint){return _1030(track,hint);}else{var _1035={refseq:brwsr.refSeq.name};var url=track.url.replace(/\{([^}]+)\}/g,function(match,group){return _1035[group];});var klass=eval(track.type);var _1036=brwsr.dataRoot;var _1037=new klass(track,url,brwsr.refSeq,{changeCallback:_102e,trackPadding:brwsr.view.trackPadding,parentWidget:brwsr.parentWidget,baseUrl:_1036,charWidth:brwsr.view.charWidth,seqHeight:brwsr.view.seqHeight});node=brwsr.view.addTrack(_1037);setTimeout(function(){brwsr.viewObject.tracklist=brwsr.listTracks();brwsr.parentWidget.updateViewTracklist(brwsr.viewObject);},100);}return {node:node,data:track,type:["track"]};};this.viewDndWidget=new dojo.dnd.Source(this.view.zoomContainer,{creator:_1034,accept:["track"],withHandles:true});dojo.subscribe("/dnd/drop",function(_1038,nodes,_1039){brwsr.onVisibleTracksChanged();if(_1038===brwsr.viewDndWidget){if(_1038.anchor==null){brwsr.parentWidget.handleTrackChange(brwsr.viewObject,nodes[0].track.name,"remove");}else{brwsr.viewObject.tracklist=brwsr.listTracks();brwsr.parentWidget.updateViewTracklist(brwsr.viewObject);}}});this.trackListWidget.insertNodes(false,_102a.trackData);var _103a=this.trackList;if(_102a.tracks){this.showTracks(_102a.tracks);}else{if(_103a){this.showTracks(_103a);}else{if(_102a.defaultTracks){this.showTracks(_102a.defaultTracks);}}}return _102d;},onVisibleTracksChanged:function(){this.view.updateTrackList();var _103b=dojo.map(this.view.tracks,function(track){return track.name;});this.view.showVisibleBlocks();},addTracks:function(_103c,_103d){if(!this.isInitialized){var brwsr=this;this.deferredFunctions.push(function(){brwsr.addTracks(_103c,show);});return;}this.tracks.concat(_103c);if(show||(show===undefined)){this.showTracks(dojo.map(_103c,function(t){return t.label;}).join(","));}},navigateTo:function(loc){if(!this.isInitialized){var brwsr=this;this.deferredFunctions.push(function(){brwsr.navigateTo(loc);});return;}loc=dojo.trim(loc);var _103e=String(loc).match(/^(((\S*)\s*:)?\s*(-?[0-9,.]*[0-9])\s*(\.\.|-|\s+))?\s*(-?[0-9,.]+)$/i);if(_103e){if(_103e[3]){var _103f;for(ref in this.allRefs){if((_103e[3].toUpperCase()==ref.toUpperCase())||("CHR"+_103e[3].toUpperCase()==ref.toUpperCase())||(_103e[3].toUpperCase()=="CHR"+ref.toUpperCase())){_103f=ref;}}if(_103f){if(_103f==this.refSeq.name){this.view.setLocation(this.refSeq,parseInt(_103e[4].replace(/[,.]/g,"")),parseInt(_103e[6].replace(/[,.]/g,"")));}else{var _1040=[];this.viewDndWidget.forInItems(function(obj,id,map){_1040.push(obj.data);});for(var i=0;i<this.chromList.options.length;i++){if(this.chromList.options[i].text==_103f){this.chromList.selectedIndex=i;}}this.refSeq=this.allRefs[_103f];this.view.setLocation(this.refSeq,parseInt(_103e[4].replace(/[,.]/g,"")),parseInt(_103e[6].replace(/[,.]/g,"")));this.viewDndWidget.insertNodes(false,_1040);this.onVisibleTracksChanged();}return;}}else{if(_103e[4]){this.view.setLocation(this.refSeq,parseInt(_103e[4].replace(/[,.]/g,"")),parseInt(_103e[6].replace(/[,.]/g,"")));return;}else{if(_103e[6]){this.view.centerAtBase(parseInt(_103e[6].replace(/[,.]/g,"")));return;}}}}var brwsr=this;this.names.exactMatch(loc,function(_1041){var _1042;for(var i=0;i<_1041.length;i++){if(_1041[i][1]==loc){_1042=_1041[i];}}if(!_1042){for(var i=0;i<_1041.length;i++){if(_1041[i][1].toLowerCase()==loc.toLowerCase()){_1042=_1041[i];}}}if(!_1042){_1042=_1041[0];}var _1043=_1042[3];var endbp=_1042[4];var flank=Math.round((endbp-_1043)*0.2);brwsr.navigateTo(_1042[2]+":"+(_1043-flank)+".."+(endbp+flank));brwsr.showTracks(brwsr.names.extra[_1041[0][0]]);});},showTracks:function(_1044){if(!this.isInitialized){var brwsr=this;this.deferredFunctions.push(function(){brwsr.showTracks(_1044);});return;}var _1045=_1044.split(",");var _1046=[];var brwsr=this;for(var n=0;n<_1045.length;n++){this.trackListWidget.forInItems(function(obj,id,map){if(_1045[n]==obj.data.label){brwsr.viewDndWidget.insertNodes(false,[obj.data]);_1046.push(id);}});}var _1047;for(var i=0;i<_1046.length;i++){this.trackListWidget.delItem(_1046[i]);_1047=dojo.byId(_1046[i]);_1047=dojo.byId(_1046[i]);_1047.parentNode.removeChild(_1047);}this.onVisibleTracksChanged();},visibleRegion:function(){return this.view.ref.name+":"+Math.round(this.view.minVisible())+".."+Math.round(this.view.maxVisible());},visibleTracks:function(){var _1048=dojo.map(this.view.tracks,function(track){return track.name;});return _1048.join(",");},onCoarseMove:function(_1049,endbp){if(!_1049||!endbp){return;}if(!this.isInitialized){return;}var _104a=this.view.ref.end-this.view.ref.start;var _104b=Math.round((((_1049-this.view.ref.start)/_104a)*this.view.overviewBox.w)+this.view.overviewBox.l);var _104c=Math.round((((endbp-this.view.ref.start)/_104a)*this.view.overviewBox.w)+this.view.overviewBox.l);this.view.locationThumb.style.cssText="height: "+(this.view.overviewBox.h-4)+"px; "+"left: "+_104b+"px; "+"width: "+(_104c-_104b)+"px;"+"z-index: 20";if(!this.isInitialized){return;}var _104d=Util.addCommas(Math.round(_1049))+" .. "+Util.addCommas(Math.round(endbp));this.locationBox.value=_104d;this.goButton.disabled=true;this.locationBox.blur();document.title=this.refSeq.name+":"+_104d;},createNavBox:function(_104e,_104f,_1050){var brwsr=this;var _1051=_1050.browserRoot?_1050.browserRoot:"";var _1052=this.navbox;if(_1050.bookmark){this.link=document.createElement("a");this.link.appendChild(document.createTextNode("Link"));this.link.href=window.location.href;dojo.connect(this,"onCoarseMove",function(){brwsr.link.href=_1050.bookmark(brwsr);});dojo.connect(this,"onVisibleTracksChanged",function(){brwsr.link.href=_1050.bookmark(brwsr);});this.link.style.cssText="float: right; clear";_1052.appendChild(this.link);}this.saveButton=document.createElement("button");this.saveButton.appendChild(document.createTextNode("Save Location"));dojo.addClass(this.saveButton,"saveButton");dojo.connect(this.saveButton,"click",function(event){brwsr.parentWidget.updateViewLocation(brwsr.viewObject,brwsr.locationBox.value,brwsr.chromList.value);dojo.stopEvent(event);});_1052.appendChild(this.saveButton);var _1053=document.createElement("input");_1053.type="image";_1053.src=_1051+"img/slide-left.png";_1053.id="moveLeft";_1053.className="icon nav";_1053.style.height="40px";dojo.connect(_1053,"click",function(event){dojo.stopEvent(event);brwsr.view.slide(0.9);});_1052.appendChild(_1053);var _1054=document.createElement("input");_1054.type="image";_1054.src=_1051+"img/slide-right.png";_1054.id="moveRight";_1054.className="icon nav";_1054.style.height="40px";dojo.connect(_1054,"click",function(event){dojo.stopEvent(event);brwsr.view.slide(-0.9);});_1052.appendChild(_1054);_1052.appendChild(document.createTextNode(""));var _1055=document.createElement("input");_1055.type="image";_1055.src=_1051+"img/zoom-out-2.png";_1055.id="bigZoomOut";_1055.className="icon nav";_1055.style.height="40px";_1052.appendChild(_1055);dojo.connect(_1055,"click",function(event){dojo.stopEvent(event);brwsr.view.zoomOut(undefined,undefined,2);});var _1056=document.createElement("input");_1056.type="image";_1056.src=_1051+"img/zoom-out-1.png";_1056.id="zoomOut";_1056.className="icon nav";_1056.style.height="40px";dojo.connect(_1056,"click",function(event){dojo.stopEvent(event);brwsr.view.zoomOut();});_1052.appendChild(_1056);var _1057=document.createElement("input");_1057.type="image";_1057.src=_1051+"img/zoom-in-1.png";_1057.id="zoomIn";_1057.className="icon nav";_1057.style.height="40px";dojo.connect(_1057,"click",function(event){dojo.stopEvent(event);brwsr.view.zoomIn();});_1052.appendChild(_1057);var _1058=document.createElement("input");_1058.type="image";_1058.src=_1051+"img/zoom-in-2.png";_1058.id="bigZoomIn";_1058.className="icon nav";_1058.style.height="40px";dojo.connect(_1058,"click",function(event){dojo.stopEvent(event);brwsr.view.zoomIn(undefined,undefined,2);});_1052.appendChild(_1058);_1052.appendChild(document.createTextNode(""));this.chromList=document.createElement("select");this.chromList.id="chrom";dojo.addClass(this.chromList,"chromList");_1052.appendChild(this.chromList);this.locationBox=document.createElement("input");this.locationBox.size=_104f;this.locationBox.type="text";this.locationBox.id="location";dojo.connect(this.locationBox,"keydown",function(event){if(event.keyCode==dojo.keys.ENTER){brwsr.navigateTo(brwsr.locationBox.value);brwsr.goButton.disabled=true;dojo.stopEvent(event);}else{brwsr.goButton.disabled=false;}});_1052.appendChild(this.locationBox);this.goButton=document.createElement("button");this.goButton.appendChild(document.createTextNode("Go"));this.goButton.disabled=true;dojo.connect(this.goButton,"click",function(event){brwsr.navigateTo(brwsr.locationBox.value);brwsr.goButton.disabled=true;dojo.stopEvent(event);});_1052.appendChild(this.goButton);dojo.addClass(this.goButton,"goButton");return _1052;}});}if(!dojo._hasResource["plugins.view.jbrowse.js.Util"]){dojo._hasResource["plugins.view.jbrowse.js.Util"]=true;dojo.provide("plugins.view.jbrowse.js.Util");dojo.declare("plugins.view.jbrowse.js.Util",null,{});var Util={};Util.is_ie=navigator.appVersion.indexOf("MSIE")>=0;Util.is_ie6=navigator.appVersion.indexOf("MSIE 6")>=0;Util.addCommas=function(nStr){nStr+="";x=nStr.split(".");x1=x[0];x2=x.length>1?"."+x[1]:"";var rgx=/(\d+)(\d{3})/;while(rgx.test(x1)){x1=x1.replace(rgx,"$1"+","+"$2");}return x1+x2;};Util.wheel=function(event){var delta=0;if(!event){event=window.event;}if(event.wheelDelta){delta=event.wheelDelta/120;if(window.opera){delta=-delta;}}else{if(event.detail){delta=-event.detail/3;}}return Math.round(delta);};Util.isRightButton=function(e){if(!e){var e=window.event;}if(e.which){return e.which==3;}else{if(e.button){return e.button==2;}}};Util.getViewportWidth=function(){var width=0;if(document.documentElement&&document.documentElement.clientWidth){width=document.documentElement.clientWidth;}else{if(document.body&&document.body.clientWidth){width=document.body.clientWidth;}else{if(window.innerWidth){width=window.innerWidth-18;}}}return width;};Util.getViewportHeight=function(){var _1059=0;if(document.documentElement&&document.documentElement.clientHeight){_1059=document.documentElement.clientHeight;}else{if(document.body&&document.body.clientHeight){_1059=document.body.clientHeight;}else{if(window.innerHeight){_1059=window.innerHeight-18;}}}return _1059;};Util.findNearest=function(_105a,num){var _105b=0;var min=Math.abs(num-_105a[0]);for(var i=0;i<_105a.length;i++){if(Math.abs(num-_105a[i])<min){_105b=i;min=Math.abs(num-_105a[i]);}}return _105b;};if(!Array.prototype.reduce){Array.prototype.reduce=function(fun){var len=this.length;if(typeof fun!="function"){throw new TypeError();}if(len==0&&arguments.length==1){throw new TypeError();}var i=0;if(arguments.length>=2){var rv=arguments[1];}else{do{if(i in this){rv=this[i++];break;}if(++i>=len){throw new TypeError();}}while(true);}for(;i<len;i++){if(i in this){rv=fun.call(null,rv,this[i],i,this);}}return rv;};}function Finisher(fun){this.fun=fun;this.count=0;};Finisher.prototype.inc=function(){this.count++;};Finisher.prototype.dec=function(){this.count--;this.finish();};Finisher.prototype.finish=function(){if(this.count<=0){this.fun();}};}if(!dojo._hasResource["plugins.view.jbrowse.js.NCList"]){dojo._hasResource["plugins.view.jbrowse.js.NCList"]=true;dojo.provide("plugins.view.jbrowse.js.NCList");dojo.declare("plugins.view.jbrowse.js.NCList",null,{});function NCList(){};NCList.prototype.importExisting=function(_105c,_105d,_105e,_105f,_1060){this.topList=_105c;this.sublistIndex=_105d;this.lazyIndex=_105e;this.baseURL=_105f;this.lazyUrlTemplate=_1060;};NCList.prototype.fill=function(_1061,_1062){this.sublistIndex=_1062;var _1063=_1061;_1063.sort(function(a,b){if(a[0]!=b[0]){return a[0]-b[0];}else{return b[1]-a[1];}});var _1064=new Array();var _1065=new Array();this.topList=_1065;_1065.push(_1063[0]);var _1066,_1067;for(var i=1,len=_1063.length;i<len;i++){_1066=_1063[i];if(_1066[1]<_1063[i-1][1]){_1064.push(_1065);_1065=new Array(_1066);_1063[i-1][_1062]=_1065;}else{while(true){if(0==_1064.length){_1065.push(_1066);break;}else{_1067=_1064[_1064.length-1];if(_1067[_1067.length-1][1]>_1066[1]){_1065.push(_1066);break;}else{_1065=_1064.pop();}}}}}};NCList.prototype.binarySearch=function(arr,item,_1068){var low=-1;var high=arr.length;var mid;while(high-low>1){mid=(low+high)>>>1;if(arr[mid][_1068]>item){high=mid;}else{low=mid;}}if(1==_1068){return high;}else{return low;}};NCList.prototype.iterHelper=function(arr,from,to,fun,_1069,inc,_106a,_106b,path){var len=arr.length;var i=this.binarySearch(arr,from,_106a);while((i<len)&&(i>=0)&&((inc*arr[i][_106b])<(inc*to))){if("object"==typeof arr[i][this.lazyIndex]){var ncl=this;if(arr[i][this.lazyIndex].state){if("loading"==arr[i][this.lazyIndex].state){_1069.inc();arr[i][this.lazyIndex].callbacks.push(function(_106c){return function(o){ncl.iterHelper(o,from,to,fun,_1069,inc,_106a,_106b,path.concat(_106c));_1069.dec();};}(i));}else{if("loaded"==arr[i][this.lazyIndex].state){}else{}}}else{arr[i][this.lazyIndex].state="loading";arr[i][this.lazyIndex].callbacks=[];_1069.inc();dojo.xhrGet({url:this.baseURL+this.lazyUrlTemplate.replace(/\{chunk\}/g,arr[i][this.lazyIndex].chunk),handleAs:"json",load:function(_106d,_106e,_106f,_1070){return function(o){_106e.state="loaded";_106d[_106f]=o;ncl.iterHelper(o,from,to,fun,_1069,inc,_106a,_106b,path.concat(_1070));for(var c=0;c<_106e.callbacks.length;c++){_106e.callbacks[c](o);}_1069.dec();};}(arr[i],arr[i][this.lazyIndex],this.sublistIndex,i),error:function(){_1069.dec();}});}}else{fun(arr[i],path.concat(i));}if(arr[i][this.sublistIndex]){this.iterHelper(arr[i][this.sublistIndex],from,to,fun,_1069,inc,_106a,_106b,path.concat(i));}i+=inc;}};NCList.prototype.iterate=function(from,to,fun,_1071){var inc=(from>to)?-1:1;var _1072=(from>to)?0:1;var _1073=(from>to)?1:0;var _1074=new Finisher(_1071);this.iterHelper(this.topList,from,to,fun,_1074,inc,_1072,_1073,[]);_1074.finish();};NCList.prototype.histogram=function(from,to,_1075,_1076){var _1077=new Array(_1075);var _1078=(to-from)/_1075;for(var i=0;i<_1075;i++){_1077[i]=0;}this.iterate(from,to,function(feat){var _1079=Math.max(0,((feat[0]-from)/_1078)|0);var _107a=Math.min(_1075,((feat[1]-from)/_1078)|0);for(var bin=_1079;bin<=_107a;bin++){_1077[bin]++;}},function(){_1076(_1077);});};}if(!dojo._hasResource["plugins.view.jbrowse.js.Layout"]){dojo._hasResource["plugins.view.jbrowse.js.Layout"]=true;dojo.provide("plugins.view.jbrowse.js.Layout");dojo.declare("plugins.view.jbrowse.js.Layout",null,{});function Contour(top){if(top===undefined){top=0;}this.spans=[{top:top,x:Infinity,height:0}];};Contour.prototype.getFit=function(x,_107b,_107c){var _107d,_107e;var above=0;if(_107c){for(;this.spans[above].top<_107c;above++){if(above>=(this.spans.length-1)){return {above:this.spans.length-1,count:0};}}}ABOVE:for(;above<this.spans.length;above++){_107d=this.spans[above].top+this.spans[above].height;for(var count=1;above+count<this.spans.length;count++){_107e=this.spans[above+count];if((_107d+_107b)<=_107e.top){return {above:above,count:count-1};}if(_107e.x>x){continue ABOVE;}if((_107e.x<=x)&&((_107d+_107b)<(_107e.top+_107e.height))){return {above:above,count:count-1};}}return {above:above,count:count-1};}return {above:above,count:0};};Contour.prototype.insertFit=function(fit,x,top,_107f){var _1080=this.spans[fit.above];if((Math.abs(_1080.x-x)<1)&&(Math.abs((_1080.top+_1080.height)-top)<1)){_1080.height=(top+_107f)-_1080.top;_1080.x=Math.max(_1080.x,x);this.spans.splice(fit.above+1,fit.count);}else{this.spans.splice(fit.above+1,fit.count,{top:top,x:x,height:_107f});}};Contour.prototype.unionWith=function(x,top,_1081){var _1082,_1083,_1084,_1085,_1086;var _1087=top+_1081;START:for(_1083=0;_1083<this.spans.length;_1083++){_1085=this.spans[_1083];_1082=_1085.top+_1085.height;if(_1085.top>top){_1084=_1083;break START;}if(_1082>top){if(_1085.x>=x){var _1088=_1082-top;top+=_1088;_1081-=_1088;if(top>=_1087){return;}continue;}else{for(_1084=_1083;_1084<this.spans.length;_1084++){_1086=this.spans[_1084];if(((_1086.top+_1086.height)>_1087)||_1086.x>x){break START;}}break START;}}}var _1089=this.spans[_1083-1];if((Math.abs(_1089.x-x)<1)&&(Math.abs((_1089.top+_1089.height)-top)<1)){_1089.height=(top+_1081)-_1089.top;_1089.x=Math.max(_1089.x,x);this.spans.splice(_1083,_1084-_1083);}else{this.spans.splice(_1083,_1084-_1083,{top:top,x:x,height:_1081});}};Contour.prototype.getNextTop=function(fit){return this.spans[fit.above].top+this.spans[fit.above].height;};function Layout(_108a,_108b){this.leftBound=_108a;this.rightBound=_108b;this.leftContour=new Contour();this.rightContour=new Contour();this.seen={};this.leftOverlaps=[];this.rightOverlaps=[];this.totalHeight=0;};Layout.prototype.addRect=function(id,left,right,_108c){if(this.seen[id]!==undefined){return this.seen[id];}var _108d=this.tryLeftFit(left,right,_108c,0);var _108e=this.tryRightFit(left,right,_108c,0);var top;if(_108d.top<_108e.top){top=_108d.top;this.leftContour.insertFit(_108d.fit,this.rightBound-left,top,_108c);this.rightContour.unionWith(right-this.leftBound,top,_108c);}else{top=_108e.top;this.rightContour.insertFit(_108e.fit,right-this.leftBound,top,_108c);this.leftContour.unionWith(this.rightBound-left,top,_108c);}var _108f={id:id,left:left,right:right,top:top,height:_108c};this.seen[id]=top;if(left<=this.leftBound){this.leftOverlaps.push(_108f);if(this.leftLayout){this.leftLayout.addExisting(_108f);}}if(right>=this.rightBound){this.rightOverlaps.push(_108f);if(this.rightLayout){this.rightLayout.addExisting(_108f);}}this.seen[id]=top;this.totalHeight=Math.max(this.totalHeight,top+_108c);return top;};Layout.prototype.tryLeftFit=function(left,right,_1090,top){var fit,_1091;var _1092=top;while(true){fit=this.leftContour.getFit(this.rightBound-right,_1090,_1092);_1092=Math.max(this.leftContour.getNextTop(fit),_1092);if(this.rightLayout&&(right>=this.rightBound)){_1091=this.rightLayout.tryLeftFit(left,right,_1090,_1092);if(_1091.top>_1092){_1092=_1091.top;continue;}}break;}return {top:_1092,fit:fit};};Layout.prototype.tryRightFit=function(left,right,_1093,top){var fit,_1094;var _1095=top;while(true){fit=this.rightContour.getFit(left-this.leftBound,_1093,_1095);_1095=Math.max(this.rightContour.getNextTop(fit),_1095);if(this.leftLayout&&(left<=this.leftBound)){_1094=this.leftLayout.tryRightFit(left,right,_1093,_1095);if(_1094.top>_1095){_1095=_1094.top;continue;}}break;}return {top:_1095,fit:fit};};Layout.prototype.hasSeen=function(id){return (this.seen[id]!==undefined);};Layout.prototype.setLeftLayout=function(left){for(var i=0;i<this.leftOverlaps.length;i++){left.addExisting(this.leftOverlaps[i]);}this.leftLayout=left;};Layout.prototype.setRightLayout=function(right){for(var i=0;i<this.rightOverlaps.length;i++){right.addExisting(this.rightOverlaps[i]);}this.rightLayout=right;};Layout.prototype.cleanup=function(){this.leftLayout=undefined;this.rightLayout=undefined;};Layout.prototype.addExisting=function(_1096){if(this.seen[_1096.id]!==undefined){return;}this.seen[_1096.id]=_1096.top;this.totalHeight=Math.max(this.totalHeight,_1096.top+_1096.height);if(_1096.left<=this.leftBound){this.leftOverlaps.push(_1096);if(this.leftLayout){this.leftLayout.addExisting(_1096);}}if(_1096.right>=this.rightBound){this.rightOverlaps.push(_1096);if(this.rightLayout){this.rightLayout.addExisting(_1096);}}this.leftContour.unionWith(this.rightBound-_1096.left,_1096.top,_1096.height);this.rightContour.unionWith(_1096.right-this.leftBound,_1096.top,_1096.height);};}if(!dojo._hasResource["plugins.view.jbrowse.js.LazyArray"]){dojo._hasResource["plugins.view.jbrowse.js.LazyArray"]=true;dojo.provide("plugins.view.jbrowse.js.LazyArray");dojo.declare("plugins.view.jbrowse.js.LazyArray",null,{});function LazyArray(_1097,_1098){this.urlTemplate=_1097.urlTemplate;this.chunkSize=_1097.chunkSize;this.length=_1097.length;this.baseUrl=(_1098===undefined?"":_1098);this.chunks=[];this.toProcess={};};LazyArray.prototype.index=function(i,_1099,param){this.range(i,i,_1099,undefined,param);};LazyArray.prototype.range=function(start,end,_109a,_109b,param){start=Math.max(0,start);end=Math.min(end,this.length-1);var _109c=Math.floor(start/this.chunkSize);var _109d=Math.floor(end/this.chunkSize);if(_109b===undefined){_109b=function(){};}var _109e=new Finisher(_109b);for(var chunk=_109c;chunk<=_109d;chunk++){if(this.chunks[chunk]){this._processChunk(start,end,chunk,_109a,param);}else{var _109f={start:start,end:end,callback:_109a,param:param,finish:_109e};_109e.inc();if(this.toProcess[chunk]){this.toProcess[chunk].push(_109f);}else{this.toProcess[chunk]=[_109f];var url=this.urlTemplate.replace(/\{chunk\}/g,chunk);var _10a0=this;dojo.xhrGet({url:this.baseUrl+url,handleAs:"json",load:this._makeLoadFun(chunk),error:function(){_109e.dec();}});}}}_109e.finish();};LazyArray.prototype._makeLoadFun=function(chunk){var _10a1=this;return function(data){_10a1.chunks[chunk]=data;var _10a2=_10a1.toProcess[chunk];delete _10a1.toProcess[chunk];for(var i=0;i<_10a2.length;i++){_10a1._processChunk(_10a2[i].start,_10a2[i].end,chunk,_10a2[i].callback,_10a2[i].param);_10a2[i].finish.dec();}};};LazyArray.prototype._processChunk=function(start,end,chunk,_10a3,param){var _10a4=chunk*this.chunkSize;var _10a5=start-_10a4;var _10a6=end-_10a4;_10a5=Math.max(0,_10a5);_10a6=Math.min(_10a6,this.chunkSize-1);for(var i=_10a5;i<=_10a6;i++){_10a3(i+_10a4,this.chunks[chunk][i],param);}};}if(!dojo._hasResource["plugins.view.jbrowse.js.LazyPatricia"]){dojo._hasResource["plugins.view.jbrowse.js.LazyPatricia"]=true;dojo.provide("plugins.view.jbrowse.js.LazyPatricia");dojo.declare("plugins.view.jbrowse.js.LazyPatricia",null,{});function LazyTrie(_10a7,_10a8){this.baseURL=_10a7;var trie=this;dojo.xhrGet({url:_10a8,handleAs:"json",load:function(o){if(!o){return;}trie.root=o;trie.extra=o[0];if(trie.deferred){trie.deferred.callee.apply(trie,trie.deferred);delete trie.deferred;}}});};LazyTrie.prototype.pathToPrefix=function(path){var node=this.root;var _10a9="";loop:for(var i=0;i<path.length;i++){switch(typeof node[path[i]][0]){case "string":_10a9+=node[path[i]][0];break;case "number":_10a9+=node[path[i]][1];break loop;}node=node[path[i]];}return _10a9;};LazyTrie.prototype.valuesFromPrefix=function(query,_10aa){var trie=this;this.findNode(query,function(_10ab,node){_10aa(trie.valuesFromNode(node));});};LazyTrie.prototype.mappingsFromPrefix=function(query,_10ac){var trie=this;this.findNode(query,function(_10ad,node){_10ac(trie.mappingsFromNode(_10ad,node));});};LazyTrie.prototype.mappingsFromNode=function(_10ae,node){var _10af=[];if(node[1]!==null){_10af.push([_10ae,node[1]]);}for(var i=2;i<node.length;i++){if("string"==typeof node[i][0]){_10af=_10af.concat(this.mappingsFromNode(_10ae+node[i][0],node[i]));}}return _10af;};LazyTrie.prototype.valuesFromNode=function(node){var _10b0=[];if(node[1]!==null){_10b0.push(node[1]);}for(var i=2;i<node.length;i++){_10b0=_10b0.concat(this.valuesFromNode(node[i]));}return _10b0;};LazyTrie.prototype.exactMatch=function(key,_10b1){var trie=this;this.findNode(key,function(_10b2,node){if((_10b2.toLowerCase()==key.toLowerCase())&&node[1]){_10b1(node[1]);}});};LazyTrie.prototype.findNode=function(query,_10b3){var trie=this;this.findPath(query,function(path){var node=trie.root;for(i=0;i<path.length;i++){node=node[path[i]];}var _10b4=trie.pathToPrefix(path);_10b3(_10b4,node);});};LazyTrie.prototype.findPath=function(query,_10b5){if(!this.root){this.deferred=arguments;return;}query=query.toLowerCase();var node=this.root;var _10b6=0;var _10b7;var path=[];while(true){_10b7=this.binarySearch(node,query.charAt(_10b6));if(_10b7<0){return;}path.push(_10b7);if("number"==typeof node[_10b7][0]){var trie=this;dojo.xhrGet({url:this.baseURL+this.pathToPrefix(path)+".json",handleAs:"json",load:function(o){node[_10b7]=o;trie.findPath(query,_10b5);}});return;}node=node[_10b7];if(query.substr(_10b6,node[0].length)!=node[0].substr(0,Math.min(node[0].length,query.length-_10b6))){return;}_10b6+=node[0].length;if(_10b6>=query.length){_10b5(path);return;}}};LazyTrie.prototype.binarySearch=function(a,_10b8){var low=2;var high=a.length-1;var mid,_10b9;while(low<=high){mid=(low+high)>>>1;switch(typeof a[mid][0]){case "string":_10b9=a[mid][0].charAt(0);break;case "number":_10b9=a[mid][1].charAt(0);break;}if(_10b9<_10b8){low=mid+1;}else{if(_10b9>_10b8){high=mid-1;}else{return mid;}}}return -(low+1);};}if(!dojo._hasResource["plugins.view.jbrowse.js.Track"]){dojo._hasResource["plugins.view.jbrowse.js.Track"]=true;dojo.provide("plugins.view.jbrowse.js.Track");dojo.declare("plugins.view.jbrowse.js.Track",null,{});function Track(name,key,_10ba,_10bb){this.name=name;this.key=key;this.loaded=_10ba;this.changed=_10bb;this.height=0;this.shown=true;this.empty=false;};Track.prototype.load=function(url){var _10bc=this;dojo.xhrGet({url:url,handleAs:"json",load:function(o){_10bc.loadSuccess(o);},error:function(o){_10bc.loadFail(o);}});};Track.prototype.loadFail=function(error){this.empty=true;this.setLoaded();};Track.prototype.setViewInfo=function(_10bd,_10be,_10bf,_10c0,_10c1,_10c2,scale){var track=this;this.heightUpdate=function(_10c3,_10c4){if(!this.shown){_10bd(0);return;}if(_10c4!==undefined){track.blockHeights[_10c4]=_10c3;}track.height=Math.max(track.height,_10c3);if(!track.inShowRange){_10bd(Math.max(track.labelHeight,track.height));}};this.div=_10bf;this.label=_10c0;this.widthPct=_10c1;this.widthPx=_10c2;this.leftBlank=document.createElement("div");this.leftBlank.className="blank-block";this.rightBlank=document.createElement("div");this.rightBlank.className="blank-block";this.div.appendChild(this.rightBlank);this.div.appendChild(this.leftBlank);this.sizeInit(_10be,_10c1);this.labelHTML="";this.labelHeight=0;};Track.prototype.hide=function(){if(this.shown){this.div.style.display="none";this.shown=false;}};Track.prototype.show=function(){if(!this.shown){this.div.style.display="block";this.shown=true;}};Track.prototype.initBlocks=function(){this.blocks=new Array(this.numBlocks);this.blockHeights=new Array(this.numBlocks);for(var i=0;i<this.numBlocks;i++){this.blockHeights[i]=0;}this.firstAttached=null;this.lastAttached=null;this._adjustBlanks();};Track.prototype.clear=function(){if(this.blocks){for(var i=0;i<this.numBlocks;i++){this._hideBlock(i);}}this.initBlocks();};Track.prototype.setLabel=function(_10c5){if(this.label===undefined){return;}if(this.labelHTML==_10c5){return;}this.labelHTML=_10c5;this.label.innerHTML=_10c5;this.labelHeight=this.label.offsetHeight;};Track.prototype.transfer=function(){};Track.prototype.startZoom=function(_10c6,_10c7,_10c8){};Track.prototype.endZoom=function(_10c9,_10ca){};Track.prototype.showRange=function(first,last,_10cb,_10cc,scale,_10cd,_10ce){if(this.blocks===undefined){return 0;}if((this.labelHeight==0)&&this.label){this.labelHeight=this.label.offsetHeight;}this.inShowRange=true;this.height=this.labelHeight;var _10cf=(null==this.firstAttached?last+1:this.firstAttached);var _10d0=(null==this.lastAttached?first-1:this.lastAttached);var i,_10d1;var _10d2=0;for(i=_10d0;i>=first;i--){_10d1=_10cb+(_10cc*(i-first));this._showBlock(i,_10d1,_10d1+_10cc,scale,_10cd,_10ce);}for(i=_10d0+1;i<=last;i++){_10d1=_10cb+(_10cc*(i-first));this._showBlock(i,_10d1,_10d1+_10cc,scale,_10cd,_10ce);}var _10d3=this.blocks[first];for(i=_10cf;i<first;i++){this.transfer(this.blocks[i],_10d3,scale,_10cd,_10ce);this.cleanupBlock(this.blocks[i]);this._hideBlock(i);}_10d3=this.blocks[last];for(i=_10d0;i>last;i--){this.transfer(this.blocks[i],_10d3,scale,_10cd,_10ce);this.cleanupBlock(this.blocks[i]);this._hideBlock(i);}this.firstAttached=first;this.lastAttached=last;this._adjustBlanks();this.inShowRange=false;this.heightUpdate(this.height);};Track.prototype.cleanupBlock=function(){};Track.prototype._hideBlock=function(_10d4){if(this.blocks[_10d4]){this.div.removeChild(this.blocks[_10d4]);this.blocks[_10d4]=undefined;this.blockHeights[_10d4]=0;}};Track.prototype._adjustBlanks=function(){if((this.firstAttached===null)||(this.lastAttached===null)){this.leftBlank.style.left="0px";this.leftBlank.style.width="50%";this.rightBlank.style.left="50%";this.rightBlank.style.width="50%";}else{this.leftBlank.style.width=(this.firstAttached*this.widthPct)+"%";this.rightBlank.style.left=((this.lastAttached+1)*this.widthPct)+"%";this.rightBlank.style.width=((this.numBlocks-this.lastAttached-1)*this.widthPct)+"%";}};Track.prototype.hideAll=function(){if(null==this.firstAttached){return;}for(var i=this.firstAttached;i<=this.lastAttached;i++){this._hideBlock(i);}this.firstAttached=null;this.lastAttached=null;this._adjustBlanks();};Track.prototype.setLoaded=function(){this.loaded=true;this.hideAll();this.changed();};Track.prototype._loadingBlock=function(_10d5){_10d5.appendChild(document.createTextNode("Loading..."));_10d5.style.backgroundColor="#eee";return 50;};Track.prototype._showBlock=function(_10d6,_10d7,_10d8,scale,_10d9,_10da){if(this.blocks[_10d6]){this.heightUpdate(this.blockHeights[_10d6],_10d6);return;}if(this.empty){this.heightUpdate(this.labelHeight,_10d6);return;}var _10db=document.createElement("div");_10db.className="block";_10db.style.left=(_10d6*this.widthPct)+"%";_10db.style.width=this.widthPct+"%";_10db.startBase=_10d7;_10db.endBase=_10d8;if(this.loaded){this.fillBlock(_10d6,_10db,this.blocks[_10d6-1],this.blocks[_10d6+1],_10d7,_10d8,scale,this.widthPx,_10d9,_10da);}else{this._loadingBlock(_10db);}this.blocks[_10d6]=_10db;this.div.appendChild(_10db);};Track.prototype.moveBlocks=function(delta){var _10dc=new Array(this.numBlocks);var _10dd=new Array(this.numBlocks);var i;for(i=0;i<this.numBlocks;i++){_10dd[i]=0;}var _10de;if((this.lastAttached+delta<0)||(this.firstAttached+delta>=this.numBlocks)){this.firstAttached=null;this.lastAttached=null;}else{this.firstAttached=Math.max(0,Math.min(this.numBlocks-1,this.firstAttached+delta));this.lastAttached=Math.max(0,Math.min(this.numBlocks-1,this.lastAttached+delta));if(delta<0){_10de=this.blocks[this.firstAttached-delta];}else{_10de=this.blocks[this.lastAttached-delta];}}for(i=0;i<this.blocks.length;i++){var _10df=i+delta;if((_10df<0)||(_10df>=this.numBlocks)){if(_10de&&this.blocks[i]){this.transfer(this.blocks[i],_10de);}this._hideBlock(i);}else{_10dc[_10df]=this.blocks[i];if(_10dc[_10df]){_10dc[_10df].style.left=((_10df)*this.widthPct)+"%";}_10dd[_10df]=this.blockHeights[i];}}this.blocks=_10dc;this.blockHeights=_10dd;this._adjustBlanks();};Track.prototype.sizeInit=function(_10e0,_10e1,_10e2){var i,_10e3;this.numBlocks=_10e0;this.widthPct=_10e1;if(_10e2){this.moveBlocks(-_10e2);}if(this.blocks&&(this.blocks.length>0)){var _10e4=this.blocks[_10e0-1];for(i=_10e0;i<this.blocks.length;i++){if(_10e4&&this.blocks[i]){this.transfer(this.blocks[i],_10e4);}this._hideBlock(i);}_10e3=this.blocks.length;this.blocks.length=_10e0;this.blockHeights.length=_10e0;for(i=_10e3;i<_10e0;i++){this.blocks[i]=undefined;this.blockHeights[i]=0;}this.lastAttached=Math.min(this.lastAttached,_10e0-1);if(this.firstAttached>this.lastAttached){this.firstAttached=null;this.lastAttached=null;}if(this.blocks.length!=_10e0){throw new Error("block number mismatch: should be "+_10e0+"; blocks.length: "+this.blocks.length);}for(i=0;i<_10e0;i++){if(this.blocks[i]){this.blocks[i].style.left=(i*_10e1)+"%";this.blocks[i].style.width=_10e1+"%";}}}else{this.initBlocks();}};}if(!dojo._hasResource["plugins.view.jbrowse.js.SequenceTrack"]){dojo._hasResource["plugins.view.jbrowse.js.SequenceTrack"]=true;dojo.provide("plugins.view.jbrowse.js.SequenceTrack");dojo.declare("plugins.view.jbrowse.js.SequenceTrack",null,{});function SequenceTrack(_10e5,url,_10e6,_10e7){Track.call(this,_10e5.label,_10e5.key,false,_10e7.changeCallback);this.browserParams=_10e7;this.trackMeta=_10e5;this.setLoaded();this.chunks=[];this.chunkSize=_10e5.args.chunkSize;this.baseUrl=(_10e7.baseUrl?_10e7.baseUrl:"")+url;};SequenceTrack.prototype=new Track("");SequenceTrack.prototype.startZoom=function(_10e8,_10e9,_10ea){this.hide();this.heightUpdate(0);};SequenceTrack.prototype.endZoom=function(_10eb,_10ec){if(_10eb==this.browserParams.charWidth){this.show();}Track.prototype.clear.apply(this);};SequenceTrack.prototype.setViewInfo=function(_10ed,_10ee,_10ef,_10f0,_10f1,_10f2,scale){Track.prototype.setViewInfo.apply(this,[_10ed,_10ee,_10ef,_10f0,_10f1,_10f2,scale]);if(scale==this.browserParams.charWidth){this.show();}else{this.hide();}this.setLabel(this.key);};SequenceTrack.prototype.fillBlock=function(_10f3,block,_10f4,_10f5,_10f6,_10f7,scale,_10f8,_10f9,_10fa){if(this.shown){this.getRange(_10f6,_10f7,function(start,end,seq){var _10fb=document.createElement("div");_10fb.className="sequence";_10fb.appendChild(document.createTextNode(seq));_10fb.style.cssText="top: 0px;";block.appendChild(_10fb);});this.heightUpdate(this.browserParams.seqHeight,_10f3);}else{this.heightUpdate(0,_10f3);}};SequenceTrack.prototype.getRange=function(start,end,_10fc){var _10fd=Math.floor((start)/this.chunkSize);var _10fe=Math.floor((end-1)/this.chunkSize);var _10ff={start:start,end:end,callback:_10fc};var _1100=this.chunkSize;var chunk;for(var i=_10fd;i<=_10fe;i++){chunk=this.chunks[i];if(chunk){if(chunk.loaded){_10fc(start,end,chunk.sequence.substring(start-(i*_1100),end-(i*_1100)));}else{chunk.callbacks.push(_10ff);}}else{chunk={loaded:false,num:i,callbacks:[_10ff]};this.chunks[i]=chunk;dojo.xhrGet({url:this.baseUrl+i+".txt",load:function(_1101){var ci;chunk.sequence=_1101;for(var c=0;c<chunk.callbacks.length;c++){ci=chunk.callbacks[c];ci.callback(ci.start,ci.end,_1101.substring(ci.start-(chunk.num*_1100),ci.end-(chunk.num*_1100)));}chunk.callbacks=undefined;chunk.loaded=true;}});}}};}if(!dojo._hasResource["plugins.view.jbrowse.js.FeatureTrack"]){dojo._hasResource["plugins.view.jbrowse.js.FeatureTrack"]=true;dojo.provide("plugins.view.jbrowse.js.FeatureTrack");dojo.declare("plugins.view.jbrowse.js.FeatureTrack",null,{});function FeatureTrack(_1102,url,_1103,_1104){Track.call(this,_1102.label,_1102.key,false,_1104.changeCallback);this.fields={};this.features=new NCList();this.refSeq=_1103;this.baseUrl=(_1104.baseUrl?_1104.baseUrl:"");this.url=url;this.parentWidget=_1104.parentWidget;this.trackBaseUrl=this.baseUrl;this.numBins=25;this.histLabel=false;this.padding=5;this.trackPadding=_1104.trackPadding;this.trackMeta=_1102;this.load(this.baseUrl+url);var _1105=this;};FeatureTrack.prototype=new Track("");FeatureTrack.prototype.loadSuccess=function(_1106){var _1107=new Date().getTime();this.count=_1106.featureCount;this.fields={};for(var i=0;i<_1106.headers.length;i++){this.fields[_1106.headers[i]]=i;}this.subFields={};if(_1106.subfeatureHeaders){for(var i=0;i<_1106.subfeatureHeaders.length;i++){this.subFields[_1106.subfeatureHeaders[i]]=i;}}this.features.importExisting(_1106.featureNCList,_1106.sublistIndex,_1106.lazyIndex,this.trackBaseUrl,_1106.lazyfeatureUrlTemplate);if(_1106.subfeatureArray){this.subfeatureArray=new LazyArray(_1106.subfeatureArray,this.trackBaseUrl);}this.histScale=4*(_1106.featureCount/this.refSeq.length);this.labelScale=50*(_1106.featureCount/this.refSeq.length);this.subfeatureScale=80*(_1106.featureCount/this.refSeq.length);this.className=_1106.className;this.subfeatureClasses=_1106.subfeatureClasses;this.arrowheadClass=_1106.arrowheadClass;this.urlTemplate=_1106.urlTemplate;this.histogramMeta=_1106.histogramMeta;for(var i=0;i<this.histogramMeta.length;i++){this.histogramMeta[i].lazyArray=new LazyArray(this.histogramMeta[i].arrayParams,this.trackBaseUrl);}this.histStats=_1106.histStats;this.histBinBases=_1106.histBinBases;if(_1106.clientConfig){var cc=_1106.clientConfig;var _1108=_1106.featureCount/this.refSeq.length;this.histScale=(cc.histScale?cc.histScale:4)*_1108;this.labelScale=(cc.labelScale?cc.labelScale:50)*_1108;this.subfeatureScale=(cc.subfeatureScale?cc.subfeatureScale:80)*_1108;if(cc.featureCss){this.featureCss=cc.featureCss;}if(cc.histCss){this.histCss=cc.histCss;}if(cc.featureCallback){try{this.featureCallback=eval("("+cc.featureCallback+")");}catch(e){}}}var _1109=this;var _110a=this.fields;this.onFeatureClick=function(event){event=event||window.event;if(event.shiftKey){return;}var elem=(event.currentTarget||event.srcElement);if(!elem.feature){elem=elem.parentElement;}if(!elem.feature){return;}};this.setLoaded();};FeatureTrack.prototype.setViewInfo=function(_110b,_110c,_110d,_110e,_110f,_1110,scale){Track.prototype.setViewInfo.apply(this,[_110b,_110c,_110d,_110e,_110f,_1110,scale]);this.setLabel(this.key);};FeatureTrack.prototype.fillHist=function(_1111,block,_1112,_1113,_1114){var _1115=(_1113-_1112)/this.numBins;var _1116=2;var _1117=false;for(var i=0;i<this.histStats.length;i++){if(this.histStats[i].bases>=_1115){_1117=((this.histStats[i].mean/this.histStats[i].max)<0.01);_1116=100/(_1117?Math.log(this.histStats[i].max):this.histStats[i].max);break;}}var track=this;var _1118=function(hist){var _1119=0;for(var bin=0;bin<track.numBins;bin++){if(typeof hist[bin]=="number"&&isFinite(hist[bin])){_1119=Math.max(_1119,hist[bin]);}}var _111a;for(var bin=0;bin<track.numBins;bin++){if(!(typeof hist[bin]=="number"&&isFinite(hist[bin]))){continue;}_111a=document.createElement("div");_111a.className=track.className+"-hist";_111a.style.cssText="left: "+((bin/track.numBins)*100)+"%; "+"height: "+(_1116*(_1117?Math.log(hist[bin]):hist[bin]))+"px;"+"bottom: "+track.trackPadding+"px;"+"width: "+(((1/track.numBins)*100)-(100/_1114))+"%;"+(track.histCss?track.histCss:"");if(Util.is_ie6){_111a.appendChild(document.createComment());}block.appendChild(_111a);}track.heightUpdate(_1116*(_1117?Math.log(_1119):_1119),_1111);};var _111b=this.histogramMeta[0];for(var i=0;i<this.histogramMeta.length;i++){if(_1115>=this.histogramMeta[i].basesPerBin){_111b=this.histogramMeta[i];}}var _111c=_1115/_111b.basesPerBin;if((_111c>0.9)&&(Math.abs(_111c-Math.round(_111c))<0.0001)){var _111d=Math.floor(_1112/_111b.basesPerBin);_111c=Math.round(_111c);var _111e=[];for(var bin=0;bin<this.numBins;bin++){_111e[bin]=0;}_111b.lazyArray.range(_111d,_111d+(_111c*this.numBins),function(i,val){_111e[Math.floor((i-_111d)/_111c)]+=val;},function(){_1118(_111e);});}else{this.features.histogram(_1112,_1113,this.numBins,_1118);}};FeatureTrack.prototype.endZoom=function(_111f,_1120){if(_111f<this.histScale){this.setLabel(this.key+"<br>per "+Math.round(_1120/this.numBins)+"bp");}else{this.setLabel(this.key);}this.clear();};FeatureTrack.prototype.fillBlock=function(_1121,block,_1122,_1123,_1124,_1125,scale,_1126,_1127,_1128){if(scale<this.histScale){this.fillHist(_1121,block,_1124,_1125,_1126,_1127,_1128);}else{this.fillFeatures(_1121,block,_1122,_1123,_1124,_1125,scale,_1127,_1128);}};FeatureTrack.prototype.cleanupBlock=function(block){if(block&&block.featureLayout){block.featureLayout.cleanup();}};FeatureTrack.prototype.transfer=function(_1129,_112a,scale,_112b,_112c){if(!(_1129&&_112a)){return;}if(!_1129.featureLayout){return;}var _112d=_112a.startBase;var _112e=_112a.endBase;var _112f=_112e-_112d;var _1130;var _1131=(_1129.startBase<_112a.startBase)?_1129.featureLayout.rightOverlaps:_1129.featureLayout.leftOverlaps;for(var i=0;i<_1131.length;i++){_1130=_1129.featureNodes[_1131[i].id];if(_1130&&("label" in _1130)){_1130.label.parentNode.removeChild(_1130.label);}if(_1130&&_1130.feature){if((_1130.layoutEnd>_112d)&&(_1130.feature[this.fields["start"]]<_112e)){_1129.removeChild(_1130);delete _1129.featureNodes[_1131[i].id];var _1132=this.renderFeature(_1130.feature,_1131[i].id,_112a,scale,_112b,_112c);_112a.appendChild(_1132);}}}};FeatureTrack.prototype.fillFeatures=function(_1133,block,_1134,_1135,_1136,_1137,scale,_1138,_1139){var _113a=new Layout(_1136,_1137);block.featureLayout=_113a;block.featureNodes={};block.style.backgroundColor="#ddd";var _113b=false;if(_1134&&_1134.featureLayout){_1134.featureLayout.setRightLayout(_113a);_113a.setLeftLayout(_1134.featureLayout);}if(_1135&&_1135.featureLayout){_1135.featureLayout.setLeftLayout(_113a);_113a.setRightLayout(_1135.featureLayout);_113b=true;}if(!this.haveMeasurements){this.measureStyles();this.haveMeasurements=true;}var _113c=this;var _113d=function(_113e,path){var _113f=path.join(",");if(_113a.hasSeen(_113f)){return;}var _1140=_113c.renderFeature(_113e,_113f,block,scale,_1138,_1139);block.appendChild(_1140);};var _1141=_113b?_1137:_1136;var _1142=_113b?_1136:_1137;this.features.iterate(_1141,_1142,_113d,function(){block.style.backgroundColor="";_113c.heightUpdate(_113a.totalHeight,_1133);});};FeatureTrack.prototype.measureStyles=function(){var _1143=document.createElement("div");_1143.className="feature-label";_1143.style.height="auto";_1143.style.visibility="hidden";_1143.appendChild(document.createTextNode("1234567890"));document.body.appendChild(_1143);this.nameHeight=_1143.clientHeight;this.nameWidth=_1143.clientWidth/10;document.body.removeChild(_1143);var _1144;_1143=document.createElement("div");_1143.className=this.className+" plus-"+this.className+" plus-"+this.className+"1";if(this.featureCss){_1143.style.cssText=this.featureCss;}_1143.style.visibility="hidden";if(Util.is_ie6){_1143.appendChild(document.createComment("foo"));}document.body.appendChild(_1143);_1144=dojo.marginBox(_1143);this.glyphHeight=Math.round(_1144.h+2);this.padding+=_1144.w;document.body.removeChild(_1143);if(this.arrowheadClass){var ah=document.createElement("div");ah.className="plus-"+this.arrowheadClass;if(Util.is_ie6){ah.appendChild(document.createComment("foo"));}document.body.appendChild(ah);_1144=dojo.marginBox(ah);this.plusArrowWidth=_1144.w;ah.className="minus-"+this.arrowheadClass;_1144=dojo.marginBox(ah);this.minusArrowWidth=_1144.w;document.body.removeChild(ah);}};FeatureTrack.prototype.renderFeature=function(_1145,_1146,block,scale,_1147,_1148){var _1149=this.fields;var _114a=_1145[_1149["end"]];var _114b=_1145[_1149["start"]];if(this.arrowheadClass){switch(_1145[_1149["strand"]]){case 1:_114a+=(this.plusArrowWidth/scale);break;case -1:_114b-=(this.minusArrowWidth/scale);break;}}if(scale>this.labelScale){_114a=Math.max(_114a,_1145[_1149["start"]]+(((_1149["name"]&&_1145[_1149["name"]])?_1145[_1149["name"]].length:0)*(this.nameWidth/scale)));}_114a+=Math.max(1,this.padding/scale);var _114c=this.glyphHeight+2+((_1149["name"]&&(scale>this.labelScale))?this.nameHeight:0);var top=block.featureLayout.addRect(_1146,_114b,_114a,_114c);var _114d;var _114e=this.featureUrl(_1145);if(_114e){_114d=document.createElement("a");_114d.href=_114e;_114d.target="_new";}else{_114d=document.createElement("div");_114d.onclick=this.onFeatureClick;}_114d.feature=_1145;_114d.layoutEnd=_114a;block.featureNodes[_1146]=_114d;switch(_1145[_1149["strand"]]){case 1:_114d.className="plus-"+this.className;break;case 0:case null:case undefined:_114d.className=this.className;break;case -1:_114d.className="minus-"+this.className;break;}if((_1149["phase"]!==undefined)&&(_1145[_1149["phase"]]!==null)){_114d.className=_114d.className+_1145[_1149["phase"]];}var _114f=Math.max(_1145[_1149["start"]],_1147);var _1150=Math.min(_1145[_1149["end"]],_1148);var _1151=block.endBase-block.startBase;_114d.style.cssText="left:"+(100*(_114f-block.startBase)/_1151)+"%;"+"top:"+top+"px;"+" width:"+(100*((_1150-_114f)/_1151))+"%;"+(this.featureCss?this.featureCss:"");if(this.featureCallback){this.featureCallback(_1145,_1149,_114d);}if(this.arrowheadClass){var ah=document.createElement("div");switch(_1145[_1149["strand"]]){case 1:ah.className="plus-"+this.arrowheadClass;ah.style.cssText="left: 100%; top: 0px;";_114d.appendChild(ah);break;case -1:ah.className="minus-"+this.arrowheadClass;ah.style.cssText="left: "+(-this.minusArrowWidth)+"px; top: 0px;";_114d.appendChild(ah);break;}}if((scale>this.labelScale)&&_1149["name"]&&_1145[_1149["name"]]){var _1152;if(_114e){_1152=document.createElement("a");_1152.href=_114e;_1152.target=_114d.target;}else{_1152=document.createElement("div");_1152.onclick=this.onFeatureClick;}_1152.className="feature-label";_1152.appendChild(document.createTextNode(_1145[_1149["name"]]));_1152.style.cssText="left: "+(100*(_1145[_1149["start"]]-block.startBase)/_1151)+"%; "+"top: "+(top+this.glyphHeight)+"px;";_114d.label=_1152;_1152.feature=_1145;block.appendChild(_1152);}if(_1149["subfeatures"]&&(scale>this.subfeatureScale)&&_1145[_1149["subfeatures"]]&&_1145[_1149["subfeatures"]].length>0){for(var i=0;i<_1145[_1149["subfeatures"]].length;i++){this.renderSubfeature(_1145,_114d,_1145[_1149["subfeatures"]][i],_114f,_1150);}}if(Util.is_ie6){_114d.appendChild(document.createComment());}return _114d;};FeatureTrack.prototype.featureUrl=function(_1153){var _1154=true;var _1155=this.fields;if(this.urlTemplate){var href=this.urlTemplate.replace(/\{([^}]+)\}/g,function(match,group){if(_1153[_1155[group]]!=undefined){return _1153[_1155[group]];}else{_1154=false;}return 0;});if(_1154){return href;}}return undefined;};FeatureTrack.prototype.renderSubfeature=function(_1156,_1157,_1158,_1159,_115a){var _115b=_1158[this.subFields["start"]];var _115c=_1158[this.subFields["end"]];var _115d=_115a-_1159;var _115e=document.createElement("div");if(this.subfeatureClasses){var _115f=this.subfeatureClasses[_1158[this.subFields["type"]]];switch(_1158[this.subFields["strand"]]){case 1:_115e.className="plus-"+_115f;break;case 0:case null:case undefined:_115e.className=_115f;break;case -1:_115e.className="minus-"+_115f;break;}}if((_115c<=_1159)||(_115b>=_115a)){return;}if(Util.is_ie6){_115e.appendChild(document.createComment());}_115e.style.cssText="left: "+(100*((_115b-_1159)/_115d))+"%;"+"top: 0px;"+"width: "+(100*((_115c-_115b)/_115d))+"%;";if(this.featureCallback){this.featureCallback(_1158,this.subFields,_115e);}_1157.appendChild(_115e);};}if(!dojo._hasResource["plugins.view.jbrowse.js.UITracks"]){dojo._hasResource["plugins.view.jbrowse.js.UITracks"]=true;dojo.provide("plugins.view.jbrowse.js.UITracks");dojo.declare("plugins.view.jbrowse.js.UITracks",null,{});function StaticTrack(name,_1160,_1161){Track.call(this,name,name,true,function(){});this.labelClass=_1160;this.posHeight=_1161;this.height=_1161;};StaticTrack.prototype=new Track("");StaticTrack.prototype.fillBlock=function(_1162,block,_1163,_1164,_1165,_1166,scale,_1167,_1168){var _1169=document.createElement("div");_1169.className=this.labelClass;_1169.appendChild(document.createTextNode(Util.addCommas(_1165)));_1169.style.top="0px";block.appendChild(_1169);this.heightUpdate(this.posHeight,_1162);};function GridTrack(name){Track.call(this,name,name,true,function(){});};GridTrack.prototype=new Track("");GridTrack.prototype.fillBlock=function(_116a,block,_116b,_116c,_116d,_116e,scale,_116f,_1170){var _1171=document.createElement("div");_1171.className="gridline";_1171.style.cssText="left: 0%; width: 0px;";block.appendChild(_1171);this.heightUpdate(100,_116a);};}if(!dojo._hasResource["plugins.view.jbrowse.js.ImageTrack"]){dojo._hasResource["plugins.view.jbrowse.js.ImageTrack"]=true;dojo.provide("plugins.view.jbrowse.js.ImageTrack");dojo.declare("plugins.view.jbrowse.js.ImageTrack",null,{});function ImageTrack(_1172,url,_1173,_1174){Track.call(this,_1172.label,_1172.key,false,_1174.changeCallback);this.refSeq=_1173;this.tileToImage={};this.zoomCache={};this.baseUrl=(_1174.baseUrl?_1174.baseUrl:"");this.load(this.baseUrl+url);this.imgErrorHandler=function(ev){var img=ev.target||ev.srcElement;img.style.display="none";dojo.stopEvent(ev);};};ImageTrack.prototype=new Track("");ImageTrack.prototype.loadSuccess=function(o){this.tileWidth=o.tileWidth;this.zoomLevels=o.zoomLevels;this.setLoaded();};ImageTrack.prototype.setViewInfo=function(_1175,_1176,_1177,_1178,_1179,_117a,scale){Track.prototype.setViewInfo.apply(this,[_1175,_1176,_1177,_1178,_1179,_117a,scale]);this.setLabel(this.key);};ImageTrack.prototype.getZoom=function(scale){var _117b=this.zoomCache[scale];if(_117b){return _117b;}_117b=this.zoomLevels[0];var _117c=this.tileWidth/scale;for(i=1;i<this.zoomLevels.length;i++){if(Math.abs(this.zoomLevels[i].basesPerTile-_117c)<Math.abs(_117b.basesPerTile-_117c)){_117b=this.zoomLevels[i];}}this.zoomCache[scale]=_117b;return _117b;};ImageTrack.prototype.getImages=function(zoom,_117d,_117e){var _117f=(_117d/zoom.basesPerTile)|0;var _1180=(_117e/zoom.basesPerTile)|0;_117f=Math.max(_117f,0);var _1181=[];var im;for(var i=_117f;i<=_1180;i++){im=this.tileToImage[i];if(!im){im=document.createElement("img");dojo.connect(im,"onerror",this.imgErrorHandler);var _1182=new RegExp("^(([^/]+:)|/)");im.src=(zoom.urlPrefix.match(_1182)?"":this.baseUrl)+zoom.urlPrefix+i+".png";im.startBase=(i*zoom.basesPerTile);im.baseWidth=zoom.basesPerTile;im.tileNum=i;this.tileToImage[i]=im;}_1181.push(im);}return _1181;};ImageTrack.prototype.fillBlock=function(_1183,block,_1184,_1185,_1186,_1187,scale,_1188,_1189,_118a){var zoom=this.getZoom(scale);var _118b=_1187-_1186;var _118c=this.getImages(zoom,_1186,_1187);var im;for(var i=0;i<_118c.length;i++){im=_118c[i];if(!(im.parentNode&&im.parentNode.parentNode)){im.style.position="absolute";im.style.left=(100*((im.startBase-_1186)/_118b))+"%";im.style.width=(100*(im.baseWidth/_118b))+"%";im.style.top="0px";im.style.height=zoom.height+"px";block.appendChild(im);}}this.heightUpdate(zoom.height,_1183);};ImageTrack.prototype.startZoom=function(_118d,_118e,_118f){if(this.empty){return;}this.tileToImage={};this.getImages(this.getZoom(_118d),_118e,_118f);};ImageTrack.prototype.endZoom=function(_1190,_1191){Track.prototype.clear.apply(this);};ImageTrack.prototype.clear=function(){Track.prototype.clear.apply(this);this.tileToImage={};};ImageTrack.prototype.transfer=function(_1192,_1193,scale,_1194,_1195){if(!(_1192&&_1193)){return;}var _1196=_1192.childNodes;var _1197=_1193.startBase;var _1198=_1193.endBase;var im;for(var i=0;i<_1196.length;i++){im=_1196[i];if("startBase" in im){if((im.startBase<_1198)&&((im.startBase+im.baseWidth)>_1197)){im.style.left=(100*((im.startBase-_1197)/(_1198-_1197)))+"%";_1193.appendChild(im);}else{delete this.tileToImage[im.tileNum];}}}};}if(!dojo._hasResource["plugins.view.jbrowse.js.GenomeView"]){dojo._hasResource["plugins.view.jbrowse.js.GenomeView"]=true;dojo.provide("plugins.view.jbrowse.js.GenomeView");dojo.declare("plugins.view.jbrowse.js.GenomeView",null,{});function Animation(_1199,_119a,time){if(_1199===undefined){return;}if("animation" in _1199){_1199.animation.stop();}this.index=0;this.time=time;this.subject=_1199;this.callback=_119a;var _119b=this;this.animFunction=function(){_119b.animate();};this.animID=setTimeout(this.animFunction,33);this.frames=0;_1199.animation=this;};Animation.prototype.animate=function(){if(this.finished){this.stop();return;}var _119c=33;var _119d=0;if(!("startTime" in this)){this.startTime=(new Date()).getTime();}else{_119d=(new Date()).getTime()-this.startTime;_119c=Math.max(33,_119d/this.frames);}if(_119d<this.time){this.step(_119d/this.time);this.frames++;}else{this.step(1);this.finished=true;}this.animID=setTimeout(this.animFunction,_119c);};Animation.prototype.stop=function(){clearTimeout(this.animID);delete this.subject.animation;this.callback(this);};function Slider(view,_119e,time,_119f){Animation.call(this,view,_119e,time);this.slideStart=view.getX();this.slideDistance=_119f;};Slider.prototype=new Animation();Slider.prototype.step=function(pos){var newX=(this.slideStart-(this.slideDistance*((-0.5*Math.cos(pos*Math.PI))+0.5)))|0;newX=Math.max(Math.min(this.subject.maxLeft-this.subject.offset,newX),this.subject.minLeft-this.subject.offset);this.subject.setX(newX);};function Zoomer(scale,_11a0,_11a1,time,_11a2){Animation.call(this,_11a0,_11a1,time);this.toZoom=_11a0.zoomContainer;var _11a3=this.toZoom.clientWidth;this.initialWidth=_11a3;this.width0=_11a3*Math.min(1,scale);var _11a4=_11a3*Math.max(1,scale);this.distance=_11a4-this.width0;this.zoomingIn=scale>1;this.center=(_11a0.getX()+(_11a0.elem.clientWidth*_11a2))/_11a0.scrollContainer.clientWidth;this.initialX=this.subject.getX();this.initialLeft=parseInt(this.toZoom.style.left);};Zoomer.prototype=new Animation();Zoomer.prototype.step=function(pos){var _11a5=this.zoomingIn?pos:1-pos;var _11a6=((_11a5*_11a5)*this.distance)+this.width0;var _11a7=(this.center*this.initialWidth)-(this.center*_11a6);this.toZoom.style.width=_11a6+"px";this.toZoom.style.left=(this.initialLeft+_11a7)+"px";var _11a8=this.toZoom.offsetTop;this.subject.updateTrackLabels(this.initialX-_11a7);};function GenomeView(elem,_11a9,_11aa,_11ab,_11ac){var _11ad=document.createElement("div");_11ad.className="sequence";_11ad.style.visibility="hidden";var _11ae="12345678901234567890123456789012345678901234567890";_11ad.appendChild(document.createTextNode(_11ae));elem.appendChild(_11ad);this.charWidth=_11ad.clientWidth/_11ae.length;this.seqHeight=_11ad.clientHeight;elem.removeChild(_11ad);var _11af=document.createElement("div");_11af.className="pos-label";_11af.style.visibility="hidden";_11af.appendChild(document.createTextNode("42"));elem.appendChild(_11af);this.posHeight=_11af.clientHeight;this.topSpace=1.5*this.posHeight;elem.removeChild(_11af);this.ref=_11aa;this.pxPerBp=_11ab;this.stripeWidth=_11a9;this.elem=elem;this.scrollContainer=document.createElement("div");this.scrollContainer.id="container";this.scrollContainer.style.cssText="position: absolute; left: 0px; top: 0px;";elem.appendChild(this.scrollContainer);this.zoomContainer=document.createElement("div");this.zoomContainer.id="zoomContainer";this.zoomContainer.style.cssText="position: absolute; left: 0px; top: 0px; height: 100%;";this.scrollContainer.appendChild(this.zoomContainer);this.regularStripe=_11a9;this.fullZoomStripe=this.charWidth*(_11a9/10);this.overview=_11ac.overview;this.overviewBox=dojo.marginBox(this.overview);this.tracks=[];this.uiTracks=[];this.trackIndices={};this.sizeInit();this.offset=0;this.maxLeft=this.bpToPx(this.ref.end)-this.dim.width;this.minLeft=this.bpToPx(this.ref.start);this.trackPadding=20;this.drawMargin=0.2;this.slideTimeMultiple=0.8;this.trackHeights=[];this.trackTops=[];this.trackLabels=[];this.waitElems=[dojo.byId("moveLeft"),dojo.byId("moveRight"),dojo.byId("zoomIn"),dojo.byId("zoomOut"),dojo.byId("bigZoomIn"),dojo.byId("bigZoomOut"),document.body,elem];this.prevCursors=[];this.locationThumb=_11ac.locationThumb;this.locationThumb.className="locationThumb";this.overview.appendChild(this.locationThumb);this.locationThumbMover=new dojo.dnd.move.parentConstrainedMoveable(this.locationThumb,{area:"margin",within:true});dojo.connect(this.locationThumbMover,"onMoveStop",this,"thumbMoved");var view=this;var _11b0=dojo.isIE;if(_11b0){view.x=-parseInt(view.scrollContainer.style.left);view.y=-parseInt(view.scrollContainer.style.top);view.getX=function(){return view.x;};view.getY=function(){return view.y;};view.getPosition=function(){return {x:view.x,y:view.y};};view.rawSetX=function(x){view.scrollContainer.style.left=-x+"px";view.x=x;};view.setX=function(x){view.x=Math.max(Math.min(view.maxLeft-view.offset,x),view.minLeft-view.offset);view.x=Math.round(view.x);view.updateTrackLabels(view.x);view.showFine();view.scrollContainer.style.left=-view.x+"px";};view.rawSetY=function(y){view.scrollContainer.style.top=-y+"px";view.y=y;};view.setY=function(y){view.y=Math.min((y<0?0:y),view.containerHeight-view.dim.height);view.y=Math.round(view.y);view.updatePosLabels(view.y);view.scrollContainer.style.top=-view.y+"px";};view.rawSetPosition=function(pos){view.scrollContainer.style.left=-pos.x+"px";view.scrollContainer.style.top=-pos.y+"px";};view.setPosition=function(pos){view.x=Math.max(Math.min(view.maxLeft-view.offset,pos.x),view.minLeft-view.offset);view.y=Math.min((pos.y<0?0:pos.y),view.containerHeight-view.dim.height);view.x=Math.round(view.x);view.y=Math.round(view.y);view.updateTrackLabels(view.x);view.updatePosLabels(view.y);view.showFine();view.scrollContainer.style.left=-view.x+"px";view.scrollContainer.style.top=-view.y+"px";};}else{view.x=view.elem.scrollLeft;view.y=view.elem.scrollTop;view.getX=function(){return view.x;};view.getY=function(){return view.y;};view.getPosition=function(){return {x:view.x,y:view.y};};view.rawSetX=function(x){view.elem.scrollLeft=x;view.x=x;};view.setX=function(x){view.x=Math.max(Math.min(view.maxLeft-view.offset,x),view.minLeft-view.offset);view.x=Math.round(view.x);view.updateTrackLabels(view.x);view.showFine();view.elem.scrollLeft=view.x;};view.rawSetY=function(y){view.elem.scrollTop=y;view.y=y;};view.rawSetPosition=function(pos){view.elem.scrollLeft=pos.x;view.x=pos.x;view.elem.scrollTop=pos.y;view.y=pos.y;};view.setY=function(y){view.y=Math.min((y<0?0:y),view.containerHeight-view.dim.height);view.y=Math.round(view.y);view.updatePosLabels(view.y);view.elem.scrollTop=view.y;};view.setPosition=function(pos){view.x=Math.max(Math.min(view.maxLeft-view.offset,pos.x),view.minLeft-view.offset);view.y=Math.min((pos.y<0?0:pos.y),view.containerHeight-view.dim.height);view.x=Math.round(view.x);view.y=Math.round(view.y);view.updateTrackLabels(view.x);view.updatePosLabels(view.y);view.showFine();view.elem.scrollLeft=view.x;view.elem.scrollTop=view.y;};}view.dragEnd=function(event){dojo.forEach(view.dragEventHandles,dojo.disconnect);view.dragging=false;view.elem.style.cursor="url(\"plugins/view/jbrowse/openhand.cur\"), move";document.body.style.cursor="default";dojo.stopEvent(event);view.showCoarse();view.scrollUpdate();view.showVisibleBlocks(true);};var _11b1=document.body.parentNode;var _11b2=document.body;view.checkDragOut=function(event){if(!(event.relatedTarget||event.toElement)||(_11b1===(event.relatedTarget||event.toElement))||(_11b2===(event.relatedTarget||event.toElement))){view.dragEnd(event);}};view.dragMove=function(event){view.setPosition({x:view.winStartPos.x-(event.clientX-view.dragStartPos.x),y:view.winStartPos.y-(event.clientY-view.dragStartPos.y)});dojo.stopEvent(event);};view.mouseDown=function(event){if("animation" in view){if(view.animation instanceof Zoomer){dojo.stopEvent(event);return;}else{view.animation.stop();}}if(Util.isRightButton(event)){return;}dojo.stopEvent(event);if(event.shiftKey||event.ctrlKey){return;}view.dragEventHandles=[dojo.connect(document.body,"mouseup",view.dragEnd),dojo.connect(document.body,"mousemove",view.dragMove),dojo.connect(document.body,"mouseout",view.checkDragOut)];view.dragging=true;view.dragStartPos={x:event.clientX,y:event.clientY};view.winStartPos=view.getPosition();document.body.style.cursor="url(\"plugins/view/jbrowse/closedhand.cur\"), move";view.elem.style.cursor="url(\"plugins/view/jbrowse/closedhand.cur\"), move";};dojo.connect(view.elem,"mousedown",view.mouseDown);dojo.connect(view.elem,"dblclick",function(event){if(view.dragging){return;}if("animation" in view){return;}var _11b3=(event.pageX-dojo.coords(view.elem,true).x)/view.dim.width;if(event.shiftKey){view.zoomOut(event,_11b3,2);}else{view.zoomIn(event,_11b3,2);}dojo.stopEvent(event);});view.afterSlide=function(){view.showCoarse();view.scrollUpdate();view.showVisibleBlocks(true);};view.zoomCallback=function(){view.zoomUpdate();};var _11b4=null;var _11b5=function(){view.showVisibleBlocks(true);_11b4=null;};view.wheelScroll=function(e){var oldY=view.getY();var newY=Math.min(Math.max(0,oldY-60*Util.wheel(e)),view.containerHeight-view.dim.height);view.setY(newY);if(_11b4){clearTimeout(_11b4);}_11b4=setTimeout(_11b5,100);dojo.stopEvent(e);};dojo.connect(view.scrollContainer,"mousewheel",view.wheelScroll,false);dojo.connect(view.scrollContainer,"DOMMouseScroll",view.wheelScroll,false);var _11b6=document.createElement("div");_11b6.className="track";_11b6.style.height=this.posHeight+"px";_11b6.id="static_track";this.staticTrack=new StaticTrack("static_track","pos-label",this.posHeight);this.staticTrack.setViewInfo(function(_11b7){},this.stripeCount,_11b6,undefined,this.stripePercent,this.stripeWidth,this.pxPerBp);this.zoomContainer.appendChild(_11b6);this.waitElems.push(_11b6);var _11b8=document.createElement("div");_11b8.className="track";_11b8.style.cssText="top: 0px; height: 100%;";_11b8.id="gridtrack";var _11b9=new GridTrack("gridtrack");_11b9.setViewInfo(function(_11ba){},this.stripeCount,_11b8,undefined,this.stripePercent,this.stripeWidth,this.pxPerBp);this.zoomContainer.appendChild(_11b8);this.uiTracks=[this.staticTrack,_11b9];dojo.forEach(this.uiTracks,function(track){track.showRange(0,this.stripeCount-1,Math.round(this.pxToBp(this.offset)),Math.round(this.stripeWidth/this.pxPerBp),this.pxPerBp);},this);this.zoomContainer.style.paddingTop=this.topSpace+"px";this.addOverviewTrack(new StaticTrack("overview_loc_track","overview-pos",this.overviewPosHeight));document.body.style.cursor="url(\"plugins/view/jbrowse/closedhand.cur\")";document.body.style.cursor="default";this.showFine();this.showCoarse();};GenomeView.prototype.slide=function(_11bb){if(this.animation){this.animation.stop();}this.trimVertical();new Slider(this,this.afterSlide,Math.abs(_11bb)*this.dim.width*this.slideTimeMultiple+200,_11bb*this.dim.width);};GenomeView.prototype.highlightRegions=function(_11bc){};GenomeView.prototype.setLocation=function(_11bd,_11be,endbp){if(_11be===undefined){_11be=this.minVisible();}if(endbp===undefined){endbp=this.maxVisible();}if((_11be<_11bd.start)||(_11be>_11bd.end)){_11be=_11bd.start;}if((endbp<_11bd.start)||(endbp>_11bd.end)){endbp=_11bd.end;}if(this.ref!=_11bd){this.ref=_11bd;var _11bf=function(track){if(track.div&&track.div.parentNode){track.div.parentNode.removeChild(track.div);}};dojo.forEach(this.tracks,_11bf);dojo.forEach(this.uiTracks,function(track){track.clear();});this.overviewTrackIterate(_11bf);this.addOverviewTrack(new StaticTrack("overview_loc_track","overview-pos",this.overviewPosHeight));this.sizeInit();this.setY(0);this.containerHeight=this.topSpace;}this.pxPerBp=Math.min(this.dim.width/(endbp-_11be),this.charWidth);this.curZoom=Util.findNearest(this.zoomLevels,this.pxPerBp);if(Math.abs(this.pxPerBp-this.zoomLevels[this.zoomLevels.length-1])<0.2){this.pxPerBp=this.zoomLevels[this.zoomLevels.length-1];}this.stripeWidth=(this.stripeWidthForZoom(this.curZoom)/this.zoomLevels[this.curZoom])*this.pxPerBp;this.instantZoomUpdate();this.centerAtBase((_11be+endbp)/2,true);};GenomeView.prototype.stripeWidthForZoom=function(_11c0){if((this.zoomLevels.length-1)==_11c0){return this.fullZoomStripe;}else{if(0==_11c0){return this.minZoomStripe;}else{return this.regularStripe;}}};GenomeView.prototype.instantZoomUpdate=function(){this.scrollContainer.style.width=(this.stripeCount*this.stripeWidth)+"px";this.zoomContainer.style.width=(this.stripeCount*this.stripeWidth)+"px";this.maxOffset=this.bpToPx(this.ref.end)-this.stripeCount*this.stripeWidth;this.maxLeft=this.bpToPx(this.ref.end)-this.dim.width;this.minLeft=this.bpToPx(this.ref.start);};GenomeView.prototype.centerAtBase=function(base,_11c1){base=Math.min(Math.max(base,this.ref.start),this.ref.end);if(_11c1){var _11c2=this.bpToPx(base);var _11c3=this.stripeCount*this.stripeWidth;var _11c4=Math.floor((_11c2-(_11c3/2))/this.stripeWidth);this.offset=_11c4*this.stripeWidth;this.setX(_11c2-this.offset-(this.dim.width/2));this.trackIterate(function(track){track.clear();});this.showVisibleBlocks(true);this.showCoarse();}else{var _11c5=this.pxToBp(this.x+this.offset);var _11c6=(this.dim.width/this.pxPerBp)/2;var endbp=_11c5+_11c6+_11c6;var _11c7=_11c5+_11c6;if((base>=(_11c5-_11c6))&&(base<=(endbp+_11c6))){if(this.animation){this.animation.stop();}var _11c8=(_11c7-base)*this.pxPerBp;this.trimVertical();new Slider(this,this.afterSlide,Math.abs(_11c8)*this.slideTimeMultiple+200,_11c8);}else{this.centerAtBase(base,true);}}};GenomeView.prototype.minVisible=function(){return this.pxToBp(this.x+this.offset);};GenomeView.prototype.maxVisible=function(){return this.pxToBp(this.x+this.offset+this.dim.width);};GenomeView.prototype.showFine=function(){this.onFineMove(this.minVisible(),this.maxVisible());};GenomeView.prototype.showCoarse=function(){if(!this.minVisible()||!this.maxVisible()){return;}this.onCoarseMove(this.minVisible(),this.maxVisible());};GenomeView.prototype.onFineMove=function(){};GenomeView.prototype.onCoarseMove=function(){};GenomeView.prototype.thumbMoved=function(mover){var _11c9=parseInt(this.locationThumb.style.left);var _11ca=parseInt(this.locationThumb.style.width);var _11cb=_11c9+(_11ca/2);this.centerAtBase(((_11cb/this.overviewBox.w)*(this.ref.end-this.ref.start))+this.ref.start);};GenomeView.prototype.checkY=function(y){return Math.min((y<0?0:y),this.containerHeight-this.dim.height);};GenomeView.prototype.updatePosLabels=function(newY){if(newY===undefined){newY=this.getY();}this.staticTrack.div.style.top=newY+"px";};GenomeView.prototype.updateTrackLabels=function(newX){if(newX===undefined){newX=this.getX();}for(var i=0;i<this.trackLabels.length;i++){this.trackLabels[i].style.left=newX+"px";}};GenomeView.prototype.showWait=function(){var _11cc=[];for(var i=0;i<this.waitElems.length;i++){_11cc[i]=this.waitElems[i].style.cursor;this.waitElems[i].style.cursor="wait";}this.prevCursors.push(_11cc);};GenomeView.prototype.showDone=function(){var _11cd=this.prevCursors.pop();for(var i=0;i<this.waitElems.length;i++){this.waitElems[i].style.cursor=_11cd[i];}};GenomeView.prototype.pxToBp=function(_11ce){return _11ce/this.pxPerBp;};GenomeView.prototype.bpToPx=function(bp){return bp*this.pxPerBp;};GenomeView.prototype.sizeInit=function(){this.dim={width:this.elem.clientWidth,height:this.elem.clientHeight};this.overviewBox=dojo.marginBox(this.overview);this.zoomLevels=[1/500000,1/200000,1/100000,1/50000,1/20000,1/10000,1/5000,1/2000,1/1000,1/500,1/200,1/100,1/50,1/20,1/10,1/5,1/2,1,2,5,this.charWidth];while(((this.ref.end-this.ref.start)*this.zoomLevels[0])<this.dim.width){this.zoomLevels.shift();}this.zoomLevels.unshift(this.dim.width/(this.ref.end-this.ref.start));this.minZoomStripe=this.regularStripe*(this.zoomLevels[0]/this.zoomLevels[1]);this.curZoom=0;while(this.pxPerBp>this.zoomLevels[this.curZoom]){this.curZoom++;}this.maxLeft=this.bpToPx(this.ref.end)-this.dim.width;delete this.stripePercent;var _11cf=[20,10,5,4,2,1];for(var i=0;i<_11cf.length;i++){if(((100/_11cf[i])*(this.regularStripe*0.7))>((this.dim.width*3)+this.regularStripe)){this.stripePercent=_11cf[i];break;}}if(this.stripePercent===undefined){this.stripePercent=1;}var oldX;var _11d0=this.stripeCount;if(_11d0){oldX=this.getX();}this.stripeCount=Math.round(100/this.stripePercent);this.scrollContainer.style.width=(this.stripeCount*this.stripeWidth)+"px";this.zoomContainer.style.width=(this.stripeCount*this.stripeWidth)+"px";var _11d1=undefined;if(_11d0&&(_11d0!=this.stripeCount)){_11d1=Math.floor((_11d0-this.stripeCount)/2);var delta=(_11d1*this.stripeWidth);var newX=this.getX()-delta;this.offset+=delta;this.updateTrackLabels(newX);this.rawSetX(newX);}this.trackIterate(function(track,view){track.sizeInit(view.stripeCount,view.stripePercent,_11d1);});var _11d2=parseInt(this.scrollContainer.style.height);_11d2=(_11d2>this.dim.height?_11d2:this.dim.height);this.scrollContainer.style.height=_11d2+"px";this.containerHeight=_11d2;var _11d3=this.ref.end-this.ref.start;var _11d4=document.createElement("div");_11d4.className="overview-pos";_11d4.appendChild(document.createTextNode(Util.addCommas(this.ref.end)));_11d4.style.visibility="hidden";this.overview.appendChild(_11d4);var _11d5=_11d4.clientWidth*1.2;this.overviewPosHeight=_11d4.clientHeight;this.overview.removeChild(_11d4);for(var n=1;n<30;n++){this.overviewStripeBases=(Math.pow(n%3,2)+1)*Math.pow(10,Math.floor(n/3));this.overviewStripes=Math.ceil(_11d3/this.overviewStripeBases);if((this.overviewBox.w/this.overviewStripes)>_11d5){break;}if(this.overviewStripes<2){break;}}var _11d6=100/(_11d3/this.overviewStripeBases);var _11d7=0;this.overviewTrackIterate(function(track,view){track.clear();track.sizeInit(view.overviewStripes,_11d6);track.showRange(0,view.overviewStripes-1,0,view.overviewStripeBases,view.overviewBox.w/(view.ref.end-view.ref.start));});this.updateOverviewHeight();};GenomeView.prototype.overviewTrackIterate=function(_11d8){var _11d9=this.overview.firstChild;do{if(_11d9&&_11d9.track){_11d8(_11d9.track,this);}}while(_11d9&&(_11d9=_11d9.nextSibling));};GenomeView.prototype.updateOverviewHeight=function(_11da,_11db){var _11dc=0;this.overviewTrackIterate(function(track,view){_11dc+=track.height;});this.overview.style.height=_11dc+"px";this.overviewBox=dojo.marginBox(this.overview);};GenomeView.prototype.addOverviewTrack=function(track){var _11dd=this.ref.end-this.ref.start;var _11de=100/(_11dd/this.overviewStripeBases);var _11df=document.createElement("div");_11df.className="track";_11df.style.height=this.overviewBox.h+"px";_11df.style.left=(((-this.ref.start)/_11dd)*this.overviewBox.w)+"px";_11df.track=track;var view=this;var _11e0=function(_11e1){view.updateOverviewHeight();};track.setViewInfo(_11e0,this.overviewStripes,_11df,undefined,_11de,this.overviewStripeBases,this.pxPerBp);this.overview.appendChild(_11df);this.updateOverviewHeight();return _11df;};GenomeView.prototype.trimVertical=function(y){if(y===undefined){y=this.getY();}var _11e2;var _11e3=this.topSpace;var _11e4=y+this.dim.height;for(var i=0;i<this.tracks.length;i++){if(this.tracks[i].shown){_11e2=_11e3+this.trackHeights[i];if(!((_11e2>y)&&(_11e3<_11e4))){this.tracks[i].hideAll();}_11e3=_11e2+this.trackPadding;}}};GenomeView.prototype.zoomIn=function(e,_11e5,steps){if(this.animation){return;}if(_11e5===undefined){_11e5=0.5;}if(steps===undefined){steps=1;}steps=Math.min(steps,(this.zoomLevels.length-1)-this.curZoom);if(0==steps){return;}this.showWait();var pos=this.getPosition();this.trimVertical(pos.y);var scale=this.zoomLevels[this.curZoom+steps]/this.pxPerBp;var _11e6=this.pxToBp(pos.x+this.offset+(_11e5*this.dim.width));this.curZoom+=steps;this.pxPerBp=this.zoomLevels[this.curZoom];this.maxLeft=(this.pxPerBp*this.ref.end)-this.dim.width;for(var track=0;track<this.tracks.length;track++){this.tracks[track].startZoom(this.pxPerBp,_11e6-((_11e5*this.dim.width)/this.pxPerBp),_11e6+(((1-_11e5)*this.dim.width)/this.pxPerBp));}var _11e7=this;new Zoomer(scale,this,function(){_11e7.zoomUpdate(_11e5,_11e6);},700,_11e5);};GenomeView.prototype.zoomOut=function(e,_11e8,steps){if(this.animation){return;}if(steps===undefined){steps=1;}steps=Math.min(steps,this.curZoom);if(0==steps){return;}this.showWait();var pos=this.getPosition();this.trimVertical(pos.y);if(_11e8===undefined){_11e8=0.5;}var scale=this.zoomLevels[this.curZoom-steps]/this.pxPerBp;var _11e9=this.bpToPx(this.ref.end)-(this.offset+pos.x+this.dim.width);_11e8=Math.max(_11e8,1-(((_11e9*scale)/(1-scale))/this.dim.width));_11e9=pos.x+this.offset-this.bpToPx(this.ref.start);_11e8=Math.min(_11e8,((_11e9*scale)/(1-scale))/this.dim.width);var _11ea=this.pxToBp(pos.x+this.offset+(_11e8*this.dim.width));this.curZoom-=steps;this.pxPerBp=this.zoomLevels[this.curZoom];for(var track=0;track<this.tracks.length;track++){this.tracks[track].startZoom(this.pxPerBp,_11ea-((_11e8*this.dim.width)/this.pxPerBp),_11ea+(((1-_11e8)*this.dim.width)/this.pxPerBp));}this.minLeft=this.pxPerBp*this.ref.start;var _11eb=this;new Zoomer(scale,this,function(){_11eb.zoomUpdate(_11e8,_11ea);},700,_11e8);};GenomeView.prototype.zoomUpdate=function(_11ec,_11ed){var _11ee=this.elem.clientWidth;var _11ef=this.bpToPx(_11ed)-(_11ec*_11ee)+(_11ee/2);this.stripeWidth=this.stripeWidthForZoom(this.curZoom);this.scrollContainer.style.width=(this.stripeCount*this.stripeWidth)+"px";this.zoomContainer.style.width=(this.stripeCount*this.stripeWidth)+"px";var _11f0=Math.round(_11ef/this.stripeWidth);var _11f1=(_11f0-((this.stripeCount)/2))|0;this.offset=_11f1*this.stripeWidth;this.maxOffset=this.bpToPx(this.ref.end)-this.stripeCount*this.stripeWidth;this.maxLeft=this.bpToPx(this.ref.end)-this.dim.width;this.minLeft=this.bpToPx(this.ref.start);this.zoomContainer.style.left="0px";this.setX((_11ef-this.offset)-(_11ee/2));dojo.forEach(this.uiTracks,function(track){track.clear();});for(var track=0;track<this.tracks.length;track++){this.tracks[track].endZoom(this.pxPerBp,Math.round(this.stripeWidth/this.pxPerBp));}this.showVisibleBlocks(true);this.showDone();this.showCoarse();};GenomeView.prototype.scrollUpdate=function(){var x=this.getX();var _11f2=this.stripeCount;var _11f3=_11f2*this.stripeWidth;var _11f4=this.dim.width;var dx=(_11f3/2)-((_11f4/2)+x);var _11f5=(dx/this.stripeWidth)|0;if(0==_11f5){return;}var _11f6=Math.abs(_11f5);var _11f7=this.offset-(_11f5*this.stripeWidth);if(this.offset==_11f7){return;}this.offset=_11f7;this.trackIterate(function(track){track.moveBlocks(_11f5);});var newX=x+(_11f5*this.stripeWidth);this.updateTrackLabels(newX);this.rawSetX(newX);var _11f8=(newX/this.stripeWidth)|0;};GenomeView.prototype.trackHeightUpdate=function(_11f9,_11fa){var y=this.getY();if(!_11f9 in this.trackIndices){return;}var track=this.trackIndices[_11f9];if(Math.abs(_11fa-this.trackHeights[track])<1){return;}if((((this.trackTops[track]+this.trackHeights[track])-y)<(this.dim.height/2))&&(y>0)){this.setY(y+(_11fa-this.trackHeights[track]));}this.trackHeights[track]=_11fa;this.tracks[track].div.style.height=(_11fa+this.trackPadding)+"px";var _11fb=this.trackTops[track];if(this.tracks[track].shown){_11fb+=_11fa+this.trackPadding;}for(var i=track+1;i<this.tracks.length;i++){this.trackTops[i]=_11fb;this.tracks[i].div.style.top=_11fb+"px";if(this.tracks[i].shown){_11fb+=this.trackHeights[i]+this.trackPadding;}}this.containerHeight=Math.max(_11fb,this.getY()+this.dim.height);this.scrollContainer.style.height=this.containerHeight+"px";};GenomeView.prototype.showVisibleBlocks=function(_11fc,pos,_11fd,endX){if(pos===undefined){pos=this.getPosition();}if(_11fd===undefined){_11fd=pos.x-(this.drawMargin*this.dim.width);}if(endX===undefined){endX=pos.x+((1+this.drawMargin)*this.dim.width);}var _11fe=Math.max(0,(_11fd/this.stripeWidth)|0);var _11ff=Math.min(this.stripeCount-1,(endX/this.stripeWidth)|0);var _1200=Math.round(this.stripeWidth/this.pxPerBp);var _1201=Math.round(this.pxToBp((_11fe*this.stripeWidth)+this.offset));var _1202=Math.round(this.pxToBp(this.offset));var _1203=Math.round(this.pxToBp(this.offset+(this.stripeCount*this.stripeWidth)));this.trackIterate(function(track,view){track.showRange(_11fe,_11ff,_1201,_1200,view.pxPerBp,_1202,_1203);});};GenomeView.prototype.addTrack=function(track){var _1204=this.tracks.length;var _1205=document.createElement("div");_1205.className="track-label dojoDndHandle";dojo.addClass(_1205,track.trackMeta.label+"-label");var _1206=track.trackMeta.sourceType;if(_1206){var _1207=_1206+"-label";dojo.addClass(_1205,_1207);}var _1208=track.trackMeta.urlInfo;if(_1208){_1205.ondblclick=function(event){console.log("js.GenomeView.addTrack    FIRED ondblclick FOR urlInfo:"+_1208);window.open(_1208,"_blank");event.stopPropagation();};}else{_1205.ondblclick=function(event){event.stopPropagation();};}_1205.id="label_"+track.name;this.trackLabels.push(_1205);var _1209=document.createElement("div");_1209.className="track";_1209.id="track_"+track.name;_1209.track=track;var view=this;var _120a=function(_120b){view.trackHeightUpdate(track.name,_120b);};track.setViewInfo(_120a,this.stripeCount,_1209,_1205,this.stripePercent,this.stripeWidth,this.pxPerBp);_1205.style.position="absolute";_1205.style.top="0px";_1205.style.left=this.getX()+"px";_1209.appendChild(_1205);return _1209;};GenomeView.prototype.trackIterate=function(_120c){var i;for(i=0;i<this.uiTracks.length;i++){_120c(this.uiTracks[i],this);}for(i=0;i<this.tracks.length;i++){_120c(this.tracks[i],this);}};GenomeView.prototype.updateTrackList=function(){var _120d=[];var _120e=this.zoomContainer.firstChild;do{if(_120e.track){_120d.push(_120e.track);}}while((_120e=_120e.nextSibling));this.tracks=_120d;var _120f={};var _1210=new Array(this.tracks.length);for(var i=0;i<_120d.length;i++){_120f[_120d[i].name]=i;if(_120d[i].name in this.trackIndices){_1210[i]=this.trackHeights[this.trackIndices[_120d[i].name]];}else{_1210[i]=0;}this.trackIndices[_120d[i].name]=i;}this.trackIndices=_120f;this.trackHeights=_1210;var _1211=this.topSpace;for(var i=0;i<this.tracks.length;i++){this.trackTops[i]=_1211;this.tracks[i].div.style.top=_1211+"px";if(this.tracks[i].shown){_1211+=this.trackHeights[i]+this.trackPadding;}}};}if(!dojo._hasResource["plugins.view.jbrowse.js.touchJBrowse"]){dojo._hasResource["plugins.view.jbrowse.js.touchJBrowse"]=true;dojo.provide("plugins.view.jbrowse.js.touchJBrowse");dojo.declare("plugins.view.jbrowse.js.touchJBrowse",null,{});function CompareObjPos(nodes,touch){var _1212=0,j=0,top=touch.pageY;for(var i=0;i<nodes.length;i++){_1212=j++;var _1213=findPos(nodes[i]);if(_1213.top>top){break;}}return _1212;};function checkAvatarPosition(first){var _1214=document.getElementById("tracksAvail"),_1215=document.getElementById("container");if(first.pageX<(_1214.offsetLeft+_1214.offsetWidth)){return _1214;}else{return _1215;}};var startX;function removeTouchEvents(){startX=null;};function touchSimulated(event){if(event.touches.length<=1){var _1216=event.changedTouches,first=_1216[0],type1="",type2="mouseover",_1217=document.getElementsByClassName("dojoDndAvatar"),obj={},pane=checkAvatarPosition(first),nodes=pane.getElementsByClassName("dojoDndItem"),_1218={},_1219=document.createEvent("MouseEvent"),_121a=document.createEvent("MouseEvent");switch(event.type){case "touchstart":startX=first.pageX;type1="mousedown";break;case "touchmove":event.preventDefault();type1="mousemove";break;default:return;}_1219.initMouseEvent(type1,true,true,window,1,first.pageX,first.pageY,first.clientX,first.clientY,false,false,false,false,0,null);_121a.initMouseEvent(type2,true,true,window,1,first.pageX,first.pageY,first.clientX,first.clientY,false,false,false,false,0,null);switch(event.type){case "touchstart":first.target.dispatchEvent(_1219);first.target.dispatchEvent(_121a);initialPane=pane;break;case "touchmove":if(_1217.length>0){if(nodes.length>0){_1218=CompareObjPos(nodes,first);obj=nodes[_1218];}try{if(initialPane!=pane){var _121b=document.createEvent("MouseEvent");var type3="mouseout";_121b.initMouseEvent(type3,true,true,window,1,first.pageX,first.pageY,first.clientX,first.clientY,false,false,false,false,0,null);initialPane.dispatchEvent(_121b);}obj.dispatchEvent(_121a);obj.dispatchEvent(_1219);}catch(err){pane.dispatchEvent(_121a);pane.dispatchEvent(_1219);}}break;default:return;}}else{removeTouchEvents();}};function touchEnd(event){var _121c=event.changedTouches,first=_121c[0],type1="mouseup",type2="mouseover",_121d=document.getElementsByClassName("dojoDndAvatar"),obj={},pane=checkAvatarPosition(first),nodes=pane.getElementsByClassName("dojoDndItem"),_121e={},_121f=document.createEvent("MouseEvent"),_1220=document.createEvent("MouseEvent");if(startX!==first.pageX){event.preventDefault();}var test=findPos(first.target);_121f.initMouseEvent(type1,true,true,window,1,first.pageX,first.pageY,first.clientX,first.clientY,false,false,false,false,0,null);_1220.initMouseEvent(type2,true,true,window,1,first.pageX,first.pageY,first.clientX,first.clientY,false,false,false,false,0,null);if(_121d.length>0){if(nodes.length>0){_121e=CompareObjPos(nodes,first);obj=nodes[_121e];}try{obj.dispatchEvent(_1220);obj.dispatchEvent(_121f);}catch(error){first.target.dispatchEvent(_1220);pane.dispatchEvent(_1220);}}else{first.target.dispatchEvent(_121f);first.target.dispatchEvent(_1220);}removeTouchEvents();};function touchHandle(event){dojo.query(".dojoDndItemAnchor").connect("touchstart",touchSimulated);dojo.query(".dojoDndItemAnchor").connect("touchmove",touchSimulated);dojo.query(".dojoDndItemAnchor").connect("touchend",touchEnd);dojo.query(".dojoDndItemAnchor").connect("click",function(){void (0);});if(event.touches.length<=1){var _1221=event.changedTouches,first=_1221[0],type="";switch(event.type){case "touchstart":startX=first.pageX;type="mousedown";break;case "touchmove":event.preventDefault();type="mousemove";break;case "touchend":if(startX!==first.pageX){event.preventDefault();}type="mouseup";break;default:return;}var _1222=document.createEvent("MouseEvent");_1222.initMouseEvent(type,true,true,window,1,first.screenX,first.screenY,first.clientX,first.clientY,false,false,false,false,0,null);first.target.dispatchEvent(_1222);}else{removeTouchEvents();}};function touchinit(){dojo.query(".dojoDndItem").connect("touchstart",touchSimulated);dojo.query(".dojoDndItem").connect("touchmove",touchSimulated);dojo.query(".dojoDndItem").connect("touchend",touchEnd);dojo.query(".locationThumb").connect("touchstart",touchHandle);dojo.query(".locationThumb").connect("touchmove",touchHandle);dojo.query(".locationThumb").connect("touchend",touchHandle);dojo.query(".dojoDndItem").connect("click",function(){void (0);});dojo.query(".dojoDndTarget").connect("touchstart",touchHandle);dojo.query(".dojoDndTarget").connect("touchmove",touchHandle);dojo.query(".dojoDndTarget").connect("touchend",touchHandle);dojo.query(".dijitSplitter").connect("touchstart",touchHandle);dojo.query(".dijitSplitter").connect("touchmove",touchHandle);dojo.query(".dijitSplitter").connect("touchend",touchHandle);};function load(){touchinit();document.documentElement.style.webkitTouchCallout="none";};function findPos(obj){var _1223=0,objP={};if(obj.offsetParent){do{_1223+=obj.offsetTop;}while((obj=obj.offsetParent));}objP.top=_1223;return objP;};}if(!dojo._hasResource["plugins.view.View"]){dojo._hasResource["plugins.view.View"]=true;dojo.provide("plugins.view.View");if(1){var refSeqs;var trackInfo;}dojo.declare("plugins.view.View",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n\t<div\n\t\tdojoAttachPoint=\"mainTab\"\n\t\tclass=\"view\"\n\t\ttitle=\"View\"\n\t\tdojoType=\"dijit.layout.BorderContainer\"\n\t\ticonClass=\"viewIcon\"\n\t\tstyle=\"width: 1100px !important; min-width: 100% !important;  height: 100% !important; min-height: 1200px !important; padding: 0px !important; bottom: 0px !important;\"\n\t\tclosable=\"true\"\n\t>\n\t\t\n\t\t<!-- LEFT PANE -->\n\t\t<div\n\t\t\tdojoAttachPoint=\"leftPane\" \n\t\t\tclass=\"leftPane\" \n\t\t\tdojoType=\"dojox.layout.ExpandoPane\" \n\t\t\tmaxWidth=\"200px\"\n\t\t\tsplitter=\"true\" \n\t\t\tduration=\"125\"\n\t\t\tregion=\"left\"\n\t\t\tstartExpanded=\"false\"\n\t\t\tstyle=\"width: 210px; min-width: 25px; background: #FFF; padding: 0; overflow: visible;\"\n\t\t\teaseIn=\"dojo.fx.easing.expoOut\" \n\t\t\teaseOut=\"dojo.fx.easing.expoInOut\"\n\t\t\tduration=\"100\"\n\t\t>\n\t\t\t\n\t\t\t<table width=\"210px\">\n\n\t\t\t\t<tr class=\"spacerTitle\">\n\n\t\t\t\t\t<td class=\"statusReady\"\n\t\t\t\t\t\tdojoAttachPoint=\"statusDisplay\"\n\t\t\t\t\t\tdojoAttachEvent=\"onclick:stopPoll\"\n\t\t\t\t\t>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td colspan=\"1\" class=\"spacerTitle\">Views</td>\n\t\t\t\t\t<td class=\"spacerTitle\"> &nbsp; </td>\n\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td class=\"viewTitle\" colspan=\"3\">Project</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td class=\"projectIcon\">\n\t\t\t\t\t</td>\n\t\t\t\t\t\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<div dojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\tclass=\"viewProjectCombo\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"viewProjectCombo\"\n\t\t\t\t\t\t\tdojoAttachEvent=\"onChange:fireViewProjectCombo\"\n\t\t\t\t\t\t\tautocomplete=\"false\"\n\t\t\t\t\t\t\ttitle=\"Select a project containing your views\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t\t\n\t\t\t\t</tr>\t\t\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td class=\"viewTitle\" colspan=\"4\">View</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\n\t\t\t\t\t<td class=\"viewIcon\"\n\t\t\t\t\t\tdojoAttachEvent=\"onclick:refreshView\"\n\t\t\t\t\t\ttitle=\"Click to reload View\"\n\t\t\t\t\t>\n\t\t\t\t\t</td>\n\t\t\n\t\t\t\t\t<td>\n\t\t\n\t\t\t\t\t\t<div dojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\tclass=\"viewCombo\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"viewCombo\"\n\t\t\t\t\t\t\tdojoAttachEvent=\"onChange:fireViewCombo\"\n\t\t\t\t\t\t\tautocomplete=\"false\"'\n\t\t\t\t\t\t\ttitle=\"Select a view or type a name to create one\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td dojoAttachPoint=\"deleteViewButton\"\n\t\t\t\t\t\tclass=\"deleteViewButton\"\n\t\t\t\t\t\tdojoAttachEvent=\"onclick:confirmRemoveView\"\n\t\t\t\t\t\twidth=\"20%\"\n\t\t\t\t\t\talign=\"center\"\n\t\t\t\t\t\tclass=\"fileUpload\"\n\t\t\t\t\t\ttitle=\"Click to delete the selected View\"\n\t\t\t\t\t></td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td class=\"viewTitle\" colspan=\"3\">Species</td>\n\t\t\t\t</tr>\n\n\t\t\t\t\t<td class=\"speciesIcon\">\n\t\t\t\t\t</td>\n\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<table>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\t\tclass=\"speciesLabel\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"speciesLabel\"\n\t\t\t\t\t\t\t\t>&nbsp;</td>\n\t\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\t\tclass=\"buildLabel\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"buildLabel\"\n\t\t\t\t\t\t\t\t>&nbsp;</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\t\t\n\t\t\t\t</tr>\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td class=\"viewTitle\" colspan=\"3\">Feature List</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td class=\"featureIcon\">\n\t\t\t\t\t</td>\n\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<div dojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\tclass=\"featureList\"\n\t\t\t\t\t\t\tdojoAttachPoint=\"featureList\"\n\t\t\t\t\t\t\tautocomplete=\"false\"\n\t\t\t\t\t\t\ttitle=\"Select a feature to add to the selected View\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<div dojoAttachPoint=\"deleteFeatureButton\"\n\t\t\t\t\t\tclass=\"deleteFeatureButton\"\n\t\t\t\t\t\tdojoAttachEvent=\"onclick:removeViewFeature\"\n\t\t\t\t\t\twidth=\"20%\"\n\t\t\t\t\t\talign=\"center\"\n\t\t\t\t\t\tclass=\"fileUpload\" ></div>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td colspan=\"4\">\n\n\t\t\t\t\t\t<div class=\"addFeatures\">\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<table class=\"addFeaturesTable\">\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td class=\"spacerTitle\" colspan=\"3\">Add Features</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td class=\"viewTitle\" colspan=\"3\">Project</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td class=\"projectIcon\">\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<div dojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"featureProjectCombo\"\n\t\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"featureProjectCombo\"\n\t\t\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onChange:fireFeatureProjectCombo\"\n\t\t\t\t\t\t\t\t\t\t\tautocomplete=\"false\"\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"Select a project containing features\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td class=\"viewTitle\" colspan=\"3\">Workflow</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\n\t\t\t\t\t\t\t\t\t<td class=\"workflowIcon\">\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<div dojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"workflowCombo\"\n\t\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"workflowCombo\"\n\t\t\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onChange:fireWorkflowCombo\"\n\t\t\t\t\t\t\t\t\t\t\tautocomplete=\"false\"\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"Select a workflow containing features\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td class=\"viewTitle\" colspan=\"3\">Species</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\n\t\t\t\t\t\t\t\t\t<td class=\"speciesIcon\">\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<select dojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"speciesCombo\"\n\t\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"speciesCombo\"\n\t\t\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onChange:fireSpeciesCombo\"\n\t\t\t\t\t\t\t\t\t\t\tautocomplete=\"false\"\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"Select a species and build to display features below\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td class=\"viewTitle\" colspan=\"3\">Feature Tracks</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td class=\"featureIcon\">\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<div dojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"featureCombo\"\n\t\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"featureCombo\"\n\t\t\t\t\t\t\t\t\t\t\tautocomplete=\"false\"\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"Select a feature to add to the selected view\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\n\t\t\t\t\t\t\t\t<tr align=\"center\">\n\t\t\t\t\t\t\t\t\t<td colspan=\"3\">\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"addFeatureButton\"\n\t\t\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:addViewFeature\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"addFeatureButton\"\n\t\t\t\t\t\t\t\t\t\t\twidth=\"20%\"\n\t\t\t\t\t\t\t\t\t\t\talign=\"center\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"fileUpload\"\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"Click to add the selected Feature to the selected View\"\n\t\t\t\t\t\t\t\t\t\t\t>Add</div>\n\t\t\t\t\t\t\t\t\t</td>\t\t\t\t\t\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t</table>\n\n\t\t\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t\n\t\t\t</table>\n\n\n\t\t</div>\n\t\t<!-- END OF LEFT PANE -->\n\n\n\t\t<!-- RIGHT PANE -->\n\t\t<div\n\t\t\tdojoType=\"dijit.layout.TabContainer\" \n\t\t\tdojoAttachPoint=\"rightPane\"\n\t\t\tclass=\"rightPane\" \n\t\t\tregion=\"center\"\n\t\t>\n\n\n\t\t</div>\n\t\t<!-- END OF RIGHT PANE -->\n\n\t</div>\n\t<!-- END OF VIEW TAB dijit.layout.BorderContainer -->\n\n</div> \n",parentWidget:null,project:null,workflow:null,onChangeListeners:new Object,setListeners:false,widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins","view/css/view.css"),dojo.moduleUrl("plugins","view/css/genome.css"),dojo.moduleUrl("dojox","layout/resources/ExpandoPane.css"),dojo.moduleUrl("dojox","layout/tests/_expando.css"),dojo.moduleUrl("plugins","dnd/css/dnd.css")],browsers:[],url:null,baseUrl:"plugins/view/jbrowse/",browserRoot:"plugins/view/jbrowse/",polling:false,delay:10000,constructor:function(args){this.parentWidget=args.parentWidget;this.project=args.project;this.workflow=args.workflow;if(Agua.cgiUrl){this.url=Agua.cgiUrl+"/view.cgi";}if(args["cssFiles"]!=null){this.cssFiles=args.cssFiles;}this.loadCSS(this.cssFiles);},postCreate:function(){this.startup();},startup:function(){console.log("View.startup    plugins.view.Template.View.startup()");Agua.addWidget("view",this);this.inherited(arguments);this.attachWidget.addChild(this.mainTab);this.attachWidget.selectChild(this.mainTab);this.leftPane.toggle();this.setUrl();this.setSequence();this.setConfirmDialog();this.setSelectiveDialog();this.setStandby();this.setViewProjectCombo();setTimeout(function(_1224){_1224.setFeatureProjectCombo();},10,this);setTimeout(function(_1225){_1225.setOnkeyListener();},1000,this);setTimeout(function(_1226){_1226.loadBrowser(_1226.getProject(),_1226.getView());},2000,this);},loadEval:function(url){console.log("View.loadEval    url: "+url);dojo.xhrGet({url:url,sync:true,handleAs:"text",load:function(_1227){eval(_1227);},error:function(_1228,_1229){console.log("  View.loadEval    Response error. Response: "+_1228);return _1228;}});},getRefseqfile:function(_122a,_122b,_122c){return this.baseUrl+"/users"+"/"+_122a+"/"+_122b+"/"+_122c+"/data/refSeqs.js";},getTrackinfofile:function(_122d,_122e,_122f){return this.baseUrl+"/users"+"/"+_122d+"/"+_122e+"/"+_122f+"/data/trackInfo.js";},getProject:function(){return this.viewProjectCombo.get("value");},getWorkflow:function(){return this.workflowCombo.get("value");},getView:function(){return this.viewCombo.get("value");},getViewFeature:function(){return this.featureList.get("value")?this.featureList.get("value"):"";},getBuild:function(){return this.buildLabel.innerHTML;},getSpecies:function(){return this.speciesLabel.innerHTML;},getFeatureBuild:function(){var _1230=this.speciesCombo.get("value");if(_1230.match(/^(\S+)\(([^\)]+)\)$/)){return _1230.match(/^(\S+)\(([^\)]+)\)$/)[2];}},getFeatureSpecies:function(){var _1231=this.speciesCombo.get("value");if(_1231.match(/^(\S+)\(([^\)]+)\)$/)){return _1231.match(/^(\S+)\(([^\)]+)\)$/)[1];}},getFeature:function(){return this.featureCombo.get("value");},getFeatureProject:function(){return this.featureProjectCombo.get("value");},getFeatureWorkflow:function(){return this.workflowCombo.get("value");},setUrl:function(){this.url=Agua.cgiUrl+"view.cgi?";return this.url;},setSequence:function(){this.sequence=new plugins.dojox.timing.Sequence({});},setOnkeyListener:function(){var _1232=this;this.viewCombo._onKey=function(event){var key=event.charOrCode;if(key==13){var _1233=_1232.viewProjectCombo.get("value");var _1234=_1232.viewCombo.get("value");var _1235=Agua.isView(_1233,_1234);console.log("View.setOnKeyListener._onKey\t   isView: "+_1235);if(_1235==false){_1232.confirmAddView(_1233,_1234);}if(_1232.viewCombo._popupWidget!=null){_1232.viewCombo._showResultList();}}};},setConfirmDialog:function(){var _1236=function(){};var _1237=function(){};var title="Dialog title";var _1238="Dialog message";this.confirmDialog=new plugins.dijit.ConfirmDialog({title:title,message:_1238,parentWidget:this,yesCallback:_1236,noCallback:_1237});},loadConfirmDialog:function(title,_1239,_123a,_123b){this.confirmDialog.load({title:title,message:_1239,yesCallback:_123a,noCallback:_123b});},setSelectiveDialog:function(){var _123c=function(){};var _123d=function(){};var title="";var _123e="";console.log("Stages.setSelectiveDialog    plugins.files.Stages.setSelectiveDialog()");this.selectiveDialog=new plugins.dijit.SelectiveDialog({title:title,message:_123e,parentWidget:this,enterCallback:_123c,cancelCallback:_123d});console.log("Stages.setSelectiveDialog    this.selectiveDialog: "+this.selectiveDialog);},loadSelectiveDialog:function(title,_123f,_1240,_1241,_1242,_1243,_1244,_1245){console.log("Stages.loadSelectiveDialog    plugins.files.Stages.loadSelectiveDialog()");console.log("Stages.loadSelectiveDialog    enterCallback.toString(): "+_1244.toString());console.log("Stages.loadSelectiveDialog    title: "+title);console.log("Stages.loadSelectiveDialog    message: "+_123f);console.log("Stages.loadSelectiveDialog    enterCallback: "+_1244);console.log("Stages.loadSelectiveDialog    cancelCallback: "+_1245);this.selectiveDialog.load({title:title,message:_123f,comboValues:_1240,inputMessage:_1241,comboMessage:_1242,checkboxMessage:_1243,parentWidget:this,enterCallback:_1244,cancelCallback:_1245});},setViewProjectCombo:function(_1246,_1247){console.log("View.setViewProjectCombo    projectName: "+_1246);console.log("View.setViewProjectCombo    viewName: "+_1247);var _1248=Agua.getProjects();var _1249=Agua.getProjectNames(_1248);console.log("View.setViewProjectCombo    BEFORE SORT projectNames: ");console.dir({projectNames:_1249});console.log("View.setViewProjectCombo    DOING projectNames.sort(this.sortNaturally)");_1249.sort(this.sortNaturally);console.log("View.setViewProjectCombo    AFTER SORT projectNames: ");console.dir({projectName:_1246});if(!_1249){return;}var data={identifier:"name",items:[]};for(var i in _1249){data.items[i]={name:_1249[i]};}var store=new dojo.data.ItemFileReadStore({data:data});this.viewProjectCombo.store=store;if(_1246==null||!_1246){_1246=_1249[0];}this.viewProjectCombo.setValue(_1246);if(_1246==null){_1246=this.viewProjectCombo.get("value");}this.setViewCombo(_1246,_1247);},setViewCombo:function(_124a,_124b){console.log("View.setViewCombo    projectName: "+_124a);console.log("View.setViewCombo    viewName: "+_124b);this.inherited(arguments);if(_124b==null){var views=Agua.getViewsByProject(_124a);if(views==null||views.length==0){return;}if(views.length>0){_124b=views[0].view;}}this.setSpeciesLabel(_124a,_124b);},setSpeciesLabel:function(_124c,_124d){console.log("View.setSpeciesLabel    projectName: "+_124c);console.log("View.setSpeciesLabel    viewName: "+_124d);var _124e=Agua.getSpecies(_124c,_124d);this.speciesLabel.innerHTML=_124e||"";var build=Agua.getBuild(_124c,_124d);this.buildLabel.innerHTML=build||"";var _124f=_124e+"("+build+")";this.speciesCombo.set("value",_124f);var _1250=Agua.getViewFeatures(_124c,_124d);var _1251=this.hashArrayKeyToArray(_1250,"feature");this.setFeatureList(_1251);},setFeatureProjectCombo:function(_1252,_1253){console.log("Common.setFeatureProjectCombo    projectName: "+_1252);var _1254=Agua.getFeatureProjects();console.log("  View.setFeatureProjectCombo    projects: ");console.dir({projectNames:_1254});var data={identifier:"name",items:[]};for(var i in _1254){data.items[i]={name:_1254[i]};}var store=new dojo.data.ItemFileReadStore({data:data});this.featureProjectCombo.store=store;if(_1252==null||!_1252){_1252=_1254[0];}this.featureProjectCombo.setValue(_1252);if(_1252==null){_1252=this.featureProjectCombo.get("value");}this.setWorkflowCombo(_1252);},setWorkflowCombo:function(_1255,_1256){console.log("View.setWorkflowCombo    projectName: "+_1255);console.log("View.setWorkflowCombo    workflowName: "+_1256);if(_1255==null||!_1255){return;}if(this.workflowCombo==null){return;}var _1257=Agua.getViewProjectWorkflows(_1255);console.log("View.setWorkflowCombo    projectName '"+_1255+"' workflowNames: ");console.dir({workflowNames:_1257});if(!_1257){return;}var data={identifier:"name",items:[]};for(var i in _1257){data.items[i]={name:_1257[i]};}var store=new dojo.data.ItemFileReadStore({data:data});this.workflowCombo.store=store;if(_1256==null||!_1256){_1256=_1257[0];}this.workflowCombo.startup();this.workflowCombo.set("value",_1256);if(_1255==null){_1255=this.viewProjectCombo.get("value");}if(_1256==null){_1256=this.workflowCombo.get("value");}this.setSpeciesCombo(_1255,_1256);},setSpeciesCombo:function(_1258,_1259,_125a,_125b){if(_1258==null){_1258=this.featureProjectCombo.get("value");}if(_1259==null){_1259=this.workflowCombo.get("value");}var _125c=Agua.getViewWorkflowFeatures(_1258,_1259);if(_125c==null||_125c.length==0){return;}var _125d=new Array;for(var i=0;i<_125c.length;i++){_125d.push(_125c[i].species+"("+_125c[i].build+")");}_125d=this.uniqueValues(_125d);var _125e;if(_125a==null||!_125a||_125b==null||!_125b){_125e=_125d[0];_125a=_125c[0].species;_125b=_125c[0].build;}else{_125e=_125a+"("+_125b+")";}var data={identifier:"name",items:[]};for(var i in _125d){data.items[i]={name:_125d[i]};}var store=new dojo.data.ItemFileReadStore({data:data});this.speciesCombo.store=store;this.speciesCombo.startup();this.speciesCombo.set("value",_125e);this.setFeatureCombo(_1258,_1259,_125a,_125b);},setFeatureCombo:function(_125f,_1260,_1261,_1262){console.log("View.setFeatureCombo    plugins.view.View.setFeatureCombo(projectName, workflowName)");console.log("View.setFeatureCombo    projectName: "+_125f);console.log("View.setFeatureCombo    workflowName: "+_1260);if(_125f==null||!_125f||_1260==null||!_1260||_1261==null||!_1261||_1262==null||!_1262){console.log("View.setFeatureCombo    Project, workflow, species or build not defined. Returning.");return;}var _1263=Agua.getViewSpeciesFeatureNames(_125f,_1260,_1261,_1262);if(!_1263){console.log("View.setFeatureCombo    featureNames not defined. Returning.");return;}console.log("View.setFeatureCombo    projectName '"+_125f+"' workflowName '"+_1260+"' speciesName '"+_1261+"' buildName '"+_1262+"' featureNames: "+dojo.toJson(_1263));var data={identifier:"name",items:[]};for(var i in _1263){data.items[i]={name:_1263[i]};}console.log("View.setFeatureCombo    data: "+dojo.toJson(data));var store=new dojo.data.ItemFileReadStore({data:data});this.featureCombo.store=store;var _1264=_1263[0];this.featureCombo.startup();this.featureCombo.set("value",_1264);},setFeatureList:function(_1265){console.log("View.setFeatureList    featureNames: "+dojo.toJson(_1265));var data={identifier:"name",items:[]};for(var i in _1265){data.items[i]={name:_1265[i]};}var store=new dojo.data.ItemFileReadStore({data:data});this.featureList.store=store;this.featureList.startup();this.featureList.set("value",_1265[0]);},_delayedPoll:function(_1266,_1267,_1268){console.log("View._delayedPoll    viewObject:");console.dir({viewObject:_1266});var _1269=_1266;_1269.mode="viewStatus";_1269.username=Agua.cookie("username");_1269.sessionid=Agua.cookie("sessionid");console.log("View._delayedPoll    putData:");console.dir({putData:_1269});if(!_1268){_1268="";}var delay=this.delay;var _126a=[{func:[this.showMessage,this,_1268,_1269],pauseAfter:delay},{func:[this.pollStatus,this,_1269,_1267]}];this.sequence.clear();this.sequence.go(_126a,function(){});},pollStatus:function(_126b,_126c){console.log("View.pollStatus    putData:");console.dir({putData:_126b});console.log("View.pollStatus    this.polling: "+this.polling);if(!this.polling){return;}var url=this.url;var _126d=this;this.pollStatusDeferred=dojo.xhrPut({url:url,handleAs:"json-comment-optional",sync:false,putData:dojo.toJson(_126b),handle:function(_126e){_126c(_126e,_126b);}});},stopPoll:function(){this.polling=false;console.log("View.stopPoll    this.polling: "+this.polling);if(!this.pollStatusDeferred){return;}this.pollStatusDeferred.handle=function(){};},refreshView:function(){console.log("View.refreshView    plugins.view.View.refreshView()");this.standby.hide();this.displayLoading();this.reloadBrowser(this.getProject(),this.getView());var _126f=new Object;_126f.feature=this.getFeature();_126f.sourceproject=this.getFeatureProject();_126f.sourceworkflow=this.getFeatureWorkflow();_126f.species=this.getFeatureSpecies();_126f.build=this.getFeatureBuild();_126f.project=this.getProject();_126f.view=this.getView();_126f.username=Agua.cookie("username");_126f.sessionid=Agua.cookie("sessionid");_126f.mode="refreshView";var url=Agua.cgiUrl+"view.cgi";var _1270=dojo.hitch(this,"_refreshView");this.doPut({url:this.url,query:_126f,callback:_1270});},_refreshView:function(_1271){this.displayReady();if(!_1271){Agua.toastError("Problem reloading 'views'/'viewfeatures'");}else{Agua.setData("views",_1271.views);Agua.setData("viewfeatures",_1271.viewfeatures);this.setViewCombo(this.getProject());}},updateViewLocation:function(_1272,_1273,chrom){if(this.loading==true){return 1;}console.log("View.updateViewLocation    location: "+_1273);if(_1273==null){return 1;}var _1274=String(_1273).match(/^(((\S*)\s*:)?\s*(-?[0-9,.]*[0-9])\s*(\.\.|-|\s+))?\s*(-?[0-9,.]+)$/i);if(_1274==null){return 1;}var _1275=_1274[3];if(_1275==null){_1275=chrom;}var start=parseInt(_1274[4].replace(/[,.]/g,""));var stop=parseInt(_1274[6].replace(/[,.]/g,""));if(!start&&!stop){return 1;}var _1276=Agua.getViewObject(_1272.project,_1272.view);if(!_1276){console.log("View.updateViewLocation    object NOT DEFINED");return;}if(_1276.chromosome==_1275&&_1276.start==start&&_1276.stop==stop){return;}_1276.chromosome=_1275;_1276.start=start;_1276.stop=stop;var _1277=Agua._removeView(_1276);if(_1277!=true){console.log("View.updateViewLocation    Could not do Agua.removeView() for add track to view "+_1272.view);return;}_1277=Agua._addView(_1276);if(_1277!=true){return;}_1276.username=Agua.cookie("username");_1276.sessionid=Agua.cookie("sessionid");_1276.mode="updateViewLocation";this.doPut({url:this.url,query:_1276,doToast:false});},handleTrackChange:function(_1278,track,_1279){console.log("View.handleTrackChange    view.View.handleTrackChange(viewObject, track, action)");if(this.loading==true){return 1;}var _127a=Agua.getViewObject(_1278.project,_1278.view);var _127b=[];if(_127a.tracklist){_127b=_127a.tracklist.split(",");}var index;for(var i=0;i<_127b.length;i++){if(_127b[i]==track){index=i;continue;}}if(_1279=="add"){if(index!=null){return 0;}else{_127b.push(track);}}if(_1279=="remove"){if(index==null){return 1;}else{_127b.splice(index,1);}}_127a.tracklist=_127b.join(",");this.updateViewTracklist(_127a);},updateViewTracklist:function(_127c){console.log("View.updateViewTracklist    object: ");console.dir({object:_127c});var _127d=Agua._removeView(_127c);console.log("View.updateViewTracklist    success: "+_127d);console.dir({views:Agua.cloneData("views")});if(!_127d){console.log("View.updateViewTracklist    Could not do Agua._removeView() for view: "+_127c.view);return;}_127d=Agua._addView(_127c);console.log("View.updateViewTracklist    Agua._addView(object) success: "+_127d);console.dir({views:Agua.cloneData("views")});if(!_127d){console.log("View.updateViewTracklist    Could not do Agua._addView() for view: "+_127c.view);return;}_127c.username=Agua.cookie("username");_127c.sessionid=Agua.cookie("sessionid");_127c.mode="updateViewTracklist";this.doPut({url:this.url,query:_127c,doToast:false});},confirmAddView:function(_127e,_127f){console.log("View.confirmAddView    plugins.files.View.confirmAddView()");console.log("View.confirmAddView    this.selectiveDialog: "+this.selectiveDialog);this.polling=false;var _1280=this;var _1281=Agua.getSpeciesBuilds();console.log("View.confirmAddView    speciesBuilds: "+dojo.toJson(_1281));var _1282=function(){};var _1283=dojo.hitch(this,function(input,_1284,_1285,_1286){console.log("View.confirmAddView    Doing enterCallback(input, speciesBuild, checked, dialogWidget)");console.log("View.confirmAddView    viewName: "+_127f);console.log("View.confirmAddView    projectName: "+_127e);console.log("View.confirmAddView    input: "+input);console.log("View.confirmAddView    speciesBuild: "+_1284);console.log("View.confirmAddView    checked: "+_1285);console.log("View.confirmAddView    dialogWidget: "+_1286);_1286.messageNode.innerHTML="Adding view: "+_127f;_1286.close();console.log("View.confirmAddView    Doing this.addView()");_1280.addView(_127e,_127f,_1284);});this.selectiveDialog.load({title:"Add view: "+_127f,message:"Select species/build combination",comboValues:_1281,inputMessage:null,comboMessage:null,checkboxMessage:null,parentWidget:this,enterCallback:_1283,cancelCallback:_1282,enterLabel:"Add",cancelLabel:"Cancel"});},addView:function(_1287,_1288,_1289){console.log("View.addView    projectName: "+_1287);console.log("View.addView    viewName: "+_1288);console.log("View.addView    speciesBuild: "+_1289);if(this.polling){console.log("View.addView    this.polling is TRUE. Returning");return;}this.polling=true;this.standby.show();var _128a=_1289.match(/^(\S+)\(([^\)]+)\)$/)[1];var build=_1289.match(/^(\S+)\(([^\)]+)\)$/)[2];this.speciesLabel.innerHTML="";this.buildLabel.innerHTML="";var _128b=new Object;_128b.project=_1287;_128b.view=_1288;_128b.species=_128a;_128b.build=build;console.log("View.addView    viewObject: "+_128b);console.dir({viewObject:_128b});if(!Agua._addView(dojo.clone(_128b))){console.log("View.addView    Could not add view to this.views["+_128b.view+"]");}this._remoteAddView(dojo.clone(_128b));console.log("View.addView    Doing this._delayedPoll(dojo.clone(viewObject), this._handleAddView, message)");var _128c="View._delayedPoll    addView";this._delayedPoll(dojo.clone(_128b),dojo.hitch(this,"_handleAddView"),_128c);},_remoteAddView:function(_128d){console.log("View._remoteAddView    viewObject:");console.dir({viewObject:_128d});var _128e=dojo.clone(_128d);_128e.mode="addView";_128e.username=Agua.cookie("username");_128e.sessionid=Agua.cookie("sessionid");var url=this.url;var _128f=function(_1290){console.log("View._remoteAddView    response: ");console.dir({response:_1290});if(_1290.error){thisObject.standby.hide();console.log("View._remoteAddView    Error adding view");Agua.toast(_1290);}};this.doPut({url:url,query:_128e,callback:_128f,doToast:false});},_handleAddView:function(_1291,_1292){console.log("View._handleAddView    response: ");console.dir({response:_1291});console.log("View._handleAddView    viewObject: ");console.dir({viewObject:_1292});if(_1291.status=="ready"){this.polling=false;this.standby._setTextAttr("");this.standby.hide();this.displayReady();console.log("View._handleAddView    Doing this.setViewCombo()");this.setViewCombo(_1292.project,_1292.view);console.log("View._handleAddView    Doing this.reloadBrowser()");this.reloadBrowser(_1292.project,_1292.view);Agua.toastInfo("Added view: "+_1292.view);}else{if(_1291.error){this.polling=false;this.standby.hide();this.displayReady();console.log("View.addView    Error on remote. Response: ");console.dir({response:_1291});}else{console.log("View._delayedPoll    Doing this._delayedPoll(dojo.clone(viewObject), this._handleAddView, message)");var _1293="View._delayedPoll    addView";this._delayedPoll(dojo.clone(_1292),dojo.hitch(this,"_handleAddView"),_1293);}}},confirmRemoveView:function(){var _1294=function(){};var _1295=dojo.hitch(this,function(){this.removeView();});var _1296=this.getProject();var _1297=this.getView();var title="Delete view '"+_1296+"."+_1297+"' ?";var _1298="All its data will be destroyed";this.loadConfirmDialog(title,_1298,_1295,_1294);},removeView:function(){console.log("View.removeView    plugins.view.View.removeView()");var _1299=this.getProject();var _129a=this.getView();var _129b=this.getSpecies();var build=this.getBuild();console.log("View.removeView    projectName: "+_1299);console.log("View.removeView    viewName: "+_129a);console.log("View.removeView    species: "+_129b);console.log("View.removeView    build: "+build);this.speciesLabel.innerHTML="";this.buildLabel.innerHTML="";var _129c=new Object;_129c.project=_1299;_129c.view=_129a;_129c.species=_129b;_129c.build=build;console.log("View.removeView    viewObject: "+_129c);console.dir({viewObject:_129c});this._removeView(dojo.clone(_129c));console.log("View._removeView    Doing this.removeBrowser()");var _129d=this.getBrowser(_129c.project,_129c.view);console.log("View._removeView    browserObject: ");console.dir({browserObject:_129d});if(_129d){this.removeBrowser(_129d.browser,_129c.project,_129c.view);}var _129e=Agua.getPreviousView(_129c);console.log("View.removeView    previousView: ");console.dir({previousView:_129e});if(_129e){console.log("View.removeView    XXX DOING this.setViewProjectCombo(previousView.project, previousView.view)");this.setViewProjectCombo(_129e.project,_129e.view);}Agua.toastInfo("Removed view: "+_129c.view);this._remoteRemoveView(dojo.clone(_129c));},_removeView:function(_129f){console.log("View._removeView    viewObject: "+dojo.toJson(_129f));console.dir({viewObject:_129f});if(!Agua.removeView(_129f)){console.log("View._removeView    Could not remove view: "+_129f.view);return;}},_remoteRemoveView:function(_12a0){console.log("View._remoteRemoveView    viewObject:");console.dir({viewObject:_12a0});var _12a1=dojo.clone(_12a0);_12a1.mode="removeView";_12a1.username=Agua.cookie("username");_12a1.sessionid=Agua.cookie("sessionid");var _12a2=this;var url=this.url;var _12a3=function(_12a4){console.log("View._remoteRemoveView    response: ");console.dir({response:_12a4});if(_12a4.error){_12a2.standby.hide();console.log("View._remoteRemoveView    Error removing view");Agua.toast(_12a4);}};this.doPut({url:url,query:_12a1,callback:_12a3,doToast:false});},_handleRemoveView:function(_12a5,_12a6){console.log("View._handleRemoveView    response: ");console.dir({response:_12a5});console.log("View._handleRemoveView    viewObject: ");console.dir({viewObject:_12a6});if(_12a5){console.log("View._handleRemoveView    HERE 1 XXX");this.polling=false;if(this.standby._textNode){this.standby._setTextAttr("");}console.log("View._handleRemoveView    HERE 2");this.standby.hide();console.log("View._handleRemoveView    HERE 3");this.displayReady();console.log("View._handleRemoveView    HERE 4");var _12a7=Agua.getPreviousView(_12a6);console.log("View._handleRemoveView    previousView: ");console.dir({previousView:_12a7});console.log("View._handleRemoveView    Doing this.removeBrowser()");var _12a8=this.getBrowser(_12a6.project,_12a6.view);console.log("View._handleRemoveView    browserObject: ");console.dir({browserObject:_12a8});this.removeBrowser(_12a8.browser,_12a6.project,_12a6.view);console.log("View._handleRemoveView    DOING this.setViewProjectCombo(previousView.project, previousView.view)");this.setViewProjectCombo(_12a7.project,_12a7.view);Agua.toastInfo("Removed view: "+_12a6.view);}else{if(_12a5.error){this.polling=false;this.standby.hide();this.displayReady();console.log("View.addView    Error on remote. Response: ");console.dir({response:_12a5});}else{console.log("View._delayedPoll    Doing this._delayedPoll(dojo.clone(viewObject), this._handleRemoveView, message)");var _12a9="View._delayedPoll    addView";this._delayedPoll(dojo.clone(_12a6),dojo.hitch(this,"_handleRemoveView"),_12a9);}}},addViewFeature:function(){console.log("View.addViewFeature    plugins.view.View.addViewFeature()");if(!this.getFeature()){return;}if(this.polling==true){console.log("View.addViewFeature    this.polling IS TRUE. Returning");return;}this.polling=true;var _12aa=this.getProject();var view=this.getView();var _12ab=this.getFeature();if(Agua.hasViewFeature(_12aa,view,_12ab)){console.log("View.addViewFeature    Feature already present. Returning");this.polling=false;return;}this.displayLoading();this.showStandby("Adding feature '"+_12ab+"' <br>to view '"+_12aa+"."+view+"'");var _12ac=new Object;_12ac.project=_12aa;_12ac.view=view;_12ac.feature=_12ab;_12ac.sourceproject=this.getFeatureProject();_12ac.sourceworkflow=this.getFeatureWorkflow();_12ac.species=this.getFeatureSpecies();_12ac.build=this.getFeatureBuild();if(Agua.hasViewFeature==true){console.log("View.addViewFeature    hasViewFeature is TRUE");return;}this._addViewFeature(dojo.clone(_12ac));this._remoteAddViewFeature(dojo.clone(_12ac));console.log("View.addViewFeature    Doing this._delayedPoll()");var _12ad="View._delayedPoll    addViewFeature";this._delayedPoll(dojo.clone(_12ac),dojo.hitch(this,"_handleAddViewFeature"),_12ad);},_addViewFeature:function(_12ae){console.log("View._addViewFeature    featureObject: ");console.dir({featureObject:_12ae});if(!Agua._addViewFeature(_12ae)){console.log("View._addViewFeature    Agua._addViewFeature FAILED");Agua.toastError("Failed to add feature to local data: "+_12ae.feature);}},_remoteAddViewFeature:function(_12af){console.log("View._remoteAddViewFeature    featureObject:");console.dir({featureObject:_12af});var _12b0=dojo.clone(_12af);_12b0.username=Agua.cookie("username");_12b0.sessionid=Agua.cookie("sessionid");_12b0.mode="addViewFeature";var url=this.url;var _12b1=function(_12b2){console.log("View._remoteAddViewFeature    response: ");console.dir({response:_12b2});if(_12b2.error){thisObject.standby.hide();console.log("View._remoteAddViewFeature    Error adding viewFeature");Agua.toast(_12b2);}};this.doPut({url:url,query:_12b0,callback:_12b1,doToast:false});},_handleAddViewFeature:function(_12b3,_12b4){console.log("View._handleAddViewFeature    response: ");console.dir({response:_12b3});console.log("View._handleAddViewFeature    featureObject: ");console.dir({featureObject:_12b4});if(_12b3.status=="ready"){this.polling=false;this.standby._setTextAttr("");this.standby.hide();this.displayReady();console.log("View._handleAddViewFeature    Doing this.setViewCombo(featureObject.project, featureObject.view)");this.setViewCombo(_12b4.project,_12b4.view);console.log("View._handleAddViewFeature    Doing this.reloadBrowser(featureObject.project, featureObject.view)");this.reloadBrowser(_12b4.project,_12b4.view);Agua.toastInfo("Added feature: "+_12b4.feature);}else{if(_12b3.error){this.polling=false;this.standby.hide();this.displayReady();console.log("View.handleAddViewFeature    Error on remote. Response: ");console.dir({response:_12b3});}else{console.log("View._handleAddViewFeature    Doing this._delayedPollAddViewFeature()");var _12b5="View._delayedPoll    handleAddViewFeature";this._delayedPoll(dojo.clone(_12b4),dojo.hitch(this,"_handleAddViewFeature"),_12b5);}}},removeViewFeature:function(){console.log("View.removeViewFeature    plugins.view.View.removeViewFeature()");if(!this.getViewFeature()){return;}if(this.polling==true){console.log("View.addViewFeature    this.polling IS TRUE. Returning");return;}this.polling=true;var _12b6=this.getProject();var view=this.getView();var _12b7=this.getViewFeature();if(!Agua.hasViewFeature(_12b6,view,_12b7)){console.log("View.removeViewFeature    Feature NOT present. Returning");this.polling=false;return;}this.showStandby("Removing feature '"+_12b7+"' <br>from view '"+_12b6+"."+view+"'");this.displayLoading();var _12b8=new Object;_12b8.project=this.getProject();_12b8.view=this.getView();_12b8.feature=this.getViewFeature();_12b8.species=this.getFeatureSpecies();_12b8.build=this.getFeatureBuild();_12b8.username=Agua.cookie("username");_12b8.sessionid=Agua.cookie("sessionid");_12b8.mode="removeViewFeature";console.log("View.removeViewFeature    featureObject: "+dojo.toJson(_12b8,true));this._removeViewFeature(dojo.clone(_12b8));this._remoteRemoveViewFeature(dojo.clone(_12b8));console.log("View.addViewFeature    Doing this._delayedPoll()");var _12b9="View._delayedPoll    addViewFeature";this._delayedPoll(dojo.clone(_12b8),dojo.hitch(this,"_handleRemoveViewFeature"),_12b9);},_removeViewFeature:function(_12ba){console.log("View._removeViewFeature    featureObject: "+dojo.toJson(_12ba));console.log("View._removeViewFeature    Doing Agua._removeViewFeature()");if(!Agua._removeViewFeature(_12ba)){console.log("View._removeViewFeature    Agua._removeViewFeature FAILED");Agua.toastError("Failed to remove feature from local data: "+_12ba.feature);}},_remoteRemoveViewFeature:function(_12bb){console.log("View._remoteRemoveViewFeature    featureObject:");console.dir({featureObject:_12bb});var _12bc=dojo.clone(_12bb);_12bc.username=Agua.cookie("username");_12bc.sessionid=Agua.cookie("sessionid");_12bc.mode="removeViewFeature";var url=this.url;var _12bd=function(_12be){console.log("View._remoteRemoveViewFeature    response: ");console.dir({response:_12be});if(_12be.error){thisObject.standby.hide();console.log("View._remoteRemoveViewFeature    Error removing viewFeature");Agua.toast(_12be);}};this.doPut({url:url,query:_12bc,callback:_12bd,doToast:false});},_handleRemoveViewFeature:function(_12bf,_12c0){console.log("View._handleRemoveViewFeature    response: ");console.dir({response:_12bf});console.log("View._handleRemoveViewFeature    featureObject: ");console.dir({featureObject:_12c0});if(_12bf.status=="ready"){this.polling=false;this.standby._setTextAttr("");this.standby.hide();this.displayReady();console.log("View._handleRemoveViewFeature    DOING this.setViewCombo("+_12c0.project+", "+_12c0.view+")");this.setViewCombo(_12c0.project,_12c0.view);console.log("View._handleRemoveViewFeature    DOING this.reloadBrowser("+_12c0.project+", "+_12c0.view+")");this.reloadBrowser(_12c0.project,_12c0.view);Agua.toastInfo("Removed feature: "+_12c0.feature);}else{if(_12bf.error){this.polling=false;this.standby.hide();this.displayReady();console.log("View.handleRemoveViewFeature    Error on remote. Response: ");console.dir({response:_12bf});}else{console.log("View._handleRemoveViewFeature    Doing this._handleRemoveViewFeature()");var _12c1="View._delayedPoll    handleRemoveViewFeature";this._delayedPoll(dojo.clone(_12c0),dojo.hitch(this,"_handleRemoveViewFeature"),_12c1);}}},displayLoading:function(){dojo.removeClass(this.statusDisplay,"statusReady");dojo.addClass(this.statusDisplay,"statusLoading");},displayReady:function(){dojo.removeClass(this.statusDisplay,"statusLoading");dojo.addClass(this.statusDisplay,"statusReady");},onStartRemote:function(){console.log("View.onStartRemote    caller: "+this.onStartRemote.caller.nom);console.dir({caller:this.onStartRemote.caller});console.log("View.onStartRemote    this.standby: "+this.standby);this.standby.show();this.displayLoading();},pollRemote:function(timer){console.log("View.pollRemote    timer: "+timer);console.dir({timer:timer});if(timer.url==null){return;}if(timer.query==null){return;}var _12c2=this;var _12c3=false;dojo.xhrPut({url:timer.url,contentType:"text",putData:dojo.toJson(timer.query),handleAs:"json-comment-optional",sync:true,handle:function(_12c4){console.log("View.pollRemote    response: "+dojo.toJson(_12c4,true));if(_12c4.status=="ready"||_12c4.status=="error"||_12c4.error!=null){console.log("View.pollRemote    setting completed to TRUE");_12c3=true;timer.response=_12c4;}}});console.log("View.pollRemote    Returning completed: "+_12c3);return _12c3;},onEndRemote:function(){console.log("View.onEndRemote    plugins.view.View.onEndRemote()");this.standby.hide();this.displayReady();console.log("View.onEndRemote    Doing this.callback()");console.dir({callback:this.callback});if(this.callback){this.callback();}},setStandby:function(){console.log("View.setStandby    _GroupDragPane.setStandby()");if(this.standby!=null){return this.standby;}var id=dijit.getUniqueId("dojox_widget_Standby");this.standby=new dojox.widget.Standby({target:this.rightPane.domNode,centerIndicator:"text",text:"Loading",id:id});document.body.appendChild(this.standby.domNode);dojo.addClass(this.standby._textNode,"viewStandby");console.log("View.setStandby    this.standby: ");console.dir({this_standby:this.standby});return this.standby;},showStandby:function(_12c5){console.log("View.showStandby    message: "+_12c5);this.standby._setTextAttr(_12c5);this.standby.show();},hideStandby:function(){this.standby._setTextAttr("");this.standby.hide();},loadBrowser:function(_12c6,_12c7){console.log("View.loadBrowser      PASSED projectName: "+_12c6);console.log("View.loadBrowser      PASSED viewName: "+_12c7);if(_12c6==null){_12c6=this.getProject();}if(_12c7==null){_12c7=this.getView();}console.log("View.loadBrowser      projectName: "+_12c6);console.log("View.loadBrowser      viewName: "+_12c7);if(this.selectBrowser(_12c6,_12c7)){return;}var _12c8=Agua.cookie("username");var _12c9=this.getRefseqfile(_12c8,_12c6,_12c7);var _12ca=this.getTrackinfofile(_12c8,_12c6,_12c7);console.log("View.loadBrowser      refseqfile: "+_12c9);console.log("View.loadBrowser      trackinfofile: "+_12ca);this.loadEval(_12ca);this.loadEval(_12c9);if(refSeqs==null){console.log("View.loadBrowser      refSeqs is null. Returning");return;}if(trackInfo==null){console.log("View.loadBrowser      trackInfo is null. Returning");return;}console.log("View.loadBrowser      refSeqs: ");console.dir({refSeqs:refSeqs});if(_12c6==null||_12c7==null){console.log("View.loadBrowser    One of the required inputs (projectName, viewName) is null. Returning");return;}var _12cb=Agua.getViewObject(_12c6,_12c7);console.log("View.loadBrowser      viewObject: ");console.dir({viewObject:_12cb});if(!_12cb){console.log("View.loadBrowser      viewObject is not defined. Returning");return;}var _12cc=_12cb.tracklist;var _12cd=_12cb.species;var _12ce=_12cb.build;var _12c8=Agua.cookie("username");var _12cf=this.getLocationObject(_12cb);var _12d0=_12cf.start+"..."+_12cf.stop;var _12d1=_12cf.name+":"+_12d0;console.log("View.loadBrowser      location: "+_12d1);var _12d2="plugins.view.View.jbrowse.Browser";var _12d3=dijit.getUniqueId(_12d2.replace(/\./g,"_"));this.loading=true;var b=new plugins.view.jbrowse.js.Browser({parentWidget:this,viewObject:_12cb,speciesName:_12cd,buildName:_12ce,species:_12cd,build:_12ce,refSeqs:refSeqs,trackData:trackInfo,baseUrl:this.baseUrl,dataRoot:this.baseUrl+"/users/"+_12c8+"/"+_12c6+"/"+_12c7+"/",locationObject:_12cf,location:_12d1,browserRoot:this.browserRoot,trackList:_12cc,tracks:_12cc,attachWidget:this.rightPane});this.addBrowser(b,_12c6,_12c7);console.dir({browser:b});console.log("View.loadBrowser    XXXXXXX END OF LOADING XXXXXX");console.log("View.loadBrowser    this.loading: "+this.loading);dojo.connect(b.mainTab,"destroy",dojo.hitch(this,"removeBrowserObject",b,_12c6,_12c7));console.log("View.loadBrowser      XXXXXXX END OF NAVIGATION XXXXXX");this.loading=false;console.log("View.loadBrowser    SET this.loading TO : "+this.loading);},getLocationObject:function(_12d4){console.log("View.getLocationObject    viewObject:");console.dir({viewObject:_12d4});var _12d5=new Object;if(!_12d4.chromosome){_12d4.chromosome=refSeqs[0].name;_12d4.start=0;_12d4.stop=(refSeqs[0].end/10);}_12d5.name=_12d4.chromosome;_12d5.start=parseInt(_12d4.start);_12d5.stop=parseInt(_12d4.stop);console.log("View.getLocationObject    Returning locationObject:");console.dir({locationObject:_12d5});return _12d5;},reloadBrowser:function(_12d6,_12d7){console.log("View.reloadBrowser      projectName: "+_12d6);console.log("View.reloadBrowser      viewName: "+_12d7);var _12d8=this.getBrowser(_12d6,_12d7);if(_12d8!=null){console.log("View.reloadBrowser    BEFORE this.removeBrowser(projectName, workflow, viewName)");this.removeBrowser(_12d8.browser,_12d6,_12d7);console.log("View.reloadBrowser    AFTER this.removeBrowser(projectName, workflow, viewName)");}this.loadBrowser(_12d6,_12d7);console.log("View.reloadBrowser    AFTER loadBrowser");},selectBrowser:function(_12d9,_12da){var _12db=this.getBrowser(_12d9,_12da);if(_12db==null){return;}var _12dc=_12db.browser;this.rightPane.selectChild(_12dc.mainTab);return 1;},getBrowser:function(_12dd,_12de){var index=this.getBrowserIndex(_12dd,_12de);console.log("View.selectBrowser    index: "+index);if(index==null){return;}return this.browsers[index];},addBrowser:function(_12df,_12e0,_12e1){console.log("View.addBrowser    browser: "+_12df);console.log("View.addBrowser    projectName: "+_12e0);console.log("View.addBrowser    viewName: "+_12e1);var _12e2={browser:_12df,project:_12e0,view:_12e1};var _12e3=this._addObjectToArray(this.browsers,_12e2,["browser","project","view"]);console.log("View.addBrowser    success: "+_12e3);return _12e3;},isBrowser:function(_12e4,_12e5){console.log("View.isBrowser    projectName: "+_12e4);console.log("View.isBrowser    viewName: "+_12e5);if(this.getBrowserIndex(_12e4,_12e5)!=null){console.log("View.isBrowser    Returning 1");return 1;}else{console.log("View.isBrowser    Returning 0");return 0;}},getBrowserIndex:function(_12e6,_12e7){console.log("View.getBrowserIndex    projectName: "+_12e6);console.log("View.getBrowserIndex    viewName: "+_12e7);console.log("View.getBrowserIndex    this.browsers: ");console.dir({this_browsers:this.browsers});var _12e8={project:_12e6,view:_12e7};var index=this._getIndexInArray(this.browsers,{project:_12e6,view:_12e7},["project","view"]);console.log("View.getBrowserIndex    index: "+index);return index;},removeBrowser:function(_12e9,_12ea,_12eb){console.log("View.removeBrowser    plugins.viewName.View.removeBrowser(browser, projectName, viewName)");console.log("View.removeBrowser    browser: "+_12e9);console.log("View.removeBrowser    projectName: "+_12ea);console.log("View.removeBrowser    viewName: "+_12eb);this.removeBrowserTab(_12e9);var _12ec=this.removeBrowserObject(_12e9,_12ea,_12eb);console.log("View.removeBrowser    success: "+_12ec);},removeBrowserObject:function(_12ed,_12ee,_12ef){console.log("View.removeBrowserObject    caller: "+this.removeBrowserObject.caller.nom);console.log("View.removeBrowserObject    browser: "+_12ed);console.dir({browser:_12ed});console.log("View.removeBrowserObject    projectName: "+_12ee);console.log("View.removeBrowserObject    viewName: "+_12ef);console.log("View.removeBrowserObject    BEFORE this.browsers: ");console.dir({this_browsers:this.browsers});var _12f0={browser:_12ed,project:_12ee,view:_12ef};console.log("View.removeBrowserObject    browserObject: ");console.dir({browserObject:_12f0});console.log("View.removeBrowserObject    BEFORE this.browsers.length: "+this.browsers.length);var _12f1=this._removeObjectFromArray(this.browsers,_12f0,["browser","project","view"]);console.log("View.removeBrowserObject    success: "+_12f1);console.log("View.removeBrowserObject    AFTER this.browsers: ");console.dir({this_browsers:this.browsers});console.log("View.removeBrowserObject    AFTER this.browsers.length: "+this.browsers.length);return _12f1;},removeBrowserTab:function(_12f2,_12f3,_12f4){console.log("View.removeBrowserTab    browser:");console.dir({browser:_12f2});this.rightPane.removeChild(_12f2.mainTab);console.log("View.removeBrowserTab    AFTER removeChild(browser.mainTab)");return true;},fireViewProjectCombo:function(){console.log("View.fireViewProjectCombo    viewProjectCombo._onchange");var _12f5=this.viewProjectCombo.get("value");this.setViewCombo(_12f5);},fireViewCombo:function(){if(!this.viewComboFired==true){this.viewComboFired=true;}else{console.log("View.fireViewCombo    plugins.view.View.fireViewCombo()");var _12f6=this.getProject();var _12f7=this.getView();console.log("View.fireViewCombo    projectName: "+_12f6);console.log("View.fireViewCombo    viewName: "+_12f7);this.setSpeciesLabel(_12f6,_12f7);this.loadBrowser(_12f6,_12f7);}},fireFeatureProjectCombo:function(){if(!this.featureProjectComboFired==true){this.featureProjectComboFired=true;}else{console.log("View.fireFeatureProjectCombo    plugins.view.View.fireFeatureProjectCombo()");var _12f8=this.featureProjectCombo.get("value");this.setWorkflowCombo(_12f8);}},fireWorkflowCombo:function(){if(!this.workflowComboFired==true){this.workflowComboFired=true;}else{console.log("View.fireWorkflowCombo    plugins.view.View.fireWorkflowCombo()");var _12f9=this.featureProjectCombo.get("value");var _12fa=this.workflowCombo.get("value");this.setSpeciesCombo(_12f9,_12fa);}},fireSpeciesCombo:function(){if(!this.speciesComboFired==true){console.log("View.fireSpeciesCombo    FIRST FIRE");this.speciesComboFired=true;}else{console.log("View.fireSpeciesCombo    plugins.view.View.fireSpeciesCombo()");var _12fb=this.viewProjectCombo.get("value");var _12fc=this.workflowCombo.get("value");var _12fd=this.getSpecies();var _12fe=this.getBuild();console.log("View.fireSpeciesCombo    projectName: "+_12fb);console.log("View.fireSpeciesCombo    workflowName: "+_12fc);console.log("View.fireSpeciesCombo    speciesName: "+_12fd);console.log("View.fireSpeciesCombo    buildName: "+_12fe);console.log("View.fireSpeciesCombo    this.setFeatureCombo("+_12fb+", "+_12fc+", "+_12fd+", "+_12fe+")");if(_12fd==null||_12fe==null){console.log("View.fireSpeciesCombo    speciesName and/or buildName is null. Returning.");return;}this.setFeatureCombo(_12fb,_12fc,_12fd,_12fe);}},destroyRecursive:function(){console.log("View.destroyRecursive    this.mainTab: ");console.dir({this_mainTab:this.mainTab});if(Agua&&Agua.tabs){Agua.tabs.removeChild(this.mainTab);}this.inherited(arguments);}});}if(!dojo._hasResource["plugins.view.Controller"]){dojo._hasResource["plugins.view.Controller"]=true;dojo.provide("plugins.view.Controller");dojo.declare("plugins.view.Controller",[dijit._Widget,dijit._Templated,plugins.core.Common],{templatePath:dojo.moduleUrl("","../plugins/view/templates/controller.html"),widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins")+"view/css/controller.css"],tabPanes:[],constructor:function(args){console.log("Controller.constructor     plugins.view.Controller.constructor");this.loadCSS();},postCreate:function(){console.log("Controller.postCreate    plugins.view.Controller.postCreate()");this.startup();},startup:function(){console.log("Controller.startup    plugins.view.Controller.startup()");this.inherited(arguments);Agua.toolbar.addChild(this.menuButton);this.menuButton.parentWidget=this;var _12ff=dojo.connect(this.menuButton,"onClick",this,"createTab");},createTab:function(args){console.log("Controller.createTab    args: ");console.dir({args:args});window.getSelection().removeAllRanges();if(args==null){args=new Object;}args.attachWidget=Agua.tabs;var _1300=new plugins.view.View(args);this.tabPanes.push(_1300);this._supportingWidgets.push(_1300);}});dojo.addOnLoad(function(){});}if(!dojo._hasResource["plugins.workflow.AppRow"]){dojo._hasResource["plugins.workflow.AppRow"]=true;dojo.provide("plugins.workflow.AppRow");dojo.declare("plugins.workflow.AppRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table\n        class=\"approw\"\n        cellspacing=\"0px\"\n        height=\"16px\" width=\"100%\" style=\"padding: 0; margin: 0; height: 16px !important;\">\n        <tr width=\"100%\">\n            <td\n                colspan=\"3\"\n                dojoAttachPoint=\"name\"\n                class=\"name\"\n                >${name}</td>\n        </tr>\n        <tr width=\"100%\">\n            <td colspan=\"3\"\n                dojoAttachPoint=\"description\"\n                class='description'\n                title=\"Description\"\n                style=\"display: none;\" >${description}</td>\n        </tr>\n        <tr width=\"100%\">\n            <td colspan=\"3\"\n                dojoAttachPoint=\"location\"\n                class='location'\n                title=\"Location\"\n                style=\"display: none;\" >${location}</td>\n        </tr>\n        <tr width=\"100%\">\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"version\"\n                class=\"version\"\n                title=\"Version\"\n                style=\"display: none;\" >${version}</td>\n\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"executor\"\n                class=\"executor\"\n                title=\"Executor\"\n                style=\"display: none;\" >${executor}</td>\n\n            <td \n                colspan=\"1\"\n                dojoAttachPoint=\"localonly\"\n                class=\"localonly\"\n                title=\"LocalOnly\"\n                style=\"display: none;\" >${localonly}</td>\n            <td></td>\n            \n        </tr>\n        <tr width=\"100%\">\n            <td colspan=\"3\"\n                dojoAttachPoint=\"notes\"\n                class='notes'\n                title=\"Notes\"\n                style=\"display: none;\" >${notes}</td>\n        </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,parentWidget:null,core:null,application:null,constructor:function(args){this.core=args.core;this.parentWidget=args.parentWidget;this.application=new Object;for(var key in args){if(key!="parentWidget"){this.application[key]=args[key];}}},getApplication:function(){return dojo.clone(this.application);},setApplication:function(_1301){this.application=_1301;return this.application;},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.name.parentWidget=this;var _1302=this;dojo.connect(this.name,"onclick",function(event){event.stopPropagation();_1302.toggle();});},toggle:function(){var array=["description","location","notes","version","executor","localonly"];for(var i in array){if(this[array[i]].style){if(this[array[i]].style.display=="table-cell"){this[array[i]].style.display="none";}else{this[array[i]].style.display="table-cell";}}}}});}if(!dojo._hasResource["plugins.workflow.AppSource"]){dojo._hasResource["plugins.workflow.AppSource"]=true;dojo.provide("plugins.workflow.AppSource");dojo.declare("plugins.workflow.AppSource",[dijit._Widget,dijit._Templated,plugins.form.DndSource],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n<div>\n    \n    <div dojoType=\"dijit.TitlePane\"\n        dojoAttachPoint=\"titlePane\"\n        title=\"${title}\"\n        style=\"width: 200px !important; min-width: 25px; background: #FFF;\"\n        >\n    \n        <div\n            dojoAttachPoint=\"dragSourceNode\"\n            class=\"dragSource\"\n            style=\"height: auto; width: 96%; margin-left: auto; margin-right: auto;\"\n        >\n    \n    </div>\n    </div>\n\n</div>\n",widgetsInTemplate:true,parentWidget:null,contextMenu:null,rowClass:"plugins.workflow.AppRow",avatarItems:["name","description"],formInputs:{name:1,owner:1,type:1,version:1,executor:1,localonly:1,location:1,description:1,notes:1,url:1},constructor:function(args){this.parentWidget=args.parentWidget;this.itemArray=args.itemArray;this.contextMenu=args.contextMenu;},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.setDragSource();},getItemArray:function(){return this.itemArray;}});}if(!dojo._hasResource["plugins.workflow.AppType"]){dojo._hasResource["plugins.workflow.AppType"]=true;dojo.provide("plugins.workflow.AppType");dojo.declare("plugins.workflow.AppType",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n<div>\n    \n    <div dojoType=\"dijit.TitlePane\"\n        dojoAttachPoint=\"titlePane\"\n        title=\"${title}\"\n        class=\"pipelineTitlePane\"\n        style=\"width: 200px !important; min-width: 25px; background: #FFF;\"\n        >\n    \n        <div\n            dojoAttachPoint=\"dragSourceNode\"\n            class=\"dragSource\"\n            style=\"height: auto; width: 96%; margin-left: auto; margin-right: auto;\"\n        >\n    \n    </div>\n    </div>\n\n</div>\n",widgetsInTemplate:true,parentWidget:null,constructor:function(args){this.parentWidget=args.parentWidget;},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);}});}if(!dojo._hasResource["plugins.workflow.AppsMenu"]){dojo._hasResource["plugins.workflow.AppsMenu"]=true;dojo.provide("plugins.workflow.AppsMenu");dojo.declare("plugins.workflow.AppsMenu",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n<div\n    dojoAttachPoint=\"menu\"\n    class=\"appsmenu\"\n    dojoType=\"plugins.menu.Menu\">\n\n<!--    <div dojoType=\"dijit.MenuItem\"\n        label=\"Info\"\n        dojoAttachPoint=\"title\"\n        class=\"title\"\n        disabled=\"false\">\n    </div>\n-->\n<!--    <div\n        dojoAttachPoint=\"aboutNode\"\n        dojoType=\"dijit.MenuItem\"\n        iconClass=\"dijitEditorIcon dijitEditorIconWikiword\"\n        >\n        About\n    </div>\n-->\n    <div\n        dojoAttachPoint=\"websiteNode\"\n        dojoAttachEvent=\"onClick:website\"\n        dojoType=\"dijit.MenuItem\"\n        iconClass=\"dijitEditorIcon dijitEditorIconInsertImage\"\n        >\n        Website\n    </div>\n\n</div>\n",widgetsInTemplate:true,addingApp:false,cssFiles:[dojo.moduleUrl("plugins")+"/workflow/css/appsmenu.css"],parentWidget:null,core:null,constructor:function(args){this.parentWidget=args.parentWidget;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.setMenu();},bind:function(node){if(node==null){}return this.menu.bindDomNode(node);},about:function(event){event.stopPropagation();},website:function(event){console.log("AppsMenu.website     plugins.workflow.Workflow.website(event)");event.stopPropagation();var _1303=this.menu.currentTarget.parentWidget;console.log("FileMenu.onUploadComplete    appRow: "+_1303);if(_1303==null){return;}var _1304=_1303.application;console.log("FileMenu.onUploadComplete    application: "+dojo.toJson(_1304));if(_1304==null){return;}var url=_1304.url;console.log("FileMenu.onUploadComplete    url: "+url);window.open(url);},setMenu:function(){}});}if(!dojo._hasResource["plugins.workflow.Apps"]){dojo._hasResource["plugins.workflow.Apps"]=true;dojo.provide("plugins.workflow.Apps");dojo.declare("plugins.workflow.Apps",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n    <div\n        dojoAttachPoint=\"mainTab\"\n        class=\"apps\"\n        dojoType=\"dijit.layout.ContentPane\"\n        parseOnLoad=\"false\"\n        title=\"My Apps\"\n\t\tstyle=\"position: relative; height: 100%; max-height: auto !important; width: 400px !important; padding: 0 !important;\"\n    >\n\n        <table width=\"200px\">\n\t\t\t<tr valign=\"top\" width=\"100%\">\n\t\t\t\t\n\t\t\t\t<td colspan=\"3\" class=\"tabTitle\" align=\"center\">\n\t\t\t\t\t<div class=\"header\">\n\t\t\t\t\t    Applications\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n            <tr>\n                <td>\n                    <div\n                        dojoAttachPoint=\"appSourcesContainer\"\n\t\t\t\t\t\tclass=\"appSource\">\n                    </div>\n                    \n                </td>\n            </tr>\n        </table>\n    \n    </div>\n</div>\n",widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins","workflow/css/apps.css")],parentWidget:null,core:null,tabContainer:null,contextMenu:null,constructor:function(args){this.core=args.core;this.parentWidget=args.parentWidget;this.attachNode=args.attachNode;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.attachNode.addChild(this.mainTab);this.attachNode.selectChild(this.mainTab);this.setContextMenu();this.loadAppSources();Agua.updater.subscribe(this,"updateApps");},setContextMenu:function(){this.contextMenu=new plugins.workflow.AppsMenu({parentWidget:this});},updateApps:function(args){this.loadAppSources();},closePanes:function(){if(this.appSources==null||this.appSources.length==0){return;}for(var i=0;i<this.appSources.length;i++){var _1305=this.appSources[i].titlePane;if(_1305.open==true){_1305.toggle();}}},clearAppSources:function(){if(this.appSources==null||this.appSources.length==0){return;}for(var i=0;i<this.appSources.length;i++){this.appSources[i].clearDragSource();this.appSourcesContainer.removeChild(this.appSources[i].domNode);this.appSources[i].destroy();}},getApps:function(){return Agua.getApps();},getAppsByType:function(type,apps){var _1306=["type"];var _1307=[type];var _1308=dojo.clone(apps);return this.filterByKeyValues(_1308,_1306,_1307);},loadAppSources:function(){this.clearAppSources();var apps=this.getApps();var types=Agua.getAppTypes(apps);this.appSources=new Array;for(var i=0;i<types.length;i++){var type=types[i];var _1309=this.getAppsByType(type,apps);if(_1309==null||_1309.length==0){continue;}var _130a=new plugins.workflow.AppSource({title:type,itemArray:_1309,contextMenu:this.contextMenu});this.appSources.push(_130a);this.appSourcesContainer.appendChild(_130a.domNode);}}});}if(!dojo._hasResource["dojo.cldr.monetary"]){dojo._hasResource["dojo.cldr.monetary"]=true;dojo.provide("dojo.cldr.monetary");dojo.getObject("cldr.monetary",true,dojo);dojo.cldr.monetary.getData=function(code){var _130b={ADP:0,AFN:0,ALL:0,AMD:0,BHD:3,BIF:0,BYR:0,CLF:0,CLP:0,COP:0,CRC:0,DJF:0,ESP:0,GNF:0,GYD:0,HUF:0,IDR:0,IQD:0,IRR:3,ISK:0,ITL:0,JOD:3,JPY:0,KMF:0,KPW:0,KRW:0,KWD:3,LAK:0,LBP:0,LUF:0,LYD:3,MGA:0,MGF:0,MMK:0,MNT:0,MRO:0,MUR:0,OMR:3,PKR:0,PYG:0,RSD:0,RWF:0,SLL:0,SOS:0,STD:0,SYP:0,TMM:0,TND:3,TRL:0,TZS:0,UGX:0,UZS:0,VND:0,VUV:0,XAF:0,XOF:0,XPF:0,YER:0,ZMK:0,ZWD:0};var _130c={CHF:5};var _130d=_130b[code],round=_130c[code];if(typeof _130d=="undefined"){_130d=2;}if(typeof round=="undefined"){round=0;}return {places:_130d,round:round};};}if(!dojo._hasResource["dojo.currency"]){dojo._hasResource["dojo.currency"]=true;dojo.provide("dojo.currency");dojo.getObject("currency",true,dojo);dojo.currency._mixInDefaults=function(_130e){_130e=_130e||{};_130e.type="currency";var _130f=dojo.i18n.getLocalization("dojo.cldr","currency",_130e.locale)||{};var iso=_130e.currency;var data=dojo.cldr.monetary.getData(iso);dojo.forEach(["displayName","symbol","group","decimal"],function(prop){data[prop]=_130f[iso+"_"+prop];});data.fractional=[true,false];return dojo.mixin(data,_130e);};dojo.currency.format=function(value,_1310){return dojo.number.format(value,dojo.currency._mixInDefaults(_1310));};dojo.currency.regexp=function(_1311){return dojo.number.regexp(dojo.currency._mixInDefaults(_1311));};dojo.currency.parse=function(_1312,_1313){return dojo.number.parse(_1312,dojo.currency._mixInDefaults(_1313));};}if(!dojo._hasResource["dijit.form.CurrencyTextBox"]){dojo._hasResource["dijit.form.CurrencyTextBox"]=true;dojo.provide("dijit.form.CurrencyTextBox");dojo.declare("dijit.form.CurrencyTextBox",dijit.form.NumberTextBox,{currency:"",baseClass:"dijitTextBox dijitCurrencyTextBox",regExpGen:function(_1314){return "("+(this._focused?this.inherited(arguments,[dojo.mixin({},_1314,this.editOptions)])+"|":"")+dojo.currency.regexp(_1314)+")";},_formatter:dojo.currency.format,_parser:dojo.currency.parse,parse:function(value,_1315){var v=this.inherited(arguments);if(isNaN(v)&&/\d+/.test(value)){v=dojo.hitch(dojo.mixin({},this,{_parser:dijit.form.NumberTextBox.prototype._parser}),"inherited")(arguments);}return v;},_setConstraintsAttr:function(_1316){if(!_1316.currency&&this.currency){_1316.currency=this.currency;}this.inherited(arguments,[dojo.currency._mixInDefaults(dojo.mixin(_1316,{exponent:false}))]);}});}if(!dojo._hasResource["dojo.DeferredList"]){dojo._hasResource["dojo.DeferredList"]=true;dojo.provide("dojo.DeferredList");dojo.DeferredList=function(list,_1317,_1318,_1319,_131a){var _131b=[];dojo.Deferred.call(this);var self=this;if(list.length===0&&!_1317){this.resolve([0,[]]);}var _131c=0;dojo.forEach(list,function(item,i){item.then(function(_131d){if(_1317){self.resolve([i,_131d]);}else{_131e(true,_131d);}},function(error){if(_1318){self.reject(error);}else{_131e(false,error);}if(_1319){return null;}throw error;});function _131e(_131f,_1320){_131b[i]=[_131f,_1320];_131c++;if(_131c===list.length){self.resolve(_131b);}};});};dojo.DeferredList.prototype=new dojo.Deferred();dojo.DeferredList.prototype.gatherResults=function(_1321){var d=new dojo.DeferredList(_1321,false,true,false);d.addCallback(function(_1322){var ret=[];dojo.forEach(_1322,function(_1323){ret.push(_1323[1]);});return ret;});return d;};}if(!dojo._hasResource["dijit.tree.TreeStoreModel"]){dojo._hasResource["dijit.tree.TreeStoreModel"]=true;dojo.provide("dijit.tree.TreeStoreModel");dojo.declare("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:false,constructor:function(args){dojo.mixin(this,args);this.connects=[];var store=this.store;if(!store.getFeatures()["dojo.data.api.Identity"]){throw new Error("dijit.Tree: store must support dojo.data.Identity");}if(store.getFeatures()["dojo.data.api.Notification"]){this.connects=this.connects.concat([dojo.connect(store,"onNew",this,"onNewItem"),dojo.connect(store,"onDelete",this,"onDeleteItem"),dojo.connect(store,"onSet",this,"onSetItem")]);}},destroy:function(){dojo.forEach(this.connects,dojo.disconnect);},getRoot:function(_1324,_1325){if(this.root){_1324(this.root);}else{this.store.fetch({query:this.query,onComplete:dojo.hitch(this,function(items){if(items.length!=1){throw new Error(this.declaredClass+": query "+dojo.toJson(this.query)+" returned "+items.length+" items, but must return exactly one item");}this.root=items[0];_1324(this.root);}),onError:_1325});}},mayHaveChildren:function(item){return dojo.some(this.childrenAttrs,function(attr){return this.store.hasAttribute(item,attr);},this);},getChildren:function(_1326,_1327,_1328){var store=this.store;if(!store.isItemLoaded(_1326)){var _1329=dojo.hitch(this,arguments.callee);store.loadItem({item:_1326,onItem:function(_132a){_1329(_132a,_1327,_1328);},onError:_1328});return;}var _132b=[];for(var i=0;i<this.childrenAttrs.length;i++){var vals=store.getValues(_1326,this.childrenAttrs[i]);_132b=_132b.concat(vals);}var _132c=0;if(!this.deferItemLoadingUntilExpand){dojo.forEach(_132b,function(item){if(!store.isItemLoaded(item)){_132c++;}});}if(_132c==0){_1327(_132b);}else{dojo.forEach(_132b,function(item,idx){if(!store.isItemLoaded(item)){store.loadItem({item:item,onItem:function(item){_132b[idx]=item;if(--_132c==0){_1327(_132b);}},onError:_1328});}});}},isItem:function(_132d){return this.store.isItem(_132d);},fetchItemByIdentity:function(_132e){this.store.fetchItemByIdentity(_132e);},getIdentity:function(item){return this.store.getIdentity(item);},getLabel:function(item){if(this.labelAttr){return this.store.getValue(item,this.labelAttr);}else{return this.store.getLabel(item);}},newItem:function(args,_132f,_1330){var pInfo={parent:_132f,attribute:this.childrenAttrs[0]},_1331;if(this.newItemIdAttr&&args[this.newItemIdAttr]){this.fetchItemByIdentity({identity:args[this.newItemIdAttr],scope:this,onItem:function(item){if(item){this.pasteItem(item,null,_132f,true,_1330);}else{_1331=this.store.newItem(args,pInfo);if(_1331&&(_1330!=undefined)){this.pasteItem(_1331,_132f,_132f,false,_1330);}}}});}else{_1331=this.store.newItem(args,pInfo);if(_1331&&(_1330!=undefined)){this.pasteItem(_1331,_132f,_132f,false,_1330);}}},pasteItem:function(_1332,_1333,_1334,bCopy,_1335){var store=this.store,_1336=this.childrenAttrs[0];if(_1333){dojo.forEach(this.childrenAttrs,function(attr){if(store.containsValue(_1333,attr,_1332)){if(!bCopy){var _1337=dojo.filter(store.getValues(_1333,attr),function(x){return x!=_1332;});store.setValues(_1333,attr,_1337);}_1336=attr;}});}if(_1334){if(typeof _1335=="number"){var _1338=store.getValues(_1334,_1336).slice();_1338.splice(_1335,0,_1332);store.setValues(_1334,_1336,_1338);}else{store.setValues(_1334,_1336,store.getValues(_1334,_1336).concat(_1332));}}},onChange:function(item){},onChildrenChange:function(_1339,_133a){},onDelete:function(_133b,_133c){},onNewItem:function(item,_133d){if(!_133d){return;}this.getChildren(_133d.item,dojo.hitch(this,function(_133e){this.onChildrenChange(_133d.item,_133e);}));},onDeleteItem:function(item){this.onDelete(item);},onSetItem:function(item,_133f,_1340,_1341){if(dojo.indexOf(this.childrenAttrs,_133f)!=-1){this.getChildren(item,dojo.hitch(this,function(_1342){this.onChildrenChange(item,_1342);}));}else{this.onChange(item);}}});}if(!dojo._hasResource["dijit.tree.ForestStoreModel"]){dojo._hasResource["dijit.tree.ForestStoreModel"]=true;dojo.provide("dijit.tree.ForestStoreModel");dojo.declare("dijit.tree.ForestStoreModel",dijit.tree.TreeStoreModel,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(_1343){this.root={store:this,root:true,id:_1343.rootId,label:_1343.rootLabel,children:_1343.rootChildren};},mayHaveChildren:function(item){return item===this.root||this.inherited(arguments);},getChildren:function(_1344,_1345,_1346){if(_1344===this.root){if(this.root.children){_1345(this.root.children);}else{this.store.fetch({query:this.query,onComplete:dojo.hitch(this,function(items){this.root.children=items;_1345(items);}),onError:_1346});}}else{this.inherited(arguments);}},isItem:function(_1347){return (_1347===this.root)?true:this.inherited(arguments);},fetchItemByIdentity:function(_1348){if(_1348.identity==this.root.id){var scope=_1348.scope?_1348.scope:dojo.global;if(_1348.onItem){_1348.onItem.call(scope,this.root);}}else{this.inherited(arguments);}},getIdentity:function(item){return (item===this.root)?this.root.id:this.inherited(arguments);},getLabel:function(item){return (item===this.root)?this.root.label:this.inherited(arguments);},newItem:function(args,_1349,_134a){if(_1349===this.root){this.onNewRootItem(args);return this.store.newItem(args);}else{return this.inherited(arguments);}},onNewRootItem:function(args){},pasteItem:function(_134b,_134c,_134d,bCopy,_134e){if(_134c===this.root){if(!bCopy){this.onLeaveRoot(_134b);}}dijit.tree.TreeStoreModel.prototype.pasteItem.call(this,_134b,_134c===this.root?null:_134c,_134d===this.root?null:_134d,bCopy,_134e);if(_134d===this.root){this.onAddToRoot(_134b);}},onAddToRoot:function(item){console.log(this,": item ",item," added to root");},onLeaveRoot:function(item){console.log(this,": item ",item," removed from root");},_requeryTop:function(){var _134f=this.root.children||[];this.store.fetch({query:this.query,onComplete:dojo.hitch(this,function(_1350){this.root.children=_1350;if(_134f.length!=_1350.length||dojo.some(_134f,function(item,idx){return _1350[idx]!=item;})){this.onChildrenChange(this.root,_1350);}})});},onNewItem:function(item,_1351){this._requeryTop();this.inherited(arguments);},onDeleteItem:function(item){if(dojo.indexOf(this.root.children,item)!=-1){this._requeryTop();}this.inherited(arguments);},onSetItem:function(item,_1352,_1353,_1354){this._requeryTop();this.inherited(arguments);}});}if(!dojo._hasResource["dijit.tree._dndContainer"]){dojo._hasResource["dijit.tree._dndContainer"]=true;dojo.provide("dijit.tree._dndContainer");dojo.getObject("tree",true,dojo);dijit.tree._compareNodes=function(n1,n2){if(n1===n2){return 0;}if("sourceIndex" in document.documentElement){return n1.sourceIndex-n2.sourceIndex;}else{if("compareDocumentPosition" in document.documentElement){return n1.compareDocumentPosition(n2)&2?1:-1;}else{if(document.createRange){var r1=doc.createRange();r1.setStartBefore(n1);var r2=doc.createRange();r2.setStartBefore(n2);return r1.compareBoundaryPoints(r1.END_TO_END,r2);}else{throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");}}}};dojo.declare("dijit.tree._dndContainer",null,{constructor:function(tree,_1355){this.tree=tree;this.node=tree.domNode;dojo.mixin(this,_1355);this.map={};this.current=null;this.containerState="";dojo.addClass(this.node,"dojoDndContainer");this.events=[dojo.connect(this.node,"onmouseenter",this,"onOverEvent"),dojo.connect(this.node,"onmouseleave",this,"onOutEvent"),dojo.connect(this.tree,"_onNodeMouseEnter",this,"onMouseOver"),dojo.connect(this.tree,"_onNodeMouseLeave",this,"onMouseOut"),dojo.connect(this.node,"ondragstart",dojo,"stopEvent"),dojo.connect(this.node,"onselectstart",dojo,"stopEvent")];},getItem:function(key){var _1356=this.selection[key],ret={data:_1356,type:["treeNode"]};return ret;},destroy:function(){dojo.forEach(this.events,dojo.disconnect);this.node=this.parent=null;},onMouseOver:function(_1357,evt){this.current=_1357;},onMouseOut:function(_1358,evt){this.current=null;},_changeState:function(type,_1359){var _135a="dojoDnd"+type;var state=type.toLowerCase()+"State";dojo.replaceClass(this.node,_135a+_1359,_135a+this[state]);this[state]=_1359;},_addItemClass:function(node,type){dojo.addClass(node,"dojoDndItem"+type);},_removeItemClass:function(node,type){dojo.removeClass(node,"dojoDndItem"+type);},onOverEvent:function(){this._changeState("Container","Over");},onOutEvent:function(){this._changeState("Container","");}});}if(!dojo._hasResource["dijit.tree._dndSelector"]){dojo._hasResource["dijit.tree._dndSelector"]=true;dojo.provide("dijit.tree._dndSelector");dojo.declare("dijit.tree._dndSelector",dijit.tree._dndContainer,{constructor:function(tree,_135b){this.selection={};this.anchor=null;dijit.setWaiState(this.tree.domNode,"multiselect",!this.singular);this.events.push(dojo.connect(this.tree.domNode,"onmousedown",this,"onMouseDown"),dojo.connect(this.tree.domNode,"onmouseup",this,"onMouseUp"),dojo.connect(this.tree.domNode,"onmousemove",this,"onMouseMove"));},singular:false,getSelectedTreeNodes:function(){var nodes=[],sel=this.selection;for(var i in sel){nodes.push(sel[i]);}return nodes;},selectNone:function(){this.setSelection([]);return this;},destroy:function(){this.inherited(arguments);this.selection=this.anchor=null;},addTreeNode:function(node,_135c){this.setSelection(this.getSelectedTreeNodes().concat([node]));if(_135c){this.anchor=node;}return node;},removeTreeNode:function(node){this.setSelection(this._setDifference(this.getSelectedTreeNodes(),[node]));return node;},isTreeNodeSelected:function(node){return node.id&&!!this.selection[node.id];},setSelection:function(_135d){var _135e=this.getSelectedTreeNodes();dojo.forEach(this._setDifference(_135e,_135d),dojo.hitch(this,function(node){node.setSelected(false);if(this.anchor==node){delete this.anchor;}delete this.selection[node.id];}));dojo.forEach(this._setDifference(_135d,_135e),dojo.hitch(this,function(node){node.setSelected(true);this.selection[node.id]=node;}));this._updateSelectionProperties();},_setDifference:function(xs,ys){dojo.forEach(ys,function(y){y.__exclude__=true;});var ret=dojo.filter(xs,function(x){return !x.__exclude__;});dojo.forEach(ys,function(y){delete y["__exclude__"];});return ret;},_updateSelectionProperties:function(){var _135f=this.getSelectedTreeNodes();var paths=[],nodes=[];dojo.forEach(_135f,function(node){nodes.push(node);paths.push(node.getTreePath());});var items=dojo.map(nodes,function(node){return node.item;});this.tree._set("paths",paths);this.tree._set("path",paths[0]||[]);this.tree._set("selectedNodes",nodes);this.tree._set("selectedNode",nodes[0]||null);this.tree._set("selectedItems",items);this.tree._set("selectedItem",items[0]||null);},onMouseDown:function(e){if(!this.current||this.tree.isExpandoNode(e.target,this.current)){return;}if(e.button==dojo.mouseButtons.RIGHT){return;}dojo.stopEvent(e);var _1360=this.current,copy=dojo.isCopyKey(e),id=_1360.id;if(!this.singular&&!e.shiftKey&&this.selection[id]){this._doDeselect=true;return;}else{this._doDeselect=false;}this.userSelect(_1360,copy,e.shiftKey);},onMouseUp:function(e){if(!this._doDeselect){return;}this._doDeselect=false;this.userSelect(this.current,dojo.isCopyKey(e),e.shiftKey);},onMouseMove:function(e){this._doDeselect=false;},userSelect:function(node,multi,range){if(this.singular){if(this.anchor==node&&multi){this.selectNone();}else{this.setSelection([node]);this.anchor=node;}}else{if(range&&this.anchor){var cr=dijit.tree._compareNodes(this.anchor.rowNode,node.rowNode),begin,end,_1361=this.anchor;if(cr<0){begin=_1361;end=node;}else{begin=node;end=_1361;}nodes=[];while(begin!=end){nodes.push(begin);begin=this.tree._getNextNode(begin);}nodes.push(end);this.setSelection(nodes);}else{if(this.selection[node.id]&&multi){this.removeTreeNode(node);}else{if(multi){this.addTreeNode(node,true);}else{this.setSelection([node]);this.anchor=node;}}}}},forInSelectedItems:function(f,o){o=o||dojo.global;for(var id in this.selection){f.call(o,this.getItem(id),id,this);}}});}if(!dojo._hasResource["dijit.Tree"]){dojo._hasResource["dijit.Tree"]=true;dojo.provide("dijit.Tree");dojo.declare("dijit._TreeNode",[dijit._Widget,dijit._Templated,dijit._Container,dijit._Contained,dijit._CssStateMixin],{item:null,isTreeNode:true,label:"",isExpandable:null,isExpanded:false,state:"UNCHECKED",templateString:dojo.cache("dijit","templates/TreeNode.html","<div class=\"dijitTreeNode\" role=\"presentation\"\n\t><div dojoAttachPoint=\"rowNode\" class=\"dijitTreeRow\" role=\"presentation\" dojoAttachEvent=\"onmouseenter:_onMouseEnter, onmouseleave:_onMouseLeave, onclick:_onClick, ondblclick:_onDblClick\"\n\t\t><img src=\"${_blankGif}\" alt=\"\" dojoAttachPoint=\"expandoNode\" class=\"dijitTreeExpando\" role=\"presentation\"\n\t\t/><span dojoAttachPoint=\"expandoNodeText\" class=\"dijitExpandoText\" role=\"presentation\"\n\t\t></span\n\t\t><span dojoAttachPoint=\"contentNode\"\n\t\t\tclass=\"dijitTreeContent\" role=\"presentation\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" dojoAttachPoint=\"iconNode\" class=\"dijitIcon dijitTreeIcon\" role=\"presentation\"\n\t\t\t/><span dojoAttachPoint=\"labelNode\" class=\"dijitTreeLabel\" role=\"treeitem\" tabindex=\"-1\" aria-selected=\"false\" dojoAttachEvent=\"onfocus:_onLabelFocus\"></span>\n\t\t</span\n\t></div>\n\t<div dojoAttachPoint=\"containerNode\" class=\"dijitTreeContainer\" role=\"presentation\" style=\"display: none;\"></div>\n</div>\n"),baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow",labelNode:"dijitTreeLabel"},attributeMap:dojo.delegate(dijit._Widget.prototype.attributeMap,{label:{node:"labelNode",type:"innerText"},tooltip:{node:"rowNode",type:"attribute",attribute:"title"}}),buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);if(this.isExpandable){dijit.setWaiState(this.labelNode,"expanded",this.isExpanded);}this.setSelected(false);},_setIndentAttr:function(_1362){var _1363=(Math.max(_1362,0)*this.tree._nodePixelIndent)+"px";dojo.style(this.domNode,"backgroundPosition",_1363+" 0px");dojo.style(this.rowNode,this.isLeftToRight()?"paddingLeft":"paddingRight",_1363);dojo.forEach(this.getChildren(),function(child){child.set("indent",_1362+1);});this._set("indent",_1362);},markProcessing:function(){this.state="LOADING";this._setExpando(true);},unmarkProcessing:function(){this._setExpando(false);},_updateItemClasses:function(item){var tree=this.tree,model=tree.model;if(tree._v10Compat&&item===model.root){item=null;}this._applyClassAndStyle(item,"icon","Icon");this._applyClassAndStyle(item,"label","Label");this._applyClassAndStyle(item,"row","Row");},_applyClassAndStyle:function(item,lower,upper){var _1364="_"+lower+"Class";var _1365=lower+"Node";var _1366=this[_1364];this[_1364]=this.tree["get"+upper+"Class"](item,this.isExpanded);dojo.replaceClass(this[_1365],this[_1364]||"",_1366||"");dojo.style(this[_1365],this.tree["get"+upper+"Style"](item,this.isExpanded)||{});},_updateLayout:function(){var _1367=this.getParent();if(!_1367||_1367.rowNode.style.display=="none"){dojo.addClass(this.domNode,"dijitTreeIsRoot");}else{dojo.toggleClass(this.domNode,"dijitTreeIsLast",!this.getNextSibling());}},_setExpando:function(_1368){var _1369=["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"],_136a=["*","-","+","*"],idx=_1368?0:(this.isExpandable?(this.isExpanded?1:2):3);dojo.replaceClass(this.expandoNode,_1369[idx],_1369);this.expandoNodeText.innerHTML=_136a[idx];},expand:function(){if(this._expandDeferred){return this._expandDeferred;}this._wipeOut&&this._wipeOut.stop();this.isExpanded=true;dijit.setWaiState(this.labelNode,"expanded","true");if(this.tree.showRoot||this!==this.tree.rootNode){dijit.setWaiRole(this.containerNode,"group");}dojo.addClass(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);if(this==this.tree.rootNode){dijit.setWaiState(this.tree.domNode,"expanded","true");}var def,_136b=dojo.fx.wipeIn({node:this.containerNode,duration:dijit.defaultDuration,onEnd:function(){def.callback(true);}});def=(this._expandDeferred=new dojo.Deferred(function(){_136b.stop();}));_136b.play();return def;},collapse:function(){if(!this.isExpanded){return;}if(this._expandDeferred){this._expandDeferred.cancel();delete this._expandDeferred;}this.isExpanded=false;dijit.setWaiState(this.labelNode,"expanded","false");if(this==this.tree.rootNode){dijit.setWaiState(this.tree.domNode,"expanded","false");}dojo.removeClass(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);if(!this._wipeOut){this._wipeOut=dojo.fx.wipeOut({node:this.containerNode,duration:dijit.defaultDuration});}this._wipeOut.play();},indent:0,setChildItems:function(items){var tree=this.tree,model=tree.model,defs=[];dojo.forEach(this.getChildren(),function(child){dijit._Container.prototype.removeChild.call(this,child);},this);this.state="LOADED";if(items&&items.length>0){this.isExpandable=true;dojo.forEach(items,function(item){var id=model.getIdentity(item),_136c=tree._itemNodesMap[id],node;if(_136c){for(var i=0;i<_136c.length;i++){if(_136c[i]&&!_136c[i].getParent()){node=_136c[i];node.set("indent",this.indent+1);break;}}}if(!node){node=this.tree._createTreeNode({item:item,tree:tree,isExpandable:model.mayHaveChildren(item),label:tree.getLabel(item),tooltip:tree.getTooltip(item),dir:tree.dir,lang:tree.lang,indent:this.indent+1});if(_136c){_136c.push(node);}else{tree._itemNodesMap[id]=[node];}}this.addChild(node);if(this.tree.autoExpand||this.tree._state(item)){defs.push(tree._expandNode(node));}},this);dojo.forEach(this.getChildren(),function(child,idx){child._updateLayout();});}else{this.isExpandable=false;}if(this._setExpando){this._setExpando(false);}this._updateItemClasses(this.item);if(this==tree.rootNode){var fc=this.tree.showRoot?this:this.getChildren()[0];if(fc){fc.setFocusable(true);tree.lastFocused=fc;}else{tree.domNode.setAttribute("tabIndex","0");}}return new dojo.DeferredList(defs);},getTreePath:function(){var node=this;var path=[];while(node&&node!==this.tree.rootNode){path.unshift(node.item);node=node.getParent();}path.unshift(this.tree.rootNode.item);return path;},getIdentity:function(){return this.tree.model.getIdentity(this.item);},removeChild:function(node){this.inherited(arguments);var _136d=this.getChildren();if(_136d.length==0){this.isExpandable=false;this.collapse();}dojo.forEach(_136d,function(child){child._updateLayout();});},makeExpandable:function(){this.isExpandable=true;this._setExpando(false);},_onLabelFocus:function(evt){this.tree._onNodeFocus(this);},setSelected:function(_136e){dijit.setWaiState(this.labelNode,"selected",_136e);dojo.toggleClass(this.rowNode,"dijitTreeRowSelected",_136e);},setFocusable:function(_136f){this.labelNode.setAttribute("tabIndex",_136f?"0":"-1");},_onClick:function(evt){this.tree._onClick(this,evt);},_onDblClick:function(evt){this.tree._onDblClick(this,evt);},_onMouseEnter:function(evt){this.tree._onNodeMouseEnter(this,evt);},_onMouseLeave:function(evt){this.tree._onNodeMouseLeave(this,evt);}});dojo.declare("dijit.Tree",[dijit._Widget,dijit._Templated],{store:null,model:null,query:null,label:"",showRoot:true,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:false,openOnDblClick:false,templateString:dojo.cache("dijit","templates/Tree.html","<div class=\"dijitTree dijitTreeContainer\" role=\"tree\"\n\tdojoAttachEvent=\"onkeypress:_onKeyPress\">\n\t<div class=\"dijitInline dijitTreeIndent\" style=\"position: absolute; top: -9999px\" dojoAttachPoint=\"indentDetector\"></div>\n</div>\n"),persist:true,autoExpand:false,dndController:"dijit.tree._dndSelector",dndParams:["onDndDrop","itemCreator","onDndCancel","checkAcceptance","checkItemAcceptance","dragThreshold","betweenThreshold"],onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(_1370,_1371){dojo.publish(this.id,[dojo.mixin({tree:this,event:_1370},_1371||{})]);},postMixInProperties:function(){this.tree=this;if(this.autoExpand){this.persist=false;}this._itemNodesMap={};if(!this.cookieName){this.cookieName=this.id+"SaveStateCookie";}this._loadDeferred=new dojo.Deferred();this.inherited(arguments);},postCreate:function(){this._initState();if(!this.model){this._store2model();}this.connect(this.model,"onChange","_onItemChange");this.connect(this.model,"onChildrenChange","_onItemChildrenChange");this.connect(this.model,"onDelete","_onItemDelete");this._load();this.inherited(arguments);if(this.dndController){if(dojo.isString(this.dndController)){this.dndController=dojo.getObject(this.dndController);}var _1372={};for(var i=0;i<this.dndParams.length;i++){if(this[this.dndParams[i]]){_1372[this.dndParams[i]]=this[this.dndParams[i]];}}this.dndController=new this.dndController(this,_1372);}},_store2model:function(){this._v10Compat=true;dojo.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var _1373={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};if(this.params.mayHaveChildren){_1373.mayHaveChildren=dojo.hitch(this,"mayHaveChildren");}if(this.params.getItemChildren){_1373.getChildren=dojo.hitch(this,function(item,_1374,_1375){this.getItemChildren((this._v10Compat&&item===this.model.root)?null:item,_1374,_1375);});}this.model=new dijit.tree.ForestStoreModel(_1373);this.showRoot=Boolean(this.label);},onLoad:function(){},_load:function(){this.model.getRoot(dojo.hitch(this,function(item){var rn=(this.rootNode=this.tree._createTreeNode({item:item,tree:this,isExpandable:true,label:this.label||this.getLabel(item),indent:this.showRoot?0:-1}));if(!this.showRoot){rn.rowNode.style.display="none";dijit.setWaiRole(this.domNode,"presentation");dijit.setWaiRole(rn.labelNode,"presentation");dijit.setWaiRole(rn.containerNode,"tree");}this.domNode.appendChild(rn.domNode);var _1376=this.model.getIdentity(item);if(this._itemNodesMap[_1376]){this._itemNodesMap[_1376].push(rn);}else{this._itemNodesMap[_1376]=[rn];}rn._updateLayout();this._expandNode(rn).addCallback(dojo.hitch(this,function(){this._loadDeferred.callback(true);this.onLoad();}));}),function(err){console.error(this,": error loading root: ",err);});},getNodesByItem:function(item){if(!item){return [];}var _1377=dojo.isString(item)?item:this.model.getIdentity(item);return [].concat(this._itemNodesMap[_1377]);},_setSelectedItemAttr:function(item){this.set("selectedItems",[item]);},_setSelectedItemsAttr:function(items){var tree=this;this._loadDeferred.addCallback(dojo.hitch(this,function(){var _1378=dojo.map(items,function(item){return (!item||dojo.isString(item))?item:tree.model.getIdentity(item);});var nodes=[];dojo.forEach(_1378,function(id){nodes=nodes.concat(tree._itemNodesMap[id]||[]);});this.set("selectedNodes",nodes);}));},_setPathAttr:function(path){if(path.length){return this.set("paths",[path]);}else{return this.set("paths",[]);}},_setPathsAttr:function(paths){var tree=this;return new dojo.DeferredList(dojo.map(paths,function(path){var d=new dojo.Deferred();path=dojo.map(path,function(item){return dojo.isString(item)?item:tree.model.getIdentity(item);});if(path.length){tree._loadDeferred.addCallback(function(){_1379(path,[tree.rootNode],d);});}else{d.errback("Empty path");}return d;})).addCallback(_137a);function _1379(path,nodes,def){var _137b=path.shift();var _137c=dojo.filter(nodes,function(node){return node.getIdentity()==_137b;})[0];if(!!_137c){if(path.length){tree._expandNode(_137c).addCallback(function(){_1379(path,_137c.getChildren(),def);});}else{def.callback(_137c);}}else{def.errback("Could not expand path at "+_137b);}};function _137a(_137d){tree.set("selectedNodes",dojo.map(dojo.filter(_137d,function(x){return x[0];}),function(x){return x[1];}));};},_setSelectedNodeAttr:function(node){this.set("selectedNodes",[node]);},_setSelectedNodesAttr:function(nodes){this._loadDeferred.addCallback(dojo.hitch(this,function(){this.dndController.setSelection(nodes);}));},mayHaveChildren:function(item){},getItemChildren:function(_137e,_137f){},getLabel:function(item){return this.model.getLabel(item);},getIconClass:function(item,_1380){return (!item||this.model.mayHaveChildren(item))?(_1380?"dijitFolderOpened":"dijitFolderClosed"):"dijitLeaf";},getLabelClass:function(item,_1381){},getRowClass:function(item,_1382){},getIconStyle:function(item,_1383){},getLabelStyle:function(item,_1384){},getRowStyle:function(item,_1385){},getTooltip:function(item){return "";},_onKeyPress:function(e){if(e.altKey){return;}var dk=dojo.keys;var _1386=dijit.getEnclosingWidget(e.target);if(!_1386){return;}var key=e.charOrCode;if(typeof key=="string"&&key!=" "){if(!e.altKey&&!e.ctrlKey&&!e.shiftKey&&!e.metaKey){this._onLetterKeyNav({node:_1386,key:key.toLowerCase()});dojo.stopEvent(e);}}else{if(this._curSearch){clearTimeout(this._curSearch.timer);delete this._curSearch;}var map=this._keyHandlerMap;if(!map){map={};map[dk.ENTER]="_onEnterKey";map[dk.SPACE]=map[" "]="_onEnterKey";map[this.isLeftToRight()?dk.LEFT_ARROW:dk.RIGHT_ARROW]="_onLeftArrow";map[this.isLeftToRight()?dk.RIGHT_ARROW:dk.LEFT_ARROW]="_onRightArrow";map[dk.UP_ARROW]="_onUpArrow";map[dk.DOWN_ARROW]="_onDownArrow";map[dk.HOME]="_onHomeKey";map[dk.END]="_onEndKey";this._keyHandlerMap=map;}if(this._keyHandlerMap[key]){this[this._keyHandlerMap[key]]({node:_1386,item:_1386.item,evt:e});dojo.stopEvent(e);}}},_onEnterKey:function(_1387){this._publish("execute",{item:_1387.item,node:_1387.node});this.dndController.userSelect(_1387.node,dojo.isCopyKey(_1387.evt),_1387.evt.shiftKey);this.onClick(_1387.item,_1387.node,_1387.evt);},_onDownArrow:function(_1388){var node=this._getNextNode(_1388.node);if(node&&node.isTreeNode){this.focusNode(node);}},_onUpArrow:function(_1389){var node=_1389.node;var _138a=node.getPreviousSibling();if(_138a){node=_138a;while(node.isExpandable&&node.isExpanded&&node.hasChildren()){var _138b=node.getChildren();node=_138b[_138b.length-1];}}else{var _138c=node.getParent();if(!(!this.showRoot&&_138c===this.rootNode)){node=_138c;}}if(node&&node.isTreeNode){this.focusNode(node);}},_onRightArrow:function(_138d){var node=_138d.node;if(node.isExpandable&&!node.isExpanded){this._expandNode(node);}else{if(node.hasChildren()){node=node.getChildren()[0];if(node&&node.isTreeNode){this.focusNode(node);}}}},_onLeftArrow:function(_138e){var node=_138e.node;if(node.isExpandable&&node.isExpanded){this._collapseNode(node);}else{var _138f=node.getParent();if(_138f&&_138f.isTreeNode&&!(!this.showRoot&&_138f===this.rootNode)){this.focusNode(_138f);}}},_onHomeKey:function(){var node=this._getRootOrFirstNode();if(node){this.focusNode(node);}},_onEndKey:function(_1390){var node=this.rootNode;while(node.isExpanded){var c=node.getChildren();node=c[c.length-1];}if(node&&node.isTreeNode){this.focusNode(node);}},multiCharSearchDuration:250,_onLetterKeyNav:function(_1391){var cs=this._curSearch;if(cs){cs.pattern=cs.pattern+_1391.key;clearTimeout(cs.timer);}else{cs=this._curSearch={pattern:_1391.key,startNode:_1391.node};}var self=this;cs.timer=setTimeout(function(){delete self._curSearch;},this.multiCharSearchDuration);var node=cs.startNode;do{node=this._getNextNode(node);if(!node){node=this._getRootOrFirstNode();}}while(node!==cs.startNode&&(node.label.toLowerCase().substr(0,cs.pattern.length)!=cs.pattern));if(node&&node.isTreeNode){if(node!==cs.startNode){this.focusNode(node);}}},isExpandoNode:function(node,_1392){return dojo.isDescendant(node,_1392.expandoNode);},_onClick:function(_1393,e){var _1394=e.target,_1395=this.isExpandoNode(_1394,_1393);if((this.openOnClick&&_1393.isExpandable)||_1395){if(_1393.isExpandable){this._onExpandoClick({node:_1393});}}else{this._publish("execute",{item:_1393.item,node:_1393,evt:e});this.onClick(_1393.item,_1393,e);this.focusNode(_1393);}dojo.stopEvent(e);},_onDblClick:function(_1396,e){var _1397=e.target,_1398=(_1397==_1396.expandoNode||_1397==_1396.expandoNodeText);if((this.openOnDblClick&&_1396.isExpandable)||_1398){if(_1396.isExpandable){this._onExpandoClick({node:_1396});}}else{this._publish("execute",{item:_1396.item,node:_1396,evt:e});this.onDblClick(_1396.item,_1396,e);this.focusNode(_1396);}dojo.stopEvent(e);},_onExpandoClick:function(_1399){var node=_1399.node;this.focusNode(node);if(node.isExpanded){this._collapseNode(node);}else{this._expandNode(node);}},onClick:function(item,node,evt){},onDblClick:function(item,node,evt){},onOpen:function(item,node){},onClose:function(item,node){},_getNextNode:function(node){if(node.isExpandable&&node.isExpanded&&node.hasChildren()){return node.getChildren()[0];}else{while(node&&node.isTreeNode){var _139a=node.getNextSibling();if(_139a){return _139a;}node=node.getParent();}return null;}},_getRootOrFirstNode:function(){return this.showRoot?this.rootNode:this.rootNode.getChildren()[0];},_collapseNode:function(node){if(node._expandNodeDeferred){delete node._expandNodeDeferred;}if(node.isExpandable){if(node.state=="LOADING"){return;}node.collapse();this.onClose(node.item,node);if(node.item){this._state(node.item,false);this._saveState();}}},_expandNode:function(node,_139b){if(node._expandNodeDeferred&&!_139b){return node._expandNodeDeferred;}var model=this.model,item=node.item,_139c=this;switch(node.state){case "UNCHECKED":node.markProcessing();var def=(node._expandNodeDeferred=new dojo.Deferred());model.getChildren(item,function(items){node.unmarkProcessing();var scid=node.setChildItems(items);var ed=_139c._expandNode(node,true);scid.addCallback(function(){ed.addCallback(function(){def.callback();});});},function(err){console.error(_139c,": error loading root children: ",err);});break;default:def=(node._expandNodeDeferred=node.expand());this.onOpen(node.item,node);if(item){this._state(item,true);this._saveState();}}return def;},focusNode:function(node){dijit.focus(node.labelNode);},_onNodeFocus:function(node){if(node&&node!=this.lastFocused){if(this.lastFocused&&!this.lastFocused._destroyed){this.lastFocused.setFocusable(false);}node.setFocusable(true);this.lastFocused=node;}},_onNodeMouseEnter:function(node){},_onNodeMouseLeave:function(node){},_onItemChange:function(item){var model=this.model,_139d=model.getIdentity(item),nodes=this._itemNodesMap[_139d];if(nodes){var label=this.getLabel(item),_139e=this.getTooltip(item);dojo.forEach(nodes,function(node){node.set({item:item,label:label,tooltip:_139e});node._updateItemClasses(item);});}},_onItemChildrenChange:function(_139f,_13a0){var model=this.model,_13a1=model.getIdentity(_139f),_13a2=this._itemNodesMap[_13a1];if(_13a2){dojo.forEach(_13a2,function(_13a3){_13a3.setChildItems(_13a0);});}},_onItemDelete:function(item){var model=this.model,_13a4=model.getIdentity(item),nodes=this._itemNodesMap[_13a4];if(nodes){dojo.forEach(nodes,function(node){this.dndController.removeTreeNode(node);var _13a5=node.getParent();if(_13a5){_13a5.removeChild(node);}node.destroyRecursive();},this);delete this._itemNodesMap[_13a4];}},_initState:function(){if(this.persist){var _13a6=dojo.cookie(this.cookieName);this._openedItemIds={};if(_13a6){dojo.forEach(_13a6.split(","),function(item){this._openedItemIds[item]=true;},this);}}},_state:function(item,_13a7){if(!this.persist){return false;}var id=this.model.getIdentity(item);if(arguments.length===1){return this._openedItemIds[id];}if(_13a7){this._openedItemIds[id]=true;}else{delete this._openedItemIds[id];}},_saveState:function(){if(!this.persist){return;}var ary=[];for(var id in this._openedItemIds){ary.push(id);}dojo.cookie(this.cookieName,ary.join(","),{expires:365});},destroy:function(){if(this._curSearch){clearTimeout(this._curSearch.timer);delete this._curSearch;}if(this.rootNode){this.rootNode.destroyRecursive();}if(this.dndController&&!dojo.isString(this.dndController)){this.dndController.destroy();}this.rootNode=null;this.inherited(arguments);},destroyRecursive:function(){this.destroy();},resize:function(_13a8){if(_13a8){dojo.marginBox(this.domNode,_13a8);}this._nodePixelIndent=dojo._getMarginSize(this.tree.indentDetector).w;if(this.tree.rootNode){this.tree.rootNode.set("indent",this.showRoot?0:-1);}},_createTreeNode:function(args){return new dijit._TreeNode(args);}});}if(!dojo._hasResource["dijit.layout.AccordionPane"]){dojo._hasResource["dijit.layout.AccordionPane"]=true;dojo.provide("dijit.layout.AccordionPane");dojo.declare("dijit.layout.AccordionPane",dijit.layout.ContentPane,{constructor:function(){dojo.deprecated("dijit.layout.AccordionPane deprecated, use ContentPane instead","","2.0");},onSelected:function(){}});}if(!dojo._hasResource["dijit.layout.AccordionContainer"]){dojo._hasResource["dijit.layout.AccordionContainer"]=true;dojo.provide("dijit.layout.AccordionContainer");dojo.declare("dijit.layout.AccordionContainer",dijit.layout.StackContainer,{duration:dijit.defaultDuration,buttonWidget:"dijit.layout._AccordionButton",baseClass:"dijitAccordionContainer",buildRendering:function(){this.inherited(arguments);this.domNode.style.overflow="hidden";dijit.setWaiRole(this.domNode,"tablist");},startup:function(){if(this._started){return;}this.inherited(arguments);if(this.selectedChildWidget){var style=this.selectedChildWidget.containerNode.style;style.display="";style.overflow="auto";this.selectedChildWidget._wrapperWidget.set("selected",true);}},layout:function(){var _13a9=this.selectedChildWidget;if(!_13a9){return;}var _13aa=_13a9._wrapperWidget.domNode,_13ab=dojo._getMarginExtents(_13aa),_13ac=dojo._getPadBorderExtents(_13aa),_13ad=_13a9._wrapperWidget.containerNode,_13ae=dojo._getMarginExtents(_13ad),_13af=dojo._getPadBorderExtents(_13ad),_13b0=this._contentBox;var _13b1=0;dojo.forEach(this.getChildren(),function(child){if(child!=_13a9){_13b1+=dojo._getMarginSize(child._wrapperWidget.domNode).h;}});this._verticalSpace=_13b0.h-_13b1-_13ab.h-_13ac.h-_13ae.h-_13af.h-_13a9._buttonWidget.getTitleHeight();this._containerContentBox={h:this._verticalSpace,w:this._contentBox.w-_13ab.w-_13ac.w-_13ae.w-_13af.w};if(_13a9){_13a9.resize(this._containerContentBox);}},_setupChild:function(child){child._wrapperWidget=new dijit.layout._AccordionInnerContainer({contentWidget:child,buttonWidget:this.buttonWidget,id:child.id+"_wrapper",dir:child.dir,lang:child.lang,parent:this});this.inherited(arguments);},addChild:function(child,_13b2){if(this._started){dojo.place(child.domNode,this.containerNode,_13b2);if(!child._started){child.startup();}this._setupChild(child);dojo.publish(this.id+"-addChild",[child,_13b2]);this.layout();if(!this.selectedChildWidget){this.selectChild(child);}}else{this.inherited(arguments);}},removeChild:function(child){if(child._wrapperWidget){dojo.place(child.domNode,child._wrapperWidget.domNode,"after");child._wrapperWidget.destroy();delete child._wrapperWidget;}dojo.removeClass(child.domNode,"dijitHidden");this.inherited(arguments);},getChildren:function(){return dojo.map(this.inherited(arguments),function(child){return child.declaredClass=="dijit.layout._AccordionInnerContainer"?child.contentWidget:child;},this);},destroy:function(){if(this._animation){this._animation.stop();}dojo.forEach(this.getChildren(),function(child){if(child._wrapperWidget){child._wrapperWidget.destroy();}else{child.destroyRecursive();}});this.inherited(arguments);},_showChild:function(child){child._wrapperWidget.containerNode.style.display="block";return this.inherited(arguments);},_hideChild:function(child){child._wrapperWidget.containerNode.style.display="none";this.inherited(arguments);},_transition:function(_13b3,_13b4,_13b5){if(dojo.isIE<8){_13b5=false;}if(this._animation){this._animation.stop(true);delete this._animation;}var self=this;if(_13b3){_13b3._wrapperWidget.set("selected",true);var d=this._showChild(_13b3);if(this.doLayout&&_13b3.resize){_13b3.resize(this._containerContentBox);}}if(_13b4){_13b4._wrapperWidget.set("selected",false);if(!_13b5){this._hideChild(_13b4);}}if(_13b5){var _13b6=_13b3._wrapperWidget.containerNode,_13b7=_13b4._wrapperWidget.containerNode;var _13b8=_13b3._wrapperWidget.containerNode,_13b9=dojo._getMarginExtents(_13b8),_13ba=dojo._getPadBorderExtents(_13b8),_13bb=_13b9.h+_13ba.h;_13b7.style.height=(self._verticalSpace-_13bb)+"px";this._animation=new dojo.Animation({node:_13b6,duration:this.duration,curve:[1,this._verticalSpace-_13bb-1],onAnimate:function(value){value=Math.floor(value);_13b6.style.height=value+"px";_13b7.style.height=(self._verticalSpace-_13bb-value)+"px";},onEnd:function(){delete self._animation;_13b6.style.height="auto";_13b4._wrapperWidget.containerNode.style.display="none";_13b7.style.height="auto";self._hideChild(_13b4);}});this._animation.onStop=this._animation.onEnd;this._animation.play();}return d;},_onKeyPress:function(e,_13bc){if(this.disabled||e.altKey||!(_13bc||e.ctrlKey)){return;}var k=dojo.keys,c=e.charOrCode;if((_13bc&&(c==k.LEFT_ARROW||c==k.UP_ARROW))||(e.ctrlKey&&c==k.PAGE_UP)){this._adjacent(false)._buttonWidget._onTitleClick();dojo.stopEvent(e);}else{if((_13bc&&(c==k.RIGHT_ARROW||c==k.DOWN_ARROW))||(e.ctrlKey&&(c==k.PAGE_DOWN||c==k.TAB))){this._adjacent(true)._buttonWidget._onTitleClick();dojo.stopEvent(e);}}}});dojo.declare("dijit.layout._AccordionInnerContainer",[dijit._Widget,dijit._CssStateMixin],{baseClass:"dijitAccordionInnerContainer",isContainer:true,isLayoutContainer:true,buildRendering:function(){this.domNode=dojo.place("<div class='"+this.baseClass+"'>",this.contentWidget.domNode,"after");var child=this.contentWidget,cls=dojo.getObject(this.buttonWidget);this.button=child._buttonWidget=(new cls({contentWidget:child,label:child.title,title:child.tooltip,dir:child.dir,lang:child.lang,iconClass:child.iconClass,id:child.id+"_button",parent:this.parent})).placeAt(this.domNode);this.containerNode=dojo.place("<div class='dijitAccordionChildWrapper' style='display:none'>",this.domNode);dojo.place(this.contentWidget.domNode,this.containerNode);},postCreate:function(){this.inherited(arguments);var _13bd=this.button;this._contentWidgetWatches=[this.contentWidget.watch("title",dojo.hitch(this,function(name,_13be,_13bf){_13bd.set("label",_13bf);})),this.contentWidget.watch("tooltip",dojo.hitch(this,function(name,_13c0,_13c1){_13bd.set("title",_13c1);})),this.contentWidget.watch("iconClass",dojo.hitch(this,function(name,_13c2,_13c3){_13bd.set("iconClass",_13c3);}))];},_setSelectedAttr:function(_13c4){this._set("selected",_13c4);this.button.set("selected",_13c4);if(_13c4){var cw=this.contentWidget;if(cw.onSelected){cw.onSelected();}}},startup:function(){this.contentWidget.startup();},destroy:function(){this.button.destroyRecursive();dojo.forEach(this._contentWidgetWatches||[],function(w){w.unwatch();});delete this.contentWidget._buttonWidget;delete this.contentWidget._wrapperWidget;this.inherited(arguments);},destroyDescendants:function(){this.contentWidget.destroyRecursive();}});dojo.declare("dijit.layout._AccordionButton",[dijit._Widget,dijit._Templated,dijit._CssStateMixin],{templateString:dojo.cache("dijit.layout","templates/AccordionButton.html","<div dojoAttachEvent='onclick:_onTitleClick' class='dijitAccordionTitle'>\n\t<div dojoAttachPoint='titleNode,focusNode' dojoAttachEvent='onkeypress:_onTitleKeyPress'\n\t\t\tclass='dijitAccordionTitleFocus' role=\"tab\" aria-expanded=\"false\"\n\t\t><span class='dijitInline dijitAccordionArrow' role=\"presentation\"></span\n\t\t><span class='arrowTextUp' role=\"presentation\">+</span\n\t\t><span class='arrowTextDown' role=\"presentation\">-</span\n\t\t><img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon\" dojoAttachPoint='iconNode' style=\"vertical-align: middle\" role=\"presentation\"/>\n\t\t<span role=\"presentation\" dojoAttachPoint='titleTextNode' class='dijitAccordionText'></span>\n\t</div>\n</div>\n"),attributeMap:dojo.mixin(dojo.clone(dijit.layout.ContentPane.prototype.attributeMap),{label:{node:"titleTextNode",type:"innerHTML"},title:{node:"titleTextNode",type:"attribute",attribute:"title"},iconClass:{node:"iconNode",type:"class"}}),baseClass:"dijitAccordionTitle",getParent:function(){return this.parent;},buildRendering:function(){this.inherited(arguments);var _13c5=this.id.replace(" ","_");dojo.attr(this.titleTextNode,"id",_13c5+"_title");dijit.setWaiState(this.focusNode,"labelledby",dojo.attr(this.titleTextNode,"id"));dojo.setSelectable(this.domNode,false);},getTitleHeight:function(){return dojo._getMarginSize(this.domNode).h;},_onTitleClick:function(){var _13c6=this.getParent();_13c6.selectChild(this.contentWidget,true);dijit.focus(this.focusNode);},_onTitleKeyPress:function(evt){return this.getParent()._onKeyPress(evt,this.contentWidget);},_setSelectedAttr:function(_13c7){this._set("selected",_13c7);dijit.setWaiState(this.focusNode,"expanded",_13c7);dijit.setWaiState(this.focusNode,"selected",_13c7);this.focusNode.setAttribute("tabIndex",_13c7?"0":"-1");}});}if(!dojo._hasResource["dojox.rpc.Service"]){dojo._hasResource["dojox.rpc.Service"]=true;dojo.provide("dojox.rpc.Service");dojo.declare("dojox.rpc.Service",null,{constructor:function(smd,_13c8){var url;var self=this;function _13c9(smd){smd._baseUrl=new dojo._Url((dojo.isBrowser?location.href:dojo.config.baseUrl),url||".")+"";self._smd=smd;for(var _13ca in self._smd.services){var _13cb=_13ca.split(".");var _13cc=self;for(var i=0;i<_13cb.length-1;i++){_13cc=_13cc[_13cb[i]]||(_13cc[_13cb[i]]={});}_13cc[_13cb[_13cb.length-1]]=self._generateService(_13ca,self._smd.services[_13ca]);}};if(smd){if((dojo.isString(smd))||(smd instanceof dojo._Url)){if(smd instanceof dojo._Url){url=smd+"";}else{url=smd;}var text=dojo._getText(url);if(!text){throw new Error("Unable to load SMD from "+smd);}else{_13c9(dojo.fromJson(text));}}else{_13c9(smd);}}this._options=(_13c8?_13c8:{});this._requestId=0;},_generateService:function(_13cd,_13ce){if(this[_13ce]){throw new Error("WARNING: "+_13cd+" already exists for service. Unable to generate function");}_13ce.name=_13cd;var func=dojo.hitch(this,"_executeMethod",_13ce);var _13cf=dojox.rpc.transportRegistry.match(_13ce.transport||this._smd.transport);if(_13cf.getExecutor){func=_13cf.getExecutor(func,_13ce,this);}var _13d0=_13ce.returns||(_13ce._schema={});var _13d1="/"+_13cd+"/";_13d0._service=func;func.servicePath=_13d1;func._schema=_13d0;func.id=dojox.rpc.Service._nextId++;return func;},_getRequest:function(_13d2,args){var smd=this._smd;var _13d3=dojox.rpc.envelopeRegistry.match(_13d2.envelope||smd.envelope||"NONE");var _13d4=(_13d2.parameters||[]).concat(smd.parameters||[]);if(_13d3.namedParams){if((args.length==1)&&dojo.isObject(args[0])){args=args[0];}else{var data={};for(var i=0;i<_13d2.parameters.length;i++){if(typeof args[i]!="undefined"||!_13d2.parameters[i].optional){data[_13d2.parameters[i].name]=args[i];}}args=data;}if(_13d2.strictParameters||smd.strictParameters){for(i in args){var found=false;for(var j=0;j<_13d4.length;j++){if(_13d4[i].name==i){found=true;}}if(!found){delete args[i];}}}for(i=0;i<_13d4.length;i++){var param=_13d4[i];if(!param.optional&&param.name&&!args[param.name]){if(param["default"]){args[param.name]=param["default"];}else{if(!(param.name in args)){throw new Error("Required parameter "+param.name+" was omitted");}}}}}else{if(_13d4&&_13d4[0]&&_13d4[0].name&&(args.length==1)&&dojo.isObject(args[0])){if(_13d3.namedParams===false){args=dojox.rpc.toOrdered(_13d4,args);}else{args=args[0];}}}if(dojo.isObject(this._options)){args=dojo.mixin(args,this._options);}var _13d5=_13d2._schema||_13d2.returns;var _13d6=_13d3.serialize.apply(this,[smd,_13d2,args]);_13d6._envDef=_13d3;var _13d7=(_13d2.contentType||smd.contentType||_13d6.contentType);return dojo.mixin(_13d6,{sync:dojox.rpc._sync,contentType:_13d7,headers:_13d2.headers||smd.headers||_13d6.headers||{},target:_13d6.target||dojox.rpc.getTarget(smd,_13d2),transport:_13d2.transport||smd.transport||_13d6.transport,envelope:_13d2.envelope||smd.envelope||_13d6.envelope,timeout:_13d2.timeout||smd.timeout,callbackParamName:_13d2.callbackParamName||smd.callbackParamName,rpcObjectParamName:_13d2.rpcObjectParamName||smd.rpcObjectParamName,schema:_13d5,handleAs:_13d6.handleAs||"auto",preventCache:_13d2.preventCache||smd.preventCache,frameDoc:this._options.frameDoc||undefined});},_executeMethod:function(_13d8){var args=[];var i;for(i=1;i<arguments.length;i++){args.push(arguments[i]);}var _13d9=this._getRequest(_13d8,args);var _13da=dojox.rpc.transportRegistry.match(_13d9.transport).fire(_13d9);_13da.addBoth(function(_13db){return _13d9._envDef.deserialize.call(this,_13db);});return _13da;}});dojox.rpc.getTarget=function(smd,_13dc){var dest=smd._baseUrl;if(smd.target){dest=new dojo._Url(dest,smd.target)+"";}if(_13dc.target){dest=new dojo._Url(dest,_13dc.target)+"";}return dest;};dojox.rpc.toOrdered=function(_13dd,args){if(dojo.isArray(args)){return args;}var data=[];for(var i=0;i<_13dd.length;i++){data.push(args[_13dd[i].name]);}return data;};dojox.rpc.transportRegistry=new dojo.AdapterRegistry(true);dojox.rpc.envelopeRegistry=new dojo.AdapterRegistry(true);dojox.rpc.envelopeRegistry.register("URL",function(str){return str=="URL";},{serialize:function(smd,_13de,data){var d=dojo.objectToQuery(data);return {data:d,transport:"POST"};},deserialize:function(_13df){return _13df;},namedParams:true});dojox.rpc.envelopeRegistry.register("JSON",function(str){return str=="JSON";},{serialize:function(smd,_13e0,data){var d=dojo.toJson(data);return {data:d,handleAs:"json",contentType:"application/json"};},deserialize:function(_13e1){return _13e1;}});dojox.rpc.envelopeRegistry.register("PATH",function(str){return str=="PATH";},{serialize:function(smd,_13e2,data){var i;var _13e3=dojox.rpc.getTarget(smd,_13e2);if(dojo.isArray(data)){for(i=0;i<data.length;i++){_13e3+="/"+data[i];}}else{for(i in data){_13e3+="/"+i+"/"+data[i];}}return {data:"",target:_13e3};},deserialize:function(_13e4){return _13e4;}});dojox.rpc.transportRegistry.register("POST",function(str){return str=="POST";},{fire:function(r){r.url=r.target;r.postData=r.data;return dojo.rawXhrPost(r);}});dojox.rpc.transportRegistry.register("GET",function(str){return str=="GET";},{fire:function(r){r.url=r.target+(r.data?"?"+((r.rpcObjectParamName)?r.rpcObjectParamName+"=":"")+r.data:"");return dojo.xhrGet(r);}});dojox.rpc.transportRegistry.register("JSONP",function(str){return str=="JSONP";},{fire:function(r){r.url=r.target+((r.target.indexOf("?")==-1)?"?":"&")+((r.rpcObjectParamName)?r.rpcObjectParamName+"=":"")+r.data;r.callbackParamName=r.callbackParamName||"callback";return dojo.io.script.get(r);}});dojox.rpc.Service._nextId=1;dojo._contentHandlers.auto=function(xhr){var _13e5=dojo._contentHandlers;var _13e6=xhr.getResponseHeader("Content-Type");var _13e7=!_13e6?_13e5.text(xhr):_13e6.match(/\/.*json/)?_13e5.json(xhr):_13e6.match(/\/javascript/)?_13e5.javascript(xhr):_13e6.match(/\/xml/)?_13e5.xml(xhr):_13e5.text(xhr);return _13e7;};}if(!dojo._hasResource["dojo.io.script"]){dojo._hasResource["dojo.io.script"]=true;dojo.provide("dojo.io.script");dojo.getObject("io",true,dojo);(function(){var _13e8=dojo.isIE?"onreadystatechange":"load",_13e9=/complete|loaded/;dojo.io.script={get:function(args){var dfd=this._makeScriptDeferred(args);var _13ea=dfd.ioArgs;dojo._ioAddQueryToUrl(_13ea);dojo._ioNotifyStart(dfd);if(this._canAttach(_13ea)){var node=this.attach(_13ea.id,_13ea.url,args.frameDoc);if(!_13ea.jsonp&&!_13ea.args.checkString){var _13eb=dojo.connect(node,_13e8,function(evt){if(evt.type=="load"||_13e9.test(node.readyState)){dojo.disconnect(_13eb);_13ea.scriptLoaded=evt;}});}}dojo._ioWatch(dfd,this._validCheck,this._ioCheck,this._resHandle);return dfd;},attach:function(id,url,_13ec){var doc=(_13ec||dojo.doc);var _13ed=doc.createElement("script");_13ed.type="text/javascript";_13ed.src=url;_13ed.id=id;_13ed.charset="utf-8";return doc.getElementsByTagName("head")[0].appendChild(_13ed);},remove:function(id,_13ee){console.log("dojo.io.script.remove    DESTROYING ALL");return;dojo.destroy(dojo.byId(id,_13ee));if(this["jsonp_"+id]){delete this["jsonp_"+id];}},_makeScriptDeferred:function(args){var dfd=dojo._ioSetArgs(args,this._deferredCancel,this._deferredOk,this._deferredError);var _13ef=dfd.ioArgs;_13ef.id=dojo._scopeName+"IoScript"+(this._counter++);_13ef.canDelete=false;_13ef.jsonp=args.callbackParamName||args.jsonp;if(_13ef.jsonp){_13ef.query=_13ef.query||"";if(_13ef.query.length>0){_13ef.query+="&";}_13ef.query+=_13ef.jsonp+"="+(args.frameDoc?"parent.":"")+dojo._scopeName+".io.script.jsonp_"+_13ef.id+"._jsonpCallback";_13ef.frameDoc=args.frameDoc;_13ef.canDelete=true;dfd._jsonpCallback=this._jsonpCallback;this["jsonp_"+_13ef.id]=dfd;}return dfd;},_deferredCancel:function(dfd){dfd.canceled=true;if(dfd.ioArgs.canDelete){dojo.io.script._addDeadScript(dfd.ioArgs);}},_deferredOk:function(dfd){var _13f0=dfd.ioArgs;if(_13f0.canDelete){dojo.io.script._addDeadScript(_13f0);}return _13f0.json||_13f0.scriptLoaded||_13f0;},_deferredError:function(error,dfd){if(dfd.ioArgs.canDelete){if(error.dojoType=="timeout"){dojo.io.script.remove(dfd.ioArgs.id,dfd.ioArgs.frameDoc);}else{dojo.io.script._addDeadScript(dfd.ioArgs);}}console.log("dojo.io.script error",error);return error;},_deadScripts:[],_counter:1,_addDeadScript:function(_13f1){dojo.io.script._deadScripts.push({id:_13f1.id,frameDoc:_13f1.frameDoc});_13f1.frameDoc=null;},_validCheck:function(dfd){var _13f2=dojo.io.script;var _13f3=_13f2._deadScripts;if(_13f3&&_13f3.length>0){for(var i=0;i<_13f3.length;i++){_13f2.remove(_13f3[i].id,_13f3[i].frameDoc);_13f3[i].frameDoc=null;}dojo.io.script._deadScripts=[];}return true;},_ioCheck:function(dfd){var _13f4=dfd.ioArgs;if(_13f4.json||(_13f4.scriptLoaded&&!_13f4.args.checkString)){return true;}var _13f5=_13f4.args.checkString;if(_13f5&&eval("typeof("+_13f5+") != 'undefined'")){return true;}return false;},_resHandle:function(dfd){if(dojo.io.script._ioCheck(dfd)){dfd.callback(dfd);}else{dfd.errback(new Error("inconceivable dojo.io.script._resHandle error"));}},_canAttach:function(_13f6){return true;},_jsonpCallback:function(json){this.ioArgs.json=json;}};})();}if(!dojo._hasResource["plugins.workflow.ParameterRow"]){dojo._hasResource["plugins.workflow.ParameterRow"]=true;dojo.provide("plugins.workflow.ParameterRow");dojo.declare("plugins.workflow.ParameterRow",[plugins.form.EditRow,plugins.form.Inputs,plugins.core.Common,dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n<div class=\"${paramtype}\">\n    \n    <table width=\"100%\">\n        <tr>\n            <td\n                colspan=\"1\"\n                width=\"120px\"\n                dojoAttachPoint=\"nameNode\"\n                class=\"name\"\n                >${name}</td>\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"valueNode\"\n                class=\"value\"\n                title=\"Click to edit value then press 'Return' to save (ESC to quit)\"\n                >${value}</td>\n        </tr>\n    </table>\n    <table\n        dojoAttachPoint=\"hidden\"\n        class=\"hidden\"\n        style=\"display: none;\"\n        width=\"100%\">\n        \n        <tr width=\"100%\">\n            <td colspan=\"2\">\n                <table width=\"100%\">\n                    <tr width=\"100%\">\n                        <td\n                            colspan=\"1\"\n                            width=\"60px\"\n                            dojoAttachPoint=\"typeTitle\"\n                            class=\"discretion\"\n                            style=\"display: none;\">${discretion}</td>\n                        <td \n                            colspan=\"1\"\n                            width=\"60px\"\n                            dojoAttachPoint=\"typeNode\"\n                            class=\"valuetype\"\n                            title=\"Parameter type, e.g., file, directory, integer or text string\"\n                            style=\"display: none;\">${valuetype}</td>\n                        <td \n                            colspan=\"1\"\n                            width=\"50px\"\n                            dojoAttachPoint=\"browseButton\"\n                            class=\"browseButton\"\n                            title=\"Click to browse the filesystem in your home directory on the server\"\n                            style=\"display: none;\">&nbsp;</td>\n                        <td\n                            dojoAttachPoint=\"downloadButton\"\n                            class=\"downloadButton\"\n                            title=\"Click to download this file to your computer\"\n                            style=\"display: none;\">&nbsp;</td>\n                        <td\n                            dojoAttachPoint=\"uploadButton\"\n                            dojoAttachEvent=\"onclick:upload\"\n                            class=\"uploadButton\"\n                            title=\"Click to upload a file from your computer\"\n                            style=\"display: none;\">&nbsp;</td>\n                        <td dojoAttachPoint=\"fileInputMask\"\n                            class=\"fileInputMask\"\n                            style=\"display: none;\" ></td>\n                        <td class=\"filler\">&nbsp;</td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n        <tr>\n            <td \n                colspan=\"2\"\n                dojoAttachPoint=\"descriptionNode\"\n                class=\"description\"\n                title=\"Click to edit description then press 'Return' to save (ESC to quit)\"\n                style=\"display: none;\" >${description}</td>\n        <tr>\n    </table>\n\n</div>\n\n</div>\n",widgetsInTemplate:true,validInput:true,core:null,formInputs:{valueNode:"word",descriptionNode:"phrase"},defaultInputs:{valueNode:"",descriptionNode:["Description"]},requiredInputs:{valueNode:1},invalidInputs:{valueNode:["essential","required","optional"]},constructor:function(args){this.passedArgs=args;this.core=args.core;this.uploader=args.uploader;this.parameterObject=new Object;for(var key in args){if(key=="core"||key=="uploader"){continue;}this.parameterObject[key]=args[key];}},postCreate:function(){this.inherited(arguments);this.startup();},startup:function(){this.inherited(arguments);this.setToggle();this.setEditOnclicks();this.nameNode.parentWidget=this;this.setBrowseButton();if(this.valuetype=="file"){this.setFileDownload();}if(this.valuetype=="flag"){this.setCheckbox();}var node=this.valueNode;},getInputValue:function(){console.log("ParameterRow.getInputValue    plugins.workflow.ParameterRow.getInputValue()");console.log("ParameterRow.getInputValue    '"+this.name+"' this.valueNode.innerHTML: "+this.valueNode.innerHTML);if(inputValue&&inputValue.match(/^<input type="checkbox">/)){return this.valueNode.firstChild.checked;}var value;if(this.valueNode.innerHTML){value=this.valueNode.innerHTML;}var name="valueNode";if(this.formInputs[name]=="word"){value=this.cleanWord(value);}else{if(this.formInputs[name]=="phrase"){value=this.cleanEnds(value);}}value=this.convertString(value,"htmlToText");this.valueNode.value=value;return value;},destroy:function(_13f7){this.inherited(arguments);},setCheckbox:function(){console.log("ParameterRow.setCheckbox    plugins.workflow.ParameterRow.setCheckbox()");console.log("ParameterRow.setCheckbox    this.valuetype: "+this.valuetype);this.checkbox=document.createElement("input");this.checkbox.type="checkbox";if(this.parameterObject.valuetype=="flag"){if(this.value==1){this.checkbox.checked=true;}else{this.checkbox.checked=false;}}this.valueNode.innerHTML="";this.valueNode.appendChild(this.checkbox);dojo.connect(this.checkbox,"onchange",dojo.hitch(this,"handleCheckboxOnChange"));},handleCheckboxOnChange:function(event){console.log("ParameterRow.handleCheckboxOnChange    plugins.workflow.ParameterRow.handleCheckboxOnChange(event)");console.log("ParameterRow.handleCheckboxOnChange    event: "+event);event.stopPropagation();var _13f8=this.getFormInputs(this);console.log("ParameterRow.handleCheckboxOnChange    inputs: "+dojo.toJson(_13f8));if(_13f8==null){return;}console.log("ParameterRow.setCheckbox    Doing thisObject.saveInputs(inputs)");this.saveInputs(_13f8,{originator:this,reload:false});},setBrowseButton:function(){if(!this.valuetype.match(/^file/)&&!this.valuetype.match(/^director/)){return;}dojo.connect(this.browseButton,"onclick",this,dojo.hitch(this,function(event){this.openFileManager();}));},openFileManager:function(){console.log("ParameterRow.openFileManager     workflow.ParameterRow.openFileManager()");if(!Agua.fileManager){console.log("ParameterRow.openFileManager     Agua.fileManager is null. Returning");return;}if(this.paramtype!="input"){console.log("ParameterRow.openFileManager     Doing Agua.fileManager.disableMenus()");Agua.fileManager.disableMenuSelect();Agua.fileManager.disableMenuAdd();}else{console.log("ParameterRow.openFileManager     Doing Agua.fileManager.enableMenus()");Agua.fileManager.enableMenuSelect();Agua.fileManager.enableMenuAdd();}Agua.fileManager.show(this);},saveInputs:function(_13f9,_13fa){console.log("ParameterRow.saveInputs    plugins.workflow.ParameterRow.saveInputs(inputs, updateArgs)");console.log("ParameterRow.saveInputs    inputs: "+_13f9);console.dir(_13f9);console.log("ParameterRow.saveInputs    updateArgs: ");console.dir(_13fa);console.log("ParameterRow.saveInputs    this.savingParameter: "+this.savingParameter);if(this.savingParameter==true){return;}this.savingParameter=true;var node=_13fa.originator.valueNode;var _13fb=_13f9.valueNode;var force=true;console.log("ParameterRow.saveInputs    node: "+node);console.log("ParameterRow.saveInputs    inputValue: "+_13fb);console.log("ParameterRow.saveInputs    force: "+force);console.log("ParameterRow.saveInputs    this.valuetype: "+this.valuetype);if(this.valuetype=="flag"){console.log("ParameterRow.saveInputs    DOING inputValue = this.getCheckboxValue()");_13fb=this.getCheckboxValue();console.log("ParameterRow.saveInputs    inputValue: "+_13fb);_13f9.valueNode=_13fb;}console.log("ParameterRow.saveInputs    Doing this.checkInput(node, inputValue, force)");this.checkInput(node,_13fb,force);for(var i=0;i<_13f9.length;i++){_13f9[i]=this.convertBackslash(_13f9[i],"expand");}console.log("ParameterRow.saveInputs    AFTER this.convertBackslash() inputs: "+dojo.toJson(_13f9));this.parameterObject.username=Agua.cookie("username");this.parameterObject.sessionid=Agua.cookie("sessionid");for(key in _13f9){this.parameterObject[key]=_13f9[key];}delete this.parameterObject.uploader;this.parameterObject.value=this.parameterObject.valueNode;delete this.parameterObject.valueNode;this.savingParameter=false;console.log("ParameterRow.saveInputs    Doing Agua.addStageParameter(stageParameterObject)");Agua.addStageParameter(this.parameterObject);console.log("ParameterRow.saveInputs    Doing this.core.io.chainOutputs()");var _13fc=this.core.parameters.application;console.log("ParameterRow.saveInputs    application: "+dojo.toJson(_13fc));var _13fd=this.core.io.chainOutputs(_13fc,true);console.log("ParameterRow.saveInputs    chainedOutputs: "+dojo.toJson(_13fd));this.core.parameters.resetChainedOutputs(_13fd);this.core.parameters.checkValidInputs();},getCheckboxValue:function(){if(this.valueNode.firstChild.checked==true){return "1";}return "0";},checkInput:function(node,_13fe,force){console.group("ParameterRow-"+this.id+"    checkInput");console.log("ParameterRow.checkInput    node, inputValue, force");console.log("ParameterRow.checkInput    node: "+node);console.log("ParameterRow.checkInput    inputValue: "+_13fe);console.log("ParameterRow.checkInput    force: "+force);if(this.valuetype=="flag"){this.validInput==true;this.setValid(node);}else{if(_13fe==null||_13fe==""){this.checkEmpty(node);}else{if(!this.valuetype.match(/^file$/)&&!this.valuetype.match(/^directory$/)){if(this.parameterObject.valuetype=="integer"){this.checkIntegerInput(node,_13fe);}else{if(this.parameterObject.valuetype=="string"){this.checkTextInput(node,_13fe);}}}else{if(force==null){force=false;}this.checkFile(node,_13fe,force);}}}console.groupEnd("ParameterRow-"+this.id+"    checkInput");},checkEmpty:function(node){if(this.discretion=="essential"||this.discretion=="required"){this.setInvalid(node);this.validInput=false;Agua.setParameterValidity(this,false);}else{Agua.setParameterValidity(this,true);this.setValid(node);this.validInput=true;}this.core.parameters.checkValidInputs();},checkIntegerInput:function(node,_13ff){console.log("ParameterRow.checkIntegerInput    plugins.workflow.ParameterRow.checkIntegerInput()");console.log("ParameterRow.checkIntegerInput    node: "+node);console.log("ParameterRow.checkIntegerInput    inputValue: "+_13ff);if(!_13ff.match(/^\s*[\d\.]+\s*$/)){console.log("ParameterRow.isValidInput    Non-integer inputValue. Returning false");this.validInput=false;this.setInvalid(node);Agua.setParameterValidity(this,false);}else{this.setValid(node);Agua.setParameterValidity(this,true);}},checkTextInput:function(node,_1400){console.log("ParameterRow.checkTextInput    plugins.workflow.ParameterRow.checkTextInput()");console.log("ParameterRow.checkTextInput    node: "+node);console.log("ParameterRow.checkTextInput    inputValue: "+_1400);var _1401=true;this.validInput=this.isValidInput(this.invalidInputs,"valueNode",_1400);console.log("ParameterRow.checkIntegerInput    this.validInput: "+this.validInput);if(this.validInput==false&&this.paramtype=="input"){console.log("ParameterRow.checkInput    text input not valid. Setting stageParameter. to FALSE");this.setInvalid(node);Agua.setParameterValidity(this,false);}else{console.log("ParameterRow.checkInput    text input is valid. Setting stageParameter. to TRUE");this.setValid(node);Agua.setParameterValidity(this,true);}this.core.parameters.checkValidInputs();},checkFile:function(node,_1402,force){console.log("ParameterRow.checkFile    plugins.workflow.ParameterRow.checkFile()");console.log("ParameterRow.checkFile    node: "+node);if(_1402==null||_1402==""){return null;}console.log("ParameterRow.checkFile    force: "+force);if(this.parameterObject.fileinfo!=null){this.handleCheckfile(node,this.parameterObject.fileinfo);}var _1403=Agua.getFileInfo(this.parameterObject);if(_1403!=null){this.handleCheckfile(node,_1403);}var query=new Object;if(this.core.parameters.shared==true){query.username=this.username;query.requestor=Agua.cookie("username");}else{query.username=Agua.cookie("username");}query.sessionid=Agua.cookie("sessionid");query.project=this.project;query.workflow=this.workflow;query.mode="checkFile";query.filepath=_1402;var url=this.randomiseUrl(Agua.cgiUrl+"workflow.cgi");var _1404=Math.floor(Math.random()*1000000000000);var _1405=this;dojo.xhrPut({url:url,contentType:"text",preventCache:true,sync:false,handleAs:"json",content:_1404,putData:dojo.toJson(query),handle:function(_1406,_1407){console.log("ParameterRow.checkFile    JSON fileinfo for inputValue '"+_1402+"': "+dojo.toJson(_1406));Agua.setFileInfo(_1405.parameterObject,_1406);_1405.handleCheckfile(node,_1406);_1405.core.parameters.checkValidInputs();},error:function(_1408,_1409){console.log("ParameterRow.checkFile    Error with JSON Post, response: "+_1408);}});},handleCheckfile:function(node,_140a){console.log("ParameterRow.handleCheckfile    plugins.workflow.ParameterRow.handleCheckfile(node, fileinfo)");console.log("ParameterRow.handleCheckfile    BEFORE node: node");console.log("ParameterRow.handleCheckfile    node: "+node);console.log("ParameterRow.handleCheckfile    fileinfo: "+dojo.toJson(_140a));console.log("ParameterRow.handleCheckfile    DOING Agua.setFileInfo(this.parameterObject, fileinfo)");Agua.setFileInfo(this.parameterObject,_140a);if(_140a==null||_140a.exists==null){console.log("ParameterRow.handleCheckfile    Either fileinfo or fileinfo.exists is null. Returning");return;}if(_140a.exists=="true"){console.log("ParameterRow.handleCheckfile    File exists. Changing CSS");console.log("ParameterRow.handleCheckfile    this.valuetype: "+this.valuetype);console.log("ParameterRow.handleCheckfile    fileinfo.type: "+_140a.type);this.filePresent(node);if((this.valuetype=="directory"&&_140a.type=="directory")||(this.valuetype=="file"&&_140a.type=="file")){console.log("ParameterRow.handleCheckfile    The file or directory is of the correct type. Doing this.setValid(node)");this.setValid(node);this.validInput=true;console.log("ParameterRow.handleCheckfile    essential/required file/dir is  present. DOING Agua.setParameterValidity(this, true)");Agua.setParameterValidity(this,true);}else{console.log("ParameterRow.handleCheckfile    File found when directory required (or vice-versa). Doing this.setInvalid(node)");this.setInvalid(node);this.validInput=false;console.log("ParameterRow.handleCheckfile    null/empty for essential/required input. DOING Agua.setParameterValidity(this, false)");Agua.setParameterValidity(this,false);}}else{console.log("ParameterRow.handleCheckfile    File does not exist. Changing class of node to 'fileMissing'");console.log("ParameterRow.handleCheckfile    node: "+node);this.fileMissing(node);if(this.discretion=="essential"){this.validInput=false;this.setInvalid(node);console.log("ParameterRow.handleCheckfile    null/empty for essential input. DOING Agua.setParameterValidity(this, false)");Agua.setParameterValidity(this,false);}else{this.validInput=true;this.setValid(node);console.log("ParameterRow.handleCheckfile    null/empty for required input. DOING Agua.setParameterValidity(this, true)");Agua.setParameterValidity(this,true);}}console.log("ParameterRow.handleCheckfile    "+this.appname+" parameter "+this.name+" FINAL this.validInput: "+this.validInput);console.log("ParameterRow.handleCheckfile    "+this.appname+" parameter "+this.name+" FINAL this.validInput: "+this.validInput);},isValidInput:function(name,value){return true;},setEditOnclicks:function(){if(this.paramtype!="input"){return;}var _140b=this;var array=["valueNode","descriptionNode"];for(var i in array){if(this.valuetype!="flag"){dojo.connect(this[array[i]],"onclick",dojo.hitch(this,function(event){var node=event.target;this.editRow(this,node);event.stopPropagation();}));}}},setFileDownload:function(node,name){dojo.connect(this.downloadButton,"onclick",this,dojo.hitch(this,function(event){this.downloadFile(this.valueNode.innerHTML);}));},downloadFile:function(_140c){var query="?mode=downloadFile";if(this.core.parameters.shared==true){query+="&username="+this.username;query+="&requestor="+Agua.cookie("username");}else{query+="&username="+Agua.cookie("username");}query+="&sessionid="+Agua.cookie("sessionid");query+="&filepath="+_140c;var url=Agua.cgiUrl+"download.cgi";var args={method:"GET",url:url+query,handleAs:"json",load:this.handleDownload};var value=dojo.io.iframe.send(args);},handleDownload:function(_140d,_140e){if(_140d.message=="ifd.getElementsByTagName(\"textarea\")[0] is undefined"){Agua.toastMessage({message:"Download failed: File is not present",type:"error"});}},upload:function(event){var path=this.project+"/"+this.workflow;if(path==null||path==""){return;}this.uploader.getSetter("path",path);this.uploader.show();dojo.stopEvent(event);var _140f=this;this.uploader.onComplete=function(_1410){_140f.onComplete(_1410);};},onComplete:function(_1411){if(!_1411.match(/\/([^\/]+)$/)){return;}var _1412=_1411.match(/\/([^\/]+)$/)[1];var path=this.project+"/"+this.workflow+"/"+_1412;this.changeValue(this.valueNode,this.valueNode.value,path,"file");},changeValue:function(node,_1413,_1414,type){console.log("ParameterRow.changeValue     plugins.workflow.ParameterRow.changeValue(node, oldValue, newValue)");console.log("ParameterRow.changeValue     node: "+node);console.log("ParameterRow.changeValue     newValue: "+_1414);console.log("ParameterRow.changeValue     oldValue: "+_1413);console.log("ParameterRow.changeValue     type: "+type);console.log("ParameterRow.changeValue     this.valuetype: "+this.valuetype);if(_1414==null||_1414==""||_1414==_1413){console.log("ParameterRow.changeValue    newValue is empty or newValue == oldValue. Either upload was aborted or the files have the same name. Returning.");node.innerHTML=_1413;return;}node.innerHTML=_1414;this.parameterObject.value=_1414;console.log("ParameterRow.changeValue     this.parameterObject: ");console.dir(this.parameterObject);this.parameterObject.username=Agua.cookie("username");console.log("ParameterRow.changeValue     Doing Agua.addStageParameter(this.parameterObject)");Agua.addStageParameter(this.parameterObject);this.filePresent(node);if(this.valuetype.substring(0,4)!=type.substring(0,4)){console.log("ParameterRow.changeValue     type ("+type+") does not match this.valuetype ("+this.valuetype+") ");this.validInput=false;this.setInvalid(node);console.log("ParameterRow.handleCheckfile    File found where directory wanted (or vice-versa). Setting stageParameter.isValid to FALSE");Agua.setParameterValidity(this,false);}else{console.log("ParameterRow.changeValue     type ("+type+") matches this.valuetype ("+this.valuetype+") ");this.validInput=true;this.setValid(node);console.log("ParameterRow.handleCheckfile    File found where wanted. Setting stageParameter.isValid to TRUE");Agua.setParameterValidity(this,true);}console.log("ParameterRow.changeValue     DOING this.core.parameters.checkValidInputs()");this.core.parameters.checkValidInputs();},addValue:function(node,_1415,_1416,type){console.log("ParameterRow.addValue     plugins.workflow.ParameterRow.addValue(node, oldValue, newValue)");console.log("ParameterRow.addValue     node: "+node);console.log("ParameterRow.addValue     newValue: "+_1416);console.log("ParameterRow.addValue     oldValue: "+_1415);console.log("ParameterRow.addValue     type: "+type);console.log("ParameterRow.addValue     this.valuetype: "+this.valuetype);if(_1416==null||_1416==""||_1416==_1415){console.log("ParameterRow.addValue    newValue is empty or newValue == oldValue. Either upload was aborted or the files have the same name. Returning.");node.innerHTML=_1415;return;}if(_1415){_1416=_1415+","+_1416;}node.innerHTML=_1416;console.log("ParameterRow.addValue     Doing Agua.addStageParameter(stageParameterObject)");var _1417=new Object;for(var key in this.passedArgs){if(key!="core"){_1417[key]=this.passedArgs[key];}}_1417.value=_1416;console.log("ParameterRow.addValue     stageParameterObject: ");console.dir({stageParameterObject:_1417});delete _1417.uploader;_1417.username=Agua.cookie("username");Agua.addStageParameter(_1417);this.filePresent(node);if(this.valuetype!=type){console.log("ParameterRow.addValue     Input types do not match. Doing this.setInvalid(node)");this.validInput=false;this.setInvalid(node);console.log("ParameterRow.handleCheckfile    File found where directory wanted (or vice-versa). Setting stageParameter.isValid to FALSE");Agua.setParameterValidity(this,false);}else{console.log("ParameterRow.addValue     Input types match. Doing this.setValid(node)");this.validInput=true;this.setValid(node);if(this.discretion=="essential"||this.discretion=="required"){this.inputSatisfied(node);}console.log("ParameterRow.handleCheckfile    File found where wanted. Setting stageParameter.isValid to TRUE");Agua.setParameterValidity(this,true);}console.log("ParameterRow.handleCheckfile    File found where wanted. Setting stageParameter.isValid to TRUE");var _1418=this;setTimeout(function(){console.log("ParameterRow.handleCheckfile    Doing setTimeout thisObj.checkFile("+node+", "+_1416+")");_1418.checkFile(node,_1416);},100,this);console.log("ParameterRow.addValue     DOING this.core.parameters.checkValidInputs()");this.core.parameters.checkValidInputs();},filePresent:function(node){dojo.removeClass(node,"fileMissing");dojo.addClass(node,"filePresent");},fileMissing:function(node){dojo.removeClass(node,"filePresent");dojo.addClass(node,"fileMissing");},setInvalid:function(node){console.group("ParameterRow-"+this.id+"    setInvalid");console.dir({node:node});var _1419=this.setInvalid.caller.nom;console.log("ParameterRow.setInvalid    caller: "+_1419);console.log("ParameterRow.setInvalid    this.discretion: "+this.discretion);dojo.addClass(node,"invalid");dojo.addClass(this.domNode,"invalid");if(this.discretion=="required"||this.discretion=="essential"){console.log("ParameterRow.setValid    Setting required");dojo.removeClass(node,"satisfied");dojo.addClass(node,"required");dojo.removeClass(this.domNode,"satisfied");dojo.addClass(this.domNode,"required");}console.groupEnd("ParameterRow-"+this.id+"    setInvalid");},setValid:function(node){console.group("ParameterRow-"+this.id+"    setValid");console.dir({node:node});var _141a=this.setValid.caller.nom;console.log("ParameterRow.setValid    caller: "+_141a);console.log("ParameterRow.setValid    this.discretion: "+this.discretion);dojo.removeClass(node,"invalid");dojo.removeClass(this.domNode,"invalid");if(this.discretion=="essential"||this.discretion=="required"){console.log("ParameterRow.setValid    Setting satisfied");dojo.removeClass(node,"required");dojo.addClass(node,"satisfied");dojo.removeClass(this.domNode,"required");dojo.addClass(this.domNode,"satisfied");}console.groupEnd("ParameterRow-"+this.id+"    setValid");},setToggle:function(){var _141b=this;dojo.connect(this.nameNode,"onclick",function(event){event.stopPropagation();_141b.toggle();});},toggle:function(){if(this["hidden"].style.display=="table"){this["hidden"].style.display="none";}else{this["hidden"].style.display="table";}var array=["descriptionNode","typeNode","typeTitle"];for(var i in array){if(this[array[i]].style.display=="table-cell"){this[array[i]].style.display="none";}else{this[array[i]].style.display="table-cell";}}var _141c;var end=0;if(this.paramtype=="input"){_141c=["browseButton","downloadButton","uploadButton","fileInputMask"];if(this.valuetype=="file"||this.valuetype=="files"){end=4;}if(this.valuetype=="directory"||this.valuetype=="directories"){end=1;}if(this.core.parameters.shared==true&&end==4){end=2;}}else{if(this.paramtype=="output"){_141c=["browseButton","downloadButton"];if(this.valuetype=="file"){end=2;}}}for(var i=0;i<end;i++){if(this[_141c[i]].style.display=="table-cell"){this[_141c[i]].style.display="none";}else{this[_141c[i]].style.display="table-cell";}}}});}if(!dojo._hasResource["plugins.workflow.Parameters"]){dojo._hasResource["plugins.workflow.Parameters"]=true;dojo.provide("plugins.workflow.Parameters");dojo.declare("plugins.workflow.Parameters",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n    <div\n        dojoAttachPoint=\"mainTab\"\n        dojoType=\"dijit.layout.ContentPane\"\n        parseOnLoad=\"false\"\n\t\ttitle=\"Inputs\"\n\t\tclass=\"parameters\"\n\t\tstyle=\"position: relative; height: 100%; max-height: auto !important; min-width: 400px !important; width: auto !important; padding: 0 !important;\"\n    >\n\n\t\t<table width=\"100%\">\n\t\t\t<tr>\n\t\t\t\t<td colspan=\"3\"class=\"tabTitle\" align=\"center\">\n                    Inputs\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td\n\t\t\t\t\tdojoAttachPoint=\"appNameNode\"\n\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\tclass=\"appName\"\n\t\t\t\t\talign=\"center\"\n\t\t\t\t\t>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t\n\t\t\t<tr>\n\t\t\t\t<td>\n\t\t\t\t\t<div \n\t\t\t\t\t\tdojoType=\"dijit.TitlePane\"\n\t\t\t\t\t\ttitle=\"Inputs\"\n\t\t\t\t\t\tstyle=\"background: #FFF; height: auto; width: 100% !important;\"\n\t\t\t\t\t\t>\n\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoAttachPoint=\"inputRows\"\n\t\t\t\t\t\t\tclass=\"inputRows\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t\t<td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td>\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoType=\"dijit.TitlePane\"\n\t\t\t\t\t\ttitle=\"Outputs\"\n\t\t\t\t\t\tclass=\"outputsTitlePane\"\n\t\t\t\t\t\tstyle=\"background: #FFF; height: auto; width: 100% !important;\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoAttachPoint=\"outputRows\"\n\t\t\t\t\t\t\tclass=\"outputRows\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\t\t\t\t\n\t</div>\n\n\t\n</div> \n\n\n",widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins","workflow/css/parameters.css")],parentWidget:null,childWidgets:null,isValid:null,core:null,constructor:function(args){this.core=args.core;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.setUploader();this.attachNode.addChild(this.mainTab);this.attachNode.selectChild(this.mainTab);},setUploader:function(){var _141d=dijit.getUniqueId("plugins_form_Uploader");var _141e=Agua.cookie("username");var _141f=Agua.cookie("sessionid");this.uploader=new plugins.form.Uploader({uploaderId:_141d,username:_141e,sessionid:_141f});},clear:function(){this.mainTab.style.visibility="hidden";this.appNameNode.innerHTML="";while(this["inputRows"].firstChild){this["inputRows"].removeChild(this["inputRows"].firstChild);}while(this["outputRows"].firstChild){this["outputRows"].removeChild(this["outputRows"].firstChild);}},resetChainedOutputs:function(_1420){var _1421=this;dojo.forEach(_1420,function(_1422,i){if(_1422==null){return;}var _1423=_1422.value;_1421.setOutputValue(_1423);});},setOutputValue:function(_1424){var _1425=this;dojo.forEach(_1425.childWidgets,function(_1426,j){if(_1426.paramtype=="input"){return;}if(_1424==null||_1424==""){return;}if(_1424!=_1426.value){_1426.value=_1424;_1426.valueNode.innerHTML=_1424;return;}});},load:function(node,_1427,force){console.log("Parameters.load    PASSED node.application:");console.dir({node_application:node.application});if(force==null){force=false;}this.shared=_1427;this.parentNode=node;this.parentWidget=node.parentWidget;if(node.stageRow){this.stageRow=node.stageRow;}else{this.stageRow=node.parentWidget;}if(this.stageRow==null&&node.childNodes){this.stageRow=dijit.byNode(node.childNodes[0]);}this.application=node.application;if(node.application==null){console.log("Parameters.load     node.application is null. Using node.parentWidget.application");this.application=node.parentWidget.application;}console.log("Parameters.load    AFTER node.application:");console.dir({node_application:node.application});if(this.childWidgets==null){this.childWidgets=new Array;}while(this.childWidgets.length>0){var _1428=this.childWidgets.splice(0,1)[0];if(_1428.destroy){_1428.destroy();}}this.appNameNode.innerHTML=this.application.number+". "+this.application.name;this.loadTitlePane("input",_1427);this.loadTitlePane("output",_1427);this.attachNode.selectChild(this.mainTab);var _1429=node.parentWidget;console.log("Parameters.load     BEFORE stageRow.checkValidParameters()");if(!_1427){_1429.checkValidParameters(force);}console.log("Parameters.load     AFTER stageRow.checkValidParameters()");console.log("Parameters.load     END");},setParameterRowStyles:function(){console.group("Parameters-"+this.id+"    setParameterRowStyles");console.log("Parameters.setParameterRowStyles    caller: "+this.setParameterRowStyles.caller.nom);var _142a=this.childWidgets;var _142b=new Object;for(var i=0;i<_142a.length;i++){if(_142a[i].paramtype=="input"){_142b[_142a[i].name]=_142a[i];}}console.log("Parameters.setParameterRowStyles     parameterRows:");console.dir({parameterRows:_142a});var _142c=Agua.getStageParameters(this.application);for(var i=0;i<_142c.length;i++){if(_142c[i].paramtype!="input"){continue;}var _142d=_142b[_142c[i].name];var _142e=Agua.getParameterValidity(_142c[i]);if(_142e==true||_142e==null){_142d.setValid(_142d.domNode);}else{_142d.setInvalid(_142d.domNode);}}console.groupEnd("Parameters-"+this.id+"    setParameterRowStyles");},loadTitlePane:function(_142f){var _1430=_142f+"Rows";while(this[_1430].firstChild){this[_1430].removeChild(this[_1430].firstChild);}var _1431={username:this.application.username,project:this.application.project,workflow:this.application.workflow,workflownumber:this.application.workflownumber,submit:this.application.submit,name:this.application.name,number:this.application.number};if(_142f=="input"){this.addSubmit(dojo.clone(_1431),_1430);}var _1432;if(this.shared==true){_1432=Agua.getSharedStageParameters(_1431);}else{_1432=Agua.getStageParameters(_1431);}_1432=this.filterByKeyValues(_1432,["paramtype"],[_142f]);_1432=this.sortHasharrayByKeys(_1432,["ordinal","name"]);if(_1432==null){return;}for(var i=0;i<_1432.length;i++){var _1433=new Object;for(var key in _1432[i]){if(_1432[i][key].replace){_1433[key]=_1432[i][key].replace(/\\\\/g,"\\");}else{_1433[key]=_1432[i][key];}}var _1434=Agua.cookie("username");if(_1433.value==null){_1433.value="";}else{_1433.value=String(_1433.value);_1433.value=_1433.value.replace(/%username%/,_1434);_1433.value=_1433.value.replace(/%project%/,_1433.project);_1433.value=_1433.value.replace(/%workflow%/,_1433.workflow);_1433.value=_1433.value.replace(/%username%/,Agua.cookie("username"));}_1433.core=this.core;_1433.uploader=this.uploader;var _1435=new plugins.workflow.ParameterRow(_1433);this[_1430].appendChild(_1435.domNode);this.childWidgets.push(_1435);}},addSubmit:function(_1436,_1437){var _1438=this.stageRow;var _1439=_1436;_1439.description="Submit this stage to the cluster (if cluster is defined)";_1439.discretion="optional";_1439.name="SUBMIT";_1439.value=this.application.submit;_1439.paramtype="input";_1439.valuetype="flag";if(!_1439.value){_1439.value="";}var _143a=new plugins.workflow.ParameterRow(_1439);var _143b=this;_143a.handleCheckboxOnChange=dojo.hitch(_143b,function(event){event.stopPropagation();_1436.submit=0;if(event.target.checked==true){_1436.submit=1;}this.application.submit=_1436.submit;this.setStageSubmitStyle(_1438,_1436.submit);Agua.updateStageSubmit(_1436);});this[_1437].appendChild(_143a.domNode);},setStageSubmitStyle:function(_143c,_143d){console.group("Parameters-"+this.id+"    setStageSubmitStyle");console.group("Parameters.setStageSubmitStyle     stageRow: "+_143c);console.dir({stageRow:_143c});console.group("Parameters.setStageSubmitStyle     submit: "+_143d);_143c.setSubmitStyle(_143d);console.groupEnd("Parameters-"+this.id+"    setStageSubmitStyle");},checkValidInputs:function(){this.isValid=true;for(var i=0;i<this.childWidgets.length;i++){if(this.childWidgets[i].paramtype!="input"){continue;}if(this.childWidgets[i].validInput==false){this.isValid=false;break;}}var _143e=this.stageRow;if(this.stageRow==null){return;}if(this.isValid==true){this.stageRow.setValid();}else{this.stageRow.setInvalid();}},isCurrentApplication:function(_143f){var keys=["project","workflow","workflownumber","name","number"];return (this._objectsMatchByKey(_143f,this.core.parameters.application,keys));}});}if(!dojo._hasResource["plugins.workflow.Workflow"]){dojo._hasResource["plugins.workflow.Workflow"]=true;dojo.provide("plugins.workflow.Workflow");if(1){}dojo.declare("plugins.workflow.Workflow",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n\t<!-- WORKFLOW TAB -->\n\t<div\n\t\tdojoAttachPoint=\"mainTab\"\n\t\tclass=\"workflow\"\n\t\ticonClass=\"workflowIcon\"\n\t\tminWidth=\"833\"\n\t\tstyle=\"min-width: 965px !important; width: 100% !important; padding: 0px; background: #FFF; min-height: inherit !important;\"\n\t\tclosable=\"true\"\n\t\tdojoType=\"dijit.layout.BorderContainer\"\n\t\ttitle=\"Workflow\"\n\t\tparentWidget=this>\n\n\t\t<div\n\t\t\tdojoAttachPoint=\"leftPaneExpando\"\n\t\t\tdojoType=\"dojox.layout.ExpandoPane\"\n\t\t\tclass=\"leftExpando\"\n\t\t\tstartExpanded=\"true\"\n\t\t\ttitle=\"Tools\"\n\t\t\tregion=\"left\"\n\t\t\tmaxWidth=\"200\"\n\t\t\tstyle=\"width: 200px;\">\n\t\t\t\n\t\t\t<div\n\t\t\t\tdojoAttachPoint=\"leftPane\"\n\t\t\t\tdojoType=\"dijit.layout.TabContainer\"\n\t\t\t\tregion=\"center\"\n\t\t\t\ttabStrip=\"true\">\n\t\t\t</div>\n\t\t\t\n\t\t</div>\n\t\t<div region=\"center\" startExpanded=\"false\" dojoType=\"dijit.layout.ContentPane\">\n\t\t\t\n\t\t\t<div dojoType=\"dijit.layout.BorderContainer\" style=\"height:275px; border: solid #ccc 1px;\">\n\t\t\t\t<div dojoType=\"dojox.layout.ExpandoPane\"\n\t\t\t\t\tdojoAttachPoint=\"middlePaneExpando\"\n\t\t\t\t\t title=\"Controls\"\n\t\t\t\t\t region=\"left\"\n\t\t\t\t\t class=\"middleExpando\"\n\t\t\t\t\t maxWidth=\"265\"\n\t\t\t\t\t style=\"width: 320px;\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoAttachPoint=\"middlePane\"\n\t\t\t\t\t\tdojoType=\"dijit.layout.TabContainer\" region=\"center\" tabStrip=\"true\">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tdojoAttachPoint=\"rightPane\"\n\t\t\t\t\tclass=\"rightExpando\"\n\t\t\t\t\t dojoType=\"dijit.layout.TabContainer\" region=\"center\" tabStrip=\"true\">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\n\t\t\t\n\t\t</div>\n\n\t</div>\n\t<!-- END OF WORKFLOW TAB -->\n\n\n</div>\n",widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins")+"workflow/css/workflow.css",dojo.moduleUrl("plugins")+"workflow/css/history.css",dojo.moduleUrl("plugins")+"workflow/css/shared.css",dojo.moduleUrl("dojox")+"layout/resources/ExpandoPane.css",dojo.moduleUrl("dijit")+"themes/tundra/tundra.css"],attachWidget:null,project:null,workflow:null,polling:false,textBreakWidth:22,fileManager:null,core:new Object,loadPanels:null,constructor:function(args){this.loadCSS();this.attachWidget=Agua.tabs;if(args!=null){this.project=args.project;this.workflow=args.workflow;}this.core.workflow=this;this.setLoadPanels(args);},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);Agua.addWidget("workflow",this);this.attachWidget.addChild(this.mainTab);this.attachWidget.selectChild(this.mainTab);var _1440=[["plugins.workflow.Apps","apps",this.leftPane],["plugins.workflow.SharedApps","sharedApps",this.leftPane],["plugins.workflow.Parameters","parameters",this.rightPane],["plugins.workflow.Grid","grid",this.middlePane],["plugins.workflow.UserWorkflows","userWorkflows",this.middlePane],["plugins.workflow.SharedWorkflows","sharedWorkflows",this.middlePane],["plugins.workflow.History","historyPane",this.middlePane],["plugins.workflow.RunStatus.Status","runStatus",this.rightPane]];for(var i=0;i<_1440.length;i++){var _1441=_1440[i];if(this.loadPanels&&!this.loadPanels[_1441[1].toLowerCase()]){console.log("Workflow.startup    Skipping panel: "+_1441[1]);continue;}this.setCoreWidget(_1441[0],_1441[1],_1441[2]);}console.log("Workflow.startup    BEFORE this.core.userWorkflows.setProjectCombo()");console.log("Workflow.startup    this.project: "+this.project);console.log("Workflow.startup    this.workflow: "+this.workflow);if(this.project!=null&&this.core.userWorkflows!=null){this.core.userWorkflows.setProjectCombo(this.project,this.workflow);}},setCoreWidget:function(_1442,name,pane){console.log("Workflow.setCoreWidget    moduleName: "+_1442);console.log("Workflow.setCoreWidget    BEFORE dojo.require moduleName: "+_1442);dojo["require"](_1442);console.log("Workflow.setCoreWidget    AFTER dojo.require moduleName: "+_1442);if(this[name]!=null){return;}var _1443=dojo.getObject(_1442);this[name]=new _1443({attachNode:pane,parentWidget:this,core:this.core});console.log("Workflow.setCoreWidget    this["+name+"]: "+this[name]);this.core[name]=this[name];},setParameters:function(){this.core.parameters=new plugins.workflow.Parameters({attachNode:this.rightPane,parentWidget:this,core:this.core});},destroyRecursive:function(){console.log("Workflow.destroyRecursive    this.mainTab: ");console.dir({this_mainTab:this.mainTab});if(Agua&&Agua.tabs){Agua.tabs.removeChild(this.mainTab);}this.inherited(arguments);}});}if(!dojo._hasResource["plugins.workflow.Controller"]){dojo._hasResource["plugins.workflow.Controller"]=true;dojo.provide("plugins.workflow.Controller");dojo.declare("plugins.workflow.Controller",[dijit._Widget,dijit._Templated,plugins.core.Common],{name:"plugins.workflow.Controller",version:"0.01",url:"",description:"",dependencies:[{name:"plugins.core.Agua",version:0.01}],templateString:"<div dojoAttachPoint=\"containerNode\" class=\"workflow\">\n    <button\n        dojoType=\"dijit.form.Button\"\n        dojoAttachPoint=\"menuButton\"\n        class=\"menuButton\"\n        iconClass=\"workflowIcon\"\n        type=\"button\"\n        label=\"Workflow\"\n        ></button>\n</div>\n",widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins")+"workflow/css/controller.css",dojo.moduleUrl("plugins")+"workflow/css/workflow.css"],tabPanes:[],constructor:function(args){console.log("workflow.Controller.constructor    args:");console.dir({args:args});if(args.inputs){this.inputs=args.inputs;}this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);Agua.toolbar.addChild(this.menuButton);this.menuButton.parentWidget=this;var _1444=dojo.connect(this.menuButton,"onClick",this,"createTab");},createTab:function(args){console.log("Controller.createTab    args: ");console.dir({args:args});window.getSelection().removeAllRanges();if(args==null){args=new Object;}args.attachWidget=Agua.tabs;var _1445=this.inputs;args.inputs=_1445;var _1446=new plugins.workflow.Workflow(args);this.tabPanes.push(_1446);this._supportingWidgets.push(_1446);},refreshTabs:function(){console.log("workflow.Controller.refreshTabs    Populating this.tabPanes");console.log("workflow.Controller.refreshTabs    BEFORE this.tabPanes: ");console.dir({this_tabPanes:this.tabPanes});var _1447=this;dijit.registry.byClass("plugins.workflow.Workflow").forEach(function(_1448){console.log("workflow: "+_1448);console.dir({workflow:_1448});_1447.tabPanes.push(_1448);});console.log("workflow.Controller.refreshTabs    AFTER this.tabPanes: ");console.dir({this_tabPanes:this.tabPanes});}});}if(!dojo._hasResource["dojox.mdnd.Moveable"]){dojo._hasResource["dojox.mdnd.Moveable"]=true;dojo.provide("dojox.mdnd.Moveable");dojo.declare("dojox.mdnd.Moveable",null,{handle:null,skip:true,dragDistance:3,constructor:function(_1449,node){this.node=dojo.byId(node);this.d=this.node.ownerDocument;if(!_1449){_1449={};}this.handle=_1449.handle?dojo.byId(_1449.handle):null;if(!this.handle){this.handle=this.node;}this.skip=_1449.skip;this.events=[dojo.connect(this.handle,"onmousedown",this,"onMouseDown")];if(dojox.mdnd.autoScroll){this.autoScroll=dojox.mdnd.autoScroll;}},isFormElement:function(e){var t=e.target;if(t.nodeType==3){t=t.parentNode;}return " a button textarea input select option ".indexOf(" "+t.tagName.toLowerCase()+" ")>=0;},onMouseDown:function(e){if(this._isDragging){return;}var _144a=dojo.isIE?(e.button==1):(e.which==1);if(!_144a){return;}if(this.skip&&this.isFormElement(e)){return;}if(this.autoScroll){this.autoScroll.setAutoScrollNode(this.node);this.autoScroll.setAutoScrollMaxPage();}this.events.push(dojo.connect(this.d,"onmouseup",this,"onMouseUp"));this.events.push(dojo.connect(this.d,"onmousemove",this,"onFirstMove"));this._selectStart=dojo.connect(dojo.body(),"onselectstart",dojo.stopEvent);this._firstX=e.clientX;this._firstY=e.clientY;dojo.stopEvent(e);},onFirstMove:function(e){dojo.stopEvent(e);var d=(this._firstX-e.clientX)*(this._firstX-e.clientX)+(this._firstY-e.clientY)*(this._firstY-e.clientY);if(d>this.dragDistance*this.dragDistance){this._isDragging=true;dojo.disconnect(this.events.pop());dojo.style(this.node,"width",dojo.contentBox(this.node).w+"px");this.initOffsetDrag(e);this.events.push(dojo.connect(this.d,"onmousemove",this,"onMove"));}},initOffsetDrag:function(e){this.offsetDrag={"l":e.pageX,"t":e.pageY};var s=this.node.style;var _144b=dojo.position(this.node,true);this.offsetDrag.l=_144b.x-this.offsetDrag.l;this.offsetDrag.t=_144b.y-this.offsetDrag.t;var _144c={"x":_144b.x,"y":_144b.y};this.size={"w":_144b.w,"h":_144b.h};this.onDragStart(this.node,_144c,this.size);},onMove:function(e){dojo.stopEvent(e);if(dojo.isIE==8&&new Date()-this.date<20){return;}if(this.autoScroll){this.autoScroll.checkAutoScroll(e);}var _144d={"x":this.offsetDrag.l+e.pageX,"y":this.offsetDrag.t+e.pageY};var s=this.node.style;s.left=_144d.x+"px";s.top=_144d.y+"px";this.onDrag(this.node,_144d,this.size,{"x":e.pageX,"y":e.pageY});if(dojo.isIE==8){this.date=new Date();}},onMouseUp:function(e){if(this._isDragging){dojo.stopEvent(e);this._isDragging=false;if(this.autoScroll){this.autoScroll.stopAutoScroll();}delete this.onMove;this.onDragEnd(this.node);this.node.focus();}dojo.disconnect(this.events.pop());dojo.disconnect(this.events.pop());},onDragStart:function(node,_144e,size){},onDragEnd:function(node){},onDrag:function(node,_144f,size,_1450){},destroy:function(){dojo.forEach(this.events,dojo.disconnect);this.events=this.node=null;}});}if(!dojo._hasResource["dojox.mdnd.AreaManager"]){dojo._hasResource["dojox.mdnd.AreaManager"]=true;dojo.provide("dojox.mdnd.AreaManager");dojo.declare("dojox.mdnd.AreaManager",null,{autoRefresh:true,areaClass:"dojoxDndArea",dragHandleClass:"dojoxDragHandle",constructor:function(){this._areaList=[];this.resizeHandler=dojo.connect(dojo.global,"onresize",this,function(){this._dropMode.updateAreas(this._areaList);});this._oldIndexArea=this._currentIndexArea=this._oldDropIndex=this._currentDropIndex=this._sourceIndexArea=this._sourceDropIndex=-1;},init:function(){this.registerByClass();},registerByNode:function(area,_1451){var index=this._getIndexArea(area);if(area&&index==-1){var _1452=area.getAttribute("accept");var _1453=(_1452)?_1452.split(/\s*,\s*/):["text"];var obj={"node":area,"items":[],"coords":{},"margin":null,"accept":_1453,"initItems":false};dojo.forEach(this._getChildren(area),function(item){this._setMarginArea(obj,item);obj.items.push(this._addMoveableItem(item));},this);this._areaList=this._dropMode.addArea(this._areaList,obj);if(!_1451){this._dropMode.updateAreas(this._areaList);}dojo.publish("/dojox/mdnd/manager/register",[area]);}},registerByClass:function(){dojo.query("."+this.areaClass).forEach(function(area){this.registerByNode(area,true);},this);this._dropMode.updateAreas(this._areaList);},unregister:function(area){var index=this._getIndexArea(area);if(index!=-1){dojo.forEach(this._areaList[index].items,function(item){this._deleteMoveableItem(item);},this);this._areaList.splice(index,1);this._dropMode.updateAreas(this._areaList);return true;}return false;},_addMoveableItem:function(node){node.setAttribute("tabIndex","0");var _1454=this._searchDragHandle(node);var _1455=new dojox.mdnd.Moveable({"handle":_1454,"skip":true},node);dojo.addClass(_1454||node,"dragHandle");var type=node.getAttribute("dndType");var item={"item":_1455,"type":type?type.split(/\s*,\s*/):["text"],"handlers":[dojo.connect(_1455,"onDragStart",this,"onDragStart")]};if(dijit&&dijit.byNode){var _1456=dijit.byNode(node);if(_1456){item.type=_1456.dndType?_1456.dndType.split(/\s*,\s*/):["text"];item.handlers.push(dojo.connect(_1456,"uninitialize",this,function(){this.removeDragItem(node.parentNode,_1455.node);}));}}return item;},_deleteMoveableItem:function(_1457){dojo.forEach(_1457.handlers,function(_1458){dojo.disconnect(_1458);});var node=_1457.item.node,_1459=this._searchDragHandle(node);dojo.removeClass(_1459||node,"dragHandle");_1457.item.destroy();},_getIndexArea:function(area){if(area){for(var i=0;i<this._areaList.length;i++){if(this._areaList[i].node===area){return i;}}}return -1;},_searchDragHandle:function(node){if(node){var _145a=this.dragHandleClass.split(" "),_145b=_145a.length,_145c="";dojo.forEach(_145a,function(css,i){_145c+="."+css;if(i!=_145b-1){_145c+=", ";}});return dojo.query(_145c,node)[0];}},addDragItem:function(area,node,index,_145d){var add=true;if(!_145d){add=area&&node&&(node.parentNode===null||(node.parentNode&&node.parentNode.nodeType!==1));}if(add){var _145e=this._getIndexArea(area);if(_145e!==-1){var item=this._addMoveableItem(node),items=this._areaList[_145e].items;if(0<=index&&index<items.length){var _145f=items.slice(0,index),_1460=items.slice(index,items.length);_145f[_145f.length]=item;this._areaList[_145e].items=_145f.concat(_1460);area.insertBefore(node,items[index].item.node);}else{this._areaList[_145e].items.push(item);area.appendChild(node);}this._setMarginArea(this._areaList[_145e],node);this._areaList[_145e].initItems=false;return true;}}return false;},removeDragItem:function(area,node){var index=this._getIndexArea(area);if(area&&index!==-1){var items=this._areaList[index].items;for(var j=0;j<items.length;j++){if(items[j].item.node===node){this._deleteMoveableItem(items[j]);items.splice(j,1);return area.removeChild(node);}}}return null;},_getChildren:function(area){var _1461=[];dojo.forEach(area.childNodes,function(child){if(child.nodeType==1){if(dijit&&dijit.byNode){var _1462=dijit.byNode(child);if(_1462){if(!_1462.dragRestriction){_1461.push(child);}}else{_1461.push(child);}}else{_1461.push(child);}}});return _1461;},_setMarginArea:function(area,node){if(area&&area.margin===null&&node){area.margin=dojo._getMarginExtents(node);}},findCurrentIndexArea:function(_1463,size){this._oldIndexArea=this._currentIndexArea;this._currentIndexArea=this._dropMode.getTargetArea(this._areaList,_1463,this._currentIndexArea);if(this._currentIndexArea!=this._oldIndexArea){if(this._oldIndexArea!=-1){this.onDragExit(_1463,size);}if(this._currentIndexArea!=-1){this.onDragEnter(_1463,size);}}return this._currentIndexArea;},_isAccepted:function(type,_1464){this._accept=false;for(var i=0;i<_1464.length;++i){for(var j=0;j<type.length;++j){if(type[j]==_1464[i]){this._accept=true;break;}}}},onDragStart:function(node,_1465,size){if(this.autoRefresh){this._dropMode.updateAreas(this._areaList);}var _1466=(dojo.isWebKit)?dojo.body():dojo.body().parentNode;if(!this._cover){this._cover=dojo.create("div",{"class":"dndCover"});this._cover2=dojo.clone(this._cover);dojo.addClass(this._cover2,"dndCover2");}var h=_1466.scrollHeight+"px";this._cover.style.height=this._cover2.style.height=h;dojo.body().appendChild(this._cover);dojo.body().appendChild(this._cover2);this._dragStartHandler=dojo.connect(node.ownerDocument,"ondragstart",dojo,"stopEvent");this._sourceIndexArea=this._lastValidIndexArea=this._currentIndexArea=this._getIndexArea(node.parentNode);var _1467=this._areaList[this._sourceIndexArea];var _1468=_1467.items;for(var i=0;i<_1468.length;i++){if(_1468[i].item.node==node){this._dragItem=_1468[i];this._dragItem.handlers.push(dojo.connect(this._dragItem.item,"onDrag",this,"onDrag"));this._dragItem.handlers.push(dojo.connect(this._dragItem.item,"onDragEnd",this,"onDrop"));_1468.splice(i,1);this._currentDropIndex=this._sourceDropIndex=i;break;}}var _1469=null;if(this._sourceDropIndex!==_1467.items.length){_1469=_1467.items[this._sourceDropIndex].item.node;}if(dojo.isIE>7){this._eventsIE7=[dojo.connect(this._cover,"onmouseover",dojo,"stopEvent"),dojo.connect(this._cover,"onmouseout",dojo,"stopEvent"),dojo.connect(this._cover,"onmouseenter",dojo,"stopEvent"),dojo.connect(this._cover,"onmouseleave",dojo,"stopEvent")];}var s=node.style;s.left=_1465.x+"px";s.top=_1465.y+"px";if(s.position=="relative"||s.position==""){s.position="absolute";}this._cover.appendChild(node);this._dropIndicator.place(_1467.node,_1469,size);dojo.addClass(node,"dragNode");this._accept=true;dojo.publish("/dojox/mdnd/drag/start",[node,_1467,this._sourceDropIndex]);},onDragEnter:function(_146a,size){if(this._currentIndexArea===this._sourceIndexArea){this._accept=true;}else{this._isAccepted(this._dragItem.type,this._areaList[this._currentIndexArea].accept);}},onDragExit:function(_146b,size){this._accept=false;},onDrag:function(node,_146c,size,_146d){var _146e=this._dropMode.getDragPoint(_146c,size,_146d);this.findCurrentIndexArea(_146e,size);if(this._currentIndexArea!==-1&&this._accept){this.placeDropIndicator(_146e,size);}},placeDropIndicator:function(_146f,size){this._oldDropIndex=this._currentDropIndex;var area=this._areaList[this._currentIndexArea];if(!area.initItems){this._dropMode.initItems(area);}this._currentDropIndex=this._dropMode.getDropIndex(area,_146f);if(!(this._currentIndexArea===this._oldIndexArea&&this._oldDropIndex===this._currentDropIndex)){this._placeDropIndicator(size);}return this._currentDropIndex;},_placeDropIndicator:function(size){var _1470=this._areaList[this._lastValidIndexArea];var _1471=this._areaList[this._currentIndexArea];this._dropMode.refreshItems(_1470,this._oldDropIndex,size,false);var node=null;if(this._currentDropIndex!=-1){node=_1471.items[this._currentDropIndex].item.node;}this._dropIndicator.place(_1471.node,node);this._lastValidIndexArea=this._currentIndexArea;this._dropMode.refreshItems(_1471,this._currentDropIndex,size,true);},onDropCancel:function(){if(!this._accept){var index=this._getIndexArea(this._dropIndicator.node.parentNode);if(index!=-1){this._currentIndexArea=index;}else{this._currentIndexArea=0;}}},onDrop:function(node){this.onDropCancel();var _1472=this._areaList[this._currentIndexArea];dojo.removeClass(node,"dragNode");var style=node.style;style.position="relative";style.left="0";style.top="0";style.width="auto";if(_1472.node==this._dropIndicator.node.parentNode){_1472.node.insertBefore(node,this._dropIndicator.node);}else{_1472.node.appendChild(node);this._currentDropIndex=_1472.items.length;}var _1473=this._currentDropIndex;if(_1473==-1){_1473=_1472.items.length;}var _1474=_1472.items;var _1475=_1474.slice(0,_1473);var _1476=_1474.slice(_1473,_1474.length);_1475[_1475.length]=this._dragItem;_1472.items=_1475.concat(_1476);this._setMarginArea(_1472,node);dojo.forEach(this._areaList,function(obj){obj.initItems=false;});dojo.disconnect(this._dragItem.handlers.pop());dojo.disconnect(this._dragItem.handlers.pop());this._resetAfterDrop();if(this._cover){dojo.body().removeChild(this._cover);dojo.body().removeChild(this._cover2);}dojo.publish("/dojox/mdnd/drop",[node,_1472,_1473]);},_resetAfterDrop:function(){this._accept=false;this._dragItem=null;this._currentDropIndex=-1;this._currentIndexArea=-1;this._oldDropIndex=-1;this._sourceIndexArea=-1;this._sourceDropIndex=-1;this._dropIndicator.remove();if(this._dragStartHandler){dojo.disconnect(this._dragStartHandler);}if(dojo.isIE>7){dojo.forEach(this._eventsIE7,dojo.disconnect);}},destroy:function(){while(this._areaList.length>0){if(!this.unregister(this._areaList[0].node)){throw new Error("Error while destroying AreaManager");}}dojo.disconnect(this.resizeHandler);this._dropIndicator.destroy();this._dropMode.destroy();if(dojox.mdnd.autoScroll){dojox.mdnd.autoScroll.destroy();}if(this.refreshListener){dojo.unsubscribe(this.refreshListener);}if(this._cover){dojo._destroyElement(this._cover);dojo._destroyElement(this._cover2);delete this._cover;delete this._cover2;}}});if(dijit&&dijit._Widget){dojo.extend(dijit._Widget,{dndType:"text"});}dojox.mdnd._areaManager=null;dojox.mdnd.areaManager=function(){if(!dojox.mdnd._areaManager){dojox.mdnd._areaManager=new dojox.mdnd.AreaManager();}return dojox.mdnd._areaManager;};}if(!dojo._hasResource["dojox.mdnd.DropIndicator"]){dojo._hasResource["dojox.mdnd.DropIndicator"]=true;dojo.provide("dojox.mdnd.DropIndicator");dojo.declare("dojox.mdnd.DropIndicator",null,{node:null,constructor:function(){var _1477=document.createElement("div");var _1478=document.createElement("div");_1477.appendChild(_1478);dojo.addClass(_1477,"dropIndicator");this.node=_1477;},place:function(area,_1479,size){if(size){this.node.style.height=size.h+"px";}try{if(_1479){area.insertBefore(this.node,_1479);}else{area.appendChild(this.node);}return this.node;}catch(e){return null;}},remove:function(){if(this.node){this.node.style.height="";if(this.node.parentNode){this.node.parentNode.removeChild(this.node);}}},destroy:function(){if(this.node){if(this.node.parentNode){this.node.parentNode.removeChild(this.node);}dojo._destroyElement(this.node);delete this.node;}}});(function(){dojox.mdnd.areaManager()._dropIndicator=new dojox.mdnd.DropIndicator();}());}if(!dojo._hasResource["dojox.mdnd.dropMode.OverDropMode"]){dojo._hasResource["dojox.mdnd.dropMode.OverDropMode"]=true;dojo.provide("dojox.mdnd.dropMode.OverDropMode");dojo.declare("dojox.mdnd.dropMode.OverDropMode",null,{_oldXPoint:null,_oldYPoint:null,_oldBehaviour:"up",constructor:function(){this._dragHandler=[dojo.connect(dojox.mdnd.areaManager(),"onDragEnter",function(_147a,size){var m=dojox.mdnd.areaManager();if(m._oldIndexArea==-1){m._oldIndexArea=m._lastValidIndexArea;}})];},addArea:function(areas,_147b){var _147c=areas.length,_147d=dojo.position(_147b.node,true);_147b.coords={"x":_147d.x,"y":_147d.y};if(_147c==0){areas.push(_147b);}else{var x=_147b.coords.x;for(var i=0;i<_147c;i++){if(x<areas[i].coords.x){for(var j=_147c-1;j>=i;j--){areas[j+1]=areas[j];}areas[i]=_147b;break;}}if(i==_147c){areas.push(_147b);}}return areas;},updateAreas:function(_147e){var _147f=_147e.length;for(var i=0;i<_147f;i++){this._updateArea(_147e[i]);}},_updateArea:function(area){var _1480=dojo.position(area.node,true);area.coords.x=_1480.x;area.coords.x2=_1480.x+_1480.w;area.coords.y=_1480.y;},initItems:function(area){dojo.forEach(area.items,function(obj){var node=obj.item.node;var _1481=dojo.position(node,true);var y=_1481.y+_1481.h/2;obj.y=y;});area.initItems=true;},refreshItems:function(area,_1482,size,added){if(_1482==-1){return;}else{if(area&&size&&size.h){var _1483=size.h;if(area.margin){_1483+=area.margin.t;}var _1484=area.items.length;for(var i=_1482;i<_1484;i++){var item=area.items[i];if(added){item.y+=_1483;}else{item.y-=_1483;}}}}},getDragPoint:function(_1485,size,_1486){return {"x":_1486.x,"y":_1486.y};},getTargetArea:function(_1487,_1488,_1489){var index=0;var x=_1488.x;var y=_1488.y;var end=_1487.length;var start=0,_148a="right",_148b=false;if(_1489==-1||arguments.length<3){_148b=true;}else{if(this._checkInterval(_1487,_1489,x,y)){index=_1489;}else{if(this._oldXPoint<x){start=_1489+1;}else{start=_1489-1;end=0;_148a="left";}_148b=true;}}if(_148b){if(_148a==="right"){for(var i=start;i<end;i++){if(this._checkInterval(_1487,i,x,y)){index=i;break;}}if(i==end){index=-1;}}else{for(var i=start;i>=end;i--){if(this._checkInterval(_1487,i,x,y)){index=i;break;}}if(i==end-1){index=-1;}}}this._oldXPoint=x;return index;},_checkInterval:function(_148c,index,x,y){var area=_148c[index];var node=area.node;var _148d=area.coords;var _148e=_148d.x;var endX=_148d.x2;var _148f=_148d.y;var endY=_148f+node.offsetHeight;if(_148e<=x&&x<=endX&&_148f<=y&&y<=endY){return true;}return false;},getDropIndex:function(_1490,_1491){var _1492=_1490.items.length;var _1493=_1490.coords;var y=_1491.y;if(_1492>0){for(var i=0;i<_1492;i++){if(y<_1490.items[i].y){return i;}else{if(i==_1492-1){return -1;}}}}return -1;},destroy:function(){dojo.forEach(this._dragHandler,dojo.disconnect);}});(function(){dojox.mdnd.areaManager()._dropMode=new dojox.mdnd.dropMode.OverDropMode();}());}if(!dojo._hasResource["dojox.mdnd.AutoScroll"]){dojo._hasResource["dojox.mdnd.AutoScroll"]=true;dojo.provide("dojox.mdnd.AutoScroll");dojo.declare("dojox.mdnd.AutoScroll",null,{interval:3,recursiveTimer:10,marginMouse:50,constructor:function(){this.resizeHandler=dojo.connect(dojo.global,"onresize",this,function(){this.getViewport();});dojo.ready(dojo.hitch(this,"init"));},init:function(){this._html=(dojo.isWebKit)?dojo.body():dojo.body().parentNode;this.getViewport();},getViewport:function(){var d=dojo.doc,dd=d.documentElement,w=window,b=dojo.body();if(dojo.isMozilla){this._v={"w":dd.clientWidth,"h":w.innerHeight};}else{if(!dojo.isOpera&&w.innerWidth){this._v={"w":w.innerWidth,"h":w.innerHeight};}else{if(!dojo.isOpera&&dd&&dd.clientWidth){this._v={"w":dd.clientWidth,"h":dd.clientHeight};}else{if(b.clientWidth){this._v={"w":b.clientWidth,"h":b.clientHeight};}}}}},setAutoScrollNode:function(node){this._node=node;},setAutoScrollMaxPage:function(){this._yMax=this._html.scrollHeight;this._xMax=this._html.scrollWidth;},checkAutoScroll:function(e){if(this._autoScrollActive){this.stopAutoScroll();}this._y=e.pageY;this._x=e.pageX;if(e.clientX<this.marginMouse){this._autoScrollActive=true;this._autoScrollLeft(e);}else{if(e.clientX>this._v.w-this.marginMouse){this._autoScrollActive=true;this._autoScrollRight(e);}}if(e.clientY<this.marginMouse){this._autoScrollActive=true;this._autoScrollUp(e);}else{if(e.clientY>this._v.h-this.marginMouse){this._autoScrollActive=true;this._autoScrollDown();}}},_autoScrollDown:function(){if(this._timer){clearTimeout(this._timer);}if(this._autoScrollActive&&this._y+this.marginMouse<this._yMax){this._html.scrollTop+=this.interval;this._node.style.top=(parseInt(this._node.style.top)+this.interval)+"px";this._y+=this.interval;this._timer=setTimeout(dojo.hitch(this,"_autoScrollDown"),this.recursiveTimer);}},_autoScrollUp:function(){if(this._timer){clearTimeout(this._timer);}if(this._autoScrollActive&&this._y-this.marginMouse>0){this._html.scrollTop-=this.interval;this._node.style.top=(parseInt(this._node.style.top)-this.interval)+"px";this._y-=this.interval;this._timer=setTimeout(dojo.hitch(this,"_autoScrollUp"),this.recursiveTimer);}},_autoScrollRight:function(){if(this._timer){clearTimeout(this._timer);}if(this._autoScrollActive&&this._x+this.marginMouse<this._xMax){this._html.scrollLeft+=this.interval;this._node.style.left=(parseInt(this._node.style.left)+this.interval)+"px";this._x+=this.interval;this._timer=setTimeout(dojo.hitch(this,"_autoScrollRight"),this.recursiveTimer);}},_autoScrollLeft:function(e){if(this._timer){clearTimeout(this._timer);}if(this._autoScrollActive&&this._x-this.marginMouse>0){this._html.scrollLeft-=this.interval;this._node.style.left=(parseInt(this._node.style.left)-this.interval)+"px";this._x-=this.interval;this._timer=setTimeout(dojo.hitch(this,"_autoScrollLeft"),this.recursiveTimer);}},stopAutoScroll:function(){if(this._timer){clearTimeout(this._timer);}this._autoScrollActive=false;},destroy:function(){dojo.disconnect(this.resizeHandler);}});dojox.mdnd.autoScroll=null;(function(){dojox.mdnd.autoScroll=new dojox.mdnd.AutoScroll();}());}if(!dojo._hasResource["dojox.layout.GridContainerLite"]){dojo._hasResource["dojox.layout.GridContainerLite"]=true;dojo.provide("dojox.layout.GridContainerLite");dojo.declare("dojox.layout.GridContainerLite",[dijit.layout._LayoutWidget,dijit._Templated],{autoRefresh:true,templateString:dojo.cache("dojox.layout","resources/GridContainer.html","<div id=\"${id}\" class=\"gridContainer\" dojoAttachPoint=\"containerNode\" tabIndex=\"0\" dojoAttachEvent=\"onkeypress:_selectFocus\">\n\t<div dojoAttachPoint=\"gridContainerDiv\">\n\t\t<table class=\"gridContainerTable\" dojoAttachPoint=\"gridContainerTable\" cellspacing=\"0\" cellpadding=\"0\">\n\t\t\t<tbody>\n\t\t\t\t<tr dojoAttachPoint=\"gridNode\" >\n\t\t\t\t\t\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t</table>\n\t</div>\n</div>\n"),dragHandleClass:"dojoxDragHandle",nbZones:1,doLayout:true,isAutoOrganized:true,acceptTypes:[],colWidths:"",constructor:function(props,node){this.acceptTypes=(props||{}).acceptTypes||["text"];this._disabled=true;},postCreate:function(){this.inherited(arguments);this._grid=[];this._createCells();this.subscribe("/dojox/mdnd/drop","resizeChildAfterDrop");this.subscribe("/dojox/mdnd/drag/start","resizeChildAfterDragStart");this._dragManager=dojox.mdnd.areaManager();this._dragManager.autoRefresh=this.autoRefresh;this._dragManager.dragHandleClass=this.dragHandleClass;if(this.doLayout){this._border={"h":(dojo.isIE)?dojo._getBorderExtents(this.gridContainerTable).h:0,"w":(dojo.isIE==6)?1:0};}else{dojo.style(this.domNode,"overflowY","hidden");dojo.style(this.gridContainerTable,"height","auto");}this.inherited(arguments);},startup:function(){if(this._started){return;}if(this.isAutoOrganized){this._organizeChildren();}else{this._organizeChildrenManually();}dojo.forEach(this.getChildren(),function(child){child.startup();});if(this._isShown()){this.enableDnd();}this.inherited(arguments);},resizeChildAfterDrop:function(node,_1494,_1495){if(this._disabled){return false;}if(dijit.getEnclosingWidget(_1494.node)==this){var _1496=dijit.byNode(node);if(_1496.resize&&dojo.isFunction(_1496.resize)){_1496.resize();}_1496.set("column",node.parentNode.cellIndex);if(this.doLayout){var _1497=this._contentBox.h,_1498=dojo.contentBox(this.gridContainerDiv).h;if(_1498>=_1497){dojo.style(this.gridContainerTable,"height",(_1497-this._border.h)+"px");}}return true;}return false;},resizeChildAfterDragStart:function(node,_1499,_149a){if(this._disabled){return false;}if(dijit.getEnclosingWidget(_1499.node)==this){this._draggedNode=node;if(this.doLayout){dojo.marginBox(this.gridContainerTable,{"h":dojo.contentBox(this.gridContainerDiv).h-this._border.h});}return true;}return false;},getChildren:function(){var _149b=[];dojo.forEach(this._grid,function(_149c){_149b=_149b.concat(dojo.query("> [widgetId]",_149c.node).map(dijit.byNode));});return _149b;},_isShown:function(){if("open" in this){return this.open;}else{var node=this.domNode;return (node.style.display!="none")&&(node.style.visibility!="hidden")&&!dojo.hasClass(node,"dijitHidden");}},layout:function(){if(this.doLayout){var _149d=this._contentBox;dojo.marginBox(this.gridContainerTable,{"h":_149d.h-this._border.h});dojo.contentBox(this.domNode,{"w":_149d.w-this._border.w});}dojo.forEach(this.getChildren(),function(_149e){if(_149e.resize&&dojo.isFunction(_149e.resize)){_149e.resize();}});},onShow:function(){if(this._disabled){this.enableDnd();}},onHide:function(){if(!this._disabled){this.disableDnd();}},_createCells:function(){if(this.nbZones===0){this.nbZones=1;}var _149f=this.acceptTypes.join(","),i=0;var _14a0=this.colWidths||[];var _14a1=[];var _14a2;var _14a3=0;for(i=0;i<this.nbZones;i++){if(_14a1.length<_14a0.length){_14a3+=_14a0[i];_14a1.push(_14a0[i]);}else{if(!_14a2){_14a2=(100-_14a3)/(this.nbZones-i);}_14a1.push(_14a2);}}i=0;while(i<this.nbZones){this._grid.push({"node":dojo.create("td",{"class":"gridContainerZone","accept":_149f,"id":this.id+"_dz"+i,"style":{"width":_14a1[i]+"%"}},this.gridNode)});i++;}},_getZonesAttr:function(){return dojo.query(".gridContainerZone",this.containerNode);},enableDnd:function(){var m=this._dragManager;dojo.forEach(this._grid,function(_14a4){m.registerByNode(_14a4.node);});m._dropMode.updateAreas(m._areaList);this._disabled=false;},disableDnd:function(){var m=this._dragManager;dojo.forEach(this._grid,function(_14a5){m.unregister(_14a5.node);});m._dropMode.updateAreas(m._areaList);this._disabled=true;},_organizeChildren:function(){var _14a6=dojox.layout.GridContainerLite.superclass.getChildren.call(this);var _14a7=this.nbZones,_14a8=Math.floor(_14a6.length/_14a7),mod=_14a6.length%_14a7,i=0;for(var z=0;z<_14a7;z++){for(var r=0;r<_14a8;r++){this._insertChild(_14a6[i],z);i++;}if(mod>0){try{this._insertChild(_14a6[i],z);i++;}catch(e){console.error("Unable to insert child in GridContainer",e);}mod--;}else{if(_14a8===0){break;}}}},_organizeChildrenManually:function(){var _14a9=dojox.layout.GridContainerLite.superclass.getChildren.call(this),_14aa=_14a9.length,child;for(var i=0;i<_14aa;i++){child=_14a9[i];try{this._insertChild(child,child.column-1);}catch(e){console.error("Unable to insert child in GridContainer",e);}}},_insertChild:function(child,_14ab,p){var zone=this._grid[_14ab].node,_14ac=zone.childNodes.length;if(typeof (p)==undefined||p>_14ac){p=_14ac;}if(this._disabled){dojo.place(child.domNode,zone,p);dojo.attr(child.domNode,"tabIndex","0");}else{if(!child.dragRestriction){this._dragManager.addDragItem(zone,child.domNode,p,true);}else{dojo.place(child.domNode,zone,p);dojo.attr(child.domNode,"tabIndex","0");}}child.set("column",_14ab);return child;},removeChild:function(_14ad){if(this._disabled){this.inherited(arguments);}else{this._dragManager.removeDragItem(_14ad.domNode.parentNode,_14ad.domNode);}},addService:function(child,_14ae,p){dojo.deprecated("addService is deprecated.","Please use  instead.","Future");this.addChild(child,_14ae,p);},addChild:function(child,_14af,p){child.domNode.id=child.id;dojox.layout.GridContainerLite.superclass.addChild.call(this,child,0);if(_14af<0||_14af==undefined){_14af=0;}if(p<=0){p=0;}try{return this._insertChild(child,_14af,p);}catch(e){console.error("Unable to insert child in GridContainer",e);}return null;},_setColWidthsAttr:function(value){this.colWidths=dojo.isString(value)?value.split(","):(dojo.isArray(value)?value:[value]);if(this._started){this._updateColumnsWidth();}},_updateColumnsWidth:function(_14b0){var _14b1=this._grid.length;var _14b2=this.colWidths||[];var _14b3=[];var _14b4;var _14b5=0;var i;for(i=0;i<_14b1;i++){if(_14b3.length<_14b2.length){_14b5+=_14b2[i]*1;_14b3.push(_14b2[i]);}else{if(!_14b4){_14b4=(100-_14b5)/(this.nbZones-i);if(_14b4<0){_14b4=100/this.nbZones;}}_14b3.push(_14b4);_14b5+=_14b4*1;}}if(_14b5>100){var _14b6=100/_14b5;for(i=0;i<_14b3.length;i++){_14b3[i]*=_14b6;}}for(i=0;i<_14b1;i++){this._grid[i].node.style.width=_14b3[i]+"%";}},_selectFocus:function(event){if(this._disabled){return;}var key=event.keyCode,k=dojo.keys,zone=null,focus=dijit.getFocus(),_14b7=focus.node,m=this._dragManager,found,i,j,r,_14b8,area,_14b9;if(_14b7==this.containerNode){area=this.gridNode.childNodes;switch(key){case k.DOWN_ARROW:case k.RIGHT_ARROW:found=false;for(i=0;i<area.length;i++){_14b8=area[i].childNodes;for(j=0;j<_14b8.length;j++){zone=_14b8[j];if(zone!=null&&zone.style.display!="none"){dijit.focus(zone);dojo.stopEvent(event);found=true;break;}}if(found){break;}}break;case k.UP_ARROW:case k.LEFT_ARROW:area=this.gridNode.childNodes;found=false;for(i=area.length-1;i>=0;i--){_14b8=area[i].childNodes;for(j=_14b8.length;j>=0;j--){zone=_14b8[j];if(zone!=null&&zone.style.display!="none"){dijit.focus(zone);dojo.stopEvent(event);found=true;break;}}if(found){break;}}break;}}else{if(_14b7.parentNode.parentNode==this.gridNode){var child=(key==k.UP_ARROW||key==k.LEFT_ARROW)?"lastChild":"firstChild";var pos=(key==k.UP_ARROW||key==k.LEFT_ARROW)?"previousSibling":"nextSibling";switch(key){case k.UP_ARROW:case k.DOWN_ARROW:dojo.stopEvent(event);found=false;var _14ba=_14b7;while(!found){_14b8=_14ba.parentNode.childNodes;var num=0;for(i=0;i<_14b8.length;i++){if(_14b8[i].style.display!="none"){num++;}if(num>1){break;}}if(num==1){return;}if(_14ba[pos]==null){zone=_14ba.parentNode[child];}else{zone=_14ba[pos];}if(zone.style.display==="none"){_14ba=zone;}else{found=true;}}if(event.shiftKey){var _14bb=_14b7.parentNode;for(i=0;i<this.gridNode.childNodes.length;i++){if(_14bb==this.gridNode.childNodes[i]){break;}}_14b8=this.gridNode.childNodes[i].childNodes;for(j=0;j<_14b8.length;j++){if(zone==_14b8[j]){break;}}if(dojo.isMoz||dojo.isWebKit){i--;}_14b9=dijit.byNode(_14b7);if(!_14b9.dragRestriction){r=m.removeDragItem(_14bb,_14b7);this.addChild(_14b9,i,j);dojo.attr(_14b7,"tabIndex","0");dijit.focus(_14b7);}else{dojo.publish("/dojox/layout/gridContainer/moveRestriction",[this]);}}else{dijit.focus(zone);}break;case k.RIGHT_ARROW:case k.LEFT_ARROW:dojo.stopEvent(event);if(event.shiftKey){var z=0;if(_14b7.parentNode[pos]==null){if(dojo.isIE&&key==k.LEFT_ARROW){z=this.gridNode.childNodes.length-1;}}else{if(_14b7.parentNode[pos].nodeType==3){z=this.gridNode.childNodes.length-2;}else{for(i=0;i<this.gridNode.childNodes.length;i++){if(_14b7.parentNode[pos]==this.gridNode.childNodes[i]){break;}z++;}if(dojo.isMoz||dojo.isWebKit){z--;}}}_14b9=dijit.byNode(_14b7);var _14bc=_14b7.getAttribute("dndtype");if(_14bc==null){if(_14b9&&_14b9.dndType){_14bc=_14b9.dndType.split(/\s*,\s*/);}else{_14bc=["text"];}}else{_14bc=_14bc.split(/\s*,\s*/);}var _14bd=false;for(i=0;i<this.acceptTypes.length;i++){for(j=0;j<_14bc.length;j++){if(_14bc[j]==this.acceptTypes[i]){_14bd=true;break;}}}if(_14bd&&!_14b9.dragRestriction){var _14be=_14b7.parentNode,place=0;if(k.LEFT_ARROW==key){var t=z;if(dojo.isMoz||dojo.isWebKit){t=z+1;}place=this.gridNode.childNodes[t].childNodes.length;}r=m.removeDragItem(_14be,_14b7);this.addChild(_14b9,z,place);dojo.attr(r,"tabIndex","0");dijit.focus(r);}else{dojo.publish("/dojox/layout/gridContainer/moveRestriction",[this]);}}else{var node=_14b7.parentNode;while(zone===null){if(node[pos]!==null&&node[pos].nodeType!==3){node=node[pos];}else{if(pos==="previousSibling"){node=node.parentNode.childNodes[node.parentNode.childNodes.length-1];}else{node=(dojo.isIE)?node.parentNode.childNodes[0]:node.parentNode.childNodes[1];}}zone=node[child];if(zone&&zone.style.display=="none"){_14b8=zone.parentNode.childNodes;var _14bf=null;if(pos=="previousSibling"){for(i=_14b8.length-1;i>=0;i--){if(_14b8[i].style.display!="none"){_14bf=_14b8[i];break;}}}else{for(i=0;i<_14b8.length;i++){if(_14b8[i].style.display!="none"){_14bf=_14b8[i];break;}}}if(!_14bf){_14b7=zone;node=_14b7.parentNode;zone=null;}else{zone=_14bf;}}}dijit.focus(zone);}break;}}}},destroy:function(){var m=this._dragManager;dojo.forEach(this._grid,function(_14c0){m.unregister(_14c0.node);});this.inherited(arguments);}});dojo.extend(dijit._Widget,{column:"1",dragRestriction:false});}if(!dojo._hasResource["dojox.layout.GridContainer"]){dojo._hasResource["dojox.layout.GridContainer"]=true;dojo.provide("dojox.layout.GridContainer");dojo.declare("dojox.layout.GridContainer",dojox.layout.GridContainerLite,{hasResizableColumns:true,liveResizeColumns:false,minColWidth:20,minChildWidth:150,mode:"right",isRightFixed:false,isLeftFixed:false,startup:function(){this.inherited(arguments);if(this.hasResizableColumns){for(var i=0;i<this._grid.length-1;i++){this._createGrip(i);}if(!this.getParent()){dojo.ready(dojo.hitch(this,"_placeGrips"));}}},resizeChildAfterDrop:function(node,_14c1,_14c2){if(this.inherited(arguments)){this._placeGrips();}},onShow:function(){this.inherited(arguments);this._placeGrips();},resize:function(){this.inherited(arguments);if(this._isShown()&&this.hasResizableColumns){this._placeGrips();}},_createGrip:function(index){var _14c3=this._grid[index],grip=dojo.create("div",{"class":"gridContainerGrip"},this.domNode);_14c3.grip=grip;_14c3.gripHandler=[this.connect(grip,"onmouseover",function(e){var _14c4=false;for(var i=0;i<this._grid.length-1;i++){if(dojo.hasClass(this._grid[i].grip,"gridContainerGripShow")){_14c4=true;break;}}if(!_14c4){dojo.removeClass(e.target,"gridContainerGrip");dojo.addClass(e.target,"gridContainerGripShow");}})[0],this.connect(grip,"onmouseout",function(e){if(!this._isResized){dojo.removeClass(e.target,"gridContainerGripShow");dojo.addClass(e.target,"gridContainerGrip");}})[0],this.connect(grip,"onmousedown","_resizeColumnOn")[0],this.connect(grip,"ondblclick","_onGripDbClick")[0]];},_placeGrips:function(){var _14c5,_14c6,left=0,grip;var _14c7=this.domNode.style.overflowY;dojo.forEach(this._grid,function(_14c8){if(_14c8.grip){grip=_14c8.grip;if(!_14c5){_14c5=grip.offsetWidth/2;}left+=dojo.marginBox(_14c8.node).w;dojo.style(grip,"left",(left-_14c5)+"px");if(!_14c6){_14c6=dojo.contentBox(this.gridNode).h;}if(_14c6>0){dojo.style(grip,"height",_14c6+"px");}}},this);},_onGripDbClick:function(){this._updateColumnsWidth(this._dragManager);this.resize();},_resizeColumnOn:function(e){this._activeGrip=e.target;this._initX=e.pageX;e.preventDefault();dojo.body().style.cursor="ew-resize";this._isResized=true;var _14c9=[];var grid;var i;for(i=0;i<this._grid.length;i++){_14c9[i]=dojo.contentBox(this._grid[i].node).w;}this._oldTabSize=_14c9;for(i=0;i<this._grid.length;i++){grid=this._grid[i];if(this._activeGrip==grid.grip){this._currentColumn=grid.node;this._currentColumnWidth=_14c9[i];this._nextColumn=this._grid[i+1].node;this._nextColumnWidth=_14c9[i+1];}grid.node.style.width=_14c9[i]+"px";}var _14ca=function(_14cb,_14cc){var width=0;var _14cd=0;dojo.forEach(_14cb,function(child){if(child.nodeType==1){var _14ce=dojo.getComputedStyle(child);var _14cf=(dojo.isIE)?_14cc:parseInt(_14ce.minWidth);_14cd=_14cf+parseInt(_14ce.marginLeft)+parseInt(_14ce.marginRight);if(width<_14cd){width=_14cd;}}});return width;};var _14d0=_14ca(this._currentColumn.childNodes,this.minChildWidth);var _14d1=_14ca(this._nextColumn.childNodes,this.minChildWidth);var _14d2=Math.round((dojo.marginBox(this.gridContainerTable).w*this.minColWidth)/100);this._currentMinCol=_14d0;this._nextMinCol=_14d1;if(_14d2>this._currentMinCol){this._currentMinCol=_14d2;}if(_14d2>this._nextMinCol){this._nextMinCol=_14d2;}this._connectResizeColumnMove=dojo.connect(dojo.doc,"onmousemove",this,"_resizeColumnMove");this._connectOnGripMouseUp=dojo.connect(dojo.doc,"onmouseup",this,"_onGripMouseUp");},_onGripMouseUp:function(){dojo.body().style.cursor="default";dojo.disconnect(this._connectResizeColumnMove);dojo.disconnect(this._connectOnGripMouseUp);this._connectOnGripMouseUp=this._connectResizeColumnMove=null;if(this._activeGrip){dojo.removeClass(this._activeGrip,"gridContainerGripShow");dojo.addClass(this._activeGrip,"gridContainerGrip");}this._isResized=false;},_resizeColumnMove:function(e){e.preventDefault();if(!this._connectResizeColumnOff){dojo.disconnect(this._connectOnGripMouseUp);this._connectOnGripMouseUp=null;this._connectResizeColumnOff=dojo.connect(dojo.doc,"onmouseup",this,"_resizeColumnOff");}var d=e.pageX-this._initX;if(d==0){return;}if(!(this._currentColumnWidth+d<this._currentMinCol||this._nextColumnWidth-d<this._nextMinCol)){this._currentColumnWidth+=d;this._nextColumnWidth-=d;this._initX=e.pageX;this._activeGrip.style.left=parseInt(this._activeGrip.style.left)+d+"px";if(this.liveResizeColumns){this._currentColumn.style["width"]=this._currentColumnWidth+"px";this._nextColumn.style["width"]=this._nextColumnWidth+"px";this.resize();}}},_resizeColumnOff:function(e){dojo.body().style.cursor="default";dojo.disconnect(this._connectResizeColumnMove);dojo.disconnect(this._connectResizeColumnOff);this._connectResizeColumnOff=this._connectResizeColumnMove=null;if(!this.liveResizeColumns){this._currentColumn.style["width"]=this._currentColumnWidth+"px";this._nextColumn.style["width"]=this._nextColumnWidth+"px";}var _14d3=[],_14d4=[],_14d5=this.gridContainerTable.clientWidth,node,_14d6=false,i;for(i=0;i<this._grid.length;i++){node=this._grid[i].node;if(dojo.isIE){_14d3[i]=dojo.marginBox(node).w;_14d4[i]=dojo.contentBox(node).w;}else{_14d3[i]=dojo.contentBox(node).w;_14d4=_14d3;}}for(i=0;i<_14d4.length;i++){if(_14d4[i]!=this._oldTabSize[i]){_14d6=true;break;}}if(_14d6){var mul=dojo.isIE?100:10000;for(i=0;i<this._grid.length;i++){this._grid[i].node.style.width=Math.round((100*mul*_14d3[i])/_14d5)/mul+"%";}this.resize();}if(this._activeGrip){dojo.removeClass(this._activeGrip,"gridContainerGripShow");dojo.addClass(this._activeGrip,"gridContainerGrip");}this._isResized=false;},setColumns:function(_14d7){var z,j;if(_14d7>0){var _14d8=this._grid.length,delta=_14d8-_14d7;if(delta>0){var count=[],zone,start,end,_14d9;if(this.mode=="right"){end=(this.isLeftFixed&&_14d8>0)?1:0;start=(this.isRightFixed)?_14d8-2:_14d8-1;for(z=start;z>=end;z--){_14d9=0;zone=this._grid[z].node;for(j=0;j<zone.childNodes.length;j++){if(zone.childNodes[j].nodeType==1&&!(zone.childNodes[j].id=="")){_14d9++;break;}}if(_14d9==0){count[count.length]=z;}if(count.length>=delta){this._deleteColumn(count);break;}}if(count.length<delta){dojo.publish("/dojox/layout/gridContainer/noEmptyColumn",[this]);}}else{start=(this.isLeftFixed&&_14d8>0)?1:0;end=(this.isRightFixed)?_14d8-1:_14d8;for(z=start;z<end;z++){_14d9=0;zone=this._grid[z].node;for(j=0;j<zone.childNodes.length;j++){if(zone.childNodes[j].nodeType==1&&!(zone.childNodes[j].id=="")){_14d9++;break;}}if(_14d9==0){count[count.length]=z;}if(count.length>=delta){this._deleteColumn(count);break;}}if(count.length<delta){dojo.publish("/dojox/layout/gridContainer/noEmptyColumn",[this]);}}}else{if(delta<0){this._addColumn(Math.abs(delta));}}if(this.hasResizableColumns){this._placeGrips();}}},_addColumn:function(_14da){var grid=this._grid,_14db,node,index,_14dc,_14dd=(this.mode=="right"),_14de=this.acceptTypes.join(","),m=this._dragManager;if(this.hasResizableColumns&&((!this.isRightFixed&&_14dd)||(this.isLeftFixed&&!_14dd&&this.nbZones==1))){this._createGrip(grid.length-1);}for(var i=0;i<_14da;i++){node=dojo.create("td",{"class":"gridContainerZone dojoxDndArea","accept":_14de,"id":this.id+"_dz"+this.nbZones});_14dc=grid.length;if(_14dd){if(this.isRightFixed){index=_14dc-1;grid.splice(index,0,{"node":grid[index].node.parentNode.insertBefore(node,grid[index].node)});}else{index=_14dc;grid.push({"node":this.gridNode.appendChild(node)});}}else{if(this.isLeftFixed){index=(_14dc==1)?0:1;this._grid.splice(1,0,{"node":this._grid[index].node.parentNode.appendChild(node,this._grid[index].node)});index=1;}else{index=_14dc-this.nbZones;this._grid.splice(index,0,{"node":grid[index].node.parentNode.insertBefore(node,grid[index].node)});}}if(this.hasResizableColumns){if((!_14dd&&this.nbZones!=1)||(!_14dd&&this.nbZones==1&&!this.isLeftFixed)||(_14dd&&i<_14da-1)||(_14dd&&i==_14da-1&&this.isRightFixed)){this._createGrip(index);}}m.registerByNode(grid[index].node);this.nbZones++;}this._updateColumnsWidth(m);},_deleteColumn:function(_14df){var child,grid,index,_14e0=0,_14e1=_14df.length,m=this._dragManager;for(var i=0;i<_14e1;i++){index=(this.mode=="right")?_14df[i]:_14df[i]-_14e0;grid=this._grid[index];if(this.hasResizableColumns&&grid.grip){dojo.forEach(grid.gripHandler,function(_14e2){dojo.disconnect(_14e2);});dojo.destroy(this.domNode.removeChild(grid.grip));grid.grip=null;}m.unregister(grid.node);dojo.destroy(this.gridNode.removeChild(grid.node));this._grid.splice(index,1);this.nbZones--;_14e0++;}var _14e3=this._grid[this.nbZones-1];if(_14e3.grip){dojo.forEach(_14e3.gripHandler,dojo.disconnect);dojo.destroy(this.domNode.removeChild(_14e3.grip));_14e3.grip=null;}this._updateColumnsWidth(m);},_updateColumnsWidth:function(_14e4){this.inherited(arguments);_14e4._dropMode.updateAreas(_14e4._areaList);},destroy:function(){dojo.unsubscribe(this._dropHandler);this.inherited(arguments);}});}if(!dojo._hasResource["plugins.dijit.TitlePane"]){dojo._hasResource["plugins.dijit.TitlePane"]=true;dojo.provide("plugins.dijit.TitlePane");dojo.declare("plugins.dijit.TitlePane",[dijit.TitlePane],{templateString:dojo.cache("plugins","dijit/templates/TitlePane.html","<div>\n\t<div dojoAttachEvent=\"onclick:_onTitleClick, onkeypress:_onTitleKey\"\n\t\t\tclass=\"dijitTitlePaneTitle\" dojoAttachPoint=\"titleBarNode\">\n\t\t<div class=\"dijitTitlePaneTitleFocus\" dojoAttachPoint=\"focusNode\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" dojoAttachPoint=\"arrowNode\" class=\"dijitArrowNode\" role=\"presentation\"\n\t\t\t/><span dojoAttachPoint=\"arrowNodeInner\" class=\"dijitArrowNodeInner\"></span\n\t\t\t><span dojoAttachPoint=\"titleNode\" class=\"dijitTitlePaneTextNode\"></span\n\t\t\t><span dojoAttachPoint=\"numberNode\" class=\"dijitTitlePaneNumberNode\"></span>\n\t\t</div>\n\t</div>\n\t<div class=\"dijitTitlePaneContentOuter\" dojoAttachPoint=\"hideNode\" role=\"presentation\">\n\t\t<div class=\"dijitReset\" dojoAttachPoint=\"wipeNode\" role=\"presentation\">\n\t\t\t<div class=\"dijitTitlePaneContentInner\" dojoAttachPoint=\"containerNode\" role=\"region\" id=\"${id}_pane\">\n\t\t\t\t<!-- nested divs because wipeIn()/wipeOut() doesn't work right on node w/padding etc.  Put padding on inner div. -->\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n"),number:null,attributeMap:dojo.delegate(dijit.layout.ContentPane.prototype.attributeMap,{title:{node:"titleNode",type:"innerHTML"},number:{node:"numberNode",type:"innerHTML"},tooltip:{node:"focusNode",type:"attribute",attribute:"title"},id:""}),setNumber:function(_14e5){dojo.deprecated("dijit.TitlePane.setNumber() is deprecated.  Use set('number', ...) instead.","","2.0");this.set("number",_14e5);}});}if(!dojo._hasResource["plugins.workflow.GridStage"]){dojo._hasResource["plugins.workflow.GridStage"]=true;dojo.provide("plugins.workflow.GridStage");dojo.declare("plugins.workflow.GridStage",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table\n        class=\"stagerow\"\n        cellspacing=\"0px\"\n        height=\"16px\" width=\"100%\" style=\"padding: 0; margin: 0; height: 16px !important;\">\n        <tr>\n            <td\n                colspan=\"2\"\n                dojoAttachPoint=\"nameNode\"\n                class=\"name\"\n                >${name}</td>\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"numberNode\"\n                class=\"number\">\n            </td>\n        </tr>\n        <tr>\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"executorNode\"\n                class=\"executor\"\n                style=\"display: none;\" >${executor}\n            </td>\n\n            <td \n                colspan=\"2\"\n                dojoAttachPoint=\"submitNode\"\n                class=\"\"\n                style=\"display: none;\" >\n            </td>\n            \n        </tr>\n        <tr>\n            <td colspan=\"3\"\n                dojoAttachPoint=\"locationNode\"\n                class='location'\n                style=\"display: none;\" >${location}\n            </td>\n        </tr>\n        <tr>\n            <td colspan=\"3\"\n                dojoAttachPoint=\"descriptionNode\"\n                class='description'\n                style=\"display: none;\" >${description}\n            </td>\n        </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins")+"/workflow/css/stagerow.css"],parentWidget:null,application:null,core:null,postCreate:function(){this.startup();},constructor:function(args){this.loadCSS();this.core=args.core;this.parentWidget=args.parentWidget;this.application=new Object;for(var key in args){if(key!="parentWidget"){this.application[key]=args[key];}}},startup:function(){this.inherited(arguments);this.name.parentWidget=this;var _14e6=this;dojo.connect(this.nameNode,"onclick",function(event){event.stopPropagation();_14e6.toggle();});},toggle:function(){var array=["executor","submit","location","description"];for(var i in array){var _14e7=array[i]+"Node";if(this[_14e7].style.display=="table-cell"){this[_14e7].style.display="none";}else{this[_14e7].style.display="table-cell";}}},checkAllParameters:function(force){this.isValid=true;var _14e8=new Array;var _14e9=new Array;if(this.core.parameters!=null&&this.core.parameters.isCurrentApplication(this.application)){_14e8=this.core.parameters.childWidgets;for(var i=0;i<this.core.parameters.childWidgets.length;i++){_14e9.push(this.core.parameters.childWidgets[i].parameterObject);}}else{_14e9=Agua.getStageParameters(this.application);}if(_14e9==null){return false;}this.fileStageParameters=new Array;this.fileParameterRows=new Array;for(var i=0;i<_14e9.length;i++){_14e9[i].value=this.systemVariables(_14e9[i].value,_14e9[i]);var _14ea=Agua.getParameterValidity(_14e9[i]);if(force!=true&&_14ea!=null){if(_14e8[i]!=null){if(_14ea==true){_14e8[i].setValid(_14e8[i].containerNode);}else{_14e8[i].setInvalid(_14e8[i].containerNode);this.isValid=false;}}continue;}else{if(_14e9[i].valuetype=="flag"){continue;}}if(_14e9[i].valuetype=="file"||_14e9[i].valuetype=="directory"){this.checkValidFile(_14e9[i],_14e8[i]);}else{if(_14e9[i].valuetype=="integer"){this.checkValidInteger(_14e9[i],_14e8[i]);}else{this.checkValidText(_14e9[i],_14e8[i]);}}}if(this.fileStageParameters.length==0){if(this.isValid==false||this.isValid==null){this.setInvalid();}else{this.setValid();}return this.isValid;}},checkValidParameters:function(force){this.checkAllParameters(force);if(this.fileStageParameters.length!=0){this.checkFiles();}},currentParametersApplication:function(_14eb){var keys=["project","workflow","workflownumber","name","number"];return this._objectsMatchByKey(_14eb,this.core.parameters.application,keys);},checkFiles:function(files){if(files==null){files=this.fileStageParameters;}var url=Agua.cgiUrl+"workflow.cgi";var query=new Object;query.username=Agua.cookie("username");query.sessionid=Agua.cookie("sessionid");query.project=this.application.project;query.workflow=this.application.workflow;query.mode="checkFiles";query.files=files;var _14ec=this;var _14ed=dojo.xhrPut({url:url,contentType:"text",sync:false,handleAs:"json",putData:dojo.toJson(query),handle:function(_14ee,_14ef){_14ec.validateFiles(files,_14ee);}});if(this.isValid==false||this.isValid==null){this.setInvalid();}else{this.setValid();}return this.isValid;},validateFiles:function(_14f0){if(_14f0==null||_14f0.length==null||!_14f0.length){return;}for(var i=0;i<_14f0.length;i++){var _14f1=this.fileParameterRows[i];Agua.setFileInfo(this.fileStageParameters[i],_14f0[i]);if(_14f0[i].exists=="true"){if(_14f0[i].type!=this.fileStageParameters[i].valuetype){Agua.setParameterValidity(this.fileStageParameters[i],false);this.isValid=false;if(_14f1!=null){_14f1.setInvalid(_14f1.containerNode);}}else{Agua.setParameterValidity(this.fileStageParameters[i],true);if(_14f1!=null){_14f1.setValid(_14f1.containerNode);}}}else{if(this.fileStageParameters[i].discretion=="essential"){this.isValid=false;Agua.setParameterValidity(this.fileStageParameters[i],false);if(_14f1!=null){_14f1.setInvalid(_14f1.containerNode);}}else{Agua.setParameterValidity(this.fileStageParameters[i],true);if(_14f1!=null){_14f1.setValid(_14f1.containerNode);}}}}if(this.isValid==false){this.setInvalid();}else{this.setValid();}},checkValidFile:function(_14f2,_14f3){var _14f4=_14f2.value;if(_14f2.discretion=="required"||_14f2.discretion=="essential"){if(_14f4==null||_14f4==""){this.setInvalidParameter(_14f2,_14f3);}else{if(_14f2.fileinfo==null){this.fileStageParameters.push(_14f2);this.fileParameterRows.push(_14f3);}else{if((_14f2.fileinfo.exists==false)){if(_14f2.chained==null||_14f2.chained==0){this.fileStageParameters.push(_14f2);this.fileParameterRows.push(_14f3);}else{this.setValidParameter(_14f2,_14f3);}}else{if(_14f2.fileinfo.type!=_14f2.valuetype){this.setInvalidParameter(_14f2,_14f3);}else{this.setValidParameter(_14f2,_14f3);}}}}}else{if(_14f2.value==null||_14f2.value==""){this.setValidParameter(_14f2,_14f3);}else{this.fileStageParameters.push(_14f2);this.fileParameterRows.push(_14f3);}}},checkValidInteger:function(_14f5,_14f6){if(_14f5.discretion!="optional"){if(_14f5.value==null||_14f5.value==""){this.setInvalidParameter(_14f5,_14f6);}else{if(!_14f5.value.match(/^\s*[\d\.]+\s*$/)){this.isValid=false;Agua.setParameterValidity(_14f5,false);}else{this.setValidParameter(_14f5,_14f6);}}}else{if(_14f5.value!=null&&_14f5.value!=""&&!_14f5.value.match(/^\s*[\d\.]+\s*$/)){this.setInvalidParameter(_14f5,_14f6);}else{this.setValidParameter(_14f5,_14f6);}}},checkValidText:function(_14f7,_14f8){if(_14f7.discretion!="optional"){if(_14f7.value==null||_14f7.value==""){this.setInvalidParameter(_14f7,_14f8);}else{this.setValidParameter(_14f7,_14f8);}}else{this.setValidParameter(_14f7,_14f8);}},setInvalidParameter:function(_14f9,_14fa){this.isValid=false;Agua.setParameterValidity(_14f9,false);if(_14fa!=null){_14fa.setInvalid(_14fa.containerNode);}},setValidParameter:function(_14fb,_14fc){Agua.setParameterValidity(_14fb,true);if(_14fc!=null){_14fc.setValid(_14fc.containerNode);}},setValid:function(){dojo.removeClass(this.domNode,"unsatisfied");dojo.addClass(this.domNode,"satisfied");this.isValid=true;var _14fd=this.core.userWorkflows;_14fd.updateRunButton();},setInvalid:function(){for(var key in this.core){}dojo.removeClass(this.domNode,"satisfied");dojo.addClass(this.domNode,"unsatisfied");this.isValid=false;var _14fe=this.core.userWorkflows;_14fe.updateRunButton();}});}if(!dojo._hasResource["plugins.workflow.GridWorkflow"]){dojo._hasResource["plugins.workflow.GridWorkflow"]=true;dojo.provide("plugins.workflow.GridWorkflow");if(1){}dojo.declare("plugins.workflow.GridWorkflow",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n    <div\n        dojoAttachPoint=\"titlePane\"\n        dojoType=\"plugins.dijit.TitlePane\"\n        class=\"stageContainer\"\n        title=\"${title}\"\n        number=\"${number}\"\n        style=\"background: #FFF; height: auto; width: 100% !important; min-width: 306px\"\n    >\n        <div\n            dojoAttachPoint=\"dropTargetContainer\"\n        >\n        </div>\n    </div>\n\n</div>\n",widgetsInTemplate:true,cssFiles:[],parentWidget:null,childWidgets:null,attachNode:null,contextMenu:null,core:null,workflowLoaded:null,dropTargetLoaded:null,project:null,workflow:null,number:null,constructor:function(args){this.stages=args.stages;this.core=args.core;this.project=args.project;this.workflow=args.workflow;this.number=args.number;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.setStages(this.stages);},setStages:function(_14ff){this.clearStages();this.childWidgets=new Array;_14ff=this.sortNumericHasharray(_14ff,"number");var _1500=new Array;for(var i=0;i<_14ff.length;i++){var hash=new Object;hash.data=_14ff[i].name;hash.type=["draggableItem"];_1500.push(hash);}console.log("GridWorkflow.setStages     dataArray: ");console.dir({dataArray:_1500});if(this.dropTarget==null){this.dropTarget=new plugins.dnd.Target(this.dropTargetContainer,{accept:[],parentWidget:this});}console.log("GridWorkflow.setStages     this.dropTarget: "+this.dropTarget);this.dropTarget.insertNodes(false,_1500);allNodes=this.dropTarget.getAllNodes();var _1501=this;dojo.forEach(allNodes,function(node,i){_14ff[i].description=_14ff[i].stagedescription||"";_14ff[i].submit=_14ff[i].submit||"";var _1502=new plugins.workflow.GridStage(_14ff[i]);_1502.parentWidget=_1501;node.innerHTML="";node.appendChild(_1502.domNode);_1501.childWidgets.push(_1502);});},setNumber:function(_1503){this.number=_1503;this.titlePane.set("number",_1503);},clearStages:function(){while(this.dropTargetContainer.firstChild){this.dropTargetContainer.removeChild(this.dropTargetContainer.firstChild);}},getStagesStandby:function(){console.log("GridWorkflow.getStagesStandby    Stages.getStagesStandby()");if(this.standby==null){var id=dijit.getUniqueId("dojox_widget_Standby");this.standby=new dojox.widget.Standby({target:this.dropTargetContainer,onClick:"reload",text:"Checking stage inputs",id:id,url:"plugins/core/images/agua-biwave-24.png"});document.body.appendChild(this.standby.domNode);}console.log("GridWorkflow.getStagesStandby    this.standby: "+this.standby);return this.standby;}});}if(!dojo._hasResource["plugins.workflow.Grid"]){dojo._hasResource["plugins.workflow.Grid"]=true;dojo.provide("plugins.workflow.Grid");dojo.declare("plugins.workflow.Grid",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n    <div\n        dojoAttachPoint=\"mainTab\"\n        dojoType=\"dijit.layout.ContentPane\"\n        parseOnLoad=\"false\"\n\t\ttitle=\"Projects\"\n\t\tclass=\"grid\"\n\t\tstyle=\"position: relative; min-height: 100px; height: 100%; max-height: auto !important; width: 320px !important; padding: 0 !important;\"\n    >\n\n        <table width=\"100%\">\n\t\t\t<tr valign=\"top\" width=\"100%\">\n\t\t\t\t<td class=\"tabTitle\" align=\"center\">\n                    Projects\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\n\t\t<table width=\"100%\">\n\t\t\t<tr width=\"100%\" align=\"center\">\n\t\t\t\t<td>\n\t\n\t\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t\t<tr align=\"center\">\n\t\t\t\t\t\t\t<td class=\"projectIcon\">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<div dojoType=\"dijit.form.ComboBox\"\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"projectCombo\"\n\t\t\t\t\t\t\t\t\tclass=\"projectCombo\"\n\t\t\t\t\t\t\t\t\tautocomplete=\"false\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\n\t\t\t<tr width=\"100%\" align=\"center\">\n\t\t\t\t<td>\n\t\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"stop\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:confirmStopProject\"\n\t\t\t\t\t\t\t\tclass=\"stop\">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"pause\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:confirmPauseProject\"\n\t\t\t\t\t\t\t\tclass=\"pause\">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\tdojoAttachPoint=\"play\"\n\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:startProject\"\n\t\t\t\t\t\t\t\tclass=\"play\">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\n\t\t\t<tr width=\"100%\">\n\t\t\t\t<td width=\"100%\">\n\t\t\t\t\t\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div \n\t\t\t\t\t\t\tdojoAttachPoint=\"mainPanel\"\n\t\t\t\t\t\t\tdojoType=\"dojox.layout.GridContainer\" \n\t\t\t\t\t\t\tclass=\"workflowContainer\"\n\t\t\t\t\t\t\tnbZones=\"1\"\n\t\t\t\t\t\t\topacity=\"0.7\" \n\t\t\t\t\t\t\tallowAutoScroll=\"true\" \n\t\t\t\t\t\t\thasResizableColumns=\"false\"\n\t\t\t\t\t\t\twithHandles=\"true\"\n\t\t\t\t\t\t\tacceptTypes=\"TitlePane\"\n\t\t\t\t\t\t>\n\t\t\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\n\t</div>\n\n</div>\n",widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins","workflow/css/grid.css"),dojo.moduleUrl("dojo","resources/dojo.css"),dojo.moduleUrl("dijit","themes/tundra/tundra.css"),dojo.moduleUrl("dojox","layout/resources/GridContainer.css"),],parentWidget:null,childWidgets:null,core:null,constructor:function(args){console.log("Grid.constructor     plugins.workflow.Grid.constructor");this.core=args.core;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){console.log("Grid.startup    plugins.workflow.Grid.startup()");this.inherited(arguments);console.log("Grid.startup    Doing this.attachNode.addChild(this.mainTab)");this.attachNode.addChild(this.mainTab);console.log("Grid.startup    Doing this.attachNode.selectChild(this.mainTab)");this.attachNode.selectChild(this.mainTab);this.childWidgets=new Array;this.setProjectCombo();var _1504=this;setTimeout(function(){_1504.setProjectListeners();},100,this);Agua.updater.subscribe(this,"updateProjects");this.setSubscriptions();},updateProjects:function(args){console.log("workflow.Stages.updateProjects    workflow.Stages.updateProjects(args)");console.log("workflow.Stages.updateProjects    args:");console.dir({args:args});this.setProjectCombo();},getProject:function(){return this.projectCombo.get("value");},setProjectCombo:function(_1505){console.log("Grid.setProjectCombo    workflow.Stages.setProjectCombo(projectName)");this.settingProject=true;this.inherited(arguments);if(_1505==null){_1505=this.projectCombo.getValue();}this.setWorkflows(_1505);},setProjectListeners:function(){var _1506=this;dojo.connect(this.projectCombo,"onChange",dojo.hitch(this,function(event){var _1507=event;console.log("Grid.setProjectListeners    onchange event. Doing this.setWorkflowCombo("+_1507+")");console.log("Grid.setProjectListeners    thisObject.settingProject: "+_1506.settingProject);_1506.setWorkflows(_1507);}));},setWorkflows:function(_1508){console.log("Grid.setWorkflows    plugins.workflow.Parameters.setWorkflows(projectName)");console.log("Grid.setWorkflows    projectName: "+_1508);this.clearPanel(this.mainPanel);var _1509=Agua.getWorkflowsByProject(_1508);_1509=this.sortNumericHasharray(_1509,"number");if(_1509==null||_1509==[]){return;}var _150a=this;dojo.forEach(_1509,function(_150b,i){var _150c=_150b.project;var _150d=_150b.name;var _150e=_150b.number;var _150f=Agua.getStagesByWorkflow(_1508,_150d);var _1510=new plugins.workflow.GridWorkflow({title:_150d,project:_1508,workflow:_150d,number:_150e,stages:_150f,core:_150a.core});_150a.addChild(_1510);});},addChild:function(_1511){this.mainPanel.addChild(_1511);this.childWidgets.push(_1511);},setWorkflowStyles:function(){console.log("Grid.setWorkflowStyles     workflow.Parameters.setWorkflowStyles()");var _1512=this.childWidgets;var _1513=new Object;for(var i=0;i<_1512.length;i++){console.log("Grid.setWorkflowStyles     parameterRows["+i+"]: "+_1512[i]);console.log("Grid.setWorkflowStyles     "+_1512[i].name+", parameterRows["+i+"].paramtype: "+_1512[i].paramtype);if(_1512[i].paramtype=="input"){_1513[_1512[i].name]=_1512[i];}}console.dir(_1513);console.log("Grid.setWorkflowStyles     parameterHash:");console.log("Grid.setWorkflowStyles     this.application: "+dojo.toJson(this.application,true));var _1514=Agua.getStageParameters(this.application);console.log("Grid.setWorkflowStyles     stageParameters: "+dojo.toJson(_1514,true));console.log("Grid.setWorkflowStyles     stageParameters.length: "+_1514.length);for(var i=0;i<_1514.length;i++){if(_1514[i].paramtype!="input"){continue;}var _1515=_1513[_1514[i].name];console.log("Grid.setWorkflowStyles    stageParameters[i] "+_1514[i].name+" (paramtype: "+_1514[i].paramtype+") parameterRow: "+_1515);var _1516=Agua.getParameterValidity(_1514[i]);console.log("Grid.setWorkflowStyles     stageParameters["+i+"] '"+_1514[i].name+"' isValid: "+_1516);if(_1516==true||_1516==null){console.log("Grid.setWorkflowStyles     Doing parameterRows["+i+"].setValid()");_1515.setValid(_1515.domNode);}else{_1515.setInvalid(_1515.domNode);}}},clearPanel:function(panel){children=panel.getChildren();while(children!=null&&children.length!=0){panel.removeChild(children[0]);children=panel.getChildren();}},getWorkflowNumber:function(_1517,_1518){if(_1517==null||_1518==null){console.log("Grid.getWorkflow    project or workflow is null. Returning null");return;}return Agua.getWorkflowNumber(_1517,_1518);},updateWorkflowNumber:function(_1519,_151a){console.log("Workflows.updateWorkflowNumber     Workflow.updateWorkflowNumber(workflowObject)");console.log("Workflows.updateWorkflowNumber    workflowObject.project: "+_1519.project);console.log("Workflows.updateWorkflowNumber    workflowObject.workflow: "+_1519.workflow);console.log("Workflows.updateWorkflowNumber    workflowObject.name: "+_1519.name);console.log("Workflows.updateWorkflowNumber    workflowObject.number: "+_1519.number);var addOk=Agua.updateWorkflowNumber(_1519,_151a);if(!addOk){return;}},resetNumbers:function(node,_151b,_151c){console.log("Grid.resetNumbers    plugins.workflow.GridWorkflow.resetNumbers(node, targetArea, indexChild)");console.log("Grid.resetNumbers    indexChild: "+_151c);var _151d=dijit.byNode(node);var _151e={project:_151d.project,name:_151d.title,number:_151d.number};Agua.moveWorkflow(_151e,_151c+1);console.log("Grid.updateWorkflowNumber    DOING renumberWorkflows()");this.renumberWorkflows();console.log("Grid.updateWorkflowNumber    DOING Agua.updater.update('updateProjects')");Agua.updater.update("updateProjects",{originator:this,reload:false});},renumberWorkflows:function(){console.log("Grid.renumberWorkflows     renumberWorkflows()");var _151f=this.mainPanel.getChildren();for(var i=0;i<_151f.length;i++){var _1520=_151f[i];_1520.setNumber(i+1);var _1521=_1520.childWidgets;if(_1521==null){continue;}for(var j=0;j<_1521.length;j++){_1521[j].workflownumber=i+1;}}},confirmStopProject:function(){},confirmPauseProject:function(){},startProject:function(){},setSubscriptions:function(){var _1522=this;dojo.subscribe("/dojox/mdnd/adapter/dndToDojo/over",null,function(arg){console.log("dndToDojo/over");});dojo.subscribe("/dojox/mdnd/adapter/dndToDojo/out",null,function(arg){console.log("dndToDojo/out");});dojo.subscribe("/dojox/mdnd/adapter/dndToDojo/drop",null,function(arg){console.log("dndToDojo/drop");});dojo.subscribe("/dojox/mdnd/adapter/dndToDojo/cancel",null,function(arg){console.log("dndToDojo/cancel");});dojo.subscribe("/dojo/dnd/manager/overSource",function(_1523){console.debug("/dojo/dnd/manager/overSource",_1523);});dojo.subscribe("/dojox/mdnd/drag/start",function(node,_1524,_1525){console.dir({node:node});console.log("Doing /dojox/mdnd/drag/start    targetArea: ");console.dir({targetArea:_1524});console.log("Doing /dojox/mdnd/drag/start    indexChild: "+_1525);});dojo.subscribe("/dojox/mdnd/drop",null,function(node,_1526,_1527){console.log("Doing /dojox/mdnd/drop    node: "+node);console.log("Doing /dojox/mdnd/drop    targetArea: "+_1526);console.dir({targetArea:_1526});console.log("Doing /dojox/mdnd/drop    indexChild: "+_1527);_1522.resetNumbers(node,_1526,_1527);});dojo.subscribe("/dojox/mdnd/dropMode.OverDropMode/getDragPoint",function(node,_1528,_1529){console.log("Doing /dojox/mdnd/dropMode.OverDropMode/getDragPoint    node: "+node);console.log("Doing /dojox/mdnd/drop    targetArea: "+_1528);console.dir({targetArea:_1528});console.log("Doing /dojox/mdnd/drop    indexChild: "+_1529);});}});}if(!dojo._hasResource["plugins.workflow.HistoryPane"]){dojo._hasResource["plugins.workflow.HistoryPane"]=true;dojo.provide("plugins.workflow.HistoryPane");dojo.declare("plugins.workflow.HistoryPane",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n\t<table class=\"historyPaneTable\">\n\t\t<tr>\n\t\t\t<td colspan=\"2\"\n\t\t\t\tclass='displayStatusHeader'\n\t\t\t\tdojoAttachEvent=\"onclick:openWorkflow\"\n\t\t\t\talign=left>${project} ${workflow}</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t\t<div dojoAttachPoint=\"rowsNode\"></div>\n\t\t\t</td>\n\t\t</tr>\n\t\n\t</table>\n\n</div>\n",widgetsInTemplate:true,rows:null,core:null,constructor:function(args){this.rows=args.rows;this.core=args.core;},postMixInProperties:function(){},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);for(var i=0;i<this.rows.length;i++){var _152a=new plugins.workflow.HistoryPaneRow(this.rows[i]);this.rowsNode.innerHTML+=_152a.domNode.innerHTML;}},openWorkflow:function(){var _152b=this.project;var _152c=this.workflow;console.log("HistoryPane.openWorkflow    projectName: "+_152b);console.log("HistoryPane.openWorkflow    workflowName: "+_152c);if(Agua.controllers["workflow"]){Agua.controllers["workflow"].createTab({project:_152b,workflow:_152c});}}});dojo.declare("plugins.workflow.HistoryPaneRow",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table>\n    <tr>\n        <td colspan=\"2\" class='displayStatusRow value' width='200px'>${number}. ${name} ${status}</td>\n    </tr>\n    <tr>\n        <td class='displayStatusRow key' width='100px' align='right'>Started</td>\n        <td class='displayStatusRow value' width='200px'>${started}</td>\n    </tr>\n    <tr>\n        <td class='displayStatusRow key' width='100px' align='right'>Completed</td>\n        <td class='displayStatusRow value' width='200px'>${completed}</td>\n    </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,core:null,constructor:function(args){this.core=args.core;},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);}});}if(!dojo._hasResource["plugins.workflow.History"]){dojo._hasResource["plugins.workflow.History"]=true;dojo.provide("plugins.workflow.History");dojo.declare("plugins.workflow.History",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n    <!-- HISTORY TAB -->\n    <div\n        dojoAttachPoint=\"mainTab\" \n        dojoType=\"dijit.layout.ContentPane\"\n        title=\"History\"\n        parseOnLoad=\"false\"\n        class=\"history\"\n        style=\" height: 100%; width: 100%; padding: 0 !important;\"\n    >\n\n        <table width=\"100%\">\n            <tr>\n                <td colspan=\"5\" class=\"tabTitle\" align=\"center\">History</td>\n            </tr>\n            <tr>\n                <td width=\"20%\"></td>\n                <td\n                    dojoAttachPoint=\"downloadHistoryButton\"\n                    dojoAttachEvent=\"onclick:downloadHistory\"\n                    class=\"downloadHistoryButton\"\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"20%\"\n                    align=\"center\" >\n                </td>\n                <td width=\"20%\"></td>\n                <td\n                    dojoAttachPoint=\"refreshHistoryButton\"\n                    dojoAttachEvent=\"onclick:showHistory\"\n                    class=\"refreshHistoryButton\" \t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"20%\"\n                    align=\"center\" >\n                </td>\n                <td width=\"20%\"></td>\n            </tr>\n            <tr class=\"titles\">\n                <td width=\"20%\"></td>\n                <td width=\"20%\" height=\"12px\" align=\"center\">Download</td>\n                <td width=\"20%\"></td>\n                <td width=\"20%\" height=\"12px\" align=\"center\">Refresh</td>\n                <td width=\"20%\"></td>\n            </tr>\n\n        </table>\n\n        <div\n            dojoAttachPoint=\"historyTable\" \n            style=\"height:100%;width:100%;\"\n            parseOnLoad=\"false\"\n            >\n        </div>\n\n    </div>\n    <!-- END OF HISTORY TAB -->\n",widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins","workflow/css/history.css")],parentWidget:null,childWidgets:null,isValid:null,core:null,constructor:function(args){this.core=args.core;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.attachNode.addChild(this.mainTab);this.showHistory();},showHistory:function(){while(this.historyTable.firstChild){this.historyTable.removeChild(this.historyTable.firstChild);}var url=Agua.cgiUrl+"workflow.cgi";var query=new Object;query.username=Agua.cookie("username");query.sessionid=Agua.cookie("sessionid");query.mode="getHistory";var _152d=this;dojo.xhrPut({url:url,putData:dojo.toJson(query),handleAs:"json",sync:false,handle:function(_152e){var table=document.createElement("table");_152d.historyTable.appendChild(table);dojo.addClass(table,"historyTable");for(var i=0;i<_152e.length;i++){var tr=document.createElement("tr");table.appendChild(tr);var td=document.createElement("td");tr.appendChild(td);var _152f=_152e[i][0].project;var _1530=_152e[i][0].workflow;var _1531=new plugins.workflow.HistoryPane({project:_152f,workflow:_1530,rows:_152e[i]});td.appendChild(_1531.domNode);}}});},downloadHistory:function(event){event.stopPropagation();var query="?username="+Agua.cookie("username");query+="&sessionid="+Agua.cookie("sessionid");query+="&mode=downloadHistory";var url=Agua.cgiUrl+"download.cgi";console.log("History.setHistoryButtons     downloadHistoryButton.onclick    query: "+query);console.log("History.setHistoryButtons     downloadHistoryButton.onclick    url: "+url);var args={method:"POST",url:url+query,handleAs:"html",};dojo.io.iframe.send(args);}});}if(!dojo._hasResource["plugins.workflow.IO"]){dojo._hasResource["plugins.workflow.IO"]=true;dojo.provide("plugins.workflow.IO");dojo.declare("plugins.workflow.IO",[plugins.core.Common],{parentWidget:null,core:null,constructor:function(args){this.core=args.core;this.parentWidget=args.parentWidget;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);},chainStage:function(_1532,force){var _1533=new Object;if(_1532.number!=1){_1533.inputs=this.chainInputs(_1532,force);}_1533.outputs=this.chainOutputs(_1532,force);if(this.core.parameters!=null&&this.core.parameters.isCurrentApplication(_1532)){this.core.parameters.setParameterRowStyles();}return _1533;},chainInputs:function(_1534,force){var _1535=Agua.getStageParameters(_1534);var _1536=this.filterByKeyValues(_1535,["paramtype"],["input"]);var _1537=_1534.appnumber;if(_1537==null){return;}var _1538=Agua.getStagesByWorkflow(_1534.project,_1534.workflow);if(_1538==null){return;}var _1539=_1538[_1537-2];if(_1539==null){return;}var _153a=Agua.getStageParameters(_1539);if(_153a==null){return;}for(var i=0;i<_1536.length;i++){this.chainStageParameter(_1536[i],_153a,force);}return _1536;},chainResources:function(_153b,force){},chainOutputs:function(_153c,force){var _153d=Agua.getStageParameters(_153c);var _153e=dojo.clone(_153d);_153e=this.filterByKeyValues(_153e,["paramtype"],["output"]);for(var i=0;i<_153e.length;i++){this.chainStageParameter(_153e[i],_153d,force);}return _153e;},chainStageParameter:function(_153f,_1540,force){if(_153f.args==null||_153f.args==""){return;}var _1541=this.getValuesArray(_153f,dojo.clone(_1540));var value=this.getValue(_1541,_153f.inputParams,_153f.paramFunction);if((force==true&&value!=null&&value!="")||(value!=null&&value!=""&&_153f.value=="")){_153f.value=value;_153f.chained=1;Agua._removeStageParameter(_153f);Agua.addStageParameter(_153f);Agua.setParameterValidity(_153f,true);}},getValuesArray:function(_1542,_1543){if(_1542.args==null||_1543==null){return;}var _1544=_1542.args.split(/,/);var _1545=new Array;var _1546=this;for(var i=0;i<_1544.length;i++){var args=_1544[i];var array=args.split(".");var _1547=array[0];var _1548=array[1];var _1549=array[2];var _154a=dojo.clone(_1543);_154a=_1546.filterByKeyValues(_154a,["paramtype"],[_1547]);if(_154a==null||_154a.length==0){_1545.push(null);continue;}if(_1548==null||_1548==""){_1545.push(_154a);continue;}var _154b=_1546.filterByKeyValues(dojo.clone(_154a),["name"],[_1548])[0];if(_154b==null||_154b==""){_1545.push(null);continue;}if(_1549==null){_1545.push(_154b);continue;}var value=_154b.value;_1545.push(value);}return _1545;},getValue:function(_154c,_154d,_154e){var value;if(_154d==null||_154d==""||_154e==null||_154e==""){for(var i=0;i<_154c.length;i++){if(_154c[i]==null||_154c[i]==""){continue;}return _154c[i];}}var _154f=_154d.slice(",");var _1550=new Function(_154f,_154e);value=_1550(_154c[0],_154c[1],_154c[2],_154c[3],_154c[4]);return value;}});}if(!dojo._hasResource["plugins.workflow.RunStatus.ClusterStatus"]){dojo._hasResource["plugins.workflow.RunStatus.ClusterStatus"]=true;dojo.provide("plugins.workflow.RunStatus.ClusterStatus");dojo.declare("plugins.workflow.RunStatus.ClusterStatus",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n    <div\n        dojoAttachPoint=\"mainTab\"\n        dojoType=\"dijit.layout.ContentPane\"\n        parseOnLoad=\"false\"\n\t\toverflow=\"auto\"\n\t\ttitle=\"Cluster\"\n\t\tclass=\"clusterstatus\"\n\t\tstyle=\"position: relative; top: 0px !important; height: 100%; max-height: auto !important; min-width: 400px !important; width: auto !important; padding: 0 !important; background: #FFF;\"\n        >\n\n\t\t<table width=\"100%\">\n\t\t\t<tr>\n\t\t\t\t<td\n\t\t\t\t\tdojoAttachPoint=\"statusTitle\"\n\t\t\t\t\tclass=\"tabTitle\"\n\t\t\t\t\talign=\"center\">Cluster</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td align=\"left\">\n\t\t\t\t\t<table align=\"left\" width=\"100%\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\">\n\t\t\t\t\t\t\t\t<!--<div>-->\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"stop\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:stopCluster\"\n\t\t\t\t\t\t\t\t\t\tclass=\"stop\">\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<!--<div-->\n\t\t\t\t\t\t\t\t\t<!--\tdojoAttachPoint=\"pause\"-->\n\t\t\t\t\t\t\t\t\t<!--\tdojoAttachEvent=\"onclick:pauseCluster\"-->\n\t\t\t\t\t\t\t\t\t<!--\tclass=\"pause\">-->\n\t\t\t\t\t\t\t\t\t<!--</div>-->\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"start\"\n\t\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:startCluster\"\n\t\t\t\t\t\t\t\t\t\tclass=\"play\">\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"clusterHeading\">Cluster</div>\n\t\t\t\t\t\t\t\t\t<div dojoAttachPoint=\"clusterName\"\n\t\t\t\t\t\t\t\t\t\tclass=\"clusterText\">\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"clusterHeading\">Status</div>\n\t\t\t\t\t\t\t\t\t<div dojoAttachPoint=\"clusterStatus\"\n\t\t\t\t\t\t\t\t\t\tclass=\"clusterText\">\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<!--</div>-->\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\n\t\t\t<tr>\n\t\t\t\t<td>\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoType=\"dijit.TitlePane\"\n\t\t\t\t\t\ttitle=\"Cluster List\"\n\t\t\t\t\t\tclass=\"clusterStatus\"\n\t\t\t\t\t\tstyle=\"background: #FFF; height: auto; width: 100% !important; font-size: 10px !important\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoAttachPoint=\"list\"\n\t\t\t\t\t\t\tclass=\"clusterStatusContainer\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\n\t\t\t<tr>\n\t\t\t\t<td>\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoType=\"dijit.TitlePane\"\n\t\t\t\t\t\ttitle=\"Cluster Log\"\n\t\t\t\t\t\tclass=\"clusterStatus\"\n\t\t\t\t\t\tstyle=\"background: #FFF; height: auto; width: 100% !important; font-size: 10px !important\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoAttachPoint=\"log\"\n\t\t\t\t\t\t\tclass=\"clusterStatusContainer\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\n\t\t\t<tr>\n\t\t\t\t<td>\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoType=\"dijit.TitlePane\"\n\t\t\t\t\t\ttitle=\"Balancer Log\"\n\t\t\t\t\t\tclass=\"balancerStatus\"\n\t\t\t\t\t\tstyle=\"background: #FFF; height: auto; width: 100% !important; font-size: 10px !important\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoAttachPoint=\"balancer\"\n\t\t\t\t\t\t\tclass=\"clusterStatusContainer\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\n\t\t</table>\n\n\t</div>\n\n\n\n</div>\n",widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins")+"/workflow/RunStatus/css/clusterstatus.css"],core:null,status:"",runner:null,constructor:function(args){console.log("ClusterStatus.constructor    args:");console.dir({args:args});this.core=args.core;this.attachNode=args.attachNode;if(args.cgiUrl!=null){this.cgiUrl=args.cgiUrl;}else{this.cgiUrl=Agua.cgiUrl+"workflow.cgi";}this.loadCSS();},postCreate:function(){console.log("ClusterStatus.postCreate    plugins.workflow.RunStatus.ClusterStatus.postCreate()");this.startup();},startup:function(){console.log("ClusterStatus.startup    plugins.workflow.RunStatus.ClusterStatus.startup()");this.inherited(arguments);console.log("ClusterStatus.startup    this.attachNode: "+this.attachNode);console.log("ClusterStatus.startup    this.stagesTab: "+this.stagesTab);console.log("ClusterStatus.startup    this.queueTab: "+this.queueTab);if(this.attachNode.addChild!=null){this.attachNode.addChild(this.mainTab);}else{var div=dojo.create("div");document.body.appendChild(div);div.appendChild(this.mainTab.domNode);}this.attachNode.selectChild(this.mainTab);this.setConfirmDialog();},displayStatus:function(_1551){console.log("ClusterStatus.displayStatus      clusterstatus:");console.dir({clusterstatus:_1551});if(!_1551){_1551={cluster:"",status:"",list:"No nodes running",log:"No cluster log available",balancer:"No lbalancer log available"};}this.clearStatus();this.list.innerHTML="<PRE>"+_1551.list+"</PRE>";this.log.innerHTML="<PRE>"+_1551.log+"</PRE>";this.balancer.innerHTML="<PRE>"+_1551.balancer+"</PRE>";this.clusterName.innerHTML=_1551.cluster;this.status=_1551.status;this.clusterStatus.innerHTML=_1551.status;},clearStatus:function(){console.log("ClusterStatus.clearStatus      plugins.workflow.RunStatus.ClusterStatus.clearStatus()");this.clusterStatus.innerHTML="";this.list.innerHTML="";this.log.innerHTML="";while(this.list.firstChild){this.list.removeChild(this.list.firstChild);}while(this.log.firstChild){this.log.removeChild(this.log.firstChild);}while(this.balancer.firstChild){this.balancer.removeChild(this.balancer.firstChild);}},pauseCluster:function(){console.log("ClusterStatus.pauseCluster    ");var _1552=this.core.userWorkflows.getProject();var _1553=this.core.userWorkflows.getCluster();this.checkRunning(_1552,_1553,"confirmPauseCluster");},stopCluster:function(){console.log("ClusterStatus.stopCluster    this.status: "+this.status);var _1554=this.runner.cluster;console.log("ClusterStatus.stopCluster    cluster: "+_1554);if(!_1554){Agua.toastInfo("Cluster not defined");}else{if(!this.status||this.status=="stopping"||this.status=="stopped"){Agua.toastInfo("Cluster is already stopped");}else{this.confirmStopCluster(_1554);}}},startCluster:function(){var _1555=this.runner.cluster;console.log("ClusterStatus.startCluster    cluster: "+_1555);console.log("ClusterStatus.startCluster    this.status: "+this.status);if(!_1555){Agua.toastInfo("Cluster not defined");}else{if(this.status=="running"){Agua.toastInfo("Cluster is already running");}else{if(this.status=="starting"){Agua.toastInfo("Cluster is already starting");}else{this.confirmStartCluster(_1555);}}}},confirmPauseCluster:function(_1556,_1557,_1558){console.log("ClusterStatus.confirmPauseCluster    project: "+_1556);console.log("ClusterStatus.confirmPauseCluster    workflow: "+_1557);console.log("ClusterStatus.confirmPauseCluster    isRunning: "+_1558);if(!_1558){return;}var _1559=function(){console.log("ClusterMenu.confirmPauseCluster    noCallback()");};var _155a=dojo.hitch(this,function(){console.log("ClusterMenu.confirmPauseCluster    yesCallback()");this.doPauseCluster();});var _155b=this.core.userWorkflows.indexOfRunningStage();console.log("ClusterStatus.confirmPauseCluster   indexOfRunningStage: "+_155b);this.runner=this.core.runStatus.createRunner(_155b);var title=_1556+"."+_1557+" is running";var _155c="Are you sure you want to stop it?";this.loadConfirmDialog(title,_155c,_155a,_1559);},confirmStartCluster:function(_155d){console.log("ClusterStatus.confirmStartCluster    cluster: "+_155d);var _155e=function(){};var _155f=dojo.hitch(this,function(){console.log("ClusterStatus.startCluster    yesCallback()");this.doStartCluster();});var title="Are you sure you want to start cluster '"+_155d+"'?";var _1560="Cloud fees apply as soon as the cluster is started";this.loadConfirmDialog(title,_1560,_155f,_155e);},confirmStopCluster:function(_1561){console.log("ClusterStatus.confirmStopCluster    cluster "+_1561);var _1562=function(){};var _1563=dojo.hitch(this,function(){this.doStopCluster();});var title="Are you sure you want to stop cluster '"+_1561+"'?";var _1564="Any workflows currently running on it will be stopped";this.loadConfirmDialog(title,_1564,_1563,_1562);},doPauseCluster:function(){console.log("ClusterStatus.doPauseCluster    plugins.workflow.RunStatus.ClusterStatus.doPauseCluster");this.pauseRun();},doStartCluster:function(){console.log("ClusterStatus.doStartCluster    this.runner:");console.dir({this_runner:this.runner});var _1565=this.runner.project||"";var _1566=this.runner.workflow||"";var _1567=this.runner.cluster||"";var start=this.runner.start||"";var _1568=this.runner.username||"";var _1569=this.runner.sessionid||"";this.clusterStatus.innerHTML="starting";this.status="starting";var url=Agua.cgiUrl+"workflow.cgi";var query=new Object;query.username=_1568;query.sessionid=_1569;query.project=_1565;query.workflow=_1566;query.cluster=_1568+"-"+_1567;query.mode="startCluster";query.start=start;console.log("ClusterStatus.startCluster     query: "+dojo.toJson(query));var _156a=dojo.xhrPut({url:url,putData:dojo.toJson(query),handleAs:"json",sync:false,load:function(_156b){Agua.toast(_156b);}});},doStopCluster:function(){console.log("ClusterStatus.doStopCluster    this.runner:");console.dir({this_runner:this.runner});var _156c=this.runner.project||"";var _156d=this.runner.workflow||"";var _156e=this.runner.cluster||"";var start=this.runner.start||"";var _156f=this.runner.username||"";var _1570=this.runner.sessionid||"";this.clusterStatus.innerHTML="stopping";this.status="stopping";var url=Agua.cgiUrl+"workflow.cgi";var query=new Object;query.username=_156f;query.sessionid=_1570;query.project=_156c;query.workflow=_156d;query.cluster=_156f+"-"+_156e;query.mode="stopCluster";query.start=start;console.log("ClusterStatus.stopCluster     query: "+dojo.toJson(query));var _1571=dojo.xhrPut({url:url,putData:dojo.toJson(query),handleAs:"json",sync:false,load:function(_1572){Agua.toast(_1572);}});},setConfirmDialog:function(){var _1573=function(){};var _1574=function(){};var title="Dialog title";var _1575="Dialog message";this.confirmDialog=new plugins.dijit.ConfirmDialog({title:title,message:_1575,parentWidget:this,yesCallback:_1573,noCallback:_1574});},loadConfirmDialog:function(title,_1576,_1577,_1578){console.log("FileMenu.loadConfirmDialog    yesCallback.toString(): "+_1577.toString());console.log("FileMenu.loadConfirmDialog    title: "+title);console.log("FileMenu.loadConfirmDialog    message: "+_1576);console.log("FileMenu.loadConfirmDialog    yesCallback: "+_1577);console.log("FileMenu.loadConfirmDialog    noCallback: "+_1578);this.confirmDialog.load({title:title,message:_1576,yesCallback:_1577,noCallback:_1578});}});}if(!dojo._hasResource["plugins.workflow.RunStatus.QueueStatus"]){dojo._hasResource["plugins.workflow.RunStatus.QueueStatus"]=true;dojo.provide("plugins.workflow.RunStatus.QueueStatus");dojo.declare("plugins.workflow.RunStatus.QueueStatus",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n    <div\n        dojoAttachPoint=\"mainTab\"\n        dojoType=\"dijit.layout.ContentPane\"\n        parseOnLoad=\"false\"\n\t\toverflow=\"auto\"\n\t\ttitle=\"Queues\"\n\t\tclass=\"queuestatus\"\n\t\tstyle=\"position: relative; top: 0px !important; height: 100%; max-height: auto !important; min-width: 400px !important; width: auto !important; padding: 0 !important; background: #FFF;\"\n        >\n\n\t\t<table width=\"100%\">\n\t\t\t<tr>\n\t\t\t\t<td\n\t\t\t\t\tdojoAttachPoint=\"statusTitle\"\n\t\t\t\t\tclass=\"tabTitle\"\n\t\t\t\t\talign=\"center\">Queues</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td>\n\t\t\t\t\t<div\n\t\t\t\t\t\tdojoType=\"dijit.TitlePane\"\n\t\t\t\t\t\ttitle=\"Queue\"\n\t\t\t\t\t\tclass=\"queueStatus\"\n\t\t\t\t\t\tstyle=\"background: #FFF; height: auto; width: 100% !important; font-size: 10px !important\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoAttachPoint=\"statusList\"\n\t\t\t\t\t\t\tclass=\"statusList\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\t\t\t\t\n\t</div>\n\n</div>\n",widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins")+"/workflow/RunStatus/css/queuestatus.css"],core:null,status:"",runner:null,constructor:function(args){console.log("QueueStatus.constructor    args:");console.dir({args:args});this.core=args.core;this.attachNode=args.attachNode;if(args.cgiUrl!=null){this.cgiUrl=args.cgiUrl;}else{this.cgiUrl=Agua.cgiUrl+"workflow.cgi";}this.loadCSS();},postCreate:function(){console.log("QueueStatus.postCreate    plugins.workflow.RunStatus.QueueStatus.postCreate()");this.startup();},startup:function(){console.log("QueueStatus.startup    plugins.workflow.RunStatus.QueueStatus.startup()");this.inherited(arguments);console.log("QueueStatus.startup    this.attachNode: "+this.attachNode);if(this.attachNode.addChild!=null){this.attachNode.addChild(this.mainTab);}else{var div=dojo.create("div");document.body.appendChild(div);div.appendChild(this.mainTab.domNode);}this.attachNode.selectChild(this.mainTab);},displayStatus:function(_1579){console.log("QueueStatus.displayStatus      queuestatus:");console.dir({queuestatus:_1579});this.clearStatus();if(!_1579||!_1579.status){this.statusList.innerHTML="No queue information available";return;}this.statusList.innerHTML="<PRE>"+_1579.status+"</PRE>";},clearStatus:function(){console.log("QueueStatus.clearStatus      clearing this.statusList");this.statusList.innerHTML="";while(this.statusList.firstChild){this.statusList.removeChild(this.statusList.firstChild);}}});}if(!dojo._hasResource["plugins.workflow.RunStatus.StageStatusRow"]){dojo._hasResource["plugins.workflow.RunStatus.StageStatusRow"]=true;dojo.provide("plugins.workflow.RunStatus.StageStatusRow");dojo.declare("plugins.workflow.RunStatus.StageStatusRow",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\" class=\"stageTable\">\n\n\t<!-- NB: EXTRA dojoAttachPointS ADDED FOR TESTING -->\n\n\t<table class=\"stageTable ${status}\" width=\"100%\">\n\n\t\t<tr width=\"100%\" class='stageRow'>\n\t\t\t<td class='${status}Icon header'\n\t\t\t\talign=\"left\" width=\"100px\">${number} </td>\n\t\t\t<td dojoAttachPoint=\"nameNode\" class='name'>${name}</td>\n\t\t\t<td class='key'>Queued</td>\n\t\t\t<td dojoAttachPoint=\"queuedNode\" class='value'>${queued}</td>\n\t\t\t<td class='key'>Lapsed</td>\n\t\t\t<td dojoAttachPoint=\"lapsedNode\" dojoAttachPoint=\"lapsed\"\n\t\t\t\tclass='value'>${lapsed}</td>\n\t\t</tr>\n\n\t\t<tr width=\"100%\" class='stageRow'>\n\t\t\t<td class='key'>Status</td>\n\t\t\t<td dojoAttachPoint=\"statusNode\" class='value ${status}'>${status}</td>\n\t\t\t<td class='key'>Started</td>\n\t\t\t<td dojoAttachPoint=\"startedNode\" class='value'>${started}</td>\n\t\t\t<td class='key'>Output</td>\n\t\t\t<td dojoAttachPoint=\"stdoutNode\"\n\t\t\t\tclass='stdout'\n\t\t\t\twidth=\"50%\"\n\t\t\t\ttitle=\"Click to view run output\">STDOUT file</td>\n\t\t</tr>\n\n\t\t<tr width=\"100%\" class='stageRow'>\n\t\t\t<td class='key'>Duration</td>\n\t\t\t<td dojoAttachPoint=\"durationNode\" class='value'>${duration}</td>\n\t\t\t<td class='key'>Ended</td>\n\t\t\t<td dojoAttachPoint=\"completedNode\" class='value'>${completed}</td>\n\t\t\t<td class='key'>Errors</td>\n\t\t\t<td dojoAttachPoint=\"stderrNode\"\n\t\t\t\tclass='stderr'\n\t\t\t\twidth=\"50%\"\n\t\t\t\ttitle=\"Click to view error messages\">STDERR file</td>\n\t\t</tr>\n\n\t</table>\n\t\n</div>\n\n",widgetsInTemplate:true,constructor:function(args){this.core=args.core;},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);if(this.stderrfile!=null&&this.stderrfile!=""){this.setFileDownload("stderr");}if(this.stdoutfile!=null&&this.stdoutfile!=""){this.setFileDownload("stdout");}},setFileDownload:function(_157a){var _157b=_157a+"Node";var _157c=_157a+"file";this[_157b].innerHTML=this[_157c];dojo.connect(this[_157b],"onclick",this,dojo.hitch(this,function(event){this.downloadFile(this[_157b].innerHTML);}));},handleDownload:function(_157d,_157e){if(_157d.message=="ifd.getElementsByTagName(\"textarea\")[0] is undefined"){Agua.toastMessage({message:"Download failed: File is not present",type:"error"});}}});}if(!dojo._hasResource["plugins.workflow.RunStatus.StageStatus"]){dojo._hasResource["plugins.workflow.RunStatus.StageStatus"]=true;dojo.provide("plugins.workflow.RunStatus.StageStatus");dojo.declare("plugins.workflow.RunStatus.StageStatus",[dijit._Widget,dijit._Templated],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n\t<table class=\"stageTable\"\n\t\tdojoAttachPoint=\"stageTable\"\n\t\twidth=\"100%\">\n\t\t\n\t</table>\t\n</div>\n",widgetsInTemplate:true,stages:null,rows:new Array(),constructor:function(args){console.log("StageStatus.constructor    plugins.workflow.RunStatus.StageStatusRow.constructor(args)");},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);console.log("StageStatus.startup    this.stages: ");console.dir({stages:this.stages});this.attachNode.appendChild(this.stageTable);},displayStatus:function(_157f){console.group("StageStatus-"+this.id+"    displayStatus");console.log("StageStatus.displayStatus      stagestatus:");console.dir({stagestatus:_157f});this.clearStatus();if(!_157f){console.log("StageStatus.displayStatus    stagestatus is null. Returning");return;}this.status=_157f.status;this.core.runStatus.workflowName.innerHTML=_157f.workflow+"."+_157f.project;this.core.runStatus.workflowStatus.innerHTML=_157f.status;var _1580=_157f.stages;console.log("StageStatus.displayStatus    DOING this.displayStagesStatus()");this.displayStagesStatus(_1580);},clearStatus:function(){console.log("StageStatus.clearStatus    BEFORE clear this.stageTable");this.core.runStatus.innerHTML="";while(this.stageTable.childNodes&&this.stageTable.childNodes.length){console.log("StageStatus.clearStatus    REMOVING node "+this.stageTable.childNodes[0]);this.stageTable.removeChild(this.stageTable.childNodes[0]);}console.log("StageStatus.clearStatus    AFTER clear this.stageTable");},displayStagesStatus:function(_1581){console.log("StageStatus.displayStagesStatus    stages:");console.dir({stages:_1581});if(!_1581){return;}this.rows=[];for(var i=0;i<_1581.length;i++){console.log("StageStatus.displayStatus     Doing stages["+i+"]: ");console.dir({stage:_1581[i]});var tr=document.createElement("tr");this.stageTable.appendChild(tr);_1581[i].duration=this.calculateDuration(_1581[i]);console.log("StageStatus.displayStatus     stages[i].duration: "+_1581[i].duration);_1581[i].lapsed=this.calculateLapsed(_1581[i]);console.log("StageStatus.displayStatus     stages[i].lapsed: "+_1581[i].lapsed);if(_1581[i].completed=="0000-00-00 00:00:00"){_1581[i].completed="";}if(_1581[i].queued=="0000-00-00 00:00:00"){_1581[i].queued="";}_1581[i].core=this.core;var _1582=new plugins.workflow.RunStatus.StageStatusRow(_1581[i]);console.log("StageStatus.displayStatus     stagestatusRow:");console.dir({stagestatusRow:_1582});this.rows.push(_1582);var td=document.createElement("td");tr.appendChild(td);td.appendChild(_1582.domNode);}console.groupEnd("StageStatus-"+this.id+"    displayStatus");},stringToDate:function(_1583){console.log("StageStatus.stringToDate    string: "+_1583);var array=_1583.match(/^(\d{4})\D+(\d+)\D+(\d+)\D+(\d+)\D+(\d+)\D+(\d+)/);console.log("StageStatus.arrayToDate    array: ");console.dir({array:array});array.shift();array[1]--;return new Date(array[0],array[1],array[2],array[3],array[4],array[5]);},secondsToDuration:function(_1584){var _1585="";var _1586=0;_1586=_1584%1000;_1584-=_1586;_1584/=1000;_1586=_1584%60;if(_1586){_1585=_1586.toString();}else{_1585="0";}_1585=_1585+" sec";_1584-=_1586;_1584/=60;_1586=_1584%60;_1585=_1586.toString()+" min "+_1585;_1584-=_1586;_1584/=60;return _1584.toString()+" hours "+_1585;},calculateDuration:function(stage){console.log("StageStatus.calculateDuration    stage.started: "+stage.started);var _1587="";if(stage.started&&stage.started!="0000-00-00 00:00:00"){var _1588=this.stringToDate(stage.started);var _1589;if(!stage.completed||stage.completed=="0000-00-00 00:00:00"){_1589=this.stringToDate(stage.now);}else{_1589=this.stringToDate(stage.completed);}var _158a=_1589-_1588;_1587=this.secondsToDuration(_158a);}return _1587;},calculateLapsed:function(stage){console.log("StageStatus.calculateLapsed    stage.completed: "+stage.completed);var _158b="";if(!stage||!stage.completed||stage.completed=="0000-00-00 00:00:00"){return _158b;}var _158c=this.stringToDate(stage.completed);var _158d=new Date;console.log("StageStatus.calculateLapsed    currentDate: "+_158d);console.dir({currentDate:_158d});var _158e=_158d-_158c;console.log("StageStatus.calculateLapsed    seconds: "+_158e);_158b=this.secondsToDuration(_158e);console.log("StageStatus.calculateLapsed    lapsed: "+_158b);return _158b;}});}if(!dojo._hasResource["plugins.workflow.RunStatus.Status"]){dojo._hasResource["plugins.workflow.RunStatus.Status"]=true;dojo.provide("plugins.workflow.RunStatus.Status");dojo.declare("plugins.workflow.RunStatus.Status",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoattachpoint=\"containerNode\">\n\n    <div\n        dojoAttachPoint=\"stagesTab\"\n        dojoType=\"dijit.layout.ContentPane\"\n        parseOnLoad=\"false\"\n\t\toverflow=\"auto\"\n\t\ttitle=\"Status\"\n\t\tclass=\"runstatus\"\n\t\tstyle=\"position: relative; top: 0px !important; height: 100%; max-height: auto !important; min-width: 400px !important; width: auto !important; padding: 0 !important; background: #FFF;\"\n        >\n\n\t\t<table width=\"100%\">\n\t\t\t<tr>\n\t\t\t\t<td\n\t\t\t\t\tdojoAttachPoint=\"statusTitle\"\n\t\t\t\t\tclass=\"tabTitle\"\n\t\t\t\t\talign=\"center\">Status</td>\n\t\t\t</tr>\n\n\t\t\t<tr>\n\t\t\t\t<td>\n\t\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\">\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"toggle\"\n\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:togglePoller\"\n\t\t\t\t\t\t\t\t\tclass=\"pollingStopped\"\n\t\t\t\t\t\t\t\t\ttitle=\"Click to start or stop run status polling\">\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"pollCountdown\"\n\t\t\t\t\t\t\t\t\t\tclass=\"pollCountdown\">\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"stop\"\n\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:stopWorkflow\"\n\t\t\t\t\t\t\t\t\tclass=\"stop\">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"pause\"\n\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:pauseWorkflow\"\n\t\t\t\t\t\t\t\t\tclass=\"pause\">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"play\"\n\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onclick:startWorkflow\"\n\t\t\t\t\t\t\t\t\tclass=\"play\">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"workflowHeading\">Workflow</div>\n\t\t\t\t\t\t\t\t<div dojoAttachPoint=\"workflowName\"\n\t\t\t\t\t\t\t\t\tclass=\"workflowText\">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"workflowHeading\">Status</div>\n\t\t\t\t\t\t\t\t<div dojoAttachPoint=\"workflowStatus\"\n\t\t\t\t\t\t\t\t\tclass=\"workflowText\">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div dojoAttachPoint=\"workflowTime\"\n\t\t\t\t\t\t\t\t\tclass=\"workflowTime\">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td>\n\t\t\t\t\t<div \n\t\t\t\t\t\tdojoType=\"dijit.TitlePane\"\n\t\t\t\t\t\ttitle=\"Stages\"\n\t\t\t\t\t\tstyle=\"background: #FFF; height: auto; width: 100% !important;\"\n\t\t\t\t\t\t>\n\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tdojoAttachPoint=\"stagesStatusContainer\"\n\t\t\t\t\t\t\tclass=\"status\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t\t<td>\n\t\t\t</tr>\n\t\t</table>\n\t</div>\n\t\n</div> \n\n\n",widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins")+"/workflow/RunStatus/css/runstatus.css"],timer:null,timerInterval:20000,polling:false,core:null,delay:21000,deferreds:[],constructor:function(args){console.log("Status.constructor    plugins.workflow.RunStatus.constructor(args)");this.core=args.core||{};this.core.runStatus=this;console.log("Status.constructor    args.parentWidget: "+args.parentWidget);console.log("Status.constructor    args.attachNode: "+args.attachNode);if(args.parentWidget){this.parentWidget=args.parentWidget;}if(args.attachNode){this.attachNode=args.attachNode;}if(args.cgiUrl!=null){this.cgiUrl=args.cgiUrl;}if(this.cgiUrl==null){this.cgiUrl=Agua.cgiUrl+"workflow.cgi";}if(args.timerInterval){this.timerInterval=args.timerInterval;}this.loadCSS();},postMixInProperties:function(){console.log("Status.postMixInProperties    plugins.workflow.RunStatus.postMixInProperties()");},postCreate:function(){console.log("Status.postCreate    plugins.workflow.RunStatus.postCreate()");this.startup();},startup:function(){console.log("Status.startup    plugins.workflow.RunStatus.startup()");this.inherited(arguments);console.log("Status.startup    this.attachNode: "+this.attachNode);console.log("Status.startup    this.stagesTab: "+this.stagesTab);if(this.attachNode.addChild!=null){this.attachNode.addChild(this.stagesTab);}else{var div=dojo.create("div");document.body.appendChild(div);div.appendChild(this.stagesTab.domNode);}this.setConfirmDialog();this.setSequence();this.setStageStatus();this.setClusterStatus();this.setQueueStatus();this.attachNode.selectChild(this.core.parameters);},runWorkflow:function(_158f){console.group("runStatus-"+this.id+"    runWorkflow");console.log("XXXXXXXXXXXXXXXXXXXx RunStatus.runWorkflow      runner: ");console.dir(_158f);this.attachNode.selectChild(this.stagesTab);if(_158f!=null){delete this.runner;this.runner=_158f;}var _1590=_158f.project;var _1591=_158f.workflow;var start=_158f.start;console.log("Status.runWorkflow      project: "+_1590);console.log("Status.runWorkflow      workflow: "+_1591);console.log("Status.runWorkflow      start: "+start);this.displayWorkflowStatus("starting");var url=Agua.cgiUrl+"workflow.cgi";console.log("Status.runWorkflow      url: "+url);var _1592=Agua.getWorkflowSubmit(this.runner);var query=new Object;query.project=this.runner.project;query.workflow=this.runner.workflow;query.workflownumber=this.runner.workflownumber;query.start=this.runner.start;query.stop=this.runner.stop;query.username=Agua.cookie("username");query.sessionid=Agua.cookie("sessionid");query.mode="executeWorkflow";query.submit=_1592;query.cluster=this.runner.cluster;if(query.cluster!=""){query.cluster=query.username+"-"+query.cluster;}else{query.cluster="";}console.log("Status.runWorkflow     query: "+dojo.toJson(query));var _1593=this;var _1594=dojo.xhrPut({url:url,putData:dojo.toJson(query),handleAs:"json",sync:false,handle:function(_1595){console.log("Status.runWorkflow     response: ");console.dir({response:_1595});if(_1595.error){_1593.clearDeferreds();_1593.polling=false;_1593.displayNotPolling();if(_1595.error=="running"){console.log("Status.runWorkflow    Doing this.confirmStopWorkfkow()");_1593.displayWorkflowStatus("running");_1593.confirmStopWorkflow(_1590,_1591);}console.groupEnd("runStatus-"+_1593.id+"    runWorkflow");return;}else{console.log("0000000000000000000000    RunStatus.runWorkflow     DOING this.setNodeClass(runner.childNodes["+start+"])");_1593.setNodeClass(_158f.childNodes[start-1],"running");}Agua.toast(_1595);}});this.deferreds.push(_1594);this.polling=true;var _1596=false;var _1597=2000;this.delayCountdownTimeout=setTimeout(function(){_1593.displayActive();_1593.queryStatus(_1593.runner,_1596);},_1597,this);},checkRunning:function(_1598,_1599,_159a){console.group("runStatus-"+this.id+"    checkRunning");console.log("Status.checkRunning     project: "+_1598);console.log("Status.checkRunning     workflow: "+_1599);console.log("Status.checkRunning     callback: "+_159a);var url=Agua.cgiUrl+"workflow.cgi";console.log("Status.checkRunning     url: "+url);var query=new Object;query.username=Agua.cookie("username");query.sessionid=Agua.cookie("sessionid");query.project=_1598;query.workflow=_1599;query.mode="getStatus";console.log("Status.checkRunning    query: "+dojo.toJson(query));var _159b=this;var _159c=dojo.xhrPut({url:url,putData:dojo.toJson(query),handleAs:"json",sync:false,handle:function(_159d){console.log("Status.checkRunning    response: ");console.dir({response:_159d});var _159e=false;if(_159d.stagestatus==null){return false;}for(var i=0;i<_159d.stagestatus.length;i++){if(_159d.stagestatus[i].status=="running"){_159e=true;console.log("Status.checkRunning    stage "+i+" ("+_159d.stagestatus[i].name+") is running.");break;}}console.log("Status.checkRunning    Doing  callback "+_159a+"("+_159e+")");_159b[_159a](_1598,_1599,_159e);console.groupEnd("runStatus-"+_159b.id+"    checkRunning");return null;}});this.clearDeferreds(_159c);this.deferreds.push(_159c);},createRunner:function(_159f,_15a0){console.group("RunStatus-"+this.id+"    createRunner");if(!this.core.userWorkflows.dropTarget){console.log("workflow.RunStatus.createRunner    Returning without childNodes because this.core.userWorkflows.dropTarget is null");console.groupEnd("RunStatus-"+this.id+"    createRunner");return _15a1;}var _15a2=this.core.userWorkflows.dropTarget.getAllNodes();if(_159f==null){_159f=1;}if(_15a0==null){_15a0=_15a2.length;}console.log("workflow.RunStatus.createRunner    startNumber: "+_159f);console.log("workflow.RunStatus.createRunner    stopNumber: "+_15a0);var _15a3=this.core.userWorkflows.getProject();var _15a4=this.core.userWorkflows.getWorkflow();var _15a5=Agua.getWorkflowNumber(_15a3,_15a4);console.log("workflow.RunStatus.createRunner    workflowNumber: "+_15a5);var _15a6=this.core.userWorkflows.getCluster();console.log("workflow.RunStatus.createRunner    clusterName: "+_15a6);var _15a1=new Object;_15a1.username=Agua.cookie("username");_15a1.sessionid=Agua.cookie("sessionid");_15a1.project=_15a3;_15a1.workflow=_15a4;_15a1.cluster=_15a6;_15a1.start=_159f;_15a1.stop=_15a0;_15a1.workflownumber=_15a5;_15a1.childNodes=_15a2;console.log("workflow.RunStatus.createRunner    runner: ");console.dir({runner:_15a1});console.groupEnd("RunStatus-"+this.id+"    createRunner");return _15a1;},getStatus:function(_15a7,_15a8){console.group("RunStatus-"+this.id+"    getStatus");console.log("Status.getStatus    runner: ");console.dir({runner:_15a7});console.log("Status.getStatus      singleton: "+_15a8);console.log("Status.getStatus     this.polling: "+this.polling);if(this.polling==true){console.log("Status.getStatus     Returning because this.polling is TRUE");console.groupEnd("RunStatus-"+this.id+"    getStatus");return;}this.polling=true;this.runner=_15a7;if(!this.runner){console.log("Status.getStatus    Doing this.runner\t= this.createRunner(stageNumber)");var _15a9=1;this.runner=this.createRunner(_15a9);}this.clusterStatus.runner=this.runner;if(!this.runner.childNodes&&this.core.userWorkflows.dropTarget){this.runner.childNodes=this.core.userWorkflows.dropTarget.getAllNodes();}if(_15a8){dojo.addClass(this.toggle,"pollingActive");}else{dojo.addClass(this.toggle,"pollingStarted");}var _15aa=this.runner.project;var _15ab=this.runner.workflow;var start=this.runner.start;var _15ac=this.runner.childNodes;console.log("Status.getStatus      project: "+_15aa);console.log("Status.getStatus      workflow: "+_15ab);console.log("Status.getStatus      start: "+start);console.log("Status.getStatus      childNodes.length: "+_15ac.length);this.displayWorkflowStatus("loading...");if(_15aa==null||_15ab==null||start==null){console.groupEnd("RunStatus-"+this.id+"    getStatus");return;}if(_15ac==null||!_15ac||_15ac.length==0){console.log("Status.getStatus      No childNodes in dropTarget. Returning...");console.groupEnd("RunStatus-"+this.id+"    getStatus");return;}this.queryStatus(this.runner,_15a8);},queryStatus:function(_15ad,_15ae){if(this.queryStatus.caller){console.log("Status.queryStatus    caller: "+this.queryStatus.caller.nom);}console.log("Status.queryStatus    passed runner: ");console.dir({runner:_15ad});console.log("Status.queryStatus    passed singleton: "+_15ae);var url=this.cgiUrl;var query=new Object;query.username=_15ad.username;query.sessionid=_15ad.sessionid;query.project=_15ad.project;query.workflow=_15ad.workflow;query.mode="getStatus";console.log("Status.queryStatus    query: "+dojo.toJson(query));var _15af=this;var _15b0=dojo.xhrPut({url:url,putData:dojo.toJson(query),handleAs:"json",sync:false,handle:function(_15b1){if(_15af.runCompleted(_15b1)){console.log("Status.getStatus    response:");console.dir({response:_15b1});console.log("Status.queryStatus     DOING thisObject.handleStatus(runner, response)");_15af.handleStatus(_15ad,_15b1);console.groupEnd("RunStatus-"+_15af.id+"    getStatus");if(!_15ae){_15af.delayedQueryStatus(_15ad,_15ae);}else{_15af.stopPolling();}}else{if(!_15ae){_15af.delayedQueryStatus(_15ad,_15ae);}else{_15af.stopPolling();}}}});this.clearDeferreds();this.deferreds.push(_15b0);},clearDeferreds:function(_15b2){console.log("Status.clearDeferreds    ignore: ");console.dir({ignore:_15b2});console.log("Status.clearDeferreds    No. deferreds: "+this.deferreds.length);dojo.forEach(this.deferreds,function(_15b3,index){if(_15b3==_15b2){console.log("Status.clearDeferreds    ignoring deferred: ");console.dir({ignore:_15b2});return;}console.log("Status.clearDeferreds    Clearing deferred "+index+": "+_15b3.callback.toString());_15b3.callback=function(){console.log("Status.clearDeferreds    deleted callback");};console.log("Status.clearDeferreds    BEFORE deferred.destroy deferred:");console.dir({deferred:_15b3});});this.deferreds=[];console.log("Status.clearDeferreds    Doing this.sequence.stop()");this.sequence.stop();},showMessage:function(_15b4){console.log("Status.showMessage    message: "+_15b4);console.log("Status.showMessage    Doing queryStatus after delay: "+this.delay);},delayedQueryStatus:function(_15b5,_15b6){console.log("_GroupDragPane.delayedQueryStatus    runner:");console.dir({runner:_15b5});console.log("_GroupDragPane.delayedQueryStatus    singleton: "+_15b6);console.log("_GroupDragPane.delayedQueryStatus    this.polling: "+this.polling);if(!this.polling){console.log("_GroupDragPane.delayedQueryStatus    this.polling is FALSE. Returning");return;}var delay=this.delay;this.clearCountdown();var _15b7=_15b5.project;var _15b8=_15b5.workflow;var _15b9=parseInt(delay/1000);this.delayCountdown(_15b9,_15b7,_15b8);var _15ba=[{func:[this.showMessage,this,"RunStatus.delayedQueryStatus"],pauseAfter:delay},{func:[this.queryStatus,this,_15b5,_15b6]}];console.log("_GroupDragPane.delayedPollCopy    commands: ");console.dir({commands:_15ba});this.sequence.go(_15ba,function(){console.log("RunStatus.delayedQueryStatus    Doing this.sequence.go(commands)");});},runCompleted:function(_15bb){var _15bc=true;for(var i=0;i<_15bb.length;i++){console.log("Status.runCompleted    response.stagestatus.stages["+i+"].status: "+_15bb.stagestatus.stages[i].status);if(_15bb.stagestatus.stages[i].status=="completed"){_15bc=false;}}return _15bc;},handleStatus:function(_15bd,_15be){console.group("RunStatus-"+this.id+"    handleStatus");var _15bf=this.runner.project;var _15c0=this.runner.workflow;var start=this.runner.start;var _15c1=this.runner.childNodes;console.log("Status.handleStatus     response: ");console.dir({response:_15be});console.log("Status.handleStatus      this.polling: "+this.polling);if(!this.polling){return false;}if(!_15be){this.displayWorkflowStatus("error: no response");return;}if(_15be.error){this.displayWorkflowStatus("error");return;}this.displayWorkflowStatus("processing");this.response=_15be;this.completed=true;console.log("Status.handleStatus    Setting class of "+_15be.stagestatus.stages.length+" stage nodes");var _15c2="completed";var _15c3=_15bd.start-1;if(_15c3<0){_15c3=0;}console.log("Status.handleStatus    startIndex: "+_15c3);for(var i=_15c3;i<_15be.stagestatus.stages.length;i++){var _15c4=_15be.stagestatus.stages[i].status;console.log("Status.handleStatus   response.stagestatus.stages["+i+"].status: "+_15be.stagestatus.stages[i].status);if(!_15bd.childNodes[i]){continue;}this.setNodeClass(_15bd.childNodes[i],_15c4);if(_15c4!="completed"&&_15c2=="completed"){console.log("Status.handleStatus    Setting this.completed = false");this.completed=false;_15c2=_15c4;}}console.log("Status.handleStatus    this.completed: "+this.completed);this.displayWorkflowStatus(_15c2);if(this.completed==true){this.stopPolling();}console.log("Status.handleStatus     BEFORE Agua.updateStagesStatus(startIndex, response)");Agua.updateStagesStatus(_15be.stagestatus);console.log("Status.handleStatus     AFTER Agua.updateStagesStatus(startIndex, response)");console.log("Status.handleStatus     BEFORE this.showStatus(startIndex, response)");this.showStatus(_15be);console.log("Status.handleStatus     AFTER this.showStatus(startIndex, response)");console.groupEnd("RunStatus-"+this.id+"    handleStatus");return null;},setNodeClass:function(node,_15c5){console.log("XXXXX RunStatus.setNodeClass    nodeClass: "+_15c5);dojo.removeClass(node,"stopped");dojo.removeClass(node,"waiting");dojo.removeClass(node,"running");dojo.removeClass(node,"completed");dojo.addClass(node,_15c5);},clearCountdown:function(){if(this.delayCountdownTimeout){clearTimeout(this.delayCountdownTimeout);}this.pollCountdown.innerHTML="";},delayCountdown:function(_15c6,_15c7,_15c8){if(_15c6==1){this.displayWorkflowStatus("loading...");this.displayActive();}_15c6-=1;this.pollCountdown.innerHTML=_15c6;if(_15c6<1){return;}var _15c9=850;var _15ca=this;this.delayCountdownTimeout=setTimeout(function(){_15ca.displayPolling();_15ca.delayCountdown(_15c6,_15c7,_15c8);},_15c9,this);},togglePoller:function(){console.log("Status.togglePoller      plugins.workflow.RunStatus.togglePoller()");console.log("Status.togglePoller      this.polling: "+this.polling);if(this.polling){console.log("Status.togglePoller      Setting this.polling to FALSE and this.completed to FALSE");this.polling=false;this.completed=false;this.stopPolling();}else{console.log("Status.togglePoller      Setting this.polling to TRUE and this.completed to TRUE");this.polling=true;this.completed=true;if(!this.runner){this.runner=this.createRunner(1,null);}this.startPolling();}},displayActive:function(){console.log("Status.displayActive");dojo.removeClass(this.toggle,"pollingStopped");dojo.removeClass(this.toggle,"pollingStarted");dojo.addClass(this.toggle,"pollingActive");},displayPolling:function(){dojo.removeClass(this.toggle,"pollingStopped");dojo.removeClass(this.toggle,"pollingActive");dojo.addClass(this.toggle,"pollingStarted");},displayNotPolling:function(){console.log("Status.displayStarted");dojo.removeClass(this.toggle,"pollingStarted");dojo.removeClass(this.toggle,"pollingActive");dojo.addClass(this.toggle,"pollingStopped");},stopPolling:function(){console.log("Status.stopPolling      plugins.workflow.RunStatus.stopPolling()");console.log("Status.stopPolling      Setting this.polling to FALSE");this.polling=false;this.clearCountdown();this.clearDeferreds();this.displayNotPolling();},startPolling:function(){console.log("Status.startPolling      plugins.workflow.RunStatus.startPolling()");console.log("Status.startPolling      this.polling: "+this.polling);console.log("Status.togglePoller      Setting this.polling to FALSE (ahead of check this.polling in getStatus)");this.polling=false;if(!this.runner){console.log("Status.startPolling      this.runner is null. Returning");this.polling=false;return;}this.displayPolling();console.log("Status.togglePoller      Doing this.getStatus(null, false)");this.getStatus(null,false);},showStatus:function(_15cb){console.log("Status.showStatus      response: ");console.dir({response:_15cb});if(!_15cb){return;}console.log("Status.showStatus      Doing this.displayStageStatus(response.stages)");this.displayStageStatus(_15cb.stagestatus);console.log("Status.showStatus      Doing this.displayClusterStatus(response.clusterstatus)");this.displayClusterStatus(_15cb.clusterstatus);console.log("Status.showStatus      Doing this.displayQueueStatus(response.queuestatus)");this.displayQueueStatus(_15cb.queuestatus);this.selectTab(_15cb);var _15cc=this.getSelectedTab();console.log("Status.showStatus    -------------------------- selectedTab : "+_15cc);},selectTab:function(_15cd){console.log("Status.selectTab      response: ");console.dir({response:_15cd});if(!_15cd||!_15cd.clusterstatus){console.log("Status.selectTab      response or response.clusterstatus is null. SELECTING 'STAGE' TAB");this.attachNode.selectChild(this.stagesTab);return;}var _15ce=_15cd.clusterstatus.status;console.log("Status.selectTab      status: "+_15ce);if(_15ce==null){console.log("Status.selectTab      clusterstatus.status is null. SELECTING 'STAGE' TAB");this.attachNode.selectChild(this.stagesTab);}else{if(_15ce.match(/^cluster/)||_15ce.match(/^balancer/)){console.log("Status.selectTab      SELECTING 'CLUSTER' TAB");this.attachNode.selectChild(this.clusterStatus.mainTab);}else{if(_15ce.match(/sge/)){console.log("Status.selectTab      SELECTING 'QUEUE' TAB");this.attachNode.selectChild(this.queueStatus.mainTab);}else{console.log("Status.selectTab      SELECTING 'STAGE' TAB");this.attachNode.selectChild(this.stagesTab);}}}},getSelectedTab:function(){console.log("Status.getSelectedTab    this.attachNode: "+this.attachNode);console.dir({this_attachNode:this.attachNode});console.log("Status.getSelectedTab    this.stageTab: "+this.stagesTab);console.log("Status.getSelectedTab    this.attachNode.selectedChildWidget: "+this.attachNode.selectedChildWidget);console.dir({selectedChildWidget:this.attachNode.selectedChildWidget});if(this.attachNode.selectedChildWidget==this.stagesTab){return "stageStatus";}if(this.attachNode.selectedChildWidget==this.clusterStatus.mainTab){return "clusterStatus";}if(this.attachNode.selectedChildWidget==this.queueStatus.mainTab){return "queueStatus";}return null;},displayWorkflowStatus:function(_15cf){this.workflowStatus.innerHTML="";},displayStageStatus:function(_15d0){console.log("Status.displayStageStatus      status:");console.dir({status:_15d0});this.stageStatus.displayStatus(_15d0);},displayClusterStatus:function(_15d1){console.log("Status.displayClusterStatus      status:");console.dir({status:_15d1});this.clusterStatus.displayStatus(_15d1);},displayQueueStatus:function(_15d2){console.log("Status.displayQueueStatus      status:");console.dir({status:_15d2});this.queueStatus.displayStatus(_15d2);},clear:function(){console.log("Status.clear      plugins.workflow.RunStatus.clear()");this.queueStatus.clearStatus();this.clusterStatus.clearStatus();while(this.stagesStatusContainer.firstChild){this.stagesStatusContainer.removeChild(this.stagesStatusContainer.firstChild);}},setTime:function(stage){console.log("Status.setTime    stage: "+dojo.toJson(stage));this.displayWorkflowTime(stage.now);},displayWorkflowTime:function(time){console.log("Status.displayWorkflowTime    time: "+time);},pauseWorkflow:function(){console.log("Status.pauseWorkflow    ");var _15d3=this.core.userWorkflows.getProject();var _15d4=this.core.userWorkflows.getWorkflow();this.displayWorkflowStatus("pausing");this.checkRunning(_15d3,_15d4,"confirmPauseWorkflow");},stopWorkflow:function(){console.log("Status.stopWorkflow    ");var _15d5=this.core.userWorkflows.getProject();var _15d6=this.core.userWorkflows.getWorkflow();this.displayWorkflowStatus("stopping");this.checkRunning(_15d5,_15d6,"confirmStopWorkflow");},startWorkflow:function(){console.log("Status.startWorkflow    ");var _15d7=this.core.userWorkflows.getProject();var _15d8=this.core.userWorkflows.getWorkflow();this.displayWorkflowStatus("starting");this.checkRunning(_15d7,_15d8,"confirmStartWorkflow");},confirmPauseWorkflow:function(_15d9,_15da,_15db){console.log("Status.confirmPauseWorkflow    project: "+_15d9);console.log("Status.confirmPauseWorkflow    workflow: "+_15da);console.log("Status.confirmPauseWorkflow    isRunning: "+_15db);if(!_15db){this.displayWorkflowStatus("cancelled pause");return;}var _15dc=function(){console.log("WorkflowMenu.confirmPauseWorkflow    noCallback()");};var _15dd=dojo.hitch(this,function(){console.log("WorkflowMenu.confirmPauseWorkflow    yesCallback()");this.doPauseWorkflow();});var _15de=this.core.userWorkflows.indexOfRunningStage();console.log("Status.confirmPauseWorkflow   indexOfRunningStage: "+_15de);this.runner=this.core.runStatus.createRunner(_15de);var title=_15d9+"."+_15da+" is running";var _15df="Are you sure you want to stop it?";this.loadConfirmDialog(title,_15df,_15dd,_15dc);},confirmStartWorkflow:function(_15e0,_15e1,_15e2){console.log("Status.confirmStartWorkflow    project: "+_15e0);console.log("Status.confirmStartWorkflow    workflow: "+_15e1);console.log("Status.confirmStartWorkflow    isRunning: "+_15e2);if(_15e2){this.displayWorkflowStatus("cancelled start");return;}var _15e3=function(){console.log("Status.startWorkflow    noCallback()");};var _15e4=dojo.hitch(this,function(){console.log("Status.startWorkflow    yesCallback()");this.doStartWorkflow();});var title="Run "+_15e0+"."+_15e1+" from start to finish";var _15e5="Please confirm (click Yes to run)";this.loadConfirmDialog(title,_15e5,_15e4,_15e3);},confirmStopWorkflow:function(_15e6,_15e7,_15e8){console.log("Status.confirmStopWorkflow    project: "+_15e6);console.log("Status.confirmStopWorkflow    workflow: "+_15e7);console.log("Status.confirmStopWorkflow    isRunning: "+_15e8);if(!_15e8){this.displayWorkflowStatus("cancelled stop");return;}var _15e9=function(){console.log("Status.stopWorkflow    noCallback()");};var _15ea=dojo.hitch(this,function(){console.log("Status.stopWorkflow    yesCallback()");this.doStopWorkflow();});var title="Stop workflow "+_15e6+"."+_15e7+"?";var _15eb="Please confirm (click Yes to run)";this.loadConfirmDialog(title,_15eb,_15ea,_15e9);},doPauseWorkflow:function(){console.log("Status.doPauseWorkflow    plugins.workflow.RunStatus.pauseWorkflow");this.pauseRun();},doStartWorkflow:function(){console.log("Status.doStartWorkflow    plugins.workflow.RunStatus.startWorkflow");this.runner=this.core.runStatus.createRunner(1);this.runWorkflow(this.runner);},doStopWorkflow:function(){console.log("Status.doStopWorkflow    plugins.workflow.RunStatus.doStopWorkflow()");var _15ec=this.runner.project;var _15ed=this.runner.workflow;var _15ee=this.runner.cluster;var start=this.runner.start;var _15ef=Agua.cookie("username");var _15f0=Agua.cookie("sessionid");dojo.removeClass(this.toggle,"pollingStopped");dojo.addClass(this.toggle,"pollingStarted");this.displayWorkflowStatus("stopping");var url=Agua.cgiUrl+"workflow.cgi";console.log("Status.doStopWorkflow      url: "+url);var query=new Object;query.username=_15ef;query.sessionid=_15f0;query.project=_15ec;query.workflow=_15ed;query.cluster=_15ef+"-"+_15ee;query.mode="stopWorkflow";query.start=start;console.log("Status.doStopWorkflow     query: "+dojo.toJson(query));var _15f1=dojo.xhrPut({url:url,putData:dojo.toJson(query),handleAs:"json",sync:false,load:function(_15f2){Agua.toast(_15f2);}});this.deferreds.push(_15f1);},stopRun:function(){console.log("Status.stopRun    DOING this.stopPolling()");this.stopPolling();if(!this.core.userWorkflows.dropTarget){console.log("workflow.RunStatus.stopRun    Returning because this.core.userWorkflows.dropTarget is null");return;}console.log("Status.stopRun      this.stageStatus: "+this.stageStatus);console.dir({stageStatus:this.stageStatus});if(this.stageStatus==null||this.stageStatus.rows==null||this.stageStatus.rows.length==0){return;}for(var i=0;i<this.stageStatus.rows;i++){var row=this.stageStatus.rows[i];console.log("Status.stopRun    row.status "+i+": "+row.status);if(row.status=="running"){row.status="stopped";}}var _15f3=this.core.userWorkflows.dropTarget.getAllNodes();for(var i=0;i<this.stageNodes;i++){var node=this.stageNodes[i];console.log("Status.stopRun    node "+i+": "+node);if(dojo.hasClass(node,"running")){dojo.removeClass(node,"running");dojo.addClass(node,"stopped");}}this.stopWorkflow();},pauseRun:function(){console.log("Status.pauseRun      DOING this.stopPolling()");this.stopPolling();this.stopWorkflow();if(this.response==null){return;}console.log("Status.pauseRun    Checking "+this.response.length+" stage nodes");for(var i=0;i<this.response.length;i++){if(this.response[i].status=="completed"){continue;}this.runner.start=(startIndex+1);dojo.removeClass(childNodes[i],"waiting");dojo.removeClass(childNodes[i],"running");dojo.removeClass(childNodes[i],"completed");dojo.addClass(childNodes[i],"waiting");break;}},setConfirmDialog:function(){var _15f4=function(){};var _15f5=function(){};var title="Dialog title";var _15f6="Dialog message";this.confirmDialog=new plugins.dijit.ConfirmDialog({title:title,message:_15f6,parentWidget:this,yesCallback:_15f4,noCallback:_15f5});},loadConfirmDialog:function(title,_15f7,_15f8,_15f9){console.log("FileMenu.loadConfirmDialog    yesCallback.toString(): "+_15f8.toString());console.log("FileMenu.loadConfirmDialog    title: "+title);console.log("FileMenu.loadConfirmDialog    message: "+_15f7);console.log("FileMenu.loadConfirmDialog    yesCallback: "+_15f8);console.log("FileMenu.loadConfirmDialog    noCallback: "+_15f9);this.confirmDialog.load({title:title,message:_15f7,yesCallback:_15f8,noCallback:_15f9});},setSequence:function(){this.sequence=new dojox.timing.Sequence({});},setStageStatus:function(){console.log("Status.setStageStatus    DOING new plugins.workflow.RunStatus.StageStatus()");this.stageStatus=new plugins.workflow.RunStatus.StageStatus({core:this.core,attachNode:this.stagesStatusContainer});},setClusterStatus:function(){console.log("Status.setClusterStatus    DOING new plugins.workflow.RunStatus.ClusterStatus()");this.clusterStatus=new plugins.workflow.RunStatus.ClusterStatus({core:this.core,attachNode:this.attachNode});},setQueueStatus:function(){console.log("Status.setQueueStatus    DOING new plugins.workflow.RunStatus.QueueStatus()");this.queueStatus=new plugins.workflow.RunStatus.QueueStatus({core:this.core,attachNode:this.attachNode});}});}if(!dojo._hasResource["plugins.workflow.SharedApps"]){dojo._hasResource["plugins.workflow.SharedApps"]=true;dojo.provide("plugins.workflow.SharedApps");dojo.declare("plugins.workflow.SharedApps",[plugins.workflow.Apps],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n    <div\n        dojoAttachPoint=\"mainTab\"\n        class=\"apps\"\n        dojoType=\"dijit.layout.ContentPane\"\n        parseOnLoad=\"false\"\n        title=\"Bioapps\"\n\t\tstyle=\"position: relative; height: 100%; max-height: auto !important; width: 400px !important; padding: 0 !important;\"\n    >\n\n        <!-- NEED margin-bottom TO COMPENSATE FOR 29px MARGIN-TOP OFFSET FOR TABLE-->\n        <table width=\"200px\">\n\t\t\t<tr valign=\"top\" width=\"100%\">\n\t\t\t\t\n\t\t\t\t<td colspan=\"3\" class=\"tabTitle\" align=\"center\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"refreshButton\"\n\t\t\t\t\t\tdojoAttachPoint=\"refreshButton\"\n\t\t\t\t\t\tdojoAttachEvent=\"onclick:refresh\">\n\t\t\t\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"header\">\n\t\t\t\t\t    Applications\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n            <tr>\n                <td>\n                    <div\n                        dojoAttachPoint=\"appSourcesContainer\"\n\t\t\t\t\t>\n                    </div>\n                    \n                </td>\n            </tr>\n        </table>\n    \n    </div>\n</div>\n",startup:function(){console.log("SharedApps.startup    workflow.SharedApps.startup()");this.inherited(arguments);},setRefreshButton:function(){dojo.connect(this.refreshButton,"onclick",this,"refresh");},refresh:function(){this.updateApps();},updateApps:function(args){console.log("SharedApps.updateApps    Doing Agua.getTable(sharedapps)");this.closePanes();setTimeout(function(_15fa){Data.getTable("sharedApps,sharedParameters");_15fa.loadAppSources();},500,this);},getApps:function(){return Agua.getSharedApps();}});}if(!dojo._hasResource["plugins.workflow.StageRow"]){dojo._hasResource["plugins.workflow.StageRow"]=true;dojo.provide("plugins.workflow.StageRow");dojo.declare("plugins.workflow.StageRow",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n    <table\n        class=\"stagerow\"\n        cellspacing=\"0px\"\n        height=\"16px\" width=\"100%\" style=\"padding: 0; margin: 0; height: 16px !important;\">\n        <tr>\n            <td\n                colspan=\"2\"\n                dojoAttachPoint=\"nameNode\"\n                class=\"name\"\n                >${name}</td>\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"numberNode\"\n                class=\"number\">\n            </td>\n        </tr>\n        <tr>\n            <td\n                colspan=\"1\"\n                dojoAttachPoint=\"executorNode\"\n                class=\"executor\"\n                style=\"display: none;\" >${executor}\n            </td>\n\n            <td \n                colspan=\"2\"\n                dojoAttachPoint=\"submitNode\"\n                class=\"\"\n                style=\"display: none;\" >\n            </td>\n            \n        </tr>\n        <tr>\n            <td colspan=\"3\"\n                dojoAttachPoint=\"locationNode\"\n                class='location'\n                style=\"display: none;\" >${location}\n            </td>\n        </tr>\n        <tr>\n            <td colspan=\"3\"\n                dojoAttachPoint=\"descriptionNode\"\n                class='description'\n                style=\"display: none;\" >${description}\n            </td>\n        </tr>\n    </table>\n</div>\n",widgetsInTemplate:true,cssFiles:[dojo.moduleUrl("plugins")+"/workflow/css/stagerow.css"],parentWidget:null,application:null,core:null,constructor:function(args){this.loadCSS();this.core=args.core;this.parentWidget=args.parentWidget;this.application=new Object;for(var key in args){if(key!="parentWidget"){this.application[key]=args[key];}}},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.name.parentWidget=this;this.setNumber(this.application.number);this.setSubmitStyle(this.application.submit);},setSubmitStyle:function(_15fb){if(_15fb==1){dojo.addClass(this.domNode,"submit");}else{dojo.removeClass(this.domNode,"submit");}},checkValidParameters:function(force){this.checkAllParameters(force);if(this.fileStageParameters.length!=0){this.checkFiles();}else{this.checkRunStatus();}},checkRunStatus:function(){if(this.core.runStatus==null){return;}var _15fc=this.core.userWorkflows.indexOfRunningStage();var _15fd=this.core.runStatus.createRunner(_15fc);var _15fe=true;this.core.runStatus.getStatus(_15fd,_15fe);},checkAllParameters:function(force){this.isValid=true;var _15ff=new Array;var _1600=new Array;if(this.core.parameters!=null&&this.core.parameters.isCurrentApplication(this.application)){_15ff=this.core.parameters.childWidgets;for(var i=0;i<this.core.parameters.childWidgets.length;i++){_1600.push(this.core.parameters.childWidgets[i].parameterObject);}}else{_1600=Agua.getStageParameters(this.application);}if(_1600==null){return false;}this.fileStageParameters=new Array;this.fileParameterRows=new Array;for(var i=0;i<_1600.length;i++){_1600[i].value=this.systemVariables(_1600[i].value,_1600[i]);var _1601=Agua.getParameterValidity(_1600[i]);if(force!=true&&_1601!=null&&_1601!=false){if(_15ff[i]!=null){if(_1601==true){_15ff[i].setValid(_15ff[i].containerNode);}else{_15ff[i].setInvalid(_15ff[i].containerNode);this.isValid=false;}}continue;}else{if(_1600[i].valuetype=="flag"){continue;}}if(_1600[i].valuetype=="file"||_1600[i].valuetype=="directory"){this.checkValidFile(_1600[i],_15ff[i]);}else{if(_1600[i].valuetype=="integer"){this.checkValidInteger(_1600[i],_15ff[i]);}else{this.checkValidText(_1600[i],_15ff[i]);}}}if(this.fileStageParameters.length==0){if(this.isValid==false||this.isValid==null){this.setInvalid();}else{this.setValid();}return this.isValid;}},currentParametersApplication:function(_1602){var keys=["project","workflow","workflownumber","name","number"];return this._objectsMatchByKey(_1602,this.core.parameters.application,keys);},checkFiles:function(files){if(files==null){files=this.fileStageParameters;}var url=Agua.cgiUrl+"workflow.cgi";var query=new Object;query.username=Agua.cookie("username");query.sessionid=Agua.cookie("sessionid");query.project=this.application.project;query.workflow=this.application.workflow;query.mode="checkFiles";query.files=files;var _1603=this;var _1604=dojo.xhrPut({url:url,contentType:"text",sync:false,handleAs:"json",putData:dojo.toJson(query),handle:function(_1605,_1606){_1603.validateFiles(files,_1605);if(_1603.core.parameters!=null&&_1603.core.parameters.isCurrentApplication(_1603.application)){_1603.checkRunStatus();}}});if(this.isValid==false||this.isValid==null){this.setInvalid();}else{this.setValid();}return this.isValid;},validateFiles:function(_1607){if(_1607==null||_1607.length==null||!_1607.length){return;}for(var i=0;i<_1607.length;i++){var _1608=this.fileParameterRows[i];if(this.fileStageParameters&&this.fileStageParameters[i]){Agua.setFileInfo(this.fileStageParameters[i],_1607[i]);}if(_1607[i].exists=="true"){if(_1607[i].type!=this.fileStageParameters[i].valuetype){Agua.setParameterValidity(this.fileStageParameters[i],false);this.isValid=false;if(_1608!=null){_1608.setInvalid(_1608.containerNode);}}else{Agua.setParameterValidity(this.fileStageParameters[i],true);if(_1608!=null){_1608.setValid(_1608.containerNode);}}}else{if(this.fileStageParameters[i].discretion=="essential"){this.isValid=false;Agua.setParameterValidity(this.fileStageParameters[i],false);if(_1608!=null){_1608.setInvalid(_1608.containerNode);}}else{Agua.setParameterValidity(this.fileStageParameters[i],true);if(_1608!=null){_1608.setValid(_1608.containerNode);}}}}if(this.isValid==false){this.setInvalid();}else{this.setValid();}},checkValidFile:function(_1609,_160a){var _160b=_1609.value;if(_1609.discretion=="required"||_1609.discretion=="essential"){if(_160b==null||_160b==""){this.setInvalidParameter(_1609,_160a);}else{if(_1609.fileinfo==null){this.fileStageParameters.push(_1609);this.fileParameterRows.push(_160a);}else{if(_1609.fileinfo.exists=="false"){if(_1609.chained==null||_1609.chained==0){this.fileStageParameters.push(_1609);this.fileParameterRows.push(_160a);}else{this.setValidParameter(_1609,_160a);}}else{if(_1609.fileinfo.type!=_1609.valuetype){this.setInvalidParameter(_1609,_160a);}else{this.setValidParameter(_1609,_160a);}}}}}else{if(_1609.value==null||_1609.value==""){this.setValidParameter(_1609,_160a);}else{this.fileStageParameters.push(_1609);this.fileParameterRows.push(_160a);}}},checkValidInteger:function(_160c,_160d){if(_160c.discretion!="optional"){if(_160c.value==null||_160c.value==""){this.setInvalidParameter(_160c,_160d);}else{if(!_160c.value.match(/^\s*[\d\.]+\s*$/)){this.isValid=false;Agua.setParameterValidity(_160c,false);}else{this.setValidParameter(_160c,_160d);}}}else{if(_160c.value!=null&&_160c.value!=""&&!_160c.value.match(/^\s*[\d\.]+\s*$/)){this.setInvalidParameter(_160c,_160d);}else{this.setValidParameter(_160c,_160d);}}},checkValidText:function(_160e,_160f){if(_160e.discretion!="optional"){if(_160e.value==null||_160e.value==""){this.setInvalidParameter(_160e,_160f);}else{this.setValidParameter(_160e,_160f);}}else{this.setValidParameter(_160e,_160f);}},toggle:function(){var array=["executor","localonly","location","description","notes"];for(var i in array){if(this[array[i]].style.display=="table-cell"){this[array[i]].style.display="none";}else{this[array[i]].style.display="table-cell";}}},setInvalidParameter:function(_1610,_1611){this.isValid=false;Agua.setParameterValidity(_1610,false);if(_1611!=null){_1611.setInvalid(_1611.containerNode);}},setValidParameter:function(_1612,_1613){Agua.setParameterValidity(_1612,true);if(_1613!=null){_1613.setValid(_1613.containerNode);}},setValid:function(){dojo.removeClass(this.domNode,"unsatisfied");dojo.addClass(this.domNode,"satisfied");this.isValid=true;var _1614=this.core.userWorkflows;_1614.updateRunButton();},setInvalid:function(){dojo.removeClass(this.domNode,"satisfied");dojo.addClass(this.domNode,"unsatisfied");this.isValid=false;var _1615=this.core.userWorkflows;_1615.updateRunButton();},getApplication:function(){return dojo.clone(this.application);},setApplication:function(_1616){this.application=_1616;return this.application;},setNumber:function(_1617){this.application.number=_1617;this.application.appnumber=_1617;this.numberNode.innerHTML=_1617;}});}if(!dojo._hasResource["plugins.workflow.StageMenu"]){dojo._hasResource["plugins.workflow.StageMenu"]=true;dojo.provide("plugins.workflow.StageMenu");dojo.declare("plugins.workflow.StageMenu",[dijit._Widget,dijit._Templated,plugins.core.Common],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n<div\n    dojoAttachPoint=\"menu\"\n    class=\"stagemenu\"\n    dojoType=\"plugins.menu.Menu\">\n\n    <div\n        dojoAttachPoint=\"runNode\"\n        dojoType=\"dijit.MenuItem\"\n        class=\"runIcon\"\n        dojoAttachEvent=\"onClick:run\"    \n        >\n        Run\n    </div>\n\n    <div\n        dojoAttachPoint=\"runAllNode\"\n        dojoType=\"dijit.MenuItem\"\n        class=\"runAllIcon\"\n        dojoAttachEvent=\"onClick:runAll\"    \n        >\n        Run All\n    </div>\n\n    <div\n        dojoAttachPoint=\"chainNode\"\n        dojoType=\"dijit.MenuItem\"\n        class=\"chainIcon\"\n        dojoAttachEvent=\"onClick:chain\"    \n        >\n        Chain\n    </div>\n\n    <div\n        dojoAttachPoint=\"refreshNode\"\n        dojoType=\"dijit.MenuItem\"\n        class=\"refreshIcon\"\n        dojoAttachEvent=\"onClick:refresh\"    \n        >\n        Refresh\n    </div>\n\n    <div\n        dojoAttachPoint=\"stopNode\"\n        dojoType=\"dijit.MenuItem\"\n        class=\"stopIcon\"\n        dojoAttachEvent=\"onClick:stop\"    \n        >\n        Stop\n    </div>\n\n    <div\n        dojoAttachPoint=\"removeNode\"\n        dojoType=\"dijit.MenuItem\"\n        class=\"deleteIcon\"\n        dojoAttachEvent=\"onClick:remove\"    \n        >\n        Delete\n    </div>\n\n</div>\n",widgetsInTemplate:true,addingApp:false,cssFiles:[dojo.moduleUrl("plugins")+"/workflow/css/stagemenu.css"],parentWidget:null,core:null,constructor:function(args){console.log("StageMenu.constructor     plugins.workflow.StageMenu.constructor");this.core=args.core;console.log("StageMenu.constructor     this.core: "+this.core);this.parentWidget=args.parentWidget;this.loadCSS();},postCreate:function(){this.startup();},startup:function(){this.inherited(arguments);this.setMenu();},setMenu:function(){},bind:function(node){if(node==null){}return this.menu.bindDomNode(node);},remove:function(event){console.log("StageMenu.remove     plugins.workflow.StageMenu.remove(event)");var node=this.menu.currentTarget;var _1618=dijit.getEnclosingWidget(node);var _1619=_1618.getApplication();if(_1618==null){return;}var _161a=_1618.domNode.parentNode;this.parentWidget.dropTarget.delItem(_161a.id);dojo.destroy(_161a);var _161b=Agua.cookie(_161b);var _161c={username:_161b,project:this.parentWidget.projectCombo.getValue(),workflow:this.parentWidget.workflowCombo.getValue(),name:_1619.name,owner:_1619.owner,number:_1619.number,type:_1619.type};setTimeout(function(_161d){console.log("StageMenu.remove     Doing Agua.spliceStage(stageObject); }, 100, this)");Agua.spliceStage(_161c);},100,this);var _161e=this.parentWidget.dropTarget.getAllNodes();for(var i=_1619.number;i<_161e.length;i++){_161e[i].application.number=(i+1).toString();}for(var i=0;i<_161e.length;i++){var node=_161e[i];var _1618=dijit.byNode(node.firstChild);if(_1618==null){_1618=dijit.getEnclosingWidget(_161e[i]);}node.application.number=(i+1).toString();node.application.appnumber=(i+1).toString();_1618.setNumber(node.application.number);console.log("StageMenu.remove     Reset widget childNodes["+i+"].application.name "+node.application.name+", node.application.number: "+node.application.number);}console.log("StageMenu.remove    this.parentWidget: "+this.parentWidget);if(_161e.length){this.parentWidget.loadParametersPane(_161e[0]);}else{this.parentWidget.clearParameters();}this.parentWidget.updateRunButton();console.log("StageMenu.remove    Doing this.core.userWorkflows.checkRunStatus()");this.core.runStatus.polling=false;this.core.userWorkflows.checkRunStatus();},run:function(){console.log("StageMenu.run     plugins.workflow.StageMenu.run()");var node=this.menu.currentTarget;var _161f=dijit.getEnclosingWidget(node);var _1620=_161f.getApplication();if(_1620==null){var _161f=node.parentWidget;_1620=_161f.getApplication();}var _1621=this.core.runStatus.createRunner(_1620.number,_1620.number);this.core.runStatus.runWorkflow(_1621);},stop:function(){console.log("StageMenu.stop     plugins.workflow.StageMenu.stop()");var node=this.menu.currentTarget;var _1622=dijit.getEnclosingWidget(node);var _1623=_1622.getApplication();console.log("StageMenu.stop     application: "+dojo.toJson(_1623));if(_1623==null){var _1622=node.parentWidget;_1623=_1622.getApplication();}console.log("StageMenu.stop    application: "+dojo.toJson(_1623));var _1624=this.core.runStatus.createRunner(_1623.number,_1623.number);this.core.runStatus.confirmStopWorkflow();},runAll:function(){console.log("StageMenu.runAll     plugins.workflow.StageMenu.runAll()");var node=this.menu.currentTarget;var _1625=dijit.getEnclosingWidget(node);var _1626=_1625.getApplication();if(_1626==null){var _1625=node.parentWidget;_1626=_1625.getApplication();}var _1627=this.core.runStatus.createRunner(_1626.number);this.core.runStatus.runWorkflow(_1627);},chain:function(){var node=this.menu.currentTarget;var _1628=dijit.getEnclosingWidget(node);var _1629=_1628.getApplication();var _162a={project:this.parentWidget.projectCombo.getValue(),workflow:this.parentWidget.workflowCombo.getValue(),owner:_1629.owner,appname:_1629.name,appnumber:_1629.number,name:_1629.name,number:_1629.number};console.log("StageMenu.chain     DOING this.parentWidget.core.io.chainstage()");console.log("StageMenu.chain     this.parentWidget.core.io: "+this.parentWidget.core.io);var force=true;this.core.io.chainStage(_162a,force);var _162b=_1628.domNode.parentNode;this.core.userWorkflows.loadParametersPane(_162b);},refresh:function(){console.log("StageMenu.refresh     plugins.workflow.StageMenu.refresh()");var node=this.menu.currentTarget;console.dir({node:node});console.log("StageMenu.refresh     plugins.workflow.StageMenu.refresh()");var _162c=dijit.getEnclosingWidget(node);var _162d=_162c.getApplication();var _162e=Agua.cookie("username");var _162f=false;if(_162d.username!=_162e){_162f=true;}var force=true;this.core.parameters.load(node,_162f,force);}});}if(!dojo._hasResource["plugins.workflow.Workflows"]){dojo._hasResource["plugins.workflow.Workflows"]=true;dojo.provide("plugins.workflow.Workflows");if(1){}dojo.declare("plugins.workflow.Workflows",[dijit._Widget,dijit._Templated,plugins.core.Common],{templatePath:null,widgetsInTemplate:true,addingApp:false,cssFiles:[dojo.moduleUrl("plugins","workflow/css/workflows.css")],parentWidget:null,attachNode:null,contextMenu:null,core:null,workflowLoaded:null,dropTargetLoaded:null,ready:false,stageRows:null,workflowType:null,constructor:function(args){console.log("Workflows.constructor     plugins.workflow.Workflows.constructor");this.core=args.core;this.core[this.workflowType]=this;this.parentWidget=args.parentWidget;this.attachNode=args.attachNode;console.log("Workflows.constructor     core.userWorkflows: "+this.core.userWorkflows);console.log("Workflows.constructor     core.sharedWorkflows: "+this.core.sharedWorkflows);this.loadCSS();},postCreate:function(){if(this.preStartup){this.preStartup();}this.startup();if(this.postStartup){this.postStartup();}},startup:function(){console.log("Workflows.startup    plugins.workflow.Workflows.startup()");console.group("Workflows-"+this.id+"    startup");this.ready=false;this.inherited(arguments);this.attachNode.addChild(this.mainTab);this.attachNode.selectChild(this.mainTab);this.setWorkflowIO();this.setSelectiveDialog();this.setInteractiveDialog();this.setContextMenu();this.setDropTarget();this.setProjectCombo();this.setComboButtons();this.setProjectListeners();this.setWorkflowListeners();Agua.updater.subscribe(this,"updateProjects");Agua.updater.subscribe(this,"updateWorkflows");Agua.updater.subscribe(this,"updateClusters");console.log("Workflows.startup    END");console.groupEnd("Workflows-"+this.id+"    startup");},updateProjects:function(args){console.warn("workflow.Workflows.updateProjects    args:");console.dir({args:args});this.setProjectCombo();},updateWorkflows:function(args){console.warn("workflow.Workflows.updateWorkflows    args:");console.dir({args:args});this.setProjectCombo();},updateClusters:function(args){console.warn("admin.Clusters.updateClusters    args:");console.dir({args:args});this.setClusterCombo();},setContextMenu:function(){this.contextMenu=new plugins.workflow.StageMenu({parentWidget:this,core:this.core});},setDroppingApp:function(value){this.droppingApp=value;},setDropTarget:function(){this.dropTarget=new plugins.dnd.Target(this.dropTargetContainer,{accept:["draggableItem"],contextMenu:this.contextMenu,parentWidget:this,core:this.core});if(this.dropTarget==null){console.log("Workflows._setDropTargetNodes    this.dropTarget is null. Returning");return;}},updateDropTarget:function(_1630,_1631){if(this.dropTarget==null){this.dropTarget=new plugins.dnd.Target(this.dropTargetContainer,{accept:["draggableItem"],contextMenu:this.contextMenu,parentWidget:this,core:this.core});}if(this.dropTarget==null){console.log("Workflows._updateDropTargetNodes    this.dropTarget is null. Returning");return;}var _1632=Agua.getStagesByWorkflow(_1630,_1631);if(_1632==null){_1632=[];}this._updateDropTarget(_1632);},_updateDropTarget:function(_1633){console.group("Workflows-"+this.id+"    _updateDropTarget");console.log("Workflows._updateDropTarget    stages.length: "+_1633.length);var _1634=this._updateDropTargetNodes(_1633);this._updateDropTargetStageRows(_1633,_1634);if(_1634.length!=0&&this.shared){console.log("Workflows._updateDropTarget    Shared. Doing this.loadParametersPane(node_0)");this.loadParametersPane(_1634[0]);var _1635=this;setTimeout(function(){console.log("Workflows._updateDropTarget    setTimeout; SET this.ready TO TRUE");_1635.ready=true;},1000);}else{if(_1634.length!=0&&!this.shared){this.checkStages(_1634);}else{if(this.standby){this.standby.hide();}console.log("Workflows._updateDropTarget    Doing this.updateRunButton()");this.updateRunButton();}}console.groupEnd("Workflows-"+this.id+"    _updateDropTarget");},_clearTarget:function(){while(this.dropTargetContainer.firstChild){this.dropTargetContainer.removeChild(this.dropTargetContainer.firstChild);}},_updateDropTargetNodes:function(_1636){this._clearTarget();_1636=this.sortNumericHasharray(_1636,"number");var _1637=new Array;for(var i=0;i<_1636.length;i++){var hash=new Object;hash.data=_1636[i].name;hash.type=["draggableItem"];_1637.push(hash);}console.log("Workflows._updateDropTargetNodes     Inserting dataArray: ");console.dir({dataArray:_1637});console.log("Workflows._updateDropTargetNodes    this.dropTarget: "+this.dropTarget);this.dropTarget.insertNodes(false,_1637);console.log("Workflows._updateDropTargetNodes    this.dropTarget: "+this.dropTarget);allNodes=this.dropTarget.getAllNodes();if(!allNodes){allNodes=[];}dojo.forEach(allNodes,function(node,i){var _1638=_1637[i].type;});return allNodes;},_updateDropTargetStageRows:function(_1639,_163a){this.stageRows=new Array;var _163b=this;console.log("Workflows._updateDropTargetStageRows     Workflow.allNodes.length: "+_163a.length);dojo.forEach(_163a,function(node,i){console.log("Workflows._updateDropTargetStageRows     Doing node for stages["+i+"]: ");console.dir({stage:_1639[i]});var _163c=node.innerHTML;node.setAttribute("infoId",_163b.infoId);node.application=_1639[i];console.log("Workflows._updateDropTargetStageRows     stages["+i+"]: ");console.dir({stage:_1639[i]});node.application.description="";_1639[i].description="";_1639[i].notes="";if(_1639[i]["cluster"]==null){_1639[i]["cluster"]="";}console.log("Workflows._updateDropTargetStageRows    stages[i]: ");console.dir({stage:_1639[i]});var _163d=new plugins.workflow.StageRow(_1639[i]);_163d.core=_163b.core;_163d.parentWidget=_163b;_163b.stageRows.push(_163d);node.innerHTML="";node.appendChild(_163d.domNode);node.parentWidget=_163d;_163b.contextMenu.bind(node);dojo.connect(node,"onclick",dojo.hitch(_163b,function(event){console.log("Workflows._updateDropTargetStageRows    ONCLICK call to this.loadParametersPane()");console.log("Workflows._updateDropTargetStageRows    thisObject.ready: "+_163b.ready);event.stopPropagation();if(!_163b.ready){console.log("Workflows._updateDropTargetStageRows    QUTTING because thisObject.ready: "+_163b.ready);return;}this.loadParametersPane(node);}));});},checkStages:function(_163e){console.group("Workflows-"+this.id+"    checkStages");console.log("Workflows.checkStages    caller: "+this.checkStages.caller.nom);var _163f=this.getStandby();_163f.show();var _1640=this;setTimeout(function(){_1640.loadParametersPane(_163e[0]);var _1641=new Array;_1641[0]=[];if(_163e.length>=1){var _1642=0;for(var i=1;i<_163e.length;i++){var _1643=_163e[i].parentWidget;console.log("Workflows.checkStages    stageRows["+i+"]: "+_1643);var force=false;_1643.checkAllParameters(force);var files=_1643.fileStageParameters;console.log("Workflows.checkStages    files: ");console.dir({files:files});if(!files){files=[];}if(files!=[]&&files.length>0){console.log("Workflows.checkStages    Setting filesPresent to 1");_1642=1;}_1641[i]=files;}console.log("Workflows.checkStages    No. stageFiles to be checked: "+_1641.length);console.dir({stageFiles:_1641});if(_1642==1){_1640.checkStageFiles(_1641);}console.log("Workflows.checkStages    DOING this.standby.hide()");_1640.standby.hide();_1640.ready=true;console.log("Workflows.checkStages    SET this.ready TO TRUE");}console.log("Workflows.checkStages    Doing this.updateRunButton()");_1640.updateRunButton();_1640.ready=true;console.log("Workflows.checkStages    SET this.ready: "+_1640.ready);console.groupEnd("Workflows-"+_1640.id+"    checkStages (inside setTimeout)");},100);},checkStageFiles:function(_1644){console.group("Workflows-"+this.id+"    checkStageFiles");console.dir({stageFiles:_1644});var url=Agua.cgiUrl+"workflow.cgi";var query=new Object;query.username=Agua.cookie("username");query.sessionid=Agua.cookie("sessionid");query.project=this.getProject();query.workflow=this.getWorkflow();query.mode="checkStageFiles";query.stagefiles=_1644;var _1645=this;dojo.xhrPut({url:url,contentType:"text",sync:false,handleAs:"json",putData:dojo.toJson(query),handle:function(_1646,_1647){if(_1646.error){Agua.toastError(_1646.error);}else{console.log("Workflows.checkStageFiles    Returned stageFileInfos:");console.dir({stageFileInfos:_1646});_1645.validateStageFiles(_1646,_1644);console.groupEnd("Workflows-"+this.id+"    checkStageFiles");}_1645.standby.hide();console.log("StagescheckStageFiles    BEFORE Do checkRunStatus()");if(_1645.core.parameters!=null&&_1645.core.parameters.isCurrentApplication(_1645.application)){console.log("StagescheckStageFiles    Doing checkRunStatus()");_1645.checkRunStatus();}}});},validateStageFiles:function(_1648,_1649){console.group("Workflows-"+this.id+"    validateStageFiles");console.dir({stageFileInfos:_1648});console.log("Workflows.validateStageFiles    this.dropTarget: "+this.dropTarget);var _164a=this.dropTarget.getAllNodes();for(var i=1;i<_164a.length;i++){var _164b=_164a[i].parentWidget;var files=_1649[i];var _164c=_1648[i];console.log("Workflows.validateStageFiles    files: ");console.dir({files:files});console.log("Workflows.validateStageFiles    infofiles: ");console.dir({infofiles:_164c});if(!files){return;}if(files!=null&&files.length){_164b.validateFiles(_1648[i]);}}console.groupEnd("Workflows-"+this.id+"    validateStageFiles");},checkRunStatus:function(){console.log("Workflows.checkRunStatus    plugins.workflow.Workflows.checkRunStatus");if(this.core.runStatus==null){return;}console.log("Parameters.load     BEFORE this.indexOfRunningStage()");var _164d=this.indexOfRunningStage();console.log("Parameters.load     indexOfRunningStage: "+_164d);var _164e=this.core.runStatus.createRunner(_164d);var _164f=true;console.log("Parameters.load     DOING runStatus.getStatus");this.core.runStatus.getStatus(_164e,_164f);},getStandby:function(){console.log("Workflows.getStandby    this.standby");if(this.standby){return this.standby;}console.log("Workflows.getStandby    Creating this.standby");var id=dijit.getUniqueId("dojox_widget_Standby");this.standby=new dojox.widget.Standby({target:this.dropTargetContainer,onClick:"reload",text:"Checking stage inputs",id:id,url:"plugins/core/images/agua-biwave-24.png"});document.body.appendChild(this.standby.domNode);return this.standby;},resetNumbers:function(){var _1650=this.dropTarget.getAllNodes();for(var i=0;i<_1650.length;i++){var node=_1650[i];var _1651=dijit.byNode(node.firstChild);if(_1651==null){_1651=dijit.getEnclosingWidget(_1650[i]);}node.application.number=(i+1).toString();node.application.appnumber=(i+1).toString();_1651.setNumber(node.application.number);}},getCluster:function(){if(this.clusterCombo==null){return "";}return this.clusterCombo.get("value");},setClusterCombo:function(){this.settingCluster=true;if(this.shared==true){return;}var _1652=this.getProject();var _1653=this.getWorkflow();var _1654=Agua.getClusters();var _1655=Agua.getClusterByWorkflow(_1652,_1653);if(_1655==null){_1655="";}var regex=Agua.cookie("username")+"-";_1655=_1655.replace(regex,"");var _1656=this.hashArrayKeyToArray(_1654,"cluster");_1656.splice(0,0,"");for(var i=0;i<_1656.length;i++){_1656[i]=_1656[i].replace(regex,"");}_1656=_1656.sort();var data={identifier:"name",items:[]};for(var i in _1656){data.items[i]={name:_1656[i]};}var store=new dojo.data.ItemFileReadStore({data:data});this.clusterCombo.store=store;this.clusterCombo.startup();this.clusterCombo.set("value",_1655);var _1657=_1655;var _1658=Agua.cookie("username");if(_1655){_1657=_1658+"-"+_1655;}this.setClusterNodes(_1657);},checkClusterNodes:function(event){if(event.keyCode==dojo.keys.ENTER){document.body.focus();this.checkNodeNumbers();this.updateClusterNodes();dojo.stopEvent(event);}},setClusterNodes:function(_1659){console.log("Workflows.setClusterNodes    clusterName: "+_1659);if(_1659==null||!_1659){this.minNodes.set("value",0);this.maxNodes.set("value",0);return;}var _165a=Agua.getClusters();console.log("Workflows.setClusterNodes    clusters: ");console.dir({clusters:_165a});_165a=this.filterByKeyValues(_165a,["cluster"],[_1659]);if(_165a==null){return;}if(_165a[0]!=null&&_165a[0].minnodes!=null&&_165a[0].maxnodes!=null){var _165b=_165a[0].minnodes;var _165c=_165a[0].maxnodes;console.log("Workflows.setClusterNodes    minNodes: "+_165b);console.log("Workflows.setClusterNodes    maxNodes: "+_165c);this.minNodes.set("value",_165b);this.maxNodes.set("value",_165c);}},checkNodeNumbers:function(){if(this.minNodes.get("value")>this.maxNodes.get("value")){this.minNodes.set("value",this.maxNodes.get("value"));}},updateClusterNodes:function(){if(!this.ready){return;}var _165d=this.getCluster();if(!_165d){return;}var _165e=Agua.getClusterLongName(_165d);if(this.savingCluster==true){return;}this.savingCluster=true;var _165e=Agua.getClusterLongName(_165d);var _165f=Agua.getClusterObject(_165e);var _1660=this.minNodes.get("value");if(!_1660){this.minNodes.set("value",_165f.minnodes);return;}else{_165f.minnodes=_1660;}var _1661=this.maxNodes.get("value");if(!_1661){this.maxNodes.set("value",_165f.maxnodes);return;}else{_165f.maxnodes=_1661;}Agua._removeCluster(_165f);Agua._addCluster(_165f);this.savingCluster=false;var query=dojo.clone(_165f);query.username=Agua.cookie("username");query.sessionid=Agua.cookie("sessionid");var url=Agua.cgiUrl+"admin.cgi?";query.mode="updateClusterNodes";dojo.xhrPut({url:url,contentType:"text",putData:dojo.toJson(query),handle:function(_1662,_1663){if(_1662.error){Agua.toast(_1662);}}});Agua.updater.update("updateClusters");},saveClusterWorkflow:function(event){if(this.savingCluster==true){return;}this.savingCluster=true;var _1664=this.getCluster();var _1665=Agua.getClusterLongName(_1664);var _1666=this.getProject();var _1667=this.getWorkflow();if(_1666==null||!_1666){return;}if(_1667==null||!_1667){return;}var _1668=new Object;_1668.cluster=_1665;_1668.project=_1666;_1668.workflow=_1667;if(Agua.isClusterWorkflow(_1668)){this.savingCluster=false;return;}Agua._removeClusterWorkflow(_1668);if(!Agua._addClusterWorkflow(_1668)){this.savingCluster=false;return;}this.savingCluster=false;var query=dojo.clone(_1668);query.username=Agua.cookie("username");query.sessionid=Agua.cookie("sessionid");query.mode="saveClusterWorkflow";var url=Agua.cgiUrl+"workflow.cgi?";console.log("Workflows.saveClusterWorkflow    query: "+dojo.toJson(query));Agua.doPut({query:query,url:url});var _1669=_1664;var _166a=Agua.cookie("username");if(_1664){_1669=_166a+"-"+_1664;}this.setClusterNodes(_1669);},clearParameters:function(){if(this.core.parameters==null){return;}this.core.parameters.clear();},loadParametersPane:function(node){console.group("Workflows-"+this.id+"    loadParametersPane");console.log("Workflows.loadParametersPane    plugins.workflow.Workflows.loadParametersPane(node)");if(node==null){console.groupEnd("Workflows-"+this.id+"    loadParametersPane");return;}console.log("Workflows.loadParametersPane    node.application: ");console.dir({application:node.application});if(this.core.parameters!=null){console.log("Workflows.loadParametersPane    Doing this.core.parameters.load(node)");this.core.parameters.load(node);}else{}console.groupEnd("Workflows-"+this.id+"    loadParametersPane");},setWorkflowIO:function(){if(this.core.io==null){this.core.io=new plugins.workflow.IO({parentWidget:this,core:this.core});}},getChainedValues:function(node){if(node.application==null){return;}if(node.application.number==null){this.quit("Workflows.getChainedValues    node.application.number is null. Returning.");return;}var force=true;this.core.io.chainStage(node.application,force);},chainStages:function(force){console.log("Workflows.chainStages     plugins.workflow.Workflow.chainStages(force)");console.log("Workflows.chainStages     force: "+force);console.log("Workflows.chainStages    this.dropTarget: "+this.dropTarget);var nodes=this.dropTarget.getAllNodes();console.log("Workflows.chainStages     nodes.length: "+nodes.length);for(var i=0;i<nodes.length;i++){this.core.io.chainInputs(nodes[i].application,force);if(this.core.parameters!=null){var keys=["project","workflow","workflownumber","name","number"];if(this._objectsMatchByKey(nodes[i].application,this.core.parameters.application,keys)){this.core.parameters.setParameterRowStyles();}}}},getProject:function(){return this.projectCombo.get("value");},setProjectCombo:function(_166b,_166c){this.settingProject=true;this.inherited(arguments);if(_166b==null){_166b=this.projectCombo.getValue();}this.setWorkflowCombo(_166b,_166c);},setProjectListeners:function(){var _166d=this;dojo.connect(this.projectCombo,"onChange",dojo.hitch(this,function(event){var _166e=event;console.log("Workflows.setProjectListeners    this.projectCombo onchange event. DOING this.setWorkflowCombo("+_166e+")");_166d.clearParameters();_166d.clearRunStatus();_166d.setWorkflowCombo(_166e);}));var _166d=this;this.projectCombo._onKey=function(evt){var key=evt.charOrCode;if(key==13){var _166f=_166d.projectCombo.getValue();_166f=_166f.replace(/\s+/g,"");_166d.projectCombo.set("value",_166f);var _1670=new Object;_1670.name=_166f;if(Agua.isProject(_166f)==false){_166d.clearParameters();Agua.addProject(_1670);Agua.updater.update("updateProjects");}if(_166d.projectCombo._popupWidget!=null){_166d.projectCombo._showResultList();}}};},deleteProject:function(event){if(this.doingDelete==true){return;}this.doingDelete=true;if(!Agua.getStages()){return;}var _1671=this.projectCombo.getValue();if(_1671==null||!_1671){this.doingDelete=false;return;}var args=new Object;args.project=_1671;args.workflow=null;this.confirmDelete(args);this.doingDelete=false;},getWorkflow:function(){return this.workflowCombo.get("value");},getWorkflowNumber:function(){var _1672=this.getProject();var _1673=this.getWorkflow();if(_1672==null||_1673==null){return;}return Agua.getWorkflowNumber(_1672,_1673);},setWorkflowCombo:function(_1674,_1675){this.inherited(arguments);if(_1675==null){_1675=this.workflowCombo.getValue();}this.setClusterCombo(_1674,_1675);this.updateDropTarget(_1674,_1675);},setWorkflowListeners:function(){var _1676=this;dojo.connect(_1676.workflowCombo,"onChange",dojo.hitch(this,function(event){var _1677=event;var _1678=_1676.getProject();if(_1676.ready==false){return;}_1676.clearRunStatus();_1676.setClusterCombo(_1678,_1677);_1676.updateDropTarget(_1678,_1677);}));var _1676=this;this.workflowCombo._onKey=function(evt){var key=evt.charOrCode;if(key==13){var _1679=_1676.getProject();var _167a=_1676.getWorkflow();_167a=_167a.replace(/\s+/g,"");_1676.workflowCombo.set("value",_167a);evt.stopPropagation();var _167b=Agua.isWorkflow({project:_1679,name:_167a});if(_167b==false){Agua.addWorkflow({project:_1679,name:_167a});_1676.setWorkflowCombo(_1679,_167a);}if(_1676.workflowCombo._popupWidget!=null){_1676.workflowCombo._showResultList();}}};},newWorkflow:function(_167c,_167d){if(this.doingNewWorkflow==true){return;}this.doingNewWorkflow=true;Agua.addWorkflow({project:_167c,name:_167d});this.doingNewWorkflow=false;this.setWorkflowCombo(_167c,_167d);Agua.addProjectWorkflow(_167c,_167d);},setComboButtons:function(){var _167e=this;dojo.connect(this.deleteProjectButton,"onclick",function(event){_167e.deleteProject(event);});dojo.connect(this.deleteWorkflowButton,"onclick",function(event){_167e.deleteWorkflow(event);});},deleteWorkflow:function(event){if(this.doingDelete==true){return;}this.doingDelete=true;var _167f=this.projectCombo.getValue();if(_167f==null||!_167f){this.doingDelete=false;return;}var _1680=this.workflowCombo.getValue();if(_1680==null||!_1680){this.doingDelete=false;return;}var args=new Object;args.project=_167f;args.workflow=_1680;this.confirmDelete(args);this.doingDelete=false;},indexOfRunningStage:function(){var _1681=this.getProject();var _1682=this.getWorkflow();var _1683=Agua.getStagesByWorkflow(_1681,_1682);var _1684=0;for(var i=0;i<_1683.length;i++){if(_1683[i].status=="running"){return i+1;}}return 0;},updateStageNumber:function(_1685,_1686){var addOk=Agua.updateStageNumber(_1685,_1686);if(!addOk){return;}},clearRunStatus:function(){if(this.core.runStatus==null){return;}this.core.runStatus.clear();this.core.runStatus.polling=false;},updateRunButton:function(){console.log("Workflows.updateRunButton    plugins.workflow.Workflows.updateRunButton()");console.log("Workflows.updateRunButton    this.dropTarget: "+this.dropTarget);if(!this.dropTarget){console.log("Workflows.updateRunButton    Returning because this.dropTarget not defined");return;}var _1687=this.dropTarget.getAllNodes();console.log("Workflows.updateRunButton    stageNodes.length: "+_1687.length);this.isValid=true;for(var i=0;i<_1687.length;i++){var _1688=_1687[i].parentWidget;if(_1688==null){_1688=dijit.byNode(_1687[i].firstChild);}if(_1688==null){this.isValid=false;return;}if(_1688.isValid==false||_1688.isValid==null){this.isValid=false;}}if(this.isValid==true){this.enableRunButton();}else{this.disableRunButton();}},enableRunButton:function(){var node=this.runButton;dojo.removeClass(node,"runButtonDisabled");dojo.addClass(node,"runButtonEnabled");if(node.onclickListener!=null){dojo.disconnect(node.onclickListener);}if(this.shared==true){return;}var _1689=this;node.onclickListener=dojo.connect(node,"onclick",function(event){console.log("Workflows.enableRunButton     runButton onclick triggered");if(_1689.core.runStatus==null){return;}var _168a=_1689.core.runStatus.createRunner(1);_1689.core.runStatus.runWorkflow(_168a);});},disableRunButton:function(){var node=this.runButton;dojo.removeClass(node,"runButtonEnabled");dojo.addClass(node,"runButtonDisabled");if(node.onclickListener!=null){dojo.disconnect(node.onclickListener);}},commitDelete:function(args){if(args.project==null){return;}if(args.workflow!=null){Agua.removeWorkflow({project:args.project,name:args.workflow});this.clearParameters();var _168b=this.projectCombo.getValue();this.setWorkflowCombo(_168b);Agua.toastMessage({message:"Deleted workflow: "+args.project+"."+args.workflow,type:"message"});Agua.updater.update("updateWorkflows",{originator:this,reload:false});}else{Agua.removeProject({name:args.project});Agua.updater.update("updateProjects");Agua.toastMessage({message:"Deleted project '"+args.project+"'",type:"warning"});Agua.updater.update("updateProjects",{originator:this,reload:false});}},confirmDelete:function(args){var _168c=this;var _168d=function(){_168c.commitDelete(args);};var _168e=function(){};var title="Delete project: "+args.project+"?";if(args.workflow!=null){title="Delete workflow: "+args.workflow+"?";}var _168f="All stages and data will be destroyed<br><span style='color: #222;'>Click 'Yes' to delete or 'No' to cancel</span>";if(args.workflow!=null){_168f="All data will be destroyed<br><span style='color: #222;'>Click 'Yes' to delete or 'No' to cancel</span>";}if(this.confirm!=null){this.confirm.destroy();}this.confirm=new plugins.dijit.Confirm({parentWidget:this,title:title,message:_168f,yesCallback:_168d,noCallback:_168e});this.confirm.show();},setSelectiveDialog:function(){var _1690=function(){};var _1691=function(){};var title="";var _1692="";var _1693="";this.selectiveDialog=new plugins.dijit.SelectiveDialog({title:title,message:_1692,inputMessage:_1693,parentWidget:this,enterCallback:_1690,cancelCallback:_1691});},loadSelectiveDialog:function(title,_1694,_1695,_1696,_1697,_1698,_1699,_169a){this.selectiveDialog.load({title:title,message:_1694,comboValues:_1695,inputMessage:_1696,comboMessage:_1697,checkboxMessage:_1698,parentWidget:this,enterCallback:_1699,cancelCallback:_169a});},setInteractiveDialog:function(){var _169b=function(){};var _169c=function(){};var title="";var _169d="";var _169e="";this.interactiveDialog=new plugins.dijit.InteractiveDialog({title:title,message:_169d,inputMessage:_169e,parentWidget:this,enterCallback:_169b,cancelCallback:_169c});},loadInteractiveDialog:function(title,_169f,_16a0,_16a1,_16a2){this.interactiveDialog.load({title:title,message:_169f,checkboxMessage:_16a2,enterCallback:_16a0,cancelCallback:_16a1});},copyWorkflow:function(){var _16a3=this.projectCombo.get("value");var _16a4=this.workflowCombo.get("value");var _16a5=function(){};var _16a6=this;var _16a7=dojo.hitch(this,function(_16a8,_16a9,_16aa,_16ab){var _16ac="Copy";var _16ad="Cancel";if(_16a8==null||_16a8==""){return;}_16a8=_16a8.replace(/\s+/,"");if(Agua.isWorkflow({project:_16a9,name:_16a8})==true){_16ab.messageNode.innerHTML="/"+_16a8+"' already exists in '"+_16a9+"'";return;}else{_16ab.messageNode.innerHTML="Creating workflow";_16ab.close();}_16a6._copyWorkflow(_16a3,_16a4,_16a9,_16a8,_16aa);});this.selectiveDialog.load({title:"Copy Workflow",message:"Source: '"+_16a3+":"+_16a4+"'",comboValues:Agua.getProjectNames(),inputMessage:"Workflow",comboMessage:"Project",checkboxMessage:"Copy files",parentWidget:this,enterCallback:_16a7,cancelCallback:_16a5,enterLabel:"Copy",cancelLabel:"Cancel"});},_copyWorkflow:function(_16ae,_16af,_16b0,_16b1,_16b2){var _16b3=Agua.cookie("username");var _16b4=Agua.copyWorkflow(_16b3,_16ae,_16af,_16b3,_16b0,_16b1,_16b2);if(_16b4==true){this.setProjectCombo(_16b0,_16b1);}},copyProject:function(){var _16b5=this.projectCombo.get("value");var _16b6=function(){};var _16b7=this;var _16b8=dojo.hitch(this,function(_16b9,_16ba,_16bb){if(_16b9==null||_16b9==""){return;}_16b9=_16b9.replace(/\s+/,"");if(Agua.isProject(_16b9)==true){_16bb.messageNode.innerHTML="Project name already exists";return;}else{_16bb.messageNode.innerHTML="Creating project";_16bb.close();}_16b7._copyProject(_16b5,_16b9,_16ba);});this.interactiveDialog.load({title:"Copy Project",message:"Please enter project name",checkboxMessage:"Copy files",enterCallback:_16b8,cancelCallback:_16b6});},_copyProject:function(_16bc,_16bd,_16be){var _16bf=Agua.cookie("username");Agua.copyProject(_16bf,_16bc,_16bf,_16bd,_16be);this.setProjectCombo(_16bd);}});}if(!dojo._hasResource["plugins.workflow.SharedWorkflows"]){dojo._hasResource["plugins.workflow.SharedWorkflows"]=true;dojo.provide("plugins.workflow.SharedWorkflows");dojo.declare("plugins.workflow.SharedWorkflows",[plugins.workflow.Workflows],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n    <!-- SHARED TAB -->\n    <div\n        dojoAttachPoint=\"mainTab\"\n        dojoAttachEvent=\"onclick:assumeFocus\"\n        dojoType=\"dijit.layout.ContentPane\"\n        title=\"Shared\"\n        class=\"workflows\"\n        parseOnLoad=\"false\"\n        style=\" height: 100%; width: 100%; padding: 0 !important;\"\n        >\n            \n        <table width=\"100%\">\n            <tr>\n                <td colspan=\"4\" class=\"tabTitle\" align=\"center\">Shared Workflows</td>\n            </tr>\n            <tr>\n                <td class=\"projectTitle\" colspan=\"3\">User</td>\n            </tr>\n            <tr>\n                <td class=\"usernameIcon\">\n                </td>\n                \n                <td class=\"comboColumn\">\n                    <div dojoType=\"dijit.form.ComboBox\"\n                        dojoAttachPoint=\"usernameCombo\"\n                        class=\"usernameCombo\"\n                        autocomplete=\"false\"\n                    >\n                    </div>\n                </td>\n\n            </tr>\n            <tr>\n                <td class=\"projectTitle\" colspan=\"3\">Project</td>\n            </tr>\n            <tr>\n\n                <td class=\"projectIcon\">\n                </td>\n                \n                <td class=\"comboColumn\">\n                    <div dojoType=\"dijit.form.ComboBox\"\n                        dojoAttachPoint=\"projectCombo\"\n                        class=\"projectCombo\"\n                        autocomplete=\"false\"\n                    >\n                    </div>\n                </td>\n                \n                <td class=\"buttonColumn\">\n                    <div\n                    dojoAttachPoint=\"copyProjectButton\"\n                    dojoAttachEvent=\"onclick:copyProject\"\n                    class=\"copyProjectButton\" \t\t\t\t\t\t\t\t\t\t\t                        width=\"20%\"\n                    title=\"Copy Project\"\n                    align=\"center\"\n                    >\n                    </div>\n                </td>\n\n            </tr>\n            <tr>\n                <td class=\"workflowTitle\" colspan=\"3\">Workflow</td>\n            </tr>\n            <tr>\n\n                <td class=\"workflowIcon\">\n                </td>\n                \n                <td class=\"comboColumn\">\n                    <div dojoType=\"dijit.form.ComboBox\"\n                        dojoAttachPoint=\"workflowCombo\"\n                        class=\"workflowCombo\"\n                        autocomplete=\"false\"\n                    >\n                    </div>\n                </td>\n\n                <td class=\"buttonColumn\">\n                    <div\n                    dojoAttachPoint=\"copyWorkflowButton\"\n                    dojoAttachEvent=\"onclick:copyWorkflow\"\n                    class=\"copyWorkflowButton\"\n                    title=\"Copy Workflow\"\n                    width=\"20%\"\n                    align=\"center\"\n                    >\n                    </div>\n                </td>\n            </tr>\n            \n            <tr>\n                <td \n                    dojoAttachPoint=\"sharedDisplayStatus\"\n                    class=\"displayStatus\"\n                    colspan=\"3\"\n                    >\n                </td>\n            </tr>\n            \n            <tr>\n                <td align=\"center\" width=\"260px\" colspan=\"3\">\n                    <div\n                        dojoAttachPoint=\"dropTargetContainer\"\n                        class=\"dropTarget\"\n                        style=\"position:relative; top: 20px;\">\n                    </div>\n                </td>\n            </tr>\n\n        </table>\n    \n    </div>\n    <!-- END OF SHARED TAB -->\n\n</div>\n",widgetsInTemplate:true,shared:true,parentWidget:null,childWidgets:null,isValid:null,core:null,workflowType:"sharedWorkflows",startup:function(){this.ready=false;this.attachNode.addChild(this.mainTab);this.setSelectiveDialog();this.setInteractiveDialog();this.setContextMenu();this.setDropTarget();this.setUsernameCombo();this.setListeners();Agua.updater.subscribe(this,"updateProjects");this.ready=true;},updateProjects:function(args){},setListeners:function(){var _16c0=this;dojo.connect(this.usernameCombo,"onChange",dojo.hitch(function(event){_16c0.setProjectCombo(event);}));dojo.connect(this.projectCombo,"onChange",dojo.hitch(function(event){var _16c1=_16c0.usernameCombo.get("value");var _16c2=_16c0.projectCombo.get("value");_16c0.setWorkflowCombo(_16c1,_16c2);}));var _16c0=this;dojo.connect(this.workflowCombo,"onChange",dojo.hitch(function(event){var _16c3=_16c0.usernameCombo.get("value");var _16c4=_16c0.projectCombo.get("value");var _16c5=_16c0.workflowCombo.get("value");_16c0.updateDropTarget(_16c3,_16c4,_16c5);}));},enableRunButton:function(){},disableRunButton:function(){},setUsernameCombo:function(){this.inherited(arguments);var _16c6=this.usernameCombo.get("value");this.setProjectCombo(_16c6);},setProjectCombo:function(_16c7,_16c8,_16c9){this.setSharedProjectCombo(_16c7,_16c8,_16c9);if(_16c8==null||!_16c8){_16c8=this.projectCombo.get("value");}this.setWorkflowCombo(_16c7,_16c8);},setWorkflowCombo:function(_16ca,_16cb,_16cc){this.setSharedWorkflowCombo(_16ca,_16cb,_16cc);if(_16cb==null||!_16cb){_16cb=this.projectCombo.get("value");}if(_16cc==null||!_16cc){_16cc=this.workflowCombo.get("value");}this.updateDropTarget(_16ca,_16cb,_16cc);},setDropTarget:function(){this.dropTarget=new plugins.dnd.Target(this.dropTargetContainer,{accept:[],contextMenu:this.contextMenu,parentWidget:this,core:this.core});if(this.dropTarget==null){return;}},updateDropTarget:function(_16cd,_16ce,_16cf){if(!this.ready){return;}if(!_16cd){return;}if(!_16ce){return;}if(!_16cf){return;}var _16d0=Agua.getSharedStagesByWorkflow(_16cd,_16ce,_16cf);if(_16d0==null){return;}this._updateDropTarget(_16d0);},assumeFocus:function(){var _16d1=thisObject.usernameCombo.get("value");var _16d2=thisObject.projectCombo.get("value");var _16d3=thisObject.workflowCombo.get("value");this.updateDropTarget(_16d1,_16d2,_16d3);},loadParametersPane:function(node){if(node==null){return;}if(this.core.parameters!=null){this.core.parameters.load(node,this.shared);}this.ready=true;},_copyWorkflow:function(_16d4,_16d5,_16d6,_16d7,_16d8){var _16d9=this.usernameCombo.get("value");var _16da=Agua.cookie("username");Agua.copyWorkflow(_16d9,_16d4,_16d5,_16da,_16d6,_16d7,_16d8);Agua.updater.update("updateProjects");},_copyProject:function(_16db,_16dc,_16dd){var _16de=Agua.cookie("username");var _16df=this.usernameCombo.get("value");Agua.copyProject(_16df,_16db,_16de,_16dc,_16dd);Agua.updater.update("updateProjects");}});}if(!dojo._hasResource["plugins.workflow.UserWorkflows"]){dojo._hasResource["plugins.workflow.UserWorkflows"]=true;dojo.provide("plugins.workflow.UserWorkflows");if(1){}dojo.declare("plugins.workflow.UserWorkflows",[plugins.workflow.Workflows],{templateString:"<div dojoAttachPoint=\"containerNode\">\n\n    <div\n        dojoAttachPoint=\"mainTab\"\n        dojoType=\"dijit.layout.ContentPane\"\n        parseOnLoad=\"false\"\n        class=\"workflows\"\n\t\ttitle=\"Workflows\"\n\t\tstyle=\"height: 100%; width: 100%; padding: 0 !important;\"\n    >\n    \n        <table width=\"100%\">\n\t\t\t<tr valign=\"top\" width=\"100%\">\n\t\t\t\t<td colspan=\"4\"class=\"tabTitle\" align=\"center\">\n                    Workflows\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\t\t\n        <table align=\"center\" width=\"100%\">\n\t\t<table width=\"100%\">\n\t\t\t<tr>\n\t\t\t\t<td\n\t\t\t\t\tcolspan=\"3\"\n\t\t\t\t\tdojoAttachPoint=\"syncWorkflowsButton\"\n\t\t\t\t\tclass=\"syncWorkflowsButton\"\n\t\t\t\t\ttitle=\"Click to sync workflows to biorepository\"\n\t\t\t\t\tdojoAttachEvent=\"onclick:showSyncDialog\"\n\t\t\t\t>\n\t\t\t\t\tSync\n\t\t\t\t</td>\n\t\t\t</tr>\n            <tr>\n                <td class=\"workflowTitle\" colspan=\"5\">Cluster</td>\n            </tr>\n\n            <tr align=\"center\">\n\n                <td class=\"clusterIcon\"></td>\n\t\t\t\t<td>\n                    <div\n\t\t\t\t\t\tdojoType=\"dijit.form.ComboBox\"\n                        dojoAttachPoint=\"clusterCombo\"\n\t\t\t\t\t\tdojoAttachEvent=\"onChange:saveClusterWorkflow\"\n                        class=\"clusterCombo\"\n                        autocomplete=\"false\"\n\t\t\t\t\t\tdisabled=\"false\"\n                    >\n                    </div>\n\t\t\t\t</td>\n\t\t\t\t<td>\n\t\t\t\t\t<table>\n\t\t\t\t\t\t<tr class=\"headerRow\">\n\t\t\t\t\t\t\t<td colspan=\"2\"><b>Nodes</b></td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr class=\"headerRow\">\n\t\t\t\t\t\t\t<td>Min</td>\n\t\t\t\t\t\t\t<td>Max</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"minNodes\"\n\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onKeyPress:checkClusterNodes\"\n\t\t\t\t\t\t\t\t\tclass=\"minNodes\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.NumberTextBox\"\n\t\t\t\t\t\t\t\t\tvalue=\"0\"\n\t\t\t\t\t\t\t\t\tconstraints=\"{min:0,max:99999,places:0}\"\n\t\t\t\t\t\t\t\t\tmaxlength=\"5\" \n\t\t\t\t\t\t\t\t\tpromptMessage=\"Minimum nodes: from 0 to 99999\" \n\t\t\t\t\t\t\t\t\tinvalidMessage=\"Minimum nodes: from 0 to 99999\"\n\t\t\t\t\t\t\t\t\ttooltipPosition=\"below\"\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tdojoAttachPoint=\"maxNodes\"\n\t\t\t\t\t\t\t\t\tdojoAttachEvent=\"onKeyPress:checkClusterNodes\"\n\t\t\t\t\t\t\t\t\tclass=\"maxNodes\"\n\t\t\t\t\t\t\t\t\tdojoType=\"dijit.form.NumberTextBox\"\n\t\t\t\t\t\t\t\t\tvalue=\"0\"\n\t\t\t\t\t\t\t\t\tconstraints=\"{min:0,max:99999,places:0}\"\n\t\t\t\t\t\t\t\t\tmaxlength=\"5\" \n\t\t\t\t\t\t\t\t\tpromptMessage=\"Maximum nodes: from 0 to 99999\" \n\t\t\t\t\t\t\t\t\tinvalidMessage=\"Maximum nodes: from 0 to 99999\"\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\t\t\n\t\t\n\t\t<table width=\"100%\">\n            <tr>\n                <td class=\"projectTitle\" colspan=\"4\">Project</td>\n            </tr>\n            <tr>\n\n                <td class=\"projectIcon\">\n                </td>\n                \n                <td>\n                    <div dojoType=\"dijit.form.ComboBox\"\n                        dojoAttachPoint=\"projectCombo\"\n                        class=\"projectCombo\"\n                        autocomplete=\"false\"\n                    >\n                    </div>\n                </td>\n                \n                <td\n                    dojoAttachPoint=\"copyProjectButton\"\n\t\t\t\t\tdojoAttachEvent=\"onclick:copyProject\"\n                    class=\"copyProjectButton\" \t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"20%\"\n                    align=\"center\"\n                    class=\"fileUpload\" >\n                </td>\n\n                <td\n                    dojoAttachPoint=\"deleteProjectButton\"\n                    class=\"deleteProjectButton\" \t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"20%\"\n                    align=\"center\"\n                    class=\"fileUpload\" >\n                </td>\n\n            </tr>\n            <tr>\n                <td class=\"workflowTitle\" colspan=\"4\">Workflow</td>\n            </tr>\n            <tr>\n\n                <td class=\"workflowIcon\">\n                </td>\n\n                <td>\n                    <div dojoType=\"dijit.form.ComboBox\"\n                        dojoAttachPoint=\"workflowCombo\"\n                        class=\"workflowCombo\"\n                        autocomplete=\"false\"\n                    >\n                    </div>\n                </td>\n\n                <td \n                    dojoAttachPoint=\"copyWorkflowButton\"\n\t\t\t\t\tdojoAttachEvent=\"onclick:copyWorkflow\"\n                    class=\"copyWorkflowButton\" \t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"20%\"\n                    align=\"center\"\n                    class=\"fileUpload\" >\n                </td>\n\n                <td \n                    dojoAttachPoint=\"deleteWorkflowButton\"\n                    class=\"deleteWorkflowButton\" \t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"20%\"\n                    align=\"center\"\n                    class=\"fileUpload\" >\n                </td>\n\n            </tr>\n        </table>\n\t\t\n        <table align=\"center\" width=\"260px\">\n            <tr align=\"center\" >\n\n                <td width=80px\n                    colspan=\"3\"\n                    dojoAttachPoint=\"runButton\"\n                    class=\"runButton runButtonDisabled\"\n                    width=\"100%\"\n                    style=\"-moz-user-select: none !important; padding-left: 0px;\">\n                    Run Workflow\n                </td>\n\n            </tr>\n\n            <tr>\n                <td \n                    dojoAttachPoint=\"displayStatus\"\n                    class=\"displayStatus\"\n                    colspan=\"3\"\n                    >\n                </td>\n            </tr>\n            \n            <tr>\n                <td colspan=\"3\">\n                    <div\n                        dojoAttachPoint=\"dropTargetContainer\"\n                        class=\"dropTarget\" >\n                    </div>\n                </td>\n            </tr>\n\n        </table>\n\n    \n    </div>\n    <!-- END OF WORKFLOWS TAB -->\n    \n\n</div>\n",widgetsInTemplate:true,contextMenu:null,workflowType:"userWorkflows",syncDialog:null,constructor:function(args){console.log("Stages.constructor     plugins.workflow.UserWorkflows.constructor");this.core=args.core;this.core[this.workflowType]=this;this.parentWidget=args.parentWidget;this.attachNode=args.attachNode;this.loadCSS();},preStartup:function(){console.group("UserWorkflows-"+this.id+"    preStartup");console.log("HERE");console.log("UserWorkflows.preStartup    END");console.groupEnd("UserWorkflows-"+this.id+"    preStartup");},postStartup:function(){console.group("UserWorkflows-"+this.id+"    postStartup");this.setSyncWorkflows();Agua.updater.subscribe(this,"updateSyncWorkflows");this.setSyncDialog();console.groupEnd("UserWorkflows-"+this.id+"    postStartup");},updateSyncWorkflows:function(args){console.warn("UserWorkflows.updateSyncWorkflows    args:");console.dir({args:args});this.setSyncWorkflows();},setSyncWorkflows:function(){var hub=Agua.getHub();console.log("UserWorkflows.setSyncWorkflows    hub:");console.dir({hub:hub});if(!hub.login||!hub.token){this.disableSyncWorkflows();}else{this.enableSyncWorkflows();}},setSyncDialog:function(){console.log("UserWorkflows.loadSyncDialog    plugins.workflows.UserWorkflows.setSyncDialog()");var _16e0=function(){};var _16e1=function(){};var title="Sync";var _16e2="Sync Workflows";this.syncDialog=new plugins.dijit.SyncDialog({title:title,header:_16e2,parentWidget:this,enterCallback:_16e0});console.log("UserWorkflows.loadSyncDialog    this.syncDialog:");console.dir({this_syncDialog:this.syncDialog});},showSyncDialog:function(){var _16e3=dojo.hasClass(this.syncWorkflowsButton,"disabled");console.log("UserWorkflows.loadSyncDialog    disabled: "+_16e3);if(_16e3){console.log("UserWorkflows.loadSyncDialog    SyncWorkflows is disabled. Returning");return;}var title="Sync Workflows";var _16e4="";var _16e5="";var _16e6="";var _16e7=dojo.hitch(this,"syncWorkflows");this.loadSyncDialog(title,_16e4,_16e5,_16e6,_16e7);},loadSyncDialog:function(title,_16e8,_16e9,_16ea,_16eb){console.log("UserWorkflows.loadSyncDialog    title: "+title);console.log("UserWorkflows.loadSyncDialog    header: "+_16e8);console.log("UserWorkflows.loadSyncDialog    message: "+_16e9);console.log("UserWorkflows.loadSyncDialog    details: "+_16ea);console.log("UserWorkflows.loadSyncDialog    enterCallback: "+_16eb);this.syncDialog.load({title:title,header:_16e8,message:_16e9,details:_16ea,enterCallback:_16eb});},disableSyncWorkflows:function(){dojo.addClass(this.syncWorkflowsButton,"disabled");dojo.attr(this.syncWorkflowsButton,"title","Input AWS private key and public certificate to enable Sync");},enableSyncWorkflows:function(){dojo.removeClass(this.syncWorkflowsButton,"disabled");dojo.attr(this.syncWorkflowsButton,"title","Click to sync workflows to biorepository");},syncWorkflows:function(_16ec){console.log("Hub.syncWorkflows    inputs: ");console.dir({inputs:_16ec});if(this.syncingWorkflows==true){console.log("Hub.syncWorkflows    this.syncingWorkflows: "+this.syncingWorkflows+". Returning.");return;}this.syncingWorkflows=true;var query=new Object;query.username=Agua.cookie("username");query.sessionid=Agua.cookie("sessionid");query.message=_16ec.message;query.details=_16ec.details;query.hubtype="github";query.mode="syncWorkflows";console.log("Hub.syncWorkflows    query: ");console.dir({query:query});var url=Agua.cgiUrl+"workflow.cgi?";var _16ed=this;dojo.xhrPut({url:url,contentType:"json",putData:dojo.toJson(query),load:function(_16ee,_16ef){_16ed.syncingWorkflows=false;console.log("Workflows.syncWorkflows    OK. response:");console.dir({response:_16ee});Agua.toast(_16ee);},error:function(_16f0,_16f1){_16ed.syncingWorkflows=false;console.log("Workflows.syncWorkflows    ERROR. response:");console.dir({response:_16f0});Agua.toast(_16f0);}});}});}dojo.i18n._preloadLocalizations("dojo.nls.",["ROOT","ar","ca","cs","da","de","de-de","el","en","en-gb","en-us","es","es-es","fi","fi-fi","fr","fr-fr","he","he-il","hu","it","it-it","ja","ja-jp","ko","ko-kr","nb","nl","nl-nl","pl","pt","pt-br","pt-pt","ru","sk","sl","sv","th","tr","xx","zh","zh-cn","zh-tw"]);